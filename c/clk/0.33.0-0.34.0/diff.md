# Comparing `tmp/clk-0.33.0-py2.py3-none-any.whl.zip` & `tmp/clk-0.34.0-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,61 +1,61 @@
-Zip file size: 111264 bytes, number of entries: 59
--rw-r--r--  2.0 unx      829 b- defN 23-May-03 20:52 clk/__init__.py
--rw-r--r--  2.0 unx      113 b- defN 23-May-03 20:52 clk/__main__.py
--rw-r--r--  2.0 unx      498 b- defN 23-May-03 20:52 clk/_version.py
--rw-r--r--  2.0 unx    10784 b- defN 23-May-03 20:52 clk/alias.py
--rw-r--r--  2.0 unx      257 b- defN 23-May-03 20:52 clk/atexit.py
--rw-r--r--  2.0 unx      197 b- defN 23-May-03 20:52 clk/click_helpers.py
--rw-r--r--  2.0 unx     6345 b- defN 23-May-03 20:52 clk/colors.py
--rw-r--r--  2.0 unx      350 b- defN 23-May-03 20:52 clk/commandresolver.py
--rw-r--r--  2.0 unx      609 b- defN 23-May-03 20:52 clk/completion.py
--rw-r--r--  2.0 unx    24304 b- defN 23-May-03 20:52 clk/config.py
--rw-r--r--  2.0 unx    26172 b- defN 23-May-03 20:52 clk/core.py
--rw-r--r--  2.0 unx     2927 b- defN 23-May-03 20:52 clk/customcommands.py
--rw-r--r--  2.0 unx     9824 b- defN 23-May-03 20:52 clk/decorators.py
--rw-r--r--  2.0 unx    10627 b- defN 23-May-03 20:52 clk/externalcommands.py
--rw-r--r--  2.0 unx    11284 b- defN 23-May-03 20:52 clk/flow.py
--rw-r--r--  2.0 unx     2836 b- defN 23-May-03 20:52 clk/hook.py
--rw-r--r--  2.0 unx     1035 b- defN 23-May-03 20:52 clk/java.py
--rw-r--r--  2.0 unx     1581 b- defN 23-May-03 20:52 clk/keyrings.py
--rw-r--r--  2.0 unx     5027 b- defN 23-May-03 20:52 clk/keyvaluestore.py
--rw-r--r--  2.0 unx     2187 b- defN 23-May-03 20:52 clk/launcher.py
--rw-r--r--  2.0 unx    45689 b- defN 23-May-03 20:52 clk/lib.py
--rw-r--r--  2.0 unx      629 b- defN 23-May-03 20:52 clk/liblp.py
--rw-r--r--  2.0 unx     4070 b- defN 23-May-03 20:52 clk/log.py
--rw-r--r--  2.0 unx     1274 b- defN 23-May-03 20:52 clk/main.py
--rw-r--r--  2.0 unx      409 b- defN 23-May-03 20:52 clk/monkeypatch.py
--rw-r--r--  2.0 unx      534 b- defN 23-May-03 20:52 clk/netrc.py
--rw-r--r--  2.0 unx    57508 b- defN 23-May-03 20:52 clk/overloads.py
--rw-r--r--  2.0 unx      571 b- defN 23-May-03 20:52 clk/plugin.py
--rw-r--r--  2.0 unx    29744 b- defN 23-May-03 20:52 clk/profile.py
--rw-r--r--  2.0 unx     2595 b- defN 23-May-03 20:52 clk/setup.py
--rw-r--r--  2.0 unx     1151 b- defN 23-May-03 20:52 clk/triggers.py
--rw-r--r--  2.0 unx     3813 b- defN 23-May-03 20:52 clk/types.py
--rw-r--r--  2.0 unx        0 b- defN 23-May-03 20:52 clk/commands/__init__.py
--rw-r--r--  2.0 unx    11121 b- defN 23-May-03 20:52 clk/commands/alias.py
--rw-r--r--  2.0 unx     3882 b- defN 23-May-03 20:52 clk/commands/completion.py
--rw-r--r--  2.0 unx      335 b- defN 23-May-03 20:52 clk/commands/describe.py
--rw-r--r--  2.0 unx      636 b- defN 23-May-03 20:52 clk/commands/echo.py
--rw-r--r--  2.0 unx     5104 b- defN 23-May-03 20:52 clk/commands/env.py
--rw-r--r--  2.0 unx     1430 b- defN 23-May-03 20:52 clk/commands/exec.py
--rw-r--r--  2.0 unx    24302 b- defN 23-May-03 20:52 clk/commands/extension.py
--rw-r--r--  2.0 unx    13490 b- defN 23-May-03 20:52 clk/commands/flowdep.py
--rw-r--r--  2.0 unx     2539 b- defN 23-May-03 20:52 clk/commands/fork.py
--rw-r--r--  2.0 unx      397 b- defN 23-May-03 20:52 clk/commands/help.py
--rw-r--r--  2.0 unx     4290 b- defN 23-May-03 20:52 clk/commands/launcher.py
--rw-r--r--  2.0 unx      684 b- defN 23-May-03 20:52 clk/commands/log.py
--rw-r--r--  2.0 unx     8415 b- defN 23-May-03 20:52 clk/commands/parameter.py
--rw-r--r--  2.0 unx      382 b- defN 23-May-03 20:52 clk/commands/pip.py
--rw-r--r--  2.0 unx     6280 b- defN 23-May-03 20:52 clk/commands/plugin.py
--rw-r--r--  2.0 unx     2145 b- defN 23-May-03 20:52 clk/commands/secret.py
--rw-r--r--  2.0 unx     6652 b- defN 23-May-03 20:52 clk/commands/trigger.py
--rw-r--r--  2.0 unx      669 b- defN 23-May-03 20:52 clk/commands/value.py
--rw-r--r--  2.0 unx    18690 b- defN 23-May-03 20:52 clk/commands/command/__init__.py
--rw-r--r--  2.0 unx     3253 b- defN 23-May-03 20:52 clk/commands/command/_clk.sh
--rw-r--r--  2.0 unx     1082 b- defN 23-May-03 20:52 clk-0.33.0.dist-info/LICENSE
--rw-r--r--  2.0 unx      785 b- defN 23-May-03 20:52 clk-0.33.0.dist-info/METADATA
--rw-r--r--  2.0 unx      110 b- defN 23-May-03 20:52 clk-0.33.0.dist-info/WHEEL
--rw-r--r--  2.0 unx       38 b- defN 23-May-03 20:52 clk-0.33.0.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        4 b- defN 23-May-03 20:52 clk-0.33.0.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     4417 b- defN 23-May-03 20:52 clk-0.33.0.dist-info/RECORD
-59 files, 386905 bytes uncompressed, 104512 bytes compressed:  73.0%
+Zip file size: 112049 bytes, number of entries: 59
+-rw-r--r--  2.0 unx      829 b- defN 23-Jun-26 09:16 clk/__init__.py
+-rw-r--r--  2.0 unx      113 b- defN 23-Jun-26 09:16 clk/__main__.py
+-rw-r--r--  2.0 unx      498 b- defN 23-Jun-26 09:16 clk/_version.py
+-rw-r--r--  2.0 unx    10784 b- defN 23-Jun-26 09:16 clk/alias.py
+-rw-r--r--  2.0 unx      257 b- defN 23-Jun-26 09:16 clk/atexit.py
+-rw-r--r--  2.0 unx      197 b- defN 23-Jun-26 09:16 clk/click_helpers.py
+-rw-r--r--  2.0 unx     6391 b- defN 23-Jun-26 09:16 clk/colors.py
+-rw-r--r--  2.0 unx      350 b- defN 23-Jun-26 09:16 clk/commandresolver.py
+-rw-r--r--  2.0 unx      609 b- defN 23-Jun-26 09:16 clk/completion.py
+-rw-r--r--  2.0 unx    24344 b- defN 23-Jun-26 09:16 clk/config.py
+-rw-r--r--  2.0 unx    26690 b- defN 23-Jun-26 09:16 clk/core.py
+-rw-r--r--  2.0 unx     2927 b- defN 23-Jun-26 09:16 clk/customcommands.py
+-rw-r--r--  2.0 unx     9824 b- defN 23-Jun-26 09:16 clk/decorators.py
+-rw-r--r--  2.0 unx    10627 b- defN 23-Jun-26 09:16 clk/externalcommands.py
+-rw-r--r--  2.0 unx    11284 b- defN 23-Jun-26 09:16 clk/flow.py
+-rw-r--r--  2.0 unx     2836 b- defN 23-Jun-26 09:16 clk/hook.py
+-rw-r--r--  2.0 unx     1035 b- defN 23-Jun-26 09:16 clk/java.py
+-rw-r--r--  2.0 unx     1607 b- defN 23-Jun-26 09:16 clk/keyrings.py
+-rw-r--r--  2.0 unx     5027 b- defN 23-Jun-26 09:16 clk/keyvaluestore.py
+-rw-r--r--  2.0 unx     2187 b- defN 23-Jun-26 09:16 clk/launcher.py
+-rw-r--r--  2.0 unx    46135 b- defN 23-Jun-26 09:16 clk/lib.py
+-rw-r--r--  2.0 unx      629 b- defN 23-Jun-26 09:16 clk/liblp.py
+-rw-r--r--  2.0 unx     4170 b- defN 23-Jun-26 09:16 clk/log.py
+-rw-r--r--  2.0 unx     1274 b- defN 23-Jun-26 09:16 clk/main.py
+-rw-r--r--  2.0 unx      409 b- defN 23-Jun-26 09:16 clk/monkeypatch.py
+-rw-r--r--  2.0 unx      648 b- defN 23-Jun-26 09:16 clk/netrc.py
+-rw-r--r--  2.0 unx    57912 b- defN 23-Jun-26 09:16 clk/overloads.py
+-rw-r--r--  2.0 unx      571 b- defN 23-Jun-26 09:16 clk/plugin.py
+-rw-r--r--  2.0 unx    29745 b- defN 23-Jun-26 09:16 clk/profile.py
+-rw-r--r--  2.0 unx     2595 b- defN 23-Jun-26 09:16 clk/setup.py
+-rw-r--r--  2.0 unx     1151 b- defN 23-Jun-26 09:16 clk/triggers.py
+-rw-r--r--  2.0 unx     3813 b- defN 23-Jun-26 09:16 clk/types.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-26 09:16 clk/commands/__init__.py
+-rw-r--r--  2.0 unx    11121 b- defN 23-Jun-26 09:16 clk/commands/alias.py
+-rw-r--r--  2.0 unx     4326 b- defN 23-Jun-26 09:16 clk/commands/completion.py
+-rw-r--r--  2.0 unx      335 b- defN 23-Jun-26 09:16 clk/commands/describe.py
+-rw-r--r--  2.0 unx      636 b- defN 23-Jun-26 09:16 clk/commands/echo.py
+-rw-r--r--  2.0 unx     5104 b- defN 23-Jun-26 09:16 clk/commands/env.py
+-rw-r--r--  2.0 unx     1695 b- defN 23-Jun-26 09:16 clk/commands/exec.py
+-rw-r--r--  2.0 unx    24302 b- defN 23-Jun-26 09:16 clk/commands/extension.py
+-rw-r--r--  2.0 unx    13490 b- defN 23-Jun-26 09:16 clk/commands/flowdep.py
+-rw-r--r--  2.0 unx     2539 b- defN 23-Jun-26 09:16 clk/commands/fork.py
+-rw-r--r--  2.0 unx      397 b- defN 23-Jun-26 09:16 clk/commands/help.py
+-rw-r--r--  2.0 unx     4290 b- defN 23-Jun-26 09:16 clk/commands/launcher.py
+-rw-r--r--  2.0 unx      684 b- defN 23-Jun-26 09:16 clk/commands/log.py
+-rw-r--r--  2.0 unx     8415 b- defN 23-Jun-26 09:16 clk/commands/parameter.py
+-rw-r--r--  2.0 unx      382 b- defN 23-Jun-26 09:16 clk/commands/pip.py
+-rw-r--r--  2.0 unx     6280 b- defN 23-Jun-26 09:16 clk/commands/plugin.py
+-rw-r--r--  2.0 unx     2145 b- defN 23-Jun-26 09:16 clk/commands/secret.py
+-rw-r--r--  2.0 unx     6652 b- defN 23-Jun-26 09:16 clk/commands/trigger.py
+-rw-r--r--  2.0 unx      669 b- defN 23-Jun-26 09:16 clk/commands/value.py
+-rw-r--r--  2.0 unx    18705 b- defN 23-Jun-26 09:16 clk/commands/command/__init__.py
+-rw-r--r--  2.0 unx     3398 b- defN 23-Jun-26 09:16 clk/commands/command/_clk.sh
+-rw-r--r--  2.0 unx     1082 b- defN 23-Jun-26 09:16 clk-0.34.0.dist-info/LICENSE
+-rw-r--r--  2.0 unx      785 b- defN 23-Jun-26 09:16 clk-0.34.0.dist-info/METADATA
+-rw-r--r--  2.0 unx      110 b- defN 23-Jun-26 09:16 clk-0.34.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx       38 b- defN 23-Jun-26 09:16 clk-0.34.0.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        4 b- defN 23-Jun-26 09:16 clk-0.34.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     4417 b- defN 23-Jun-26 09:16 clk-0.34.0.dist-info/RECORD
+59 files, 389469 bytes uncompressed, 105297 bytes compressed:  73.0%
```

## zipnote {}

```diff
@@ -153,26 +153,26 @@
 
 Filename: clk/commands/command/__init__.py
 Comment: 
 
 Filename: clk/commands/command/_clk.sh
 Comment: 
 
-Filename: clk-0.33.0.dist-info/LICENSE
+Filename: clk-0.34.0.dist-info/LICENSE
 Comment: 
 
-Filename: clk-0.33.0.dist-info/METADATA
+Filename: clk-0.34.0.dist-info/METADATA
 Comment: 
 
-Filename: clk-0.33.0.dist-info/WHEEL
+Filename: clk-0.34.0.dist-info/WHEEL
 Comment: 
 
-Filename: clk-0.33.0.dist-info/entry_points.txt
+Filename: clk-0.34.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: clk-0.33.0.dist-info/top_level.txt
+Filename: clk-0.34.0.dist-info/top_level.txt
 Comment: 
 
-Filename: clk-0.33.0.dist-info/RECORD
+Filename: clk-0.34.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## clk/_version.py

```diff
@@ -4,18 +4,18 @@
 # unpacked source archive. Distribution tarballs contain a pre-generated copy
 # of this file.
 
 import json
 
 version_json = '''
 {
- "date": "2023-05-03T22:50:19+0200",
+ "date": "2023-06-23T14:53:45+0200",
  "dirty": false,
  "error": null,
- "full-revisionid": "7b26e412773789df59a55555c84fafde7ca6f46b",
- "version": "0.33.0"
+ "full-revisionid": "3d1ba16f6b03491db26ee401976c0ff19e29e320",
+ "version": "0.34.0"
 }
 '''  # END VERSION_JSON
 
 
 def get_versions():
     return json.loads(version_json)
```

## clk/colors.py

```diff
@@ -27,15 +27,15 @@
             For example, if the profile is configured to have underline on, the underlined is off.
             """
             colors = kwargs[f'{profile}_color'].copy()
             colors['underline'] = not colors.get('underline')
             return colors
 
         self.profile_to_color = {
-            name[:-len('_color')].replace('_slash_', '/'): value
+            name[:-len('_color')].replace('_slash_', '/').replace('_dash_', '-'): value
             for name, value in kwargs.items()
             if name.endswith('_color')
         }
         if not color:
             for key in self.profile_to_color.copy():
                 self.profile_to_color[key] = None
         self.used_profiles = set()
@@ -111,15 +111,15 @@
                      help='Show profiles in color')(f)
             f = flag('--full/--explicit-only',
                      default=config.get_value('config.show.full', full_default),
                      help='Show the full information, even those guessed from the context')(f)
 
             for profile in config.all_enabled_profiles:
                 f = option(f'--{profile.name.replace("/", "-")}-color',
-                           f"""{profile.name.replace("/", "_slash_")}_color""",
+                           f"""{profile.name.replace("/", "_slash_").replace("-", "_dash_")}_color""",
                            help=f'Color to show the {profile.name} profile',
                            type=ColorType(),
                            default=profiles_colors[profile.short_name])(f)
             return f
 
         if f is None:
             return decorator
```

## clk/config.py

```diff
@@ -118,14 +118,15 @@
 class Config(object):
     app_dir_name = 'clk'
     app_name = 'clk'
     main_command = None
     log_level_default = 'deprecated'
 
     def __init__(self):
+        self.ask_secret_callback = None
         self.settings2 = None
         self.debug_on_command_load_error_callback = False
         self.frozen = False
         self.settings = None
         self.app_dir = get_appdir(self.app_dir_name)
         self.autoflow = None
         self.flowstep = None
```

## clk/core.py

```diff
@@ -313,14 +313,20 @@
     f = main_command_option('--plugin-dirs', help='', callback=plugin_dirs_callback, multiple=True)(f)
     f = main_command_option('--alternate-style',
                             metavar='STYLE',
                             help='Alternate style',
                             callback=alternate_style_callback,
                             default='fg-cyan' if platform.system() == 'Windows' else 'dim-True',
                             type=ColorType())(f)
+    f = main_command_option('--ask-secret/--no-ask-secret',
+                            help=('Interactively ask for the secret if the'
+                                  ' secret manager does not provide it'),
+                            callback=ask_secret_callback,
+                            is_eager=True,
+                            default=None)(f)
     f = main_command_option('-L',
                             '--log-level',
                             default=None,
                             type=click.Choice(LOG_LEVELS.keys()),
                             callback=log_level_callback,
                             help=f"Log level (default to '{Config.log_level_default}')")(f)
     f = main_command_option('-q',
@@ -482,14 +488,21 @@
         config.log_level = value
         if value == 'develop':
             log.default_handler.formatter = log.DevelopColorFormatter()
     return value
 
 
 @main_command_options_callback
+def ask_secret_callback(ctx, attr, value):
+    if value is not None:
+        config.ask_secret_callback = value
+    return value
+
+
+@main_command_options_callback
 def exit_on_log_level_callback(ctx, attr, value):
     log.exit_on_log_level = value
 
 
 @main_command_options_callback
 def debug_callback(ctx, attr, value):
     if value:
```

## clk/keyrings.py

```diff
@@ -12,25 +12,27 @@
 try:
     import keyring.backend
 except ModuleNotFoundError:
     raise click.UsageError('You have to install keyring `pip install keyring` for this to work')
 
 
 class NetrcKeyring(netrc.Netrc, keyring.backend.KeyringBackend):
-    pass
+    priority = 1
 
 
 class DummyFileKeyring(keyring.backend.KeyringBackend):
     """A dummy keyring used only for demonstration purpose.
 
     It stores data in a plain text unencrypted unsecure untrusted json file. The
     path of this file is read from the environment variable DUMMYFILEKEYRINGPATH.
 
     """
 
+    priority = 1
+
     def __init__(self):
         path = os.environ['DUMMYFILEKEYRINGPATH']
         self.path = Path(path)
 
     @property
     def _content(self):
         if not self.path.exists():
```

## clk/lib.py

```diff
@@ -789,17 +789,24 @@
 
 def echo_json(v):
     """Print a value as formatted and colored json"""
     click.echo(colorize_json(v), nl=False)
 
 
 def colorize_json(v):
-    """Format and colorize in json"""
-    from pygments import formatters, highlight, lexers
-    return highlight(json_dumps(v), lexers.JsonLexer(), formatters.TerminalFormatter())
+    """Format and colorize in json.
+
+    Don't colorize in case of using a dumb terminal.
+    """
+    result = json_dumps(v)
+    if os.environ.get('TERM') == 'dumb':
+        return result
+    else:
+        from pygments import formatters, highlight, lexers
+        return highlight(result, lexers.JsonLexer(), formatters.TerminalFormatter())
 
 
 def ordered_unique(ls):
     """Return the list with unique elements while keeping the elements ordered by first appearance"""
     seen = set()
     return [elem for elem in ls if not (elem in seen or seen.add(elem))]
 
@@ -1179,16 +1186,22 @@
 
 
 def flat_map(elem):
     """Transform a list of list in a list with all the elements of the nested lists
 
     >>> flat_map([[1, 2, 3], [4, 5]])
     [1, 2, 3, 4, 5]
+
+    >>> flat_map(dict(one=1, two=2, three=3).items())
+    ['one', 1, 'two', 2, 'three', 3]
+
+    >>> flat_map((1, 2, 3), (4, 5))
+    [1, 2, 3, 4, 5]
     """
-    elem = list(elem)
+    elem = list(map(list, elem))
     return functools.reduce(list.__add__, elem) if elem else []
 
 
 def subkwargs(kwargs, params):
     return {key: value for key, value in kwargs.items() if key in params}
 
 
@@ -1281,15 +1294,18 @@
     """Tabulate the data"""
     from tabulate import tabulate as tabulate_
     if tablefmt == 'key_value':
         from clk.config import config
         data = []
         for kv in tabular_data:
             if len(kv) > 1:
-                data.append('%s %s' % (kv[0], click.style(u' '.join(to_string(v) for v in kv[1:]), **config.alt_style)))
+                toprint = u' '.join(to_string(v) for v in kv[1:])
+                if os.environ.get('TERM') != 'dumb':
+                    toprint = click.style(toprint, **config.alt_style)
+                data.append('%s %s' % (kv[0], toprint))
             else:
                 data.append(str(kv[0]))
         return '\n'.join(data)
     elif tablefmt == 'csv':
         import csv
         f = csv.StringIO()
         csvwriter = csv.writer(f)
```

## clk/log.py

```diff
@@ -1,11 +1,12 @@
 #!/usr/bin/env python
 # -*- coding: utf-8 -*-
 
 import logging
+import os
 import re
 
 import click
 import click_log
 
 
 class DevelopColorFormatter(click_log.core.ColorFormatter):
@@ -37,14 +38,16 @@
 
     def emit(self, record):
         from clk import completion
         if completion.IN_COMPLETION and record.levelno < 40:
             return
         try:
             msg = self.format(record)
+            if os.environ.get('TERM') == 'dumb':
+                msg = click.unstyle(msg)
             click.echo(msg, err=True)
         except Exception:
             self.handleError(record)
         if (exit_on_log_level is not None and record.levelno >= LOG_LEVELS[exit_on_log_level.lower()]):
             raise LogLevelExitException()
```

## clk/netrc.py

```diff
@@ -8,14 +8,15 @@
 class Netrc():
 
     def set_password(self, servicename, username, password):
         raise NotImplementedError
 
     def get_password(self, servicename, username):
         try:
-            authenticator = netrc.netrc(os.path.expanduser('~/.netrc')).authenticators(username)
+            authenticator = netrc.netrc(os.path.expanduser(os.environ.get('CLK_NETRC_LOCATION',
+                                                                          ('~/.netrc')))).authenticators(username)
             return authenticator[2]
         except:  # NOQA: E722
             return None
 
     def delete_password(self, servicename, username, password):
         raise NotImplementedError
```

## clk/overloads.py

```diff
@@ -300,14 +300,16 @@
 
     def get_extra_args(self, implicit_only=False):
         return config.get_parameters(self.path, implicit_only=implicit_only)
 
     def format_help_text(self, ctx, formatter):
         super(ExtraParametersMixin, self).format_help_text(ctx, formatter)
         extra_args = self.get_extra_args()
+        if '--help' in extra_args:
+            extra_args.remove('--help')
         if extra_args:
             formatter.write_paragraph()
             with formatter.indentation():
                 parameters_help = ('The current parameters set for this command are: {}').format(' '.join(extra_args))
                 formatter.write_text(parameters_help)
 
     def parameters_callback_split_value(self, value):
@@ -789,17 +791,23 @@
         key = arg[len('value:'):]
         arg = config.get_settings('value').get(key, {'value': None})['value']
     elif arg.startswith(keyring_prefix):
         from clk.lib import get_keyring
         key = arg[len(keyring_prefix):]
         if res := get_keyring().get_password('clk', key):
             return res
-        else:
-            LOGGER.error(f'Could not find the secret for {key}')
-            exit(1)
+        elif not clk.completion.IN_COMPLETION:
+            message = f'Could not find the secret for {key}'
+            if config.ask_secret_callback:
+                LOGGER.warning(message)
+                from click.termui import prompt
+                return prompt(f'Please provide the secret {key}', hide_input=True, confirmation_prompt=True)
+            else:
+                LOGGER.error(message)
+                exit(1)
     elif arg.startswith('pyeval:'):
         try:
             evaluated_arg = str(eval(arg[len('pyeval:'):]))
             LOGGER.develop('%s evaluated to %s' % (arg, evaluated_arg))
             arg = evaluated_arg
         except Exception:
             LOGGER.develop(traceback.format_exc())
```

## clk/profile.py

```diff
@@ -141,15 +141,15 @@
 
 
 plugin_sources = {}
 
 
 @ProfileFactory.register_directory_profile
 class DirectoryProfile(Profile):
-    extension_name_re = '[a-z0-9_]+'
+    extension_name_re = '[a-z0-9_-]+'
     JSON_FILE_EXTENSION = '.json'
 
     def describe(self):
         print(f'The extension {self.name}'
               f' is located at {self.location} .'
               " Let's try to see what it has to offer.")
         print('##########')
```

## clk/commands/completion.py

```diff
@@ -6,15 +6,15 @@
 
 import click
 
 import clk.completion
 from clk.completion import CASE_INSENSITIVE_ENV
 from clk.config import config
 from clk.decorators import argument, flag, group, option
-from clk.lib import call_me, check_output, quote, updated_env
+from clk.lib import call_me, check_my_output, check_output, quote, updated_env
 from clk.log import get_logger
 from clk.overloads import CommandType
 
 LOGGER = get_logger(__name__)
 
 
 class CompletionConfig(object):
@@ -50,19 +50,22 @@
     """Show the completion code"""
     click.echo(config.completion.content(shell))
 
 
 @completion.command(handle_dry_run=True, ignore_unknown_options=True)
 @option('--description/--no-description', help='Display the argument description')
 @option('--last/--after', help='Complete the last argument')
+@flag('--remove-bash-formatting/--no-remove-bash-formatting',
+      help='Remove the bash formatting, only has effect in bash and with --call',
+      default=True)
 @flag('--call/--no-call', help='Call in a new process.'
       ' --no-call is useful in combination with --post-mortem')
 @argument('command', type=CommandType(recursive=False), help='The command about which to try the completion')
 @argument('args', nargs=-1, help='The arguments to provide to the command')
-def _try(description, last, command, args, call):
+def _try(remove_bash_formatting, description, last, command, args, call):
     """Try the completion"""
     if command == config.main_command.path:
         args = [config.main_command.path] + list(args)
     else:
         args = [config.main_command.path, command] + list(args)
     complete_envvar = '_{}_COMPLETE'.format(config.main_command.path.upper().replace('-', '_'))
     if description:
@@ -76,15 +79,20 @@
             'COMP_CWORD': str(max(0,
                                   len(args) - (1 if last else 0))),
             complete_envvar: 'bash_complete',
         }
     extra_env.update({CASE_INSENSITIVE_ENV: 'ON'} if config.completion.case_insensitive else {})
     with updated_env(**extra_env):
         if call:
-            call_me()
+            if remove_bash_formatting:
+                result = check_my_output()
+                result = '\n'.join([','.join(line.split(',')[1:]) for line in result.splitlines()])
+                click.echo(result)
+            else:
+                call_me()
         else:
             oldvalue = clk.completion.IN_COMPLETION
             clk.completion.IN_COMPLETION = True
             config.main_command()
             clk.completion.IN_COMPLETION = oldvalue
```

## clk/commands/exec.py

```diff
@@ -14,15 +14,20 @@
 @option('--stderr', help='File to which redirecting the standard error')
 @flag('--no-environ/--with-environ',
       help='Disable the environment variables set automatically when running'
       ' the exec command. Might be useful if it conflits with your internal stuff')
 @launcher
 @argument('command', nargs=-1, required=True, type=ExecutableType(), help='The command to execute')
 def exec_(launcher_command, no_environ, launcher, shell, command, stdout, stderr):
-    """Run a command."""
+    """Run a program, like good old times.
+
+    The situations where using clk exec is advised rather than simply calling
+    the program is when you need to embed a command into an alias, or when you
+    want your command to take advantage of the parameters, dry-run or launchers.
+    """
     if launcher:
         launcher_command = config.settings2['launchers'][launcher]
     if shell:
         command = [' '.join([command[0]] + [double_quote(arg) for arg in command[1:]])]
     out = open(stdout, 'wb') if stdout else None
     err = open(stderr, 'wb') if stderr else None
     with updated_env(**({} if no_environ else config.external_commands_environ_variables)):
```

## clk/commands/command/__init__.py

```diff
@@ -354,15 +354,15 @@
 EOF
 }}
 
 clk_help_handler "$@"
 
 {args}
 {body}
-"""
+""".strip() + '\n'
     if from_file:
         script_content = Path(from_file).read_text()
     createfile(script_path, script_content, mode=0o755)
     if replace_alias:
         from clk.core import run
         run(['alias', f'--{profile_name_to_commandline_name(config.customcommands.profile.name)}', 'unset', name])
     if open:
```

## clk/commands/command/_clk.sh

```diff
@@ -1,8 +1,8 @@
-#!/bin/bash -eu
+#!/bin/bash
 
 clk_confirm () {
     local prompt="$1"
     local res
     read -p "${prompt} " res
     if echo "${res}" | grep -iq '^\(y\|yes\)$'
     then
@@ -13,14 +13,18 @@
 }
 
 clk_name_to_env () {
     local name="$1"
     echo "CLK___$(echo "${name}"|sed -r 's/^-+//g'|sed 's/-/_/g'|tr '[:lower:]' '[:upper:]')"
 }
 
+clk_drop_duplicate () {
+    cat -n | sort -uk2 | sort -n | cut -f2-
+}
+
 clk_value ( ) {
     local name="$1"
     local variable="$(clk_name_to_env "${name}")"
     local variable_call="\${${variable}}"
     echo "$(eval "echo \"${variable_call}\"")"
 }
 
@@ -146,18 +150,21 @@
     local file="$1"
     local variable="$2"
     if ! [ -s "${file}" ]
     then
         return 1
     fi
     local thehead="$(head -1 "${file}")"
-    TMPDIR="$(mktemp -d)"
-    trap "rm -rf '${TMPDIR}'" 0
-    tail +2 "${file}" > "${TMPDIR}/temp"
-    mv "${TMPDIR}/temp" "${file}"
+    (
+        # use a subshell to deal with a temp file
+        TMPDIR="$(mktemp -d)"
+        trap "rm -rf '${TMPDIR}'" 0
+        tail +2 "${file}" > "${TMPDIR}/temp"
+        mv "${TMPDIR}/temp" "${file}"
+    )
     read "$2" < <(echo "${thehead}")
 }
 
 clk_out () {
     if clk_debubp
     then
         echo /dev/stdout
```

## Comparing `clk-0.33.0.dist-info/LICENSE` & `clk-0.34.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `clk-0.33.0.dist-info/METADATA` & `clk-0.34.0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: clk
-Version: 0.33.0
+Version: 0.34.0
 Summary: A framework to help you have an awesome CLI
 Author: Samuel Loury
 Author-email: konubinixweb@gmail.com
 Requires-Python: >=3.8
 License-File: LICENSE
 Requires-Dist: click (>=8)
 Requires-Dist: click-log
```

## Comparing `clk-0.33.0.dist-info/RECORD` & `clk-0.34.0.dist-info/RECORD`

 * *Files 26% similar despite different names*

```diff
@@ -1,59 +1,59 @@
 clk/__init__.py,sha256=1b_paKKlrbJ78DaFfb3OVdMO_20b1_HUE1m9RLkTkM8,829
 clk/__main__.py,sha256=vKaitbafosicbokcbkeAsZXMmhTVTzvJw3DAoUgOHCg,113
-clk/_version.py,sha256=49GlUOXx8P12YFYtXwUjh7U_NWztwF8sRZgFg0_LhD0,498
+clk/_version.py,sha256=dYL22SA3dxHCvNeW4Y1Uvb_9_2w1Jseogca7MX1tAho,498
 clk/alias.py,sha256=GsBp6xX7J9yKn0hevSQ3NClnHf1C3XPBQqI8WSWWn9Y,10784
 clk/atexit.py,sha256=2aC22tDsoTqXoO4xVy6E-Sik0i-cF2tSavPPDMv3MSA,257
 clk/click_helpers.py,sha256=dQZR1E7XT9LGpnAT6hd_dHWPydHzSsXQ7j-Xh761blI,197
-clk/colors.py,sha256=BxYoR9Xbl92klrldNfaY_FxPLMhA3YepL5ze0h6jUzU,6345
+clk/colors.py,sha256=nuSiAQxkWAszFI0_Ckwd49jqzSC0CBSV2mID2YEZMJE,6391
 clk/commandresolver.py,sha256=g5t_8RBzsRx8wDo6TWjgN1qOQuOZHPXuzbVpVVIK3KY,350
 clk/completion.py,sha256=sqOcLuHao2jPMAO01m_PduCNFx22PFZPANU2yWVVLMs,609
-clk/config.py,sha256=Iyssv98pcIOPkoVQpr2OG0CXNOQhMYKLAV7h52O85Go,24304
-clk/core.py,sha256=BVM5HXGdbshLaED8D1yALzE4E9bs8TkziejxwvSdQX8,26172
+clk/config.py,sha256=qfqyA_m_m1TroFR6KOnpCLq_nnYc3gTYuHfYuB3NRy8,24344
+clk/core.py,sha256=acfkmfMTjJ0IRHbODzk3K3odOa5Upf4LLiNgzYJDnY4,26690
 clk/customcommands.py,sha256=3GNe9PdZ2g5z83ieJA0Dg6uN5161HN1DoVAaVzpXuUA,2927
 clk/decorators.py,sha256=9wtWGXYhZlXreN82YJWRhALWEmkI6l340cQsSwlHH7k,9824
 clk/externalcommands.py,sha256=myQbvCy3IyjNRGECi2IZcWcb0KJdPRz_oL4qyqgvGUQ,10627
 clk/flow.py,sha256=uifGy0OmZWPCOm_fuAsVr8CuGUa4_ZOqav0847tk3wY,11284
 clk/hook.py,sha256=4siuvsWy0MBB0iIcy3_oSxh0vbE6skQJD4mWrC0Psfk,2836
 clk/java.py,sha256=mRaFzideHjEtXhAtBx-ptW3GNoBySAdgnZ88B22tYzc,1035
-clk/keyrings.py,sha256=WjhDy0wcOXAF0gPWx2FTeRpz5cC7Om2LyPE_ZQ1p49c,1581
+clk/keyrings.py,sha256=uL5CnfPLmN9_N2mCYSm5ohHQv34nlfrra3Vym1ngh70,1607
 clk/keyvaluestore.py,sha256=OX5TmI7PVyeLjELN82PVX1uGfEdb801WyW8vosXPF-c,5027
 clk/launcher.py,sha256=6Lir-dr3RmX80e8MkB_wn_ncpGTr1aGia_BudK5wTDI,2187
-clk/lib.py,sha256=U1hH3aouduR8cUxVSWe3yeIVnP1aCX8bnuqTKEG-dbc,45689
+clk/lib.py,sha256=FOKABK43HWnCk4OWuQCf9ITla7GA3PIfm9EyLZmf6uo,46135
 clk/liblp.py,sha256=UFZUjcaGUlgtLjX8NnjyiHsDcBr1fxCbP3a4DKuV5R4,629
-clk/log.py,sha256=xi60IEIIkmCa1vsoNfHsTyGkPY4GWJDVt2ijMgVzzeU,4070
+clk/log.py,sha256=pCFGSVpQ2Xzd8-9CMlgC62MbuyEHgSRSgy6WzoqBSpY,4170
 clk/main.py,sha256=nUPpwt-j8RPO_vMTEOyzF4RJ9ifjd1TshsLl04ZX3CI,1274
 clk/monkeypatch.py,sha256=vutGYvq4lCjhNuBgVY3YB_5LkZhAx2qeCoJbmdyZHrU,409
-clk/netrc.py,sha256=KmPM2uVeeEmvdXQEtsBiIsem6DWgydI7VjdJ7-cSEZw,534
-clk/overloads.py,sha256=c0GrCWyKE0JQIbUvEZ2-bPWSZG1ESEmebpg3NHKKiQg,57508
+clk/netrc.py,sha256=BzXKMmMX-9u41cSMxHFN5HXG_5EVx5rh3uyZJdDOphc,648
+clk/overloads.py,sha256=OThWJB9OvYAS6j8ig4CiIPbc7ocKKLIHLv4BdE5LWDY,57912
 clk/plugin.py,sha256=FiHwlgHK069XjVUvrkfrn-MxEx6VOEGZWh5qvl7UwiI,571
-clk/profile.py,sha256=E-Mu_DYzXRtTuBtBIReXj3uA4t48406XcJROnt9yxFU,29744
+clk/profile.py,sha256=yfllvNaepj2418Y7FMUpRkMFrSt49tIFBNGSlILwEio,29745
 clk/setup.py,sha256=JgzWw4QQD6VyKcNZsfCOQrB_QDoZkn90GVCl9AfNlnU,2595
 clk/triggers.py,sha256=KzOiHYTYDPpAOp6pCwhgZGBaOyQBF-XP9YRoLRMqXm4,1151
 clk/types.py,sha256=-dbKe2S7lTraLEKLuohItQErxbujmbiGVt5lC9u23zs,3813
 clk/commands/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 clk/commands/alias.py,sha256=VeoMVX50eSR9xsroWnOu94ncP2ZWRu2fNDXC1LTYgro,11121
-clk/commands/completion.py,sha256=7rqlrOnniiYhu2rCHAmVcFlpqQgbFucyRew2vdwHQdE,3882
+clk/commands/completion.py,sha256=SAIc6PYiBJJdhbZMwx5JUw4bw4p42AfCbcequTDoY6w,4326
 clk/commands/describe.py,sha256=wtGzsvrq4uOzHrSsZj-Ta_948z8hbATfExBJqT3iOsw,335
 clk/commands/echo.py,sha256=5iIOv_RzNbJTIJtqtEotzaMz87AwqvmO7gmnilJo9E8,636
 clk/commands/env.py,sha256=iLp-SD3Ejku2xJ2mRI-JH-n9piSXVC1UP3vSSItUGOs,5104
-clk/commands/exec.py,sha256=fADsV3lgrZPYBzgjwlQGYAr4C6M5xjz33bxT64qzGEQ,1430
+clk/commands/exec.py,sha256=lijt8oYVXw82kAWc0tlOcCtBpVgKwWHRdhvWnMus8Ug,1695
 clk/commands/extension.py,sha256=wuxV5Bm7iJKJfjCsVhMo5WTWygBEigmp7W4PpyF487s,24302
 clk/commands/flowdep.py,sha256=52a8XNSGqNyLoM0iGqOsEcbMJry5y5ZZeWP4K-Uz9Ts,13490
 clk/commands/fork.py,sha256=9_W_ho75Ob_ypfMGN5yBCOgyNsHXxNUrI2XnRkjznaw,2539
 clk/commands/help.py,sha256=dHPBaI6qmc_mZBfcBGnB_E3EQWPJkcKjEfA-VrbGT9k,397
 clk/commands/launcher.py,sha256=CSp_zbioHa1fdxxeoHzxzK2_4bPAZHwD4ipObestSgY,4290
 clk/commands/log.py,sha256=nOXghCBwDcUURiZDqlIan_a37OWAIoir6aTKX2sT5r8,684
 clk/commands/parameter.py,sha256=vuwYFSEWtkkMYe9VPCG9erD1JA0ubOI9W-zZxtYw9Kw,8415
 clk/commands/pip.py,sha256=pIp7HTN8Dbtimed7jXskRu9E5vfl22JuWo5TR2PBqnY,382
 clk/commands/plugin.py,sha256=QanpeFiQDpeI7uQ3v1R4LkEBr8vWTg62TDvutO6nOhA,6280
 clk/commands/secret.py,sha256=KdPOFYTkK3JrAYS9JvLSFjMnvyXRkWT7soVIsJOcmVk,2145
 clk/commands/trigger.py,sha256=a3kzhuQuryo5IgWqI4K3cpWDnDGpC0qUc7YJ7SQCUvo,6652
 clk/commands/value.py,sha256=CxPjsnZTsDYUIlmEYYbAlMfPJTIY20oc5XFULPAeyiE,669
-clk/commands/command/__init__.py,sha256=eEQlWimH9fXcS8Wl_-I1RbyTVExFVJdVXiEeH2A_yKQ,18690
-clk/commands/command/_clk.sh,sha256=UMCNk1BKqYo71brH9BqHkVJqsq6AzxKND0971qeW7eY,3253
-clk-0.33.0.dist-info/LICENSE,sha256=8MfbN52orMmmZ4eve6qDoamLiER3GXz2q6FsLqNDfdM,1082
-clk-0.33.0.dist-info/METADATA,sha256=PdEcUZ6pmW0U28gGBlm7ZurnFsB_bFgLhOpW5R_hooY,785
-clk-0.33.0.dist-info/WHEEL,sha256=a-zpFRIJzOq5QfuhBzbhiA1eHTzNCJn8OdRvhdNX0Rk,110
-clk-0.33.0.dist-info/entry_points.txt,sha256=OpxuZvbXy8PcA8xl7x-4yktX1-tXqcaCH4fMWLjUs4s,38
-clk-0.33.0.dist-info/top_level.txt,sha256=12myZpVKwqJKc3kTrZzzjGBuEc-Tg12UM_uLpCpoch0,4
-clk-0.33.0.dist-info/RECORD,,
+clk/commands/command/__init__.py,sha256=vv1Vro8E0DBWwsc7RzjfGO5SJZ4_UCeLOy1SfoICXVo,18705
+clk/commands/command/_clk.sh,sha256=V5RiQUEzfMpSDS-fuAjfaExoNNGEHMsD2XjFCM0ewgM,3398
+clk-0.34.0.dist-info/LICENSE,sha256=8MfbN52orMmmZ4eve6qDoamLiER3GXz2q6FsLqNDfdM,1082
+clk-0.34.0.dist-info/METADATA,sha256=ubda_FqUHNzlo2w6LRp5UmAKxeD90W2xlMLlNJf2Jiw,785
+clk-0.34.0.dist-info/WHEEL,sha256=a-zpFRIJzOq5QfuhBzbhiA1eHTzNCJn8OdRvhdNX0Rk,110
+clk-0.34.0.dist-info/entry_points.txt,sha256=OpxuZvbXy8PcA8xl7x-4yktX1-tXqcaCH4fMWLjUs4s,38
+clk-0.34.0.dist-info/top_level.txt,sha256=12myZpVKwqJKc3kTrZzzjGBuEc-Tg12UM_uLpCpoch0,4
+clk-0.34.0.dist-info/RECORD,,
```

