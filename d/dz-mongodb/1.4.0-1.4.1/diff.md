# Comparing `tmp/dz-mongodb-1.4.0.tar.gz` & `tmp/dz-mongodb-1.4.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dz-mongodb-1.4.0.tar", last modified: Wed Feb 15 08:20:38 2023, max compression
+gzip compressed data, was "dz-mongodb-1.4.1.tar", last modified: Mon Jun 26 09:34:47 2023, max compression
```

## Comparing `dz-mongodb-1.4.0.tar` & `dz-mongodb-1.4.1.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -2,16 +2,16 @@
 00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00000080: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00000090: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+00000080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00000090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 000000a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -26,16 +26,16 @@
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 3237 206d 7469 6d65 3d31 3637 3634 3439  27 mtime=1676449
-00000210: 3233 382e 3431 3134 3336 0a00 0000 0000  238.411436......
+00000200: 3238 206d 7469 6d65 3d31 3638 3737 3732  28 mtime=1687772
+00000210: 3038 372e 3433 3137 3439 380a 0000 0000  087.4317498.....
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -58,24 +58,24 @@
 00000390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000400: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
+00000400: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
 00000410: 2f00 0000 0000 0000 0000 0000 0000 0000  /...............
 00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000460: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
 00000470: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
 00000480: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00000490: 3030 3000 3031 3436 3730 0020 3500 0000  000.014670. 5...
+00000490: 3030 3000 3031 3436 3731 0020 3500 0000  000.014671. 5...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000500: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
@@ -154,24 +154,24 @@
 00000990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000a00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
+00000a00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
 00000a10: 2f4c 4943 454e 5345 0000 0000 0000 0000  /LICENSE........
 00000a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00000a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
 00000a80: 3030 3737 3230 3200 3030 3030 3030 3030  0077202.00000000
-00000a90: 3030 3000 3031 3537 3035 0020 3000 0000  000.015705. 0...
+00000a90: 3030 3000 3031 3537 3036 0020 3000 0000  000.015706. 0...
 00000aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
@@ -2242,16 +2242,16 @@
 00008c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00008c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00008c80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00008c90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
+00008c80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00008c90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 00008ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -2266,16 +2266,16 @@
 00008d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e00: 3237 206d 7469 6d65 3d31 3637 3634 3439  27 mtime=1676449
-00008e10: 3233 382e 3431 3132 3837 0a00 0000 0000  238.411287......
+00008e00: 3238 206d 7469 6d65 3d31 3638 3737 3732  28 mtime=1687772
+00008e10: 3038 372e 3433 3136 3034 310a 0000 0000  087.4316041.....
 00008e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2298,24 +2298,24 @@
 00008f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009000: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
+00009000: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
 00009010: 2f50 4b47 2d49 4e46 4f00 0000 0000 0000  /PKG-INFO.......
 00009020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00009070: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
 00009080: 3030 3131 3637 3000 3030 3030 3030 3030  0011670.00000000
-00009090: 3030 3000 3031 3537 3732 0020 3000 0000  000.015772. 0...
+00009090: 3030 3000 3031 3537 3733 0020 3000 0000  000.015773. 0...
 000090a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009100: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
@@ -2333,15 +2333,15 @@
 000091c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000091d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000091e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000091f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009200: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00009210: 3a20 322e 310a 4e61 6d65 3a20 647a 2d6d  : 2.1.Name: dz-m
 00009220: 6f6e 676f 6462 0a56 6572 7369 6f6e 3a20  ongodb.Version: 
-00009230: 312e 342e 300a 5375 6d6d 6172 793a 2053  1.4.0.Summary: S
+00009230: 312e 342e 310a 5375 6d6d 6172 793a 2053  1.4.1.Summary: S
 00009240: 696e 6765 722e 696f 2074 6170 2066 6f72  inger.io tap for
 00009250: 2065 7874 7261 6374 696e 6720 6461 7461   extracting data
 00009260: 2066 726f 6d20 4d6f 6e67 6f44 4220 2d20   from MongoDB - 
 00009270: 4461 7461 7a69 7020 636f 6d70 6174 6962  Datazip compatib
 00009280: 6c65 0a48 6f6d 652d 7061 6765 3a20 6874  le.Home-page: ht
 00009290: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
 000092a0: 2f64 6174 617a 6970 2f64 7a2d 6d6f 6e67  /datazip/dz-mong
@@ -2682,16 +2682,16 @@
 0000a790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000a800: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-0000a810: 3033 312e 300a 0000 0000 0000 0000 0000  031.0...........
+0000a800: 3232 206d 7469 6d65 3d31 3637 3634 3530  22 mtime=1676450
+0000a810: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
 0000a820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2714,24 +2714,24 @@
 0000a990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000a9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000aa00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
+0000aa00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
 0000aa10: 2f52 4541 444d 452e 6d64 0000 0000 0000  /README.md......
 0000aa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000aa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000aa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000aa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000aa60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 0000aa70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
 0000aa80: 3030 3130 3633 3400 3030 3030 3030 3030  0010634.00000000
-0000aa90: 3030 3000 3031 3631 3533 0020 3000 0000  000.016153. 0...
+0000aa90: 3030 3000 3031 3631 3534 0020 3000 0000  000.016154. 0...
 0000aaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000aab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000aac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000aad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000aae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000aaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ab00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
@@ -3066,16 +3066,16 @@
 0000bf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c000: 3238 206d 7469 6d65 3d31 3637 3634 3439  28 mtime=1676449
-0000c010: 3233 382e 3430 3836 3935 350a 0000 0000  238.4086955.....
+0000c000: 3238 206d 7469 6d65 3d31 3638 3737 3732  28 mtime=1687772
+0000c010: 3038 372e 3432 3936 3838 320a 0000 0000  087.4296882.....
 0000c020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3098,24 +3098,24 @@
 0000c190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c200: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
+0000c200: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
 0000c210: 2f64 7a5f 6d6f 6e67 6f64 622f 0000 0000  /dz_mongodb/....
 0000c220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c260: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
 0000c270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
 0000c280: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-0000c290: 3030 3000 3031 3730 3132 0020 3500 0000  000.017012. 5...
+0000c290: 3030 3000 3031 3730 3133 0020 3500 0000  000.017013. 5...
 0000c2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c300: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
@@ -3162,16 +3162,16 @@
 0000c590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c600: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-0000c610: 3136 362e 300a 0000 0000 0000 0000 0000  166.0...........
+0000c600: 3232 206d 7469 6d65 3d31 3637 3634 3530  22 mtime=1676450
+0000c610: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
 0000c620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3194,24 +3194,24 @@
 0000c790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c800: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
+0000c800: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
 0000c810: 2f64 7a5f 6d6f 6e67 6f64 622f 5f5f 696e  /dz_mongodb/__in
 0000c820: 6974 5f5f 2e70 7900 0000 0000 0000 0000  it__.py.........
 0000c830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 0000c870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
 0000c880: 3030 3237 3036 3000 3030 3030 3030 3030  0027060.00000000
-0000c890: 3030 3000 3032 3131 3330 0020 3000 0000  000.021130. 0...
+0000c890: 3030 3000 3032 3131 3331 0020 3000 0000  000.021131. 0...
 0000c8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c900: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
@@ -4026,16 +4026,16 @@
 0000fb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fc00: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-0000fc10: 3137 312e 300a 0000 0000 0000 0000 0000  171.0...........
+0000fc00: 3232 206d 7469 6d65 3d31 3637 3634 3530  22 mtime=1676450
+0000fc10: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
 0000fc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fc80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4058,24 +4058,24 @@
 0000fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000fe00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
+0000fe00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
 0000fe10: 2f64 7a5f 6d6f 6e67 6f64 622f 636f 6e66  /dz_mongodb/conf
 0000fe20: 6967 5f75 7469 6c73 2e70 7900 0000 0000  ig_utils.py.....
 0000fe30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fe40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fe50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fe60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 0000fe70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
 0000fe80: 3030 3033 3235 3100 3030 3030 3030 3030  0003251.00000000
-0000fe90: 3030 3000 3032 3230 3532 0020 3000 0000  000.022052. 0...
+0000fe90: 3030 3000 3032 3230 3533 0020 3000 0000  000.022053. 0...
 0000fea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000feb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000fef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ff00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
@@ -4250,16 +4250,16 @@
 00010990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000109f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010a00: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00010a10: 3136 362e 300a 0000 0000 0000 0000 0000  166.0...........
+00010a00: 3232 206d 7469 6d65 3d31 3638 3737 3630  22 mtime=1687760
+00010a10: 3530 322e 300a 0000 0000 0000 0000 0000  502.0...........
 00010a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4282,24 +4282,24 @@
 00010b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010c00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00010c10: 2f64 7a5f 6d6f 6e67 6f64 622f 6462 5f75  /dz_mongodb/db_u
-00010c20: 7469 6c73 2e70 7900 0000 0000 0000 0000  tils.py.........
+00010c00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00010c10: 2f64 7a5f 6d6f 6e67 6f64 622f 6461 7465  /dz_mongodb/date
+00010c20: 7469 6d65 5f75 7469 6c73 2e70 7900 0000  time_utils.py...
 00010c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
 00010c70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00010c80: 3030 3134 3630 3200 3030 3030 3030 3030  0014602.00000000
-00010c90: 3030 3000 3032 3131 3734 0020 3000 0000  000.021174. 0...
+00010c80: 3030 3031 3136 3100 3030 3030 3030 3030  0001161.00000000
+00010c90: 3030 3000 3032 3234 3030 0020 3000 0000  000.022400. 0...
 00010ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010d00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
@@ -4314,671 +4314,671 @@
 00010d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00010df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00010e00: 2222 220a 4c69 7374 206f 6620 6865 6c70  """.List of help
-00010e10: 6572 2066 756e 6374 696f 6e73 2066 6f72  er functions for
-00010e20: 2044 4220 7265 6c61 7465 6420 7072 6f63   DB related proc
-00010e30: 6365 7365 7320 6f6e 6c79 0a22 2222 0a0a  ceses only."""..
-00010e40: 696d 706f 7274 2073 696e 6765 720a 0a66  import singer..f
-00010e50: 726f 6d20 7479 7069 6e67 2069 6d70 6f72  rom typing impor
-00010e60: 7420 4469 6374 2c20 4c69 7374 0a66 726f  t Dict, List.fro
-00010e70: 6d20 7079 6d6f 6e67 6f20 696d 706f 7274  m pymongo import
-00010e80: 204d 6f6e 676f 436c 6965 6e74 0a66 726f   MongoClient.fro
-00010e90: 6d20 7079 6d6f 6e67 6f2e 636f 6c6c 6563  m pymongo.collec
-00010ea0: 7469 6f6e 2069 6d70 6f72 7420 436f 6c6c  tion import Coll
-00010eb0: 6563 7469 6f6e 0a66 726f 6d20 7079 6d6f  ection.from pymo
-00010ec0: 6e67 6f2e 6461 7461 6261 7365 2069 6d70  ngo.database imp
-00010ed0: 6f72 7420 4461 7461 6261 7365 0a66 726f  ort Database.fro
-00010ee0: 6d20 7369 6e67 6572 2069 6d70 6f72 7420  m singer import 
-00010ef0: 6d65 7461 6461 7461 0a0a 4c4f 4747 4552  metadata..LOGGER
-00010f00: 203d 2073 696e 6765 722e 6765 745f 6c6f   = singer.get_lo
-00010f10: 6767 6572 2827 647a 5f6d 6f6e 676f 6462  gger('dz_mongodb
-00010f20: 2729 0a0a 4947 4e4f 5245 5f44 4253 203d  ')..IGNORE_DBS =
-00010f30: 205b 2773 7973 7465 6d27 2c20 276c 6f63   ['system', 'loc
-00010f40: 616c 272c 2027 636f 6e66 6967 275d 0a52  al', 'config'].R
-00010f50: 4f4c 4553 5f57 4954 484f 5554 5f46 494e  OLES_WITHOUT_FIN
-00010f60: 445f 5052 4956 494c 4547 4553 203d 207b  D_PRIVILEGES = {
-00010f70: 0a20 2020 2027 6462 4164 6d69 6e27 2c0a  .    'dbAdmin',.
-00010f80: 2020 2020 2775 7365 7241 646d 696e 272c      'userAdmin',
-00010f90: 0a20 2020 2027 636c 7573 7465 7241 646d  .    'clusterAdm
-00010fa0: 696e 272c 0a20 2020 2027 636c 7573 7465  in',.    'cluste
-00010fb0: 724d 616e 6167 6572 272c 0a20 2020 2027  rManager',.    '
-00010fc0: 636c 7573 7465 724d 6f6e 6974 6f72 272c  clusterMonitor',
-00010fd0: 0a20 2020 2027 686f 7374 4d61 6e61 6765  .    'hostManage
-00010fe0: 7227 2c0a 2020 2020 2772 6573 746f 7265  r',.    'restore
-00010ff0: 270a 7d0a 524f 4c45 535f 5749 5448 5f46  '.}.ROLES_WITH_F
-00011000: 494e 445f 5052 4956 494c 4547 4553 203d  IND_PRIVILEGES =
-00011010: 207b 0a20 2020 2027 7265 6164 272c 0a20   {.    'read',. 
-00011020: 2020 2027 7265 6164 5772 6974 6527 2c0a     'readWrite',.
-00011030: 2020 2020 2772 6561 6441 6e79 4461 7461      'readAnyData
-00011040: 6261 7365 272c 0a20 2020 2027 7265 6164  base',.    'read
-00011050: 5772 6974 6541 6e79 4461 7461 6261 7365  WriteAnyDatabase
-00011060: 272c 0a20 2020 2027 6462 4f77 6e65 7227  ',.    'dbOwner'
-00011070: 2c0a 2020 2020 2762 6163 6b75 7027 2c0a  ,.    'backup',.
-00011080: 2020 2020 2772 6f6f 7427 0a7d 0a52 4f4c      'root'.}.ROL
-00011090: 4553 5f57 4954 485f 414c 4c5f 4442 5f46  ES_WITH_ALL_DB_F
-000110a0: 494e 445f 5052 4956 494c 4547 4553 203d  IND_PRIVILEGES =
-000110b0: 207b 0a20 2020 2027 7265 6164 416e 7944   {.    'readAnyD
-000110c0: 6174 6162 6173 6527 2c0a 2020 2020 2772  atabase',.    'r
-000110d0: 6561 6457 7269 7465 416e 7944 6174 6162  eadWriteAnyDatab
-000110e0: 6173 6527 2c0a 2020 2020 2772 6f6f 7427  ase',.    'root'
-000110f0: 0a7d 0a0a 6465 6620 6765 745f 726f 6c65  .}..def get_role
-00011100: 735f 7769 7468 5f66 696e 645f 7072 6976  s_with_find_priv
-00011110: 7328 6461 7461 6261 7365 3a20 4461 7461  s(database: Data
-00011120: 6261 7365 2c20 7573 6572 3a20 4469 6374  base, user: Dict
-00011130: 2920 2d3e 204c 6973 745b 4469 6374 5d3a  ) -> List[Dict]:
-00011140: 0a20 2020 2022 2222 0a20 2020 2046 696e  .    """.    Fin
-00011150: 6473 2061 6e64 2072 6574 7572 6e73 2061  ds and returns a
-00011160: 6c6c 2074 6865 2075 7365 7227 7320 726f  ll the user's ro
-00011170: 6c65 7320 7468 6174 2068 6176 6520 6669  les that have fi
-00011180: 6e64 2070 7269 7669 6c65 6765 732e 0a20  nd privileges.. 
-00011190: 2020 2055 7365 7220 6973 2064 6963 7469     User is dicti
-000111a0: 6f6e 6172 7920 696e 2074 6865 2066 6f72  onary in the for
-000111b0: 6d3a 0a20 2020 2020 7b0a 2020 2020 2020  m:.     {.      
-000111c0: 2020 2027 5f69 6427 3a20 3c61 7574 685f     '_id': <auth_
-000111d0: 6462 3e2e 3c75 7365 723e 2c0a 2020 2020  db>.<user>,.    
-000111e0: 2020 2020 2027 6462 273a 203c 6175 7468       'db': <auth
-000111f0: 5f64 623e 2c0a 2020 2020 2020 2020 2027  _db>,.         '
-00011200: 6d65 6368 616e 6973 6d73 273a 205b 2753  mechanisms': ['S
-00011210: 4352 414d 2d53 4841 2d31 272c 2027 5343  CRAM-SHA-1', 'SC
-00011220: 5241 4d2d 5348 412d 3235 3627 5d2c 0a20  RAM-SHA-256'],. 
-00011230: 2020 2020 2020 2020 2772 6f6c 6573 273a          'roles':
-00011240: 205b 7b27 6462 273a 2027 6164 6d69 6e27   [{'db': 'admin'
-00011250: 2c20 2772 6f6c 6527 3a20 2772 6561 6457  , 'role': 'readW
-00011260: 7269 7465 416e 7944 6174 6162 6173 6527  riteAnyDatabase'
-00011270: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
-00011280: 2020 2020 2020 7b27 6462 273a 2027 6c6f        {'db': 'lo
-00011290: 6361 6c27 2c20 2772 6f6c 6527 3a20 2772  cal', 'role': 'r
-000112a0: 6561 6427 7d5d 2c0a 2020 2020 2020 2020  ead'}],.        
-000112b0: 2027 7573 6572 273a 203c 7573 6572 3e2c   'user': <user>,
-000112c0: 0a20 2020 2020 2020 2020 2775 7365 7249  .         'userI
-000112d0: 6427 3a20 3c75 7365 7249 643e 0a20 2020  d': <userId>.   
-000112e0: 2020 7d0a 2020 2020 4172 6773 3a0a 2020    }.    Args:.  
-000112f0: 2020 2020 2020 6461 7461 6261 7365 3a20        database: 
-00011300: 4d6f 6e67 6f44 4220 4461 7461 6261 7365  MongoDB Database
-00011310: 2069 6e73 7461 6e63 650a 2020 2020 2020   instance.      
-00011320: 2020 7573 6572 3a20 6462 2075 7365 7220    user: db user 
-00011330: 6469 6374 696f 6e61 7279 0a0a 2020 2020  dictionary..    
-00011340: 5265 7475 726e 733a 206c 6973 7420 6f66  Returns: list of
-00011350: 2072 6f6c 6573 0a0a 2020 2020 2222 220a   roles..    """.
-00011360: 2020 2020 726f 6c65 7320 3d20 5b5d 0a0a      roles = []..
-00011370: 2020 2020 666f 7220 726f 6c65 2069 6e20      for role in 
-00011380: 7573 6572 2e67 6574 2827 726f 6c65 7327  user.get('roles'
-00011390: 2c20 5b5d 293a 0a20 2020 2020 2020 2069  , []):.        i
-000113a0: 6620 726f 6c65 2e67 6574 2827 726f 6c65  f role.get('role
-000113b0: 2729 2069 6e20 524f 4c45 535f 5749 5448  ') in ROLES_WITH
-000113c0: 4f55 545f 4649 4e44 5f50 5249 5649 4c45  OUT_FIND_PRIVILE
-000113d0: 4745 533a 0a20 2020 2020 2020 2020 2020  GES:.           
-000113e0: 2063 6f6e 7469 6e75 650a 0a20 2020 2020   continue..     
-000113f0: 2020 2072 6f6c 655f 6e61 6d65 203d 2072     role_name = r
-00011400: 6f6c 655b 2772 6f6c 6527 5d0a 0a20 2020  ole['role']..   
-00011410: 2020 2020 2023 2072 6f6c 6573 2077 6974       # roles wit
-00011420: 6820 6669 6e64 2070 7269 7669 6c65 6765  h find privilege
-00011430: 730a 2020 2020 2020 2020 6966 2072 6f6c  s.        if rol
-00011440: 655f 6e61 6d65 2069 6e20 524f 4c45 535f  e_name in ROLES_
-00011450: 5749 5448 5f46 494e 445f 5052 4956 494c  WITH_FIND_PRIVIL
-00011460: 4547 4553 2061 6e64 2072 6f6c 652e 6765  EGES and role.ge
-00011470: 7428 2764 6227 293a 0a20 2020 2020 2020  t('db'):.       
-00011480: 2020 2020 2072 6f6c 6573 2e61 7070 656e       roles.appen
-00011490: 6428 726f 6c65 290a 0a20 2020 2020 2020  d(role)..       
-000114a0: 2023 2066 6f72 2063 7573 746f 6d20 726f   # for custom ro
-000114b0: 6c65 732c 2067 6574 2074 6865 2022 7375  les, get the "su
-000114c0: 622d 726f 6c65 7322 0a20 2020 2020 2020  b-roles".       
-000114d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000114e0: 2020 2072 6f6c 655f 696e 666f 5f6c 6973     role_info_lis
-000114f0: 7420 3d20 6461 7461 6261 7365 2e63 6f6d  t = database.com
-00011500: 6d61 6e64 287b 2772 6f6c 6573 496e 666f  mand({'rolesInfo
-00011510: 273a 207b 2772 6f6c 6527 3a20 726f 6c65  ': {'role': role
-00011520: 5f6e 616d 652c 2027 6462 273a 2064 6174  _name, 'db': dat
-00011530: 6162 6173 652e 6e61 6d65 7d7d 290a 2020  abase.name}}).  
-00011540: 2020 2020 2020 2020 2020 726f 6c65 5f69            role_i
-00011550: 6e66 6f20 3d20 5b72 2066 6f72 2072 2069  nfo = [r for r i
-00011560: 6e20 726f 6c65 5f69 6e66 6f5f 6c69 7374  n role_info_list
-00011570: 2e67 6574 2827 726f 6c65 7327 2c20 5b5d  .get('roles', []
-00011580: 2920 6966 2072 5b27 726f 6c65 275d 203d  ) if r['role'] =
-00011590: 3d20 726f 6c65 5f6e 616d 655d 0a0a 2020  = role_name]..  
-000115a0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-000115b0: 2872 6f6c 655f 696e 666f 2920 213d 2031  (role_info) != 1
-000115c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000115d0: 2020 636f 6e74 696e 7565 0a0a 2020 2020    continue..    
-000115e0: 2020 2020 2020 2020 726f 6c65 732e 6578          roles.ex
-000115f0: 7465 6e64 285b 7375 625f 726f 6c65 2066  tend([sub_role f
-00011600: 6f72 2073 7562 5f72 6f6c 6520 696e 2072  or sub_role in r
-00011610: 6f6c 655f 696e 666f 5b30 5d2e 6765 7428  ole_info[0].get(
-00011620: 2772 6f6c 6573 272c 205b 5d29 0a20 2020  'roles', []).   
-00011630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011640: 2020 2020 2020 2069 6620 7375 625f 726f         if sub_ro
-00011650: 6c65 2e67 6574 2827 726f 6c65 2729 2069  le.get('role') i
-00011660: 6e20 524f 4c45 535f 5749 5448 5f46 494e  n ROLES_WITH_FIN
-00011670: 445f 5052 4956 494c 4547 4553 2061 6e64  D_PRIVILEGES and
-00011680: 2073 7562 5f72 6f6c 652e 6765 7428 2764   sub_role.get('d
-00011690: 6227 295d 290a 0a20 2020 2072 6574 7572  b')])..    retur
-000116a0: 6e20 726f 6c65 730a 0a0a 6465 6620 6765  n roles...def ge
-000116b0: 745f 726f 6c65 7328 6461 7461 6261 7365  t_roles(database
-000116c0: 3a20 4461 7461 6261 7365 2c20 6462 5f75  : Database, db_u
-000116d0: 7365 723a 2073 7472 2920 2d3e 204c 6973  ser: str) -> Lis
-000116e0: 745b 4469 6374 5d3a 0a20 2020 2022 2222  t[Dict]:.    """
-000116f0: 0a20 2020 2047 6574 2061 6c6c 2075 7365  .    Get all use
-00011700: 7227 7320 726f 6c65 7320 7769 7468 2066  r's roles with f
-00011710: 696e 6420 7072 6976 696c 6567 6573 2069  ind privileges i
-00011720: 6620 7573 6572 2065 7869 7374 730a 2020  f user exists.  
-00011730: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-00011740: 6461 7461 6261 7365 3a20 4d6f 6e67 6f44  database: MongoD
-00011750: 4220 4442 2069 6e73 7461 6e63 650a 2020  B DB instance.  
-00011760: 2020 2020 2020 6462 5f75 7365 723a 2044        db_user: D
-00011770: 4220 7573 6572 206e 616d 6520 746f 2067  B user name to g
-00011780: 6574 2072 6f6c 6573 2066 6f72 0a0a 2020  et roles for..  
-00011790: 2020 5265 7475 726e 733a 204c 6973 7420    Returns: List 
-000117a0: 6f66 2072 6f6c 6573 2066 6f75 6e64 0a0a  of roles found..
-000117b0: 2020 2020 2222 220a 0a20 2020 2023 2075      """..    # u
-000117c0: 7365 7273 496e 666f 2043 6f6d 6d61 6e64  sersInfo Command
-000117d0: 2020 7265 7475 726e 7320 6f62 6a65 6374    returns object
-000117e0: 2069 6e20 7368 6170 653a 0a20 2020 2023   in shape:.    #
-000117f0: 207b 0a20 2020 2023 2020 203c 2073 6f6d   {.    #   < som
-00011800: 655f 6f74 6865 725f 6b65 7973 203e 0a20  e_other_keys >. 
-00011810: 2020 2023 2020 2027 7573 6572 7327 3a20     #   'users': 
-00011820: 5b0a 2020 2020 2320 2020 2020 2020 2020  [.    #         
-00011830: 2020 2020 2020 207b 0a20 2020 2023 2020         {.    #  
-00011840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011850: 2020 275f 6964 273a 203c 2061 7574 685f    '_id': < auth_
-00011860: 6462 203e 2e20 3c20 7573 6572 203e 2c0a  db >. < user >,.
-00011870: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-00011880: 2020 2020 2020 2020 2027 6462 273a 203c           'db': <
-00011890: 2061 7574 685f 6462 203e 2c0a 2020 2020   auth_db >,.    
-000118a0: 2320 2020 2020 2020 2020 2020 2020 2020  #               
-000118b0: 2020 2020 2027 6d65 6368 616e 6973 6d73       'mechanisms
-000118c0: 273a 205b 2753 4352 414d 2d53 4841 2d31  ': ['SCRAM-SHA-1
-000118d0: 272c 2027 5343 5241 4d2d 5348 412d 3235  ', 'SCRAM-SHA-25
-000118e0: 3627 5d2c 0a20 2020 2023 2020 2020 2020  6'],.    #      
-000118f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00011900: 726f 6c65 7327 3a20 5b7b 2764 6227 3a20  roles': [{'db': 
-00011910: 2761 646d 696e 272c 2027 726f 6c65 273a  'admin', 'role':
-00011920: 2027 7265 6164 5772 6974 6541 6e79 4461   'readWriteAnyDa
-00011930: 7461 6261 7365 277d 2c0a 2020 2020 2320  tabase'},.    # 
-00011940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011950: 2020 2020 2020 2020 2020 2020 2020 7b27                {'
-00011960: 6462 273a 2027 6c6f 6361 6c27 2c20 2772  db': 'local', 'r
-00011970: 6f6c 6527 3a20 2772 6561 6427 7d5d 2c0a  ole': 'read'}],.
-00011980: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-00011990: 2020 2020 2020 2020 2020 2775 7365 7227            'user'
-000119a0: 3a20 3c20 7573 6572 203e 2c0a 2020 2020  : < user >,.    
-000119b0: 2320 2020 2020 2020 2020 2020 2020 2020  #               
-000119c0: 2020 2020 2020 2775 7365 7249 6427 3a20        'userId': 
-000119d0: 3c20 7573 6572 4964 203e 0a20 2020 2023  < userId >.    #
-000119e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000119f0: 207d 0a20 2020 2023 2020 2020 2020 2020   }.    #        
-00011a00: 2020 205d 0a20 2020 2023 207d 0a20 2020     ].    # }.   
-00011a10: 2075 7365 725f 696e 666f 203d 2064 6174   user_info = dat
-00011a20: 6162 6173 652e 636f 6d6d 616e 6428 7b27  abase.command({'
-00011a30: 7573 6572 7349 6e66 6f27 3a20 6462 5f75  usersInfo': db_u
-00011a40: 7365 727d 290a 0a20 2020 2075 7365 7273  ser})..    users
-00011a50: 203d 205b 7520 666f 7220 7520 696e 2075   = [u for u in u
-00011a60: 7365 725f 696e 666f 2e67 6574 2827 7573  ser_info.get('us
-00011a70: 6572 7327 2920 6966 2075 2e67 6574 2827  ers') if u.get('
-00011a80: 7573 6572 2729 203d 3d20 6462 5f75 7365  user') == db_use
-00011a90: 725d 0a20 2020 2069 6620 6c65 6e28 7573  r].    if len(us
-00011aa0: 6572 7329 2021 3d20 313a 0a20 2020 2020  ers) != 1:.     
-00011ab0: 2020 204c 4f47 4745 522e 7761 726e 696e     LOGGER.warnin
-00011ac0: 6728 2743 6f75 6c64 206e 6f74 2066 696e  g('Could not fin
-00011ad0: 6420 616e 7920 7573 6572 7320 666f 7220  d any users for 
-00011ae0: 2573 272c 2064 625f 7573 6572 290a 2020  %s', db_user).  
-00011af0: 2020 2020 2020 7265 7475 726e 205b 5d0a        return [].
-00011b00: 0a20 2020 2072 6574 7572 6e20 6765 745f  .    return get_
-00011b10: 726f 6c65 735f 7769 7468 5f66 696e 645f  roles_with_find_
-00011b20: 7072 6976 7328 6461 7461 6261 7365 2c20  privs(database, 
-00011b30: 7573 6572 735b 305d 290a 0a0a 6465 6620  users[0])...def 
-00011b40: 6765 745f 6461 7461 6261 7365 7328 636c  get_databases(cl
-00011b50: 6965 6e74 3a20 4d6f 6e67 6f43 6c69 656e  ient: MongoClien
-00011b60: 742c 2063 6f6e 6669 673a 2044 6963 7429  t, config: Dict)
-00011b70: 202d 3e20 4c69 7374 5b73 7472 5d3a 0a20   -> List[str]:. 
-00011b80: 2020 2022 2222 0a20 2020 2047 6574 2061     """.    Get a
-00011b90: 6c6c 2074 6865 2064 6174 6162 6173 6573  ll the databases
-00011ba0: 2069 6e20 7468 6520 636c 7573 7465 7220   in the cluster 
-00011bb0: 7468 6174 2074 6865 2075 7365 7220 726f  that the user ro
-00011bc0: 6c65 7320 6361 6e20 7265 6164 2066 726f  les can read fro
-00011bd0: 6d0a 2020 2020 4172 6773 3a0a 2020 2020  m.    Args:.    
-00011be0: 2020 2020 636c 6965 6e74 3a20 4d6f 6e67      client: Mong
-00011bf0: 6f44 4220 636c 6965 6e74 2069 6e73 7461  oDB client insta
-00011c00: 6e63 650a 2020 2020 2020 2020 636f 6e66  nce.        conf
-00011c10: 6967 3a20 4442 2063 6f6e 6669 670a 0a20  ig: DB config.. 
-00011c20: 2020 2052 6574 7572 6e73 3a20 4c69 7374     Returns: List
-00011c30: 206f 6620 6462 206e 616d 6573 0a0a 2020   of db names..  
-00011c40: 2020 2222 220a 2020 2020 726f 6c65 7320    """.    roles 
-00011c50: 3d20 6765 745f 726f 6c65 7328 636c 6965  = get_roles(clie
-00011c60: 6e74 5b63 6f6e 6669 675b 2761 7574 685f  nt[config['auth_
-00011c70: 6461 7461 6261 7365 275d 5d2c 2063 6f6e  database']], con
-00011c80: 6669 675b 2775 7365 7227 5d29 0a20 2020  fig['user']).   
-00011c90: 204c 4f47 4745 522e 696e 666f 2827 526f   LOGGER.info('Ro
-00011ca0: 6c65 733a 2025 7327 2c20 726f 6c65 7329  les: %s', roles)
-00011cb0: 0a0a 2020 2020 6361 6e5f 7265 6164 5f61  ..    can_read_a
-00011cc0: 6c6c 203d 206c 656e 285b 726f 6c65 2066  ll = len([role f
-00011cd0: 6f72 2072 6f6c 6520 696e 2072 6f6c 6573  or role in roles
-00011ce0: 2069 6620 726f 6c65 5b27 726f 6c65 275d   if role['role']
-00011cf0: 2069 6e20 524f 4c45 535f 5749 5448 5f41   in ROLES_WITH_A
-00011d00: 4c4c 5f44 425f 4649 4e44 5f50 5249 5649  LL_DB_FIND_PRIVI
-00011d10: 4c45 4745 535d 2920 3e20 300a 0a20 2020  LEGES]) > 0..   
-00011d20: 2069 6620 6361 6e5f 7265 6164 5f61 6c6c   if can_read_all
-00011d30: 3a0a 2020 2020 2020 2020 6462 5f6e 616d  :.        db_nam
-00011d40: 6573 203d 205b 6420 666f 7220 6420 696e  es = [d for d in
-00011d50: 2063 6c69 656e 742e 6c69 7374 5f64 6174   client.list_dat
-00011d60: 6162 6173 655f 6e61 6d65 7328 2920 6966  abase_names() if
-00011d70: 2064 206e 6f74 2069 6e20 4947 4e4f 5245   d not in IGNORE
-00011d80: 5f44 4253 5d0a 2020 2020 656c 7365 3a0a  _DBS].    else:.
-00011d90: 2020 2020 2020 2020 6462 5f6e 616d 6573          db_names
-00011da0: 203d 205b 726f 6c65 5b27 6462 275d 2066   = [role['db'] f
-00011db0: 6f72 2072 6f6c 6520 696e 2072 6f6c 6573  or role in roles
-00011dc0: 2069 6620 726f 6c65 5b27 6462 275d 206e   if role['db'] n
-00011dd0: 6f74 2069 6e20 4947 4e4f 5245 5f44 4253  ot in IGNORE_DBS
-00011de0: 5d0a 0a20 2020 204c 4f47 4745 522e 696e  ]..    LOGGER.in
-00011df0: 666f 2827 4461 7461 6261 7365 733a 2025  fo('Databases: %
-00011e00: 7327 2c20 6462 5f6e 616d 6573 290a 0a20  s', db_names).. 
-00011e10: 2020 2072 6574 7572 6e20 6462 5f6e 616d     return db_nam
-00011e20: 6573 0a0a 0a64 6566 2070 726f 6475 6365  es...def produce
-00011e30: 5f63 6f6c 6c65 6374 696f 6e5f 7363 6865  _collection_sche
-00011e40: 6d61 2863 6f6c 6c65 6374 696f 6e3a 2043  ma(collection: C
-00011e50: 6f6c 6c65 6374 696f 6e29 202d 3e20 4469  ollection) -> Di
-00011e60: 6374 3a0a 2020 2020 2222 220a 2020 2020  ct:.    """.    
-00011e70: 4765 6e65 7261 7465 2061 2073 6368 656d  Generate a schem
-00011e80: 612f 6361 7461 6c6f 6720 6672 6f6d 2074  a/catalog from t
-00011e90: 6865 2063 6f6c 6c65 6374 696f 6e20 6465  he collection de
-00011ea0: 7461 696c 7320 666f 7220 6469 7363 6f76  tails for discov
-00011eb0: 6572 7920 6d6f 6465 0a20 2020 2041 7267  ery mode.    Arg
-00011ec0: 733a 0a20 2020 2020 2020 2063 6f6c 6c65  s:.        colle
-00011ed0: 6374 696f 6e3a 2073 7472 6561 6d20 436f  ction: stream Co
-00011ee0: 6c6c 6563 7469 6f6e 0a0a 2020 2020 5265  llection..    Re
-00011ef0: 7475 726e 733a 2063 6f6c 6c65 6374 696f  turns: collectio
-00011f00: 6e20 6361 7461 6c6f 670a 0a20 2020 2022  n catalog..    "
-00011f10: 2222 0a20 2020 2063 6f6c 6c65 6374 696f  "".    collectio
-00011f20: 6e5f 6e61 6d65 203d 2063 6f6c 6c65 6374  n_name = collect
-00011f30: 696f 6e2e 6e61 6d65 0a20 2020 2063 6f6c  ion.name.    col
-00011f40: 6c65 6374 696f 6e5f 6462 5f6e 616d 6520  lection_db_name 
-00011f50: 3d20 636f 6c6c 6563 7469 6f6e 2e64 6174  = collection.dat
-00011f60: 6162 6173 652e 6e61 6d65 0a0a 2020 2020  abase.name..    
-00011f70: 6973 5f76 6965 7720 3d20 636f 6c6c 6563  is_view = collec
-00011f80: 7469 6f6e 2e6f 7074 696f 6e73 2829 2e67  tion.options().g
-00011f90: 6574 2827 7669 6577 4f6e 2729 2069 7320  et('viewOn') is 
-00011fa0: 6e6f 7420 4e6f 6e65 0a0a 2020 2020 6d64  not None..    md
-00011fb0: 6174 6120 3d20 7b7d 0a20 2020 206d 6461  ata = {}.    mda
-00011fc0: 7461 203d 206d 6574 6164 6174 612e 7772  ta = metadata.wr
-00011fd0: 6974 6528 6d64 6174 612c 2028 292c 2027  ite(mdata, (), '
-00011fe0: 7461 626c 652d 6b65 792d 7072 6f70 6572  table-key-proper
-00011ff0: 7469 6573 272c 205b 275f 6964 275d 290a  ties', ['_id']).
-00012000: 2020 2020 6d64 6174 6120 3d20 6d65 7461      mdata = meta
-00012010: 6461 7461 2e77 7269 7465 286d 6461 7461  data.write(mdata
-00012020: 2c20 2829 2c20 2764 6174 6162 6173 652d  , (), 'database-
-00012030: 6e61 6d65 272c 2063 6f6c 6c65 6374 696f  name', collectio
-00012040: 6e5f 6462 5f6e 616d 6529 0a20 2020 206d  n_db_name).    m
-00012050: 6461 7461 203d 206d 6574 6164 6174 612e  data = metadata.
-00012060: 7772 6974 6528 6d64 6174 612c 2028 292c  write(mdata, (),
-00012070: 2027 726f 772d 636f 756e 7427 2c20 636f   'row-count', co
-00012080: 6c6c 6563 7469 6f6e 2e65 7374 696d 6174  llection.estimat
-00012090: 6564 5f64 6f63 756d 656e 745f 636f 756e  ed_document_coun
-000120a0: 7428 2929 0a20 2020 206d 6461 7461 203d  t()).    mdata =
-000120b0: 206d 6574 6164 6174 612e 7772 6974 6528   metadata.write(
-000120c0: 6d64 6174 612c 2028 292c 2027 6973 2d76  mdata, (), 'is-v
-000120d0: 6965 7727 2c20 6973 5f76 6965 7729 0a0a  iew', is_view)..
-000120e0: 2020 2020 2320 7772 6974 6520 7661 6c69      # write vali
-000120f0: 642d 7265 706c 6963 6174 696f 6e2d 6b65  d-replication-ke
-00012100: 7920 6d65 7461 6461 7461 2062 7920 6669  y metadata by fi
-00012110: 6e64 696e 6720 6669 656c 6473 2074 6861  nding fields tha
-00012120: 7420 6861 7665 2069 6e64 6578 6573 206f  t have indexes o
-00012130: 6e20 7468 656d 2e0a 2020 2020 2320 6361  n them..    # ca
-00012140: 6e6e 6f74 2067 6574 2069 6e64 6578 6573  nnot get indexes
-00012150: 2066 6f72 2076 6965 7773 202d 2d20 4e42   for views -- NB
-00012160: 3a20 5468 6973 206d 6561 6e73 206e 6f20  : This means no 
-00012170: 6b65 792d 6261 7365 6420 696e 6372 656d  key-based increm
-00012180: 656e 7461 6c20 666f 7220 7669 6577 733f  ental for views?
-00012190: 0a20 2020 2069 6620 6e6f 7420 6973 5f76  .    if not is_v
-000121a0: 6965 773a 0a20 2020 2020 2020 2076 616c  iew:.        val
-000121b0: 6964 5f72 6570 6c69 6361 7469 6f6e 5f6b  id_replication_k
-000121c0: 6579 7320 3d20 5b5d 0a20 2020 2020 2020  eys = [].       
-000121d0: 2063 6f6c 6c5f 696e 6465 7865 7320 3d20   coll_indexes = 
-000121e0: 636f 6c6c 6563 7469 6f6e 2e69 6e64 6578  collection.index
-000121f0: 5f69 6e66 6f72 6d61 7469 6f6e 2829 0a20  _information(). 
-00012200: 2020 2020 2020 2023 2069 6e64 6578 5f69         # index_i
-00012210: 6e66 6f72 6d61 7469 6f6e 2829 2072 6574  nformation() ret
-00012220: 7572 6e73 2061 206d 6170 206f 6620 696e  urns a map of in
-00012230: 6465 785f 6e61 6d65 202d 3e20 696e 6465  dex_name -> inde
-00012240: 785f 696e 666f 726d 6174 696f 6e0a 2020  x_information.  
-00012250: 2020 2020 2020 666f 7220 5f2c 2069 6e64        for _, ind
-00012260: 6578 5f69 6e66 6f20 696e 2063 6f6c 6c5f  ex_info in coll_
-00012270: 696e 6465 7865 732e 6974 656d 7328 293a  indexes.items():
-00012280: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
-00012290: 6520 646f 6e27 7420 7375 7070 6f72 7420  e don't support 
-000122a0: 636f 6d70 6f75 6e64 2069 6e64 6578 6573  compound indexes
-000122b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000122c0: 6c65 6e28 696e 6465 785f 696e 666f 2e67  len(index_info.g
-000122d0: 6574 2827 6b65 7927 2929 203d 3d20 313a  et('key')) == 1:
-000122e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000122f0: 2069 6e64 6578 5f66 6965 6c64 5f69 6e66   index_field_inf
-00012300: 6f20 3d20 696e 6465 785f 696e 666f 2e67  o = index_info.g
-00012310: 6574 2827 6b65 7927 295b 305d 0a20 2020  et('key')[0].   
-00012320: 2020 2020 2020 2020 2020 2020 2023 2069               # i
-00012330: 6e64 6578 5f66 6965 6c64 5f69 6e66 6f20  ndex_field_info 
-00012340: 6973 2061 2074 7570 6c65 206f 6620 2866  is a tuple of (f
-00012350: 6965 6c64 5f6e 616d 652c 2073 6f72 745f  ield_name, sort_
-00012360: 6469 7265 6374 696f 6e29 0a20 2020 2020  direction).     
-00012370: 2020 2020 2020 2020 2020 2069 6620 696e             if in
-00012380: 6465 785f 6669 656c 645f 696e 666f 3a0a  dex_field_info:.
-00012390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000123a0: 2020 2020 7661 6c69 645f 7265 706c 6963      valid_replic
-000123b0: 6174 696f 6e5f 6b65 7973 2e61 7070 656e  ation_keys.appen
-000123c0: 6428 696e 6465 785f 6669 656c 645f 696e  d(index_field_in
-000123d0: 666f 5b30 5d29 0a0a 2020 2020 2020 2020  fo[0])..        
-000123e0: 6966 2076 616c 6964 5f72 6570 6c69 6361  if valid_replica
-000123f0: 7469 6f6e 5f6b 6579 733a 0a20 2020 2020  tion_keys:.     
-00012400: 2020 2020 2020 206d 6461 7461 203d 206d         mdata = m
-00012410: 6574 6164 6174 612e 7772 6974 6528 6d64  etadata.write(md
-00012420: 6174 612c 2028 292c 2027 7661 6c69 642d  ata, (), 'valid-
-00012430: 7265 706c 6963 6174 696f 6e2d 6b65 7973  replication-keys
-00012440: 272c 2076 616c 6964 5f72 6570 6c69 6361  ', valid_replica
-00012450: 7469 6f6e 5f6b 6579 7329 0a0a 2020 2020  tion_keys)..    
-00012460: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
-00012470: 2027 7461 626c 655f 6e61 6d65 273a 2063   'table_name': c
-00012480: 6f6c 6c65 6374 696f 6e5f 6e61 6d65 2c0a  ollection_name,.
-00012490: 2020 2020 2020 2020 2773 7472 6561 6d27          'stream'
-000124a0: 3a20 636f 6c6c 6563 7469 6f6e 5f6e 616d  : collection_nam
-000124b0: 652c 0a20 2020 2020 2020 2027 6d65 7461  e,.        'meta
-000124c0: 6461 7461 273a 206d 6574 6164 6174 612e  data': metadata.
-000124d0: 746f 5f6c 6973 7428 6d64 6174 6129 2c0a  to_list(mdata),.
-000124e0: 2020 2020 2020 2020 2774 6170 5f73 7472          'tap_str
-000124f0: 6561 6d5f 6964 273a 2066 227b 636f 6c6c  eam_id': f"{coll
-00012500: 6563 7469 6f6e 5f64 625f 6e61 6d65 7d2d  ection_db_name}-
-00012510: 7b63 6f6c 6c65 6374 696f 6e5f 6e61 6d65  {collection_name
-00012520: 7d22 2c0a 2020 2020 2020 2020 2773 6368  }",.        'sch
-00012530: 656d 6127 3a20 7b0a 2020 2020 2020 2020  ema': {.        
-00012540: 2020 2020 2774 7970 6527 3a20 276f 626a      'type': 'obj
-00012550: 6563 7427 2c0a 2020 2020 2020 2020 2020  ect',.          
-00012560: 2020 2770 726f 7065 7274 6965 7327 3a20    'properties': 
-00012570: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00012580: 2020 225f 6964 223a 207b 0a20 2020 2020    "_id": {.     
-00012590: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000125a0: 7479 7065 223a 205b 2273 7472 696e 6722  type": ["string"
-000125b0: 2c20 226e 756c 6c22 5d0a 2020 2020 2020  , "null"].      
-000125c0: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-000125d0: 2020 2020 2020 2020 2020 2020 2022 646f               "do
-000125e0: 6375 6d65 6e74 223a 207b 0a20 2020 2020  cument": {.     
-000125f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00012600: 7479 7065 223a 205b 0a20 2020 2020 2020  type": [.       
-00012610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012620: 2022 6f62 6a65 6374 222c 0a20 2020 2020   "object",.     
-00012630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012640: 2020 2022 6172 7261 7922 2c0a 2020 2020     "array",.    
-00012650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012660: 2020 2020 2273 7472 696e 6722 2c0a 2020      "string",.  
-00012670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012680: 2020 2020 2020 226e 756c 6c22 0a20 2020        "null".   
-00012690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000126a0: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
-000126b0: 2020 207d 2c0a 2020 2020 2020 2020 2020     },.          
-000126c0: 2020 2020 2020 225f 7364 635f 6465 6c65        "_sdc_dele
-000126d0: 7465 645f 6174 223a 207b 0a20 2020 2020  ted_at": {.     
-000126e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000126f0: 7479 7065 223a 205b 0a20 2020 2020 2020  type": [.       
-00012700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012710: 2022 7374 7269 6e67 222c 0a20 2020 2020   "string",.     
-00012720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012730: 2020 2022 6e75 6c6c 220a 2020 2020 2020     "null".      
-00012740: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-00012750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012760: 7d2c 0a20 2020 2020 2020 2020 2020 207d  },.            }
-00012770: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-00012780: 7d0a 0000 0000 0000 0000 0000 0000 0000  }...............
-00012790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000127a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000127b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000127c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000127d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000127e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000127f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00012810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00012870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00012880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00012890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-000128a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000128f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00012910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000129a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000129b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000129c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000129d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000129e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000129f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a00: 3232 206d 7469 6d65 3d31 3637 3633 3739  22 mtime=1676379
-00012a10: 3532 302e 300a 0000 0000 0000 0000 0000  520.0...........
-00012a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00012c10: 2f64 7a5f 6d6f 6e67 6f64 622f 6572 726f  /dz_mongodb/erro
-00012c20: 7273 2e70 7900 0000 0000 0000 0000 0000  rs.py...........
-00012c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00012c70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00012c80: 3030 3033 3435 3200 3030 3030 3030 3030  0003452.00000000
-00012c90: 3030 3000 3032 3037 3034 0020 3000 0000  000.020704. 0...
-00012ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00012d10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00012d20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
-00012d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00012e00: 636c 6173 7320 496e 7661 6c69 6452 6570  class InvalidRep
-00012e10: 6c69 6361 7469 6f6e 4d65 7468 6f64 4578  licationMethodEx
-00012e20: 6365 7074 696f 6e28 4578 6365 7074 696f  ception(Exceptio
-00012e30: 6e29 3a0a 2020 2020 2222 2245 7863 6570  n):.    """Excep
-00012e40: 7469 6f6e 2066 6f72 2065 7272 6f72 7320  tion for errors 
-00012e50: 7265 6c61 7465 6420 746f 2072 6570 6c69  related to repli
-00012e60: 6361 7469 6f6e 206d 6574 686f 6473 2222  cation methods""
-00012e70: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-00012e80: 745f 5f28 7365 6c66 2c20 7265 706c 6963  t__(self, replic
-00012e90: 6174 696f 6e5f 6d65 7468 6f64 2c20 6d65  ation_method, me
-00012ea0: 7373 6167 653d 4e6f 6e65 293a 0a20 2020  ssage=None):.   
-00012eb0: 2020 2020 206d 7367 203d 2066 2249 6e76       msg = f"Inv
-00012ec0: 616c 6964 2072 6570 6c69 6361 7469 6f6e  alid replication
-00012ed0: 206d 6574 686f 6420 7b72 6570 6c69 6361   method {replica
-00012ee0: 7469 6f6e 5f6d 6574 686f 647d 2122 0a0a  tion_method}!"..
-00012ef0: 2020 2020 2020 2020 6966 206d 6573 7361          if messa
-00012f00: 6765 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ge is not None:.
-00012f10: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-00012f20: 3d20 6627 7b6d 7367 7d20 7b6d 6573 7361  = f'{msg} {messa
-00012f30: 6765 7d27 0a0a 2020 2020 2020 2020 7375  ge}'..        su
-00012f40: 7065 7228 292e 5f5f 696e 6974 5f5f 286d  per().__init__(m
-00012f50: 7367 290a 0a0a 636c 6173 7320 556e 7375  sg)...class Unsu
-00012f60: 7070 6f72 7465 644b 6579 5479 7065 4578  pportedKeyTypeEx
-00012f70: 6365 7074 696f 6e28 4578 6365 7074 696f  ception(Exceptio
-00012f80: 6e29 3a0a 2020 2020 2222 2252 6169 7365  n):.    """Raise
-00012f90: 6420 6966 206b 6579 2074 7970 6520 6973  d if key type is
-00012fa0: 2075 6e73 7570 706f 7274 6564 2222 220a   unsupported""".
-00012fb0: 0a63 6c61 7373 204d 6f6e 676f 4173 7365  .class MongoAsse
-00012fc0: 7274 696f 6e45 7863 6570 7469 6f6e 2845  rtionException(E
-00012fd0: 7863 6570 7469 6f6e 293a 0a20 2020 2022  xception):.    "
-00012fe0: 2222 5261 6973 6564 2069 6620 4d6f 6e67  ""Raised if Mong
-00012ff0: 6f20 6578 6869 6269 7473 2069 6e63 6f72  o exhibits incor
-00013000: 7265 6374 2062 6568 6176 696f 7222 2222  rect behavior"""
-00013010: 0a0a 636c 6173 7320 4d6f 6e67 6f49 6e76  ..class MongoInv
-00013020: 616c 6964 4461 7465 5469 6d65 4578 6365  alidDateTimeExce
-00013030: 7074 696f 6e28 4578 6365 7074 696f 6e29  ption(Exception)
-00013040: 3a0a 2020 2020 2222 2252 6169 7365 6420  :.    """Raised 
-00013050: 6966 2077 6520 6669 6e64 2061 6e20 696e  if we find an in
-00013060: 7661 6c69 6420 6461 7465 2d74 696d 6520  valid date-time 
-00013070: 7468 6174 2077 6520 6361 6e27 7420 6861  that we can't ha
-00013080: 6e64 6c65 2222 220a 0a63 6c61 7373 2053  ndle"""..class S
-00013090: 796e 6345 7863 6570 7469 6f6e 2845 7863  yncException(Exc
-000130a0: 6570 7469 6f6e 293a 0a20 2020 2022 2222  eption):.    """
-000130b0: 5261 6973 6564 2069 6620 7765 2066 696e  Raised if we fin
-000130c0: 6420 616e 2069 6e76 616c 6964 2064 6174  d an invalid dat
-000130d0: 652d 7469 6d65 2074 6861 7420 7765 2063  e-time that we c
-000130e0: 616e 2774 2068 616e 646c 6522 2222 0a0a  an't handle"""..
-000130f0: 636c 6173 7320 4e6f 5265 6164 5072 6976  class NoReadPriv
-00013100: 696c 6567 6545 7863 6570 7469 6f6e 2845  ilegeException(E
-00013110: 7863 6570 7469 6f6e 293a 0a20 2020 2022  xception):.    "
-00013120: 2222 5261 6973 6564 2069 6620 7468 6520  ""Raised if the 
-00013130: 4442 2075 7365 7220 6861 7320 6e6f 2072  DB user has no r
-00013140: 6561 6420 7072 6976 696c 6567 6520 6f6e  ead privilege on
-00013150: 2074 6865 2044 4222 2222 0a20 2020 2064   the DB""".    d
-00013160: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00013170: 2c20 7573 6572 2c20 6462 5f6e 616d 6529  , user, db_name)
-00013180: 3a0a 2020 2020 2020 2020 6d73 6720 3d20  :.        msg = 
-00013190: 6622 5468 6520 7573 6572 2027 7b75 7365  f"The user '{use
-000131a0: 727d 2720 6861 7320 6e6f 2072 6561 6420  r}' has no read 
-000131b0: 7072 6976 696c 6567 6520 6f6e 2074 6865  privilege on the
-000131c0: 2064 6174 6162 6173 6520 277b 6462 5f6e   database '{db_n
-000131d0: 616d 657d 2721 220a 2020 2020 2020 2020  ame}'!".        
-000131e0: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
-000131f0: 286d 7367 290a 0a63 6c61 7373 2049 6e76  (msg)..class Inv
-00013200: 616c 6964 5570 6461 7465 4275 6666 6572  alidUpdateBuffer
-00013210: 5369 7a65 4572 726f 7228 4578 6365 7074  SizeError(Except
-00013220: 696f 6e29 3a0a 2020 2020 2222 2252 6169  ion):.    """Rai
-00013230: 7365 6420 6966 2074 6865 2067 6976 656e  sed if the given
-00013240: 2075 7064 6174 6520 6275 6666 6572 2073   update buffer s
-00013250: 697a 6520 7573 6564 2069 6e20 6c6f 675f  ize used in log_
-00013260: 6261 7365 6420 6973 2069 6e76 616c 6964  based is invalid
-00013270: 2222 220a 2020 2020 6465 6620 5f5f 696e  """.    def __in
-00013280: 6974 5f5f 2873 656c 662c 2073 697a 652c  it__(self, size,
-00013290: 2072 6561 736f 6e29 3a0a 2020 2020 2020   reason):.      
-000132a0: 2020 6d73 6720 3d20 6622 496e 7661 6c69    msg = f"Invali
-000132b0: 6420 7570 6461 7465 2062 7566 6665 7220  d update buffer 
-000132c0: 7369 7a65 207b 7369 7a65 7d21 207b 7265  size {size}! {re
-000132d0: 6173 6f6e 7d22 0a20 2020 2020 2020 2073  ason}".        s
-000132e0: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
-000132f0: 6d73 6729 0a0a 636c 6173 7320 496e 7661  msg)..class Inva
-00013300: 6c69 6441 7761 6974 5469 6d65 4572 726f  lidAwaitTimeErro
-00013310: 7228 4578 6365 7074 696f 6e29 3a0a 2020  r(Exception):.  
-00013320: 2020 2222 2252 6169 7365 6420 6966 2074    """Raised if t
-00013330: 6865 2067 6976 656e 2061 7761 6974 2074  he given await t
-00013340: 696d 6520 7573 6564 2069 6e20 6c6f 675f  ime used in log_
-00013350: 6261 7365 6420 6973 2069 6e76 616c 6964  based is invalid
-00013360: 2222 220a 2020 2020 6465 6620 5f5f 696e  """.    def __in
-00013370: 6974 5f5f 2873 656c 662c 2074 696d 655f  it__(self, time_
-00013380: 6d73 2c20 7265 6173 6f6e 293a 0a20 2020  ms, reason):.   
-00013390: 2020 2020 206d 7367 203d 2066 2249 6e76       msg = f"Inv
-000133a0: 616c 6964 2061 7761 6974 2074 696d 6520  alid await time 
-000133b0: 7b74 696d 655f 6d73 7d21 207b 7265 6173  {time_ms}! {reas
-000133c0: 6f6e 7d22 0a20 2020 2020 2020 2073 7570  on}".        sup
-000133d0: 6572 2829 2e5f 5f69 6e69 745f 5f28 6d73  er().__init__(ms
-000133e0: 6729 0a0a 636c 6173 7320 496e 7661 6c69  g)..class Invali
-000133f0: 644c 6f67 4261 7365 6446 756c 6c4c 6f61  dLogBasedFullLoa
-00013400: 644f 6e45 6d70 7479 5374 6174 6528 4578  dOnEmptyState(Ex
-00013410: 6365 7074 696f 6e29 3a0a 2020 2020 2222  ception):.    ""
-00013420: 2252 6169 7365 6420 6966 2074 6865 2067  "Raised if the g
-00013430: 6976 656e 206c 6f67 2062 6173 6564 2066  iven log based f
-00013440: 756c 6c20 6c6f 6164 206f 6e20 656d 7074  ull load on empt
-00013450: 7920 7374 6174 6520 696e 206c 6f67 5f62  y state in log_b
-00013460: 6173 6564 2069 6e76 616c 6964 2222 220a  ased invalid""".
-00013470: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-00013480: 2873 656c 662c 2066 756c 6c5f 6c6f 6164  (self, full_load
-00013490: 5f6f 6e5f 656d 7074 795f 7374 6174 652c  _on_empty_state,
-000134a0: 2072 6561 736f 6e29 202d 3e20 4e6f 6e65   reason) -> None
-000134b0: 3a0a 2020 2020 2020 2020 6d73 6720 3d20  :.        msg = 
-000134c0: 6622 496e 7661 6c69 6420 6675 6c6c 206c  f"Invalid full l
-000134d0: 6f61 6420 6f6e 2065 6d70 7479 2073 7461  oad on empty sta
-000134e0: 7465 2061 7267 207b 6675 6c6c 5f6c 6f61  te arg {full_loa
-000134f0: 645f 6f6e 5f65 6d70 7479 5f73 7461 7465  d_on_empty_state
-00013500: 7d21 207b 7265 6173 6f6e 7d22 0a20 2020  }! {reason}".   
-00013510: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
-00013520: 6e69 745f 5f28 6d73 6729 0000 0000 0000  nit__(msg)......
+00010e00: 6672 6f6d 2064 6174 6574 696d 6520 696d  from datetime im
+00010e10: 706f 7274 2064 6174 6574 696d 650a 0a64  port datetime..d
+00010e20: 6566 2069 735f 6461 7465 5f74 696d 6528  ef is_date_time(
+00010e30: 6461 7465 7469 6d65 5f73 7472 3a20 7374  datetime_str: st
+00010e40: 7229 202d 3e20 626f 6f6c 3a0a 2020 2020  r) -> bool:.    
+00010e50: 2222 220a 2020 2020 4172 6773 3a0a 2020  """.    Args:.  
+00010e60: 2020 2020 2020 6461 7465 7469 6d65 5f73        datetime_s
+00010e70: 7472 3a20 6120 7374 7269 6e67 200a 2020  tr: a string .  
+00010e80: 2020 0a20 2020 2052 6574 7572 6e73 3a20    .    Returns: 
+00010e90: 5472 7565 2069 6620 6461 7465 7469 6d65  True if datetime
+00010ea0: 5f73 7472 2069 7320 7374 7269 6e67 2072  _str is string r
+00010eb0: 6570 7265 7365 6e74 6174 696f 6e20 6f66  epresentation of
+00010ec0: 2064 6174 6574 696d 6520 2c20 4661 6c73   datetime , Fals
+00010ed0: 6520 6f74 6865 7277 6973 650a 2020 2020  e otherwise.    
+00010ee0: 2222 220a 0a20 2020 2064 6174 6574 696d  """..    datetim
+00010ef0: 655f 666f 726d 6174 7320 3d20 5b0a 2020  e_formats = [.  
+00010f00: 2020 2020 2020 2225 592d 256d 2d25 6422        "%Y-%m-%d"
+00010f10: 2c0a 2020 2020 2020 2020 2225 592d 256d  ,.        "%Y-%m
+00010f20: 2d25 6420 2548 3a25 4d3a 2553 222c 0a20  -%d %H:%M:%S",. 
+00010f30: 2020 2020 2020 2022 2559 2d25 6d2d 2564         "%Y-%m-%d
+00010f40: 2025 483a 254d 3a25 5320 257a 222c 0a20   %H:%M:%S %z",. 
+00010f50: 2020 2020 2020 2022 2559 2d25 6d2d 2564         "%Y-%m-%d
+00010f60: 2025 483a 254d 3a25 5325 7a22 2c0a 2020   %H:%M:%S%z",.  
+00010f70: 2020 2020 2020 2225 592d 256d 2d25 6454        "%Y-%m-%dT
+00010f80: 2548 3a25 4d3a 2553 222c 0a20 2020 2020  %H:%M:%S",.     
+00010f90: 2020 2022 2559 2d25 6d2d 2564 5425 483a     "%Y-%m-%dT%H:
+00010fa0: 254d 3a25 532e 2566 220a 2020 2020 5d0a  %M:%S.%f".    ].
+00010fb0: 0a20 2020 2066 6f72 2064 745f 666d 7420  .    for dt_fmt 
+00010fc0: 696e 2064 6174 6574 696d 655f 666f 726d  in datetime_form
+00010fd0: 6174 733a 0a20 2020 2020 2020 2074 7279  ats:.        try
+00010fe0: 3a0a 2020 2020 2020 2020 2020 2020 6461  :.            da
+00010ff0: 7465 7469 6d65 2e73 7472 7074 696d 6528  tetime.strptime(
+00011000: 6461 7465 7469 6d65 5f73 7472 2c20 6474  datetime_str, dt
+00011010: 5f66 6d74 290a 2020 2020 2020 2020 2020  _fmt).          
+00011020: 2020 7265 7475 726e 2054 7275 650a 2020    return True.  
+00011030: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
+00011040: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
+00011050: 2020 2020 2070 6173 7320 0a0a 2020 2020       pass ..    
+00011060: 7265 7475 726e 2046 616c 7365 0a0a 0a0a  return False....
+00011070: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00011080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000110f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000111f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00011210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00011270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00011280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00011290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+000112a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000112f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00011310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000113f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011400: 3232 206d 7469 6d65 3d31 3638 3737 3630  22 mtime=1687760
+00011410: 3530 322e 300a 0000 0000 0000 0000 0000  502.0...........
+00011420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000114f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000115f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011600: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00011610: 2f64 7a5f 6d6f 6e67 6f64 622f 6462 5f75  /dz_mongodb/db_u
+00011620: 7469 6c73 2e70 7900 0000 0000 0000 0000  tils.py.........
+00011630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00011670: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00011680: 3030 3135 3735 3200 3030 3030 3030 3030  0015752.00000000
+00011690: 3030 3000 3032 3132 3034 0020 3000 0000  000.021204. 0...
+000116a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000116f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011700: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00011710: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00011720: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00011730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000117f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00011800: 2222 220a 4c69 7374 206f 6620 6865 6c70  """.List of help
+00011810: 6572 2066 756e 6374 696f 6e73 2066 6f72  er functions for
+00011820: 2044 4220 7265 6c61 7465 6420 7072 6f63   DB related proc
+00011830: 6365 7365 7320 6f6e 6c79 0a22 2222 0a0a  ceses only."""..
+00011840: 696d 706f 7274 2073 696e 6765 720a 0a66  import singer..f
+00011850: 726f 6d20 7479 7069 6e67 2069 6d70 6f72  rom typing impor
+00011860: 7420 4469 6374 2c20 4c69 7374 0a66 726f  t Dict, List.fro
+00011870: 6d20 7079 6d6f 6e67 6f20 696d 706f 7274  m pymongo import
+00011880: 204d 6f6e 676f 436c 6965 6e74 0a66 726f   MongoClient.fro
+00011890: 6d20 7079 6d6f 6e67 6f2e 636f 6c6c 6563  m pymongo.collec
+000118a0: 7469 6f6e 2069 6d70 6f72 7420 436f 6c6c  tion import Coll
+000118b0: 6563 7469 6f6e 0a66 726f 6d20 7079 6d6f  ection.from pymo
+000118c0: 6e67 6f2e 6461 7461 6261 7365 2069 6d70  ngo.database imp
+000118d0: 6f72 7420 4461 7461 6261 7365 0a66 726f  ort Database.fro
+000118e0: 6d20 7369 6e67 6572 2069 6d70 6f72 7420  m singer import 
+000118f0: 6d65 7461 6461 7461 0a66 726f 6d20 647a  metadata.from dz
+00011900: 5f6d 6f6e 676f 6462 2e64 6174 6574 696d  _mongodb.datetim
+00011910: 655f 7574 696c 7320 696d 706f 7274 2069  e_utils import i
+00011920: 735f 6461 7465 5f74 696d 6520 0a0a 4c4f  s_date_time ..LO
+00011930: 4747 4552 203d 2073 696e 6765 722e 6765  GGER = singer.ge
+00011940: 745f 6c6f 6767 6572 2827 647a 5f6d 6f6e  t_logger('dz_mon
+00011950: 676f 6462 2729 0a0a 4947 4e4f 5245 5f44  godb')..IGNORE_D
+00011960: 4253 203d 205b 2773 7973 7465 6d27 2c20  BS = ['system', 
+00011970: 276c 6f63 616c 272c 2027 636f 6e66 6967  'local', 'config
+00011980: 275d 0a52 4f4c 4553 5f57 4954 484f 5554  '].ROLES_WITHOUT
+00011990: 5f46 494e 445f 5052 4956 494c 4547 4553  _FIND_PRIVILEGES
+000119a0: 203d 207b 0a20 2020 2027 6462 4164 6d69   = {.    'dbAdmi
+000119b0: 6e27 2c0a 2020 2020 2775 7365 7241 646d  n',.    'userAdm
+000119c0: 696e 272c 0a20 2020 2027 636c 7573 7465  in',.    'cluste
+000119d0: 7241 646d 696e 272c 0a20 2020 2027 636c  rAdmin',.    'cl
+000119e0: 7573 7465 724d 616e 6167 6572 272c 0a20  usterManager',. 
+000119f0: 2020 2027 636c 7573 7465 724d 6f6e 6974     'clusterMonit
+00011a00: 6f72 272c 0a20 2020 2027 686f 7374 4d61  or',.    'hostMa
+00011a10: 6e61 6765 7227 2c0a 2020 2020 2772 6573  nager',.    'res
+00011a20: 746f 7265 270a 7d0a 524f 4c45 535f 5749  tore'.}.ROLES_WI
+00011a30: 5448 5f46 494e 445f 5052 4956 494c 4547  TH_FIND_PRIVILEG
+00011a40: 4553 203d 207b 0a20 2020 2027 7265 6164  ES = {.    'read
+00011a50: 272c 0a20 2020 2027 7265 6164 5772 6974  ',.    'readWrit
+00011a60: 6527 2c0a 2020 2020 2772 6561 6441 6e79  e',.    'readAny
+00011a70: 4461 7461 6261 7365 272c 0a20 2020 2027  Database',.    '
+00011a80: 7265 6164 5772 6974 6541 6e79 4461 7461  readWriteAnyData
+00011a90: 6261 7365 272c 0a20 2020 2027 6462 4f77  base',.    'dbOw
+00011aa0: 6e65 7227 2c0a 2020 2020 2762 6163 6b75  ner',.    'backu
+00011ab0: 7027 2c0a 2020 2020 2772 6f6f 7427 0a7d  p',.    'root'.}
+00011ac0: 0a52 4f4c 4553 5f57 4954 485f 414c 4c5f  .ROLES_WITH_ALL_
+00011ad0: 4442 5f46 494e 445f 5052 4956 494c 4547  DB_FIND_PRIVILEG
+00011ae0: 4553 203d 207b 0a20 2020 2027 7265 6164  ES = {.    'read
+00011af0: 416e 7944 6174 6162 6173 6527 2c0a 2020  AnyDatabase',.  
+00011b00: 2020 2772 6561 6457 7269 7465 416e 7944    'readWriteAnyD
+00011b10: 6174 6162 6173 6527 2c0a 2020 2020 2772  atabase',.    'r
+00011b20: 6f6f 7427 0a7d 0a0a 6465 6620 6765 745f  oot'.}..def get_
+00011b30: 726f 6c65 735f 7769 7468 5f66 696e 645f  roles_with_find_
+00011b40: 7072 6976 7328 6461 7461 6261 7365 3a20  privs(database: 
+00011b50: 4461 7461 6261 7365 2c20 7573 6572 3a20  Database, user: 
+00011b60: 4469 6374 2920 2d3e 204c 6973 745b 4469  Dict) -> List[Di
+00011b70: 6374 5d3a 0a20 2020 2022 2222 0a20 2020  ct]:.    """.   
+00011b80: 2046 696e 6473 2061 6e64 2072 6574 7572   Finds and retur
+00011b90: 6e73 2061 6c6c 2074 6865 2075 7365 7227  ns all the user'
+00011ba0: 7320 726f 6c65 7320 7468 6174 2068 6176  s roles that hav
+00011bb0: 6520 6669 6e64 2070 7269 7669 6c65 6765  e find privilege
+00011bc0: 732e 0a20 2020 2055 7365 7220 6973 2064  s..    User is d
+00011bd0: 6963 7469 6f6e 6172 7920 696e 2074 6865  ictionary in the
+00011be0: 2066 6f72 6d3a 0a20 2020 2020 7b0a 2020   form:.     {.  
+00011bf0: 2020 2020 2020 2027 5f69 6427 3a20 3c61         '_id': <a
+00011c00: 7574 685f 6462 3e2e 3c75 7365 723e 2c0a  uth_db>.<user>,.
+00011c10: 2020 2020 2020 2020 2027 6462 273a 203c           'db': <
+00011c20: 6175 7468 5f64 623e 2c0a 2020 2020 2020  auth_db>,.      
+00011c30: 2020 2027 6d65 6368 616e 6973 6d73 273a     'mechanisms':
+00011c40: 205b 2753 4352 414d 2d53 4841 2d31 272c   ['SCRAM-SHA-1',
+00011c50: 2027 5343 5241 4d2d 5348 412d 3235 3627   'SCRAM-SHA-256'
+00011c60: 5d2c 0a20 2020 2020 2020 2020 2772 6f6c  ],.         'rol
+00011c70: 6573 273a 205b 7b27 6462 273a 2027 6164  es': [{'db': 'ad
+00011c80: 6d69 6e27 2c20 2772 6f6c 6527 3a20 2772  min', 'role': 'r
+00011c90: 6561 6457 7269 7465 416e 7944 6174 6162  eadWriteAnyDatab
+00011ca0: 6173 6527 7d2c 0a20 2020 2020 2020 2020  ase'},.         
+00011cb0: 2020 2020 2020 2020 2020 7b27 6462 273a            {'db':
+00011cc0: 2027 6c6f 6361 6c27 2c20 2772 6f6c 6527   'local', 'role'
+00011cd0: 3a20 2772 6561 6427 7d5d 2c0a 2020 2020  : 'read'}],.    
+00011ce0: 2020 2020 2027 7573 6572 273a 203c 7573       'user': <us
+00011cf0: 6572 3e2c 0a20 2020 2020 2020 2020 2775  er>,.         'u
+00011d00: 7365 7249 6427 3a20 3c75 7365 7249 643e  serId': <userId>
+00011d10: 0a20 2020 2020 7d0a 2020 2020 4172 6773  .     }.    Args
+00011d20: 3a0a 2020 2020 2020 2020 6461 7461 6261  :.        databa
+00011d30: 7365 3a20 4d6f 6e67 6f44 4220 4461 7461  se: MongoDB Data
+00011d40: 6261 7365 2069 6e73 7461 6e63 650a 2020  base instance.  
+00011d50: 2020 2020 2020 7573 6572 3a20 6462 2075        user: db u
+00011d60: 7365 7220 6469 6374 696f 6e61 7279 0a0a  ser dictionary..
+00011d70: 2020 2020 5265 7475 726e 733a 206c 6973      Returns: lis
+00011d80: 7420 6f66 2072 6f6c 6573 0a0a 2020 2020  t of roles..    
+00011d90: 2222 220a 2020 2020 726f 6c65 7320 3d20  """.    roles = 
+00011da0: 5b5d 0a0a 2020 2020 666f 7220 726f 6c65  []..    for role
+00011db0: 2069 6e20 7573 6572 2e67 6574 2827 726f   in user.get('ro
+00011dc0: 6c65 7327 2c20 5b5d 293a 0a20 2020 2020  les', []):.     
+00011dd0: 2020 2069 6620 726f 6c65 2e67 6574 2827     if role.get('
+00011de0: 726f 6c65 2729 2069 6e20 524f 4c45 535f  role') in ROLES_
+00011df0: 5749 5448 4f55 545f 4649 4e44 5f50 5249  WITHOUT_FIND_PRI
+00011e00: 5649 4c45 4745 533a 0a20 2020 2020 2020  VILEGES:.       
+00011e10: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
+00011e20: 2020 2020 2020 2072 6f6c 655f 6e61 6d65         role_name
+00011e30: 203d 2072 6f6c 655b 2772 6f6c 6527 5d0a   = role['role'].
+00011e40: 0a20 2020 2020 2020 2023 2072 6f6c 6573  .        # roles
+00011e50: 2077 6974 6820 6669 6e64 2070 7269 7669   with find privi
+00011e60: 6c65 6765 730a 2020 2020 2020 2020 6966  leges.        if
+00011e70: 2072 6f6c 655f 6e61 6d65 2069 6e20 524f   role_name in RO
+00011e80: 4c45 535f 5749 5448 5f46 494e 445f 5052  LES_WITH_FIND_PR
+00011e90: 4956 494c 4547 4553 2061 6e64 2072 6f6c  IVILEGES and rol
+00011ea0: 652e 6765 7428 2764 6227 293a 0a20 2020  e.get('db'):.   
+00011eb0: 2020 2020 2020 2020 2072 6f6c 6573 2e61           roles.a
+00011ec0: 7070 656e 6428 726f 6c65 290a 0a20 2020  ppend(role)..   
+00011ed0: 2020 2020 2023 2066 6f72 2063 7573 746f       # for custo
+00011ee0: 6d20 726f 6c65 732c 2067 6574 2074 6865  m roles, get the
+00011ef0: 2022 7375 622d 726f 6c65 7322 0a20 2020   "sub-roles".   
+00011f00: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00011f10: 2020 2020 2020 2072 6f6c 655f 696e 666f         role_info
+00011f20: 5f6c 6973 7420 3d20 6461 7461 6261 7365  _list = database
+00011f30: 2e63 6f6d 6d61 6e64 287b 2772 6f6c 6573  .command({'roles
+00011f40: 496e 666f 273a 207b 2772 6f6c 6527 3a20  Info': {'role': 
+00011f50: 726f 6c65 5f6e 616d 652c 2027 6462 273a  role_name, 'db':
+00011f60: 2064 6174 6162 6173 652e 6e61 6d65 7d7d   database.name}}
+00011f70: 290a 2020 2020 2020 2020 2020 2020 726f  ).            ro
+00011f80: 6c65 5f69 6e66 6f20 3d20 5b72 2066 6f72  le_info = [r for
+00011f90: 2072 2069 6e20 726f 6c65 5f69 6e66 6f5f   r in role_info_
+00011fa0: 6c69 7374 2e67 6574 2827 726f 6c65 7327  list.get('roles'
+00011fb0: 2c20 5b5d 2920 6966 2072 5b27 726f 6c65  , []) if r['role
+00011fc0: 275d 203d 3d20 726f 6c65 5f6e 616d 655d  '] == role_name]
+00011fd0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00011fe0: 206c 656e 2872 6f6c 655f 696e 666f 2920   len(role_info) 
+00011ff0: 213d 2031 3a0a 2020 2020 2020 2020 2020  != 1:.          
+00012000: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+00012010: 2020 2020 2020 2020 2020 2020 726f 6c65              role
+00012020: 732e 6578 7465 6e64 285b 7375 625f 726f  s.extend([sub_ro
+00012030: 6c65 2066 6f72 2073 7562 5f72 6f6c 6520  le for sub_role 
+00012040: 696e 2072 6f6c 655f 696e 666f 5b30 5d2e  in role_info[0].
+00012050: 6765 7428 2772 6f6c 6573 272c 205b 5d29  get('roles', [])
+00012060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012070: 2020 2020 2020 2020 2020 2069 6620 7375             if su
+00012080: 625f 726f 6c65 2e67 6574 2827 726f 6c65  b_role.get('role
+00012090: 2729 2069 6e20 524f 4c45 535f 5749 5448  ') in ROLES_WITH
+000120a0: 5f46 494e 445f 5052 4956 494c 4547 4553  _FIND_PRIVILEGES
+000120b0: 2061 6e64 2073 7562 5f72 6f6c 652e 6765   and sub_role.ge
+000120c0: 7428 2764 6227 295d 290a 0a20 2020 2072  t('db')])..    r
+000120d0: 6574 7572 6e20 726f 6c65 730a 0a0a 6465  eturn roles...de
+000120e0: 6620 6765 745f 726f 6c65 7328 6461 7461  f get_roles(data
+000120f0: 6261 7365 3a20 4461 7461 6261 7365 2c20  base: Database, 
+00012100: 6462 5f75 7365 723a 2073 7472 2920 2d3e  db_user: str) ->
+00012110: 204c 6973 745b 4469 6374 5d3a 0a20 2020   List[Dict]:.   
+00012120: 2022 2222 0a20 2020 2047 6574 2061 6c6c   """.    Get all
+00012130: 2075 7365 7227 7320 726f 6c65 7320 7769   user's roles wi
+00012140: 7468 2066 696e 6420 7072 6976 696c 6567  th find privileg
+00012150: 6573 2069 6620 7573 6572 2065 7869 7374  es if user exist
+00012160: 730a 2020 2020 4172 6773 3a0a 2020 2020  s.    Args:.    
+00012170: 2020 2020 6461 7461 6261 7365 3a20 4d6f      database: Mo
+00012180: 6e67 6f44 4220 4442 2069 6e73 7461 6e63  ngoDB DB instanc
+00012190: 650a 2020 2020 2020 2020 6462 5f75 7365  e.        db_use
+000121a0: 723a 2044 4220 7573 6572 206e 616d 6520  r: DB user name 
+000121b0: 746f 2067 6574 2072 6f6c 6573 2066 6f72  to get roles for
+000121c0: 0a0a 2020 2020 5265 7475 726e 733a 204c  ..    Returns: L
+000121d0: 6973 7420 6f66 2072 6f6c 6573 2066 6f75  ist of roles fou
+000121e0: 6e64 0a0a 2020 2020 2222 220a 0a20 2020  nd..    """..   
+000121f0: 2023 2075 7365 7273 496e 666f 2043 6f6d   # usersInfo Com
+00012200: 6d61 6e64 2020 7265 7475 726e 7320 6f62  mand  returns ob
+00012210: 6a65 6374 2069 6e20 7368 6170 653a 0a20  ject in shape:. 
+00012220: 2020 2023 207b 0a20 2020 2023 2020 203c     # {.    #   <
+00012230: 2073 6f6d 655f 6f74 6865 725f 6b65 7973   some_other_keys
+00012240: 203e 0a20 2020 2023 2020 2027 7573 6572   >.    #   'user
+00012250: 7327 3a20 5b0a 2020 2020 2320 2020 2020  s': [.    #     
+00012260: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00012270: 2023 2020 2020 2020 2020 2020 2020 2020   #              
+00012280: 2020 2020 2020 275f 6964 273a 203c 2061        '_id': < a
+00012290: 7574 685f 6462 203e 2e20 3c20 7573 6572  uth_db >. < user
+000122a0: 203e 2c0a 2020 2020 2320 2020 2020 2020   >,.    #       
+000122b0: 2020 2020 2020 2020 2020 2020 2027 6462               'db
+000122c0: 273a 203c 2061 7574 685f 6462 203e 2c0a  ': < auth_db >,.
+000122d0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+000122e0: 2020 2020 2020 2020 2027 6d65 6368 616e           'mechan
+000122f0: 6973 6d73 273a 205b 2753 4352 414d 2d53  isms': ['SCRAM-S
+00012300: 4841 2d31 272c 2027 5343 5241 4d2d 5348  HA-1', 'SCRAM-SH
+00012310: 412d 3235 3627 5d2c 0a20 2020 2023 2020  A-256'],.    #  
+00012320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012330: 2020 2027 726f 6c65 7327 3a20 5b7b 2764     'roles': [{'d
+00012340: 6227 3a20 2761 646d 696e 272c 2027 726f  b': 'admin', 'ro
+00012350: 6c65 273a 2027 7265 6164 5772 6974 6541  le': 'readWriteA
+00012360: 6e79 4461 7461 6261 7365 277d 2c0a 2020  nyDatabase'},.  
+00012370: 2020 2320 2020 2020 2020 2020 2020 2020    #             
+00012380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012390: 2020 7b27 6462 273a 2027 6c6f 6361 6c27    {'db': 'local'
+000123a0: 2c20 2772 6f6c 6527 3a20 2772 6561 6427  , 'role': 'read'
+000123b0: 7d5d 2c0a 2020 2020 2320 2020 2020 2020  }],.    #       
+000123c0: 2020 2020 2020 2020 2020 2020 2020 2775                'u
+000123d0: 7365 7227 3a20 3c20 7573 6572 203e 2c0a  ser': < user >,.
+000123e0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
+000123f0: 2020 2020 2020 2020 2020 2775 7365 7249            'userI
+00012400: 6427 3a20 3c20 7573 6572 4964 203e 0a20  d': < userId >. 
+00012410: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+00012420: 2020 2020 207d 0a20 2020 2023 2020 2020       }.    #    
+00012430: 2020 2020 2020 205d 0a20 2020 2023 207d         ].    # }
+00012440: 0a20 2020 2075 7365 725f 696e 666f 203d  .    user_info =
+00012450: 2064 6174 6162 6173 652e 636f 6d6d 616e   database.comman
+00012460: 6428 7b27 7573 6572 7349 6e66 6f27 3a20  d({'usersInfo': 
+00012470: 6462 5f75 7365 727d 290a 0a20 2020 2075  db_user})..    u
+00012480: 7365 7273 203d 205b 7520 666f 7220 7520  sers = [u for u 
+00012490: 696e 2075 7365 725f 696e 666f 2e67 6574  in user_info.get
+000124a0: 2827 7573 6572 7327 2920 6966 2075 2e67  ('users') if u.g
+000124b0: 6574 2827 7573 6572 2729 203d 3d20 6462  et('user') == db
+000124c0: 5f75 7365 725d 0a20 2020 2069 6620 6c65  _user].    if le
+000124d0: 6e28 7573 6572 7329 2021 3d20 313a 0a20  n(users) != 1:. 
+000124e0: 2020 2020 2020 204c 4f47 4745 522e 7761         LOGGER.wa
+000124f0: 726e 696e 6728 2743 6f75 6c64 206e 6f74  rning('Could not
+00012500: 2066 696e 6420 616e 7920 7573 6572 7320   find any users 
+00012510: 666f 7220 2573 272c 2064 625f 7573 6572  for %s', db_user
+00012520: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00012530: 205b 5d0a 0a20 2020 2072 6574 7572 6e20   []..    return 
+00012540: 6765 745f 726f 6c65 735f 7769 7468 5f66  get_roles_with_f
+00012550: 696e 645f 7072 6976 7328 6461 7461 6261  ind_privs(databa
+00012560: 7365 2c20 7573 6572 735b 305d 290a 0a0a  se, users[0])...
+00012570: 6465 6620 6765 745f 6461 7461 6261 7365  def get_database
+00012580: 7328 636c 6965 6e74 3a20 4d6f 6e67 6f43  s(client: MongoC
+00012590: 6c69 656e 742c 2063 6f6e 6669 673a 2044  lient, config: D
+000125a0: 6963 7429 202d 3e20 4c69 7374 5b73 7472  ict) -> List[str
+000125b0: 5d3a 0a20 2020 2022 2222 0a20 2020 2047  ]:.    """.    G
+000125c0: 6574 2061 6c6c 2074 6865 2064 6174 6162  et all the datab
+000125d0: 6173 6573 2069 6e20 7468 6520 636c 7573  ases in the clus
+000125e0: 7465 7220 7468 6174 2074 6865 2075 7365  ter that the use
+000125f0: 7220 726f 6c65 7320 6361 6e20 7265 6164  r roles can read
+00012600: 2066 726f 6d0a 2020 2020 4172 6773 3a0a   from.    Args:.
+00012610: 2020 2020 2020 2020 636c 6965 6e74 3a20          client: 
+00012620: 4d6f 6e67 6f44 4220 636c 6965 6e74 2069  MongoDB client i
+00012630: 6e73 7461 6e63 650a 2020 2020 2020 2020  nstance.        
+00012640: 636f 6e66 6967 3a20 4442 2063 6f6e 6669  config: DB confi
+00012650: 670a 0a20 2020 2052 6574 7572 6e73 3a20  g..    Returns: 
+00012660: 4c69 7374 206f 6620 6462 206e 616d 6573  List of db names
+00012670: 0a0a 2020 2020 2222 220a 2020 2020 726f  ..    """.    ro
+00012680: 6c65 7320 3d20 6765 745f 726f 6c65 7328  les = get_roles(
+00012690: 636c 6965 6e74 5b63 6f6e 6669 675b 2761  client[config['a
+000126a0: 7574 685f 6461 7461 6261 7365 275d 5d2c  uth_database']],
+000126b0: 2063 6f6e 6669 675b 2775 7365 7227 5d29   config['user'])
+000126c0: 0a20 2020 204c 4f47 4745 522e 696e 666f  .    LOGGER.info
+000126d0: 2827 526f 6c65 733a 2025 7327 2c20 726f  ('Roles: %s', ro
+000126e0: 6c65 7329 0a0a 2020 2020 6361 6e5f 7265  les)..    can_re
+000126f0: 6164 5f61 6c6c 203d 206c 656e 285b 726f  ad_all = len([ro
+00012700: 6c65 2066 6f72 2072 6f6c 6520 696e 2072  le for role in r
+00012710: 6f6c 6573 2069 6620 726f 6c65 5b27 726f  oles if role['ro
+00012720: 6c65 275d 2069 6e20 524f 4c45 535f 5749  le'] in ROLES_WI
+00012730: 5448 5f41 4c4c 5f44 425f 4649 4e44 5f50  TH_ALL_DB_FIND_P
+00012740: 5249 5649 4c45 4745 535d 2920 3e20 300a  RIVILEGES]) > 0.
+00012750: 0a20 2020 2069 6620 6361 6e5f 7265 6164  .    if can_read
+00012760: 5f61 6c6c 3a0a 2020 2020 2020 2020 6462  _all:.        db
+00012770: 5f6e 616d 6573 203d 205b 6420 666f 7220  _names = [d for 
+00012780: 6420 696e 2063 6c69 656e 742e 6c69 7374  d in client.list
+00012790: 5f64 6174 6162 6173 655f 6e61 6d65 7328  _database_names(
+000127a0: 2920 6966 2064 206e 6f74 2069 6e20 4947  ) if d not in IG
+000127b0: 4e4f 5245 5f44 4253 5d0a 2020 2020 656c  NORE_DBS].    el
+000127c0: 7365 3a0a 2020 2020 2020 2020 6462 5f6e  se:.        db_n
+000127d0: 616d 6573 203d 205b 726f 6c65 5b27 6462  ames = [role['db
+000127e0: 275d 2066 6f72 2072 6f6c 6520 696e 2072  '] for role in r
+000127f0: 6f6c 6573 2069 6620 726f 6c65 5b27 6462  oles if role['db
+00012800: 275d 206e 6f74 2069 6e20 4947 4e4f 5245  '] not in IGNORE
+00012810: 5f44 4253 5d0a 0a20 2020 204c 4f47 4745  _DBS]..    LOGGE
+00012820: 522e 696e 666f 2827 4461 7461 6261 7365  R.info('Database
+00012830: 733a 2025 7327 2c20 6462 5f6e 616d 6573  s: %s', db_names
+00012840: 290a 0a20 2020 2072 6574 7572 6e20 6462  )..    return db
+00012850: 5f6e 616d 6573 0a0a 6465 6620 7661 6c75  _names..def valu
+00012860: 655f 7479 7065 2876 616c 7565 2920 2d3e  e_type(value) ->
+00012870: 2073 7472 3a0a 2020 2020 636c 6173 735f   str:.    class_
+00012880: 6e61 6d65 203d 2076 616c 7565 2e5f 5f6e  name = value.__n
+00012890: 616d 655f 5f0a 0a20 2020 2069 6620 636c  ame__..    if cl
+000128a0: 6173 735f 6e61 6d65 203d 3d20 2773 7472  ass_name == 'str
+000128b0: 273a 0a20 2020 2020 2020 2072 6574 7572  ':.        retur
+000128c0: 6e20 2273 7472 696e 6722 0a20 2020 2065  n "string".    e
+000128d0: 6c69 6620 636c 6173 735f 6e61 6d65 203d  lif class_name =
+000128e0: 3d20 2769 6e74 2720 6f72 2063 6c61 7373  = 'int' or class
+000128f0: 5f6e 616d 6520 3d3d 2027 666c 6f61 7427  _name == 'float'
+00012900: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00012910: 2022 6e75 6d62 6572 220a 2020 2020 656c   "number".    el
+00012920: 6966 2063 6c61 7373 5f6e 616d 6520 3d3d  if class_name ==
+00012930: 2027 626f 6f6c 273a 0a20 2020 2020 2020   'bool':.       
+00012940: 2072 6574 7572 6e20 2262 6f6f 6c65 616e   return "boolean
+00012950: 220a 2020 2020 656c 6966 2063 6c61 7373  ".    elif class
+00012960: 5f6e 616d 6520 3d3d 2027 6469 6374 273a  _name == 'dict':
+00012970: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00012980: 226f 626a 6563 7422 0a20 2020 2065 6c69  "object".    eli
+00012990: 6620 636c 6173 735f 6e61 6d65 203d 3d20  f class_name == 
+000129a0: 276c 6973 7427 3a0a 2020 2020 2020 2020  'list':.        
+000129b0: 7265 7475 726e 2022 6172 7261 7922 0a0a  return "array"..
+000129c0: 6465 6620 7072 6f64 7563 655f 636f 6c6c  def produce_coll
+000129d0: 6563 7469 6f6e 5f73 6368 656d 6128 636f  ection_schema(co
+000129e0: 6c6c 6563 7469 6f6e 3a20 436f 6c6c 6563  llection: Collec
+000129f0: 7469 6f6e 2920 2d3e 2044 6963 743a 0a20  tion) -> Dict:. 
+00012a00: 2020 2022 2222 0a20 2020 2047 656e 6572     """.    Gener
+00012a10: 6174 6520 6120 7363 6865 6d61 2f63 6174  ate a schema/cat
+00012a20: 616c 6f67 2066 726f 6d20 7468 6520 636f  alog from the co
+00012a30: 6c6c 6563 7469 6f6e 2064 6574 6169 6c73  llection details
+00012a40: 2066 6f72 2064 6973 636f 7665 7279 206d   for discovery m
+00012a50: 6f64 650a 2020 2020 4172 6773 3a0a 2020  ode.    Args:.  
+00012a60: 2020 2020 2020 636f 6c6c 6563 7469 6f6e        collection
+00012a70: 3a20 7374 7265 616d 2043 6f6c 6c65 6374  : stream Collect
+00012a80: 696f 6e0a 0a20 2020 2052 6574 7572 6e73  ion..    Returns
+00012a90: 3a20 636f 6c6c 6563 7469 6f6e 2063 6174  : collection cat
+00012aa0: 616c 6f67 0a0a 2020 2020 2222 220a 2020  alog..    """.  
+00012ab0: 2020 636f 6c6c 6563 7469 6f6e 5f6e 616d    collection_nam
+00012ac0: 6520 3d20 636f 6c6c 6563 7469 6f6e 2e6e  e = collection.n
+00012ad0: 616d 650a 2020 2020 636f 6c6c 6563 7469  ame.    collecti
+00012ae0: 6f6e 5f64 625f 6e61 6d65 203d 2063 6f6c  on_db_name = col
+00012af0: 6c65 6374 696f 6e2e 6461 7461 6261 7365  lection.database
+00012b00: 2e6e 616d 650a 0a20 2020 2069 735f 7669  .name..    is_vi
+00012b10: 6577 203d 2063 6f6c 6c65 6374 696f 6e2e  ew = collection.
+00012b20: 6f70 7469 6f6e 7328 292e 6765 7428 2776  options().get('v
+00012b30: 6965 774f 6e27 2920 6973 206e 6f74 204e  iewOn') is not N
+00012b40: 6f6e 650a 0a20 2020 206d 6461 7461 203d  one..    mdata =
+00012b50: 207b 7d0a 2020 2020 6d64 6174 6120 3d20   {}.    mdata = 
+00012b60: 6d65 7461 6461 7461 2e77 7269 7465 286d  metadata.write(m
+00012b70: 6461 7461 2c20 2829 2c20 2774 6162 6c65  data, (), 'table
+00012b80: 2d6b 6579 2d70 726f 7065 7274 6965 7327  -key-properties'
+00012b90: 2c20 5b27 5f69 6427 5d29 0a20 2020 206d  , ['_id']).    m
+00012ba0: 6461 7461 203d 206d 6574 6164 6174 612e  data = metadata.
+00012bb0: 7772 6974 6528 6d64 6174 612c 2028 292c  write(mdata, (),
+00012bc0: 2027 6461 7461 6261 7365 2d6e 616d 6527   'database-name'
+00012bd0: 2c20 636f 6c6c 6563 7469 6f6e 5f64 625f  , collection_db_
+00012be0: 6e61 6d65 290a 2020 2020 6d64 6174 6120  name).    mdata 
+00012bf0: 3d20 6d65 7461 6461 7461 2e77 7269 7465  = metadata.write
+00012c00: 286d 6461 7461 2c20 2829 2c20 2772 6f77  (mdata, (), 'row
+00012c10: 2d63 6f75 6e74 272c 2063 6f6c 6c65 6374  -count', collect
+00012c20: 696f 6e2e 6573 7469 6d61 7465 645f 646f  ion.estimated_do
+00012c30: 6375 6d65 6e74 5f63 6f75 6e74 2829 290a  cument_count()).
+00012c40: 2020 2020 6d64 6174 6120 3d20 6d65 7461      mdata = meta
+00012c50: 6461 7461 2e77 7269 7465 286d 6461 7461  data.write(mdata
+00012c60: 2c20 2829 2c20 2769 732d 7669 6577 272c  , (), 'is-view',
+00012c70: 2069 735f 7669 6577 290a 0a20 2020 2023   is_view)..    #
+00012c80: 2077 7269 7465 2076 616c 6964 2d72 6570   write valid-rep
+00012c90: 6c69 6361 7469 6f6e 2d6b 6579 206d 6574  lication-key met
+00012ca0: 6164 6174 6120 6279 2066 696e 6469 6e67  adata by finding
+00012cb0: 2066 6965 6c64 7320 7468 6174 2068 6176   fields that hav
+00012cc0: 6520 696e 6465 7865 7320 6f6e 2074 6865  e indexes on the
+00012cd0: 6d2e 0a20 2020 2023 2063 616e 6e6f 7420  m..    # cannot 
+00012ce0: 6765 7420 696e 6465 7865 7320 666f 7220  get indexes for 
+00012cf0: 7669 6577 7320 2d2d 204e 423a 2054 6869  views -- NB: Thi
+00012d00: 7320 6d65 616e 7320 6e6f 206b 6579 2d62  s means no key-b
+00012d10: 6173 6564 2069 6e63 7265 6d65 6e74 616c  ased incremental
+00012d20: 2066 6f72 2076 6965 7773 3f0a 2020 2020   for views?.    
+00012d30: 6966 206e 6f74 2069 735f 7669 6577 3a0a  if not is_view:.
+00012d40: 2020 2020 2020 2020 7661 6c69 645f 7265          valid_re
+00012d50: 706c 6963 6174 696f 6e5f 6b65 7973 203d  plication_keys =
+00012d60: 205b 5d0a 2020 2020 2020 2020 636f 6c6c   [].        coll
+00012d70: 5f69 6e64 6578 6573 203d 2063 6f6c 6c65  _indexes = colle
+00012d80: 6374 696f 6e2e 696e 6465 785f 696e 666f  ction.index_info
+00012d90: 726d 6174 696f 6e28 290a 2020 2020 2020  rmation().      
+00012da0: 2020 2320 696e 6465 785f 696e 666f 726d    # index_inform
+00012db0: 6174 696f 6e28 2920 7265 7475 726e 7320  ation() returns 
+00012dc0: 6120 6d61 7020 6f66 2069 6e64 6578 5f6e  a map of index_n
+00012dd0: 616d 6520 2d3e 2069 6e64 6578 5f69 6e66  ame -> index_inf
+00012de0: 6f72 6d61 7469 6f6e 0a20 2020 2020 2020  ormation.       
+00012df0: 2066 6f72 205f 2c20 696e 6465 785f 696e   for _, index_in
+00012e00: 666f 2069 6e20 636f 6c6c 5f69 6e64 6578  fo in coll_index
+00012e10: 6573 2e69 7465 6d73 2829 3a0a 2020 2020  es.items():.    
+00012e20: 2020 2020 2020 2020 2320 7765 2064 6f6e          # we don
+00012e30: 2774 2073 7570 706f 7274 2063 6f6d 706f  't support compo
+00012e40: 756e 6420 696e 6465 7865 730a 2020 2020  und indexes.    
+00012e50: 2020 2020 2020 2020 6966 206c 656e 2869          if len(i
+00012e60: 6e64 6578 5f69 6e66 6f2e 6765 7428 276b  ndex_info.get('k
+00012e70: 6579 2729 2920 3d3d 2031 3a0a 2020 2020  ey')) == 1:.    
+00012e80: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00012e90: 785f 6669 656c 645f 696e 666f 203d 2069  x_field_info = i
+00012ea0: 6e64 6578 5f69 6e66 6f2e 6765 7428 276b  ndex_info.get('k
+00012eb0: 6579 2729 5b30 5d0a 2020 2020 2020 2020  ey')[0].        
+00012ec0: 2020 2020 2020 2020 2320 696e 6465 785f          # index_
+00012ed0: 6669 656c 645f 696e 666f 2069 7320 6120  field_info is a 
+00012ee0: 7475 706c 6520 6f66 2028 6669 656c 645f  tuple of (field_
+00012ef0: 6e61 6d65 2c20 736f 7274 5f64 6972 6563  name, sort_direc
+00012f00: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+00012f10: 2020 2020 2020 6966 2069 6e64 6578 5f66        if index_f
+00012f20: 6965 6c64 5f69 6e66 6f3a 0a20 2020 2020  ield_info:.     
+00012f30: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00012f40: 616c 6964 5f72 6570 6c69 6361 7469 6f6e  alid_replication
+00012f50: 5f6b 6579 732e 6170 7065 6e64 2869 6e64  _keys.append(ind
+00012f60: 6578 5f66 6965 6c64 5f69 6e66 6f5b 305d  ex_field_info[0]
+00012f70: 290a 0a20 2020 2020 2020 2069 6620 7661  )..        if va
+00012f80: 6c69 645f 7265 706c 6963 6174 696f 6e5f  lid_replication_
+00012f90: 6b65 7973 3a0a 2020 2020 2020 2020 2020  keys:.          
+00012fa0: 2020 6d64 6174 6120 3d20 6d65 7461 6461    mdata = metada
+00012fb0: 7461 2e77 7269 7465 286d 6461 7461 2c20  ta.write(mdata, 
+00012fc0: 2829 2c20 2776 616c 6964 2d72 6570 6c69  (), 'valid-repli
+00012fd0: 6361 7469 6f6e 2d6b 6579 7327 2c20 7661  cation-keys', va
+00012fe0: 6c69 645f 7265 706c 6963 6174 696f 6e5f  lid_replication_
+00012ff0: 6b65 7973 290a 0a20 2020 2064 625f 7363  keys)..    db_sc
+00013000: 6865 6d61 203d 207b 0a20 2020 2020 2020  hema = {.       
+00013010: 2027 7461 626c 655f 6e61 6d65 273a 2063   'table_name': c
+00013020: 6f6c 6c65 6374 696f 6e5f 6e61 6d65 2c0a  ollection_name,.
+00013030: 2020 2020 2020 2020 2773 7472 6561 6d27          'stream'
+00013040: 3a20 636f 6c6c 6563 7469 6f6e 5f6e 616d  : collection_nam
+00013050: 652c 0a20 2020 2020 2020 2027 6d65 7461  e,.        'meta
+00013060: 6461 7461 273a 206d 6574 6164 6174 612e  data': metadata.
+00013070: 746f 5f6c 6973 7428 6d64 6174 6129 2c0a  to_list(mdata),.
+00013080: 2020 2020 2020 2020 2774 6170 5f73 7472          'tap_str
+00013090: 6561 6d5f 6964 273a 2066 227b 636f 6c6c  eam_id': f"{coll
+000130a0: 6563 7469 6f6e 5f64 625f 6e61 6d65 7d2d  ection_db_name}-
+000130b0: 7b63 6f6c 6c65 6374 696f 6e5f 6e61 6d65  {collection_name
+000130c0: 7d22 2c0a 2020 2020 2020 2020 2773 6368  }",.        'sch
+000130d0: 656d 6127 3a20 7b0a 2020 2020 2020 2020  ema': {.        
+000130e0: 2020 2020 2774 7970 6527 3a20 276f 626a      'type': 'obj
+000130f0: 6563 7427 2c0a 2020 2020 2020 2020 2020  ect',.          
+00013100: 2020 2770 726f 7065 7274 6965 7327 3a20    'properties': 
+00013110: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00013120: 2020 225f 6964 223a 207b 0a20 2020 2020    "_id": {.     
+00013130: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00013140: 7479 7065 223a 205b 2273 7472 696e 6722  type": ["string"
+00013150: 2c20 226e 756c 6c22 5d0a 2020 2020 2020  , "null"].      
+00013160: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
+00013170: 2020 2020 2020 2020 2020 2020 2022 5f73               "_s
+00013180: 6463 5f64 656c 6574 6564 5f61 7422 3a20  dc_deleted_at": 
+00013190: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+000131a0: 2020 2020 2020 2274 7970 6522 3a20 5b0a        "type": [.
+000131b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131c0: 2020 2020 2020 2020 2273 7472 696e 6722          "string"
+000131d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000131e0: 2020 2020 2020 2020 2020 226e 756c 6c22            "null"
+000131f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013200: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+00013210: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00013220: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+00013230: 207d 0a20 2020 207d 0a0a 2020 2020 666f   }.    }..    fo
+00013240: 7220 726f 7720 696e 2063 6f6c 6c65 6374  r row in collect
+00013250: 696f 6e2e 6669 6e64 2829 2e6c 696d 6974  ion.find().limit
+00013260: 2831 3030 3029 3a0a 2020 2020 2020 2020  (1000):.        
+00013270: 666f 7220 6b65 792c 7661 6c75 6520 696e  for key,value in
+00013280: 2072 6f77 2e69 7465 6d73 2829 3a0a 2020   row.items():.  
+00013290: 2020 2020 2020 2020 2020 7661 6c5f 7479            val_ty
+000132a0: 7065 203d 2076 616c 7565 5f74 7970 6528  pe = value_type(
+000132b0: 7479 7065 2876 616c 7565 2929 0a0a 2020  type(value))..  
+000132c0: 2020 2020 2020 2020 2020 6966 2076 616c            if val
+000132d0: 5f74 7970 6520 3d3d 2027 7374 7227 3a0a  _type == 'str':.
+000132e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000132f0: 6966 2069 735f 6461 7465 5f74 696d 6528  if is_date_time(
+00013300: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
+00013310: 2020 2020 2020 2020 2020 2020 6462 5f73              db_s
+00013320: 6368 656d 615b 2773 6368 656d 6127 5d5b  chema['schema'][
+00013330: 2770 726f 7065 7274 6965 7327 5d5b 6b65  'properties'][ke
+00013340: 795d 203d 207b 2274 7970 6522 3a20 7661  y] = {"type": va
+00013350: 6c5f 7479 7065 202c 2022 666f 726d 6174  l_type , "format
+00013360: 223a 2264 6174 652d 7469 6d65 227d 0a20  ":"date-time"}. 
+00013370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013380: 2020 2063 6f6e 7469 6e75 650a 0a20 2020     continue..   
+00013390: 2020 2020 2020 2020 2064 625f 7363 6865           db_sche
+000133a0: 6d61 5b27 7363 6865 6d61 275d 5b27 7072  ma['schema']['pr
+000133b0: 6f70 6572 7469 6573 275d 5b6b 6579 5d20  operties'][key] 
+000133c0: 3d20 7b22 7479 7065 223a 2076 616c 5f74  = {"type": val_t
+000133d0: 7970 657d 0a0a 2020 2020 7265 7475 726e  ype}..    return
+000133e0: 2064 625f 7363 6865 6d61 0000 0000 0000   db_schema......
+000133f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00013410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00013470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00013480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00013490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+000134a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000134f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00013510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00013610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013600: 3232 206d 7469 6d65 3d31 3637 3634 3530  22 mtime=1676450
+00013610: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
 00013620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00013670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00013680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00013690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00013660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000136a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000136b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000136c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000136d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000136e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000136f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00013700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4986,3551 +4986,3551 @@
 00013790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013800: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00013810: 3137 312e 300a 0000 0000 0000 0000 0000  171.0...........
-00013820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013800: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00013810: 2f64 7a5f 6d6f 6e67 6f64 622f 6572 726f  /dz_mongodb/erro
+00013820: 7273 2e70 7900 0000 0000 0000 0000 0000  rs.py...........
 00013830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00013870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00013880: 3030 3033 3435 3200 3030 3030 3030 3030  0003452.00000000
+00013890: 3030 3000 3032 3037 3035 0020 3000 0000  000.020705. 0...
 000138a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013900: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00013910: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00013920: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
 00013930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000139a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000139b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000139c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000139d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000139e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000139f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013a00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00013a10: 2f64 7a5f 6d6f 6e67 6f64 622f 7374 7265  /dz_mongodb/stre
-00013a20: 616d 5f75 7469 6c73 2e70 7900 0000 0000  am_utils.py.....
-00013a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00013a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00013a80: 3030 3130 3134 3600 3030 3030 3030 3030  0010146.00000000
-00013a90: 3030 3000 3032 3231 3031 0020 3000 0000  000.022101. 0...
-00013aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013b00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00013b10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00013b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
-00013b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013c00: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
-00013c10: 7974 686f 6e33 0a22 2222 0a4c 6973 7420  ython3.""".List 
-00013c20: 6f66 2068 656c 7065 7220 6675 6e63 7469  of helper functi
-00013c30: 6f6e 7320 666f 7220 7374 7265 616d 7320  ons for streams 
-00013c40: 6f6e 6c79 0a22 2222 0a0a 6672 6f6d 2074  only."""..from t
-00013c50: 7970 696e 6720 696d 706f 7274 2044 6963  yping import Dic
-00013c60: 742c 204f 7074 696f 6e61 6c2c 204c 6973  t, Optional, Lis
-00013c70: 742c 2054 7570 6c65 0a0a 696d 706f 7274  t, Tuple..import
-00013c80: 2073 696e 6765 720a 6672 6f6d 2073 696e   singer.from sin
-00013c90: 6765 7220 696d 706f 7274 206d 6574 6164  ger import metad
-00013ca0: 6174 612c 2077 7269 7465 5f6d 6573 7361  ata, write_messa
-00013cb0: 6765 2c20 5363 6865 6d61 4d65 7373 6167  ge, SchemaMessag
-00013cc0: 650a 0a66 726f 6d20 647a 5f6d 6f6e 676f  e..from dz_mongo
-00013cd0: 6462 2e73 796e 635f 7374 7261 7465 6769  db.sync_strategi
-00013ce0: 6573 2e63 6f6d 6d6f 6e20 696d 706f 7274  es.common import
-00013cf0: 2063 616c 6375 6c61 7465 5f64 6573 7469   calculate_desti
-00013d00: 6e61 7469 6f6e 5f73 7472 6561 6d5f 6e61  nation_stream_na
-00013d10: 6d65 0a0a 0a64 6566 2067 6574 5f72 6570  me...def get_rep
-00013d20: 6c69 6361 7469 6f6e 5f6d 6574 686f 645f  lication_method_
-00013d30: 6672 6f6d 5f73 7472 6561 6d28 7374 7265  from_stream(stre
-00013d40: 616d 3a20 4469 6374 2920 2d3e 204f 7074  am: Dict) -> Opt
-00013d50: 696f 6e61 6c5b 7374 725d 3a0a 2020 2020  ional[str]:.    
-00013d60: 2222 220a 2020 2020 5365 6172 6368 2066  """.    Search f
-00013d70: 6f72 2074 6865 2073 7472 6561 6d20 7265  or the stream re
-00013d80: 706c 6963 6174 696f 6e20 6d65 7468 6f64  plication method
-00013d90: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-00013da0: 2020 2073 7472 6561 6d3a 2073 7472 6561     stream: strea
-00013db0: 6d20 6469 6374 696f 6e61 7279 0a0a 2020  m dictionary..  
-00013dc0: 2020 5265 7475 726e 733a 2072 6570 6c69    Returns: repli
-00013dd0: 6361 7469 6f6e 206d 6574 686f 6420 6966  cation method if
-00013de0: 2064 6566 696e 6564 2c20 4e6f 6e65 206f   defined, None o
-00013df0: 7468 6572 7769 7365 0a0a 2020 2020 2222  therwise..    ""
-00013e00: 220a 2020 2020 6d64 5f6d 6170 203d 206d  ".    md_map = m
-00013e10: 6574 6164 6174 612e 746f 5f6d 6170 2873  etadata.to_map(s
-00013e20: 7472 6561 6d5b 276d 6574 6164 6174 6127  tream['metadata'
-00013e30: 5d29 0a20 2020 2072 6574 7572 6e20 6d65  ]).    return me
-00013e40: 7461 6461 7461 2e67 6574 286d 645f 6d61  tadata.get(md_ma
-00013e50: 702c 2028 292c 2027 7265 706c 6963 6174  p, (), 'replicat
-00013e60: 696f 6e2d 6d65 7468 6f64 2729 0a0a 0a64  ion-method')...d
-00013e70: 6566 2069 735f 6c6f 675f 6261 7365 645f  ef is_log_based_
-00013e80: 7374 7265 616d 2873 7472 6561 6d3a 2044  stream(stream: D
-00013e90: 6963 7429 202d 3e20 626f 6f6c 3a0a 2020  ict) -> bool:.  
-00013ea0: 2020 2222 220a 2020 2020 6368 6563 6b73    """.    checks
-00013eb0: 2069 6620 7374 7265 616d 2075 7365 7320   if stream uses 
-00013ec0: 6c6f 6720 6261 7365 6420 7265 706c 6963  log based replic
-00013ed0: 6174 696f 6e20 6d65 7468 6f64 0a20 2020  ation method.   
-00013ee0: 2052 6574 7572 6e73 3a20 5472 7565 2069   Returns: True i
-00013ef0: 6620 4c4f 475f 4241 5345 442c 2046 616c  f LOG_BASED, Fal
-00013f00: 7365 206f 7468 6572 7769 7365 0a20 2020  se otherwise.   
-00013f10: 2022 2222 0a20 2020 2072 6574 7572 6e20   """.    return 
-00013f20: 6765 745f 7265 706c 6963 6174 696f 6e5f  get_replication_
-00013f30: 6d65 7468 6f64 5f66 726f 6d5f 7374 7265  method_from_stre
-00013f40: 616d 2873 7472 6561 6d29 203d 3d20 274c  am(stream) == 'L
-00013f50: 4f47 5f42 4153 4544 270a 0a0a 6465 6620  OG_BASED'...def 
-00013f60: 7772 6974 655f 7363 6865 6d61 5f6d 6573  write_schema_mes
-00013f70: 7361 6765 2873 7472 6561 6d3a 2044 6963  sage(stream: Dic
-00013f80: 7429 3a0a 2020 2020 2222 220a 2020 2020  t):.    """.    
-00013f90: 4372 6561 7465 7320 616e 6420 7772 6974  Creates and writ
-00013fa0: 6573 2061 2073 7472 6561 6d20 7363 6865  es a stream sche
-00013fb0: 6d61 206d 6573 7361 6765 2074 6f20 7374  ma message to st
-00013fc0: 646f 7574 0a20 2020 2041 7267 733a 0a20  dout.    Args:. 
-00013fd0: 2020 2020 2020 2073 7472 6561 6d3a 2073         stream: s
-00013fe0: 7472 6561 6d20 6361 7461 6c6f 670a 2020  tream catalog.  
-00013ff0: 2020 2222 220a 2020 2020 7772 6974 655f    """.    write_
-00014000: 6d65 7373 6167 6528 5363 6865 6d61 4d65  message(SchemaMe
-00014010: 7373 6167 6528 0a20 2020 2020 2020 2073  ssage(.        s
-00014020: 7472 6561 6d3d 6361 6c63 756c 6174 655f  tream=calculate_
-00014030: 6465 7374 696e 6174 696f 6e5f 7374 7265  destination_stre
-00014040: 616d 5f6e 616d 6528 7374 7265 616d 292c  am_name(stream),
-00014050: 0a20 2020 2020 2020 2073 6368 656d 613d  .        schema=
-00014060: 7374 7265 616d 5b27 7363 6865 6d61 275d  stream['schema']
-00014070: 2c0a 2020 2020 2020 2020 6b65 795f 7072  ,.        key_pr
-00014080: 6f70 6572 7469 6573 3d5b 275f 6964 275d  operties=['_id']
-00014090: 2929 0a0a 0a64 6566 2069 735f 7374 7265  ))...def is_stre
-000140a0: 616d 5f73 656c 6563 7465 6428 7374 7265  am_selected(stre
-000140b0: 616d 3a20 4469 6374 2920 2d3e 2062 6f6f  am: Dict) -> boo
-000140c0: 6c3a 0a20 2020 2022 2222 0a20 2020 2043  l:.    """.    C
-000140d0: 6865 636b 7320 7468 6520 7374 7265 616d  hecks the stream
-000140e0: 2773 206d 6574 6164 6174 6120 746f 2073  's metadata to s
-000140f0: 6565 2069 6620 7374 7265 616d 2069 7320  ee if stream is 
-00014100: 7365 6c65 6374 6564 2066 6f72 2073 796e  selected for syn
-00014110: 630a 2020 2020 4172 6773 3a0a 2020 2020  c.    Args:.    
-00014120: 2020 2020 7374 7265 616d 3a20 7374 7265      stream: stre
-00014130: 616d 2064 6963 7469 6f6e 6172 790a 0a20  am dictionary.. 
-00014140: 2020 2052 6574 7572 6e73 3a20 5472 7565     Returns: True
-00014150: 2069 6620 7365 6c65 6374 6564 2c20 4661   if selected, Fa
-00014160: 6c73 6520 6f74 6865 7277 6973 650a 0a20  lse otherwise.. 
-00014170: 2020 2022 2222 0a20 2020 206d 6461 7461     """.    mdata
-00014180: 203d 206d 6574 6164 6174 612e 746f 5f6d   = metadata.to_m
-00014190: 6170 2873 7472 6561 6d5b 276d 6574 6164  ap(stream['metad
-000141a0: 6174 6127 5d29 0a20 2020 2069 735f 7365  ata']).    is_se
-000141b0: 6c65 6374 6564 203d 206d 6574 6164 6174  lected = metadat
-000141c0: 612e 6765 7428 6d64 6174 612c 2028 292c  a.get(mdata, (),
-000141d0: 2027 7365 6c65 6374 6564 2729 0a0a 2020   'selected')..  
-000141e0: 2020 7265 7475 726e 2069 735f 7365 6c65    return is_sele
-000141f0: 6374 6564 2069 7320 5472 7565 0a0a 0a64  cted is True...d
-00014200: 6566 2073 7472 6561 6d73 5f6c 6973 745f  ef streams_list_
-00014210: 746f 5f64 6963 7428 7374 7265 616d 733a  to_dict(streams:
-00014220: 204c 6973 745b 4469 6374 5d29 202d 3e20   List[Dict]) -> 
-00014230: 4469 6374 5b73 7472 2c20 4469 6374 5d3a  Dict[str, Dict]:
-00014240: 0a20 2020 2022 2222 0a20 2020 2063 6f6e  .    """.    con
-00014250: 7665 7274 7320 7468 6520 7374 7265 616d  verts the stream
-00014260: 7320 6c69 7374 2074 6f20 6469 6374 696f  s list to dictio
-00014270: 6e61 7279 206f 6620 7374 7265 616d 7320  nary of streams 
-00014280: 7768 6572 6520 7468 6520 6b65 7973 2061  where the keys a
-00014290: 7265 2074 6865 2074 6170 2073 7472 6561  re the tap strea
-000142a0: 6d20 6964 730a 2020 2020 4172 6773 3a0a  m ids.    Args:.
-000142b0: 2020 2020 2020 2020 7374 7265 616d 733a          streams:
-000142c0: 2073 7472 6561 6d20 6c69 7374 0a0a 2020   stream list..  
-000142d0: 2020 5265 7475 726e 733a 2064 6963 7469    Returns: dicti
-000142e0: 6f6e 6172 7920 6f64 2073 7472 6561 6d73  onary od streams
-000142f0: 0a0a 2020 2020 2222 220a 2020 2020 7265  ..    """.    re
-00014300: 7475 726e 207b 7374 7265 616d 5b27 7461  turn {stream['ta
-00014310: 705f 7374 7265 616d 5f69 6427 5d3a 2073  p_stream_id']: s
-00014320: 7472 6561 6d20 666f 7220 7374 7265 616d  tream for stream
-00014330: 2069 6e20 7374 7265 616d 737d 0a0a 0a64   in streams}...d
-00014340: 6566 2066 696c 7465 725f 7374 7265 616d  ef filter_stream
-00014350: 735f 6279 5f72 6570 6c69 6361 7469 6f6e  s_by_replication
-00014360: 5f6d 6574 686f 6428 7374 7265 616d 735f  _method(streams_
-00014370: 746f 5f73 796e 633a 204c 6973 745b 4469  to_sync: List[Di
-00014380: 6374 5d29 202d 3e20 5475 706c 655b 4c69  ct]) -> Tuple[Li
-00014390: 7374 5b44 6963 745d 2c20 4c69 7374 5b44  st[Dict], List[D
-000143a0: 6963 745d 5d3a 0a20 2020 2022 2222 0a20  ict]]:.    """. 
-000143b0: 2020 2044 6976 6964 6573 2074 6865 206c     Divides the l
-000143c0: 6973 7420 6f66 2073 7472 6561 6d73 2069  ist of streams i
-000143d0: 6e74 6f20 7477 6f20 6c69 7374 733a 206f  nto two lists: o
-000143e0: 6e65 206f 6620 7374 7265 616d 7320 7468  ne of streams th
-000143f0: 6174 2075 7365 206c 6f67 2062 6173 6564  at use log based
-00014400: 2061 6e64 2074 6865 206f 7468 6572 2074   and the other t
-00014410: 6861 7420 7573 650a 2020 2020 7472 6164  hat use.    trad
-00014420: 6974 696f 6e61 6c20 7265 706c 6963 6174  itional replicat
-00014430: 696f 6e20 6d65 7468 6f64 2c20 692e 6520  ion method, i.e 
-00014440: 6569 7468 6572 2046 756c 6c20 7461 626c  either Full tabl
-00014450: 6520 6f72 2049 6e63 7265 6d65 6e74 616c  e or Incremental
-00014460: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-00014470: 2020 2073 7472 6561 6d73 5f74 6f5f 7379     streams_to_sy
-00014480: 6e63 3a20 4c69 7374 206f 6620 7374 7265  nc: List of stre
-00014490: 616d 7320 7365 6c65 6374 6564 2074 6f20  ams selected to 
-000144a0: 7379 6e63 0a20 2020 2052 6574 7572 6e73  sync.    Returns
-000144b0: 3a20 5475 706c 6520 6f66 2074 776f 206c  : Tuple of two l
-000144c0: 6973 7473 2c20 6669 7273 7420 6973 206c  ists, first is l
-000144d0: 6f67 2062 6173 6564 2073 7472 6561 6d73  og based streams
-000144e0: 2061 6e64 2074 6865 2073 6563 6f6e 6420   and the second 
-000144f0: 6973 206c 6973 7420 6f66 2074 7261 6469  is list of tradi
-00014500: 7469 6f6e 616c 2073 7472 6561 6d73 0a0a  tional streams..
-00014510: 2020 2020 2222 220a 2020 2020 6c6f 675f      """.    log_
-00014520: 6261 7365 645f 7374 7265 616d 7320 3d20  based_streams = 
-00014530: 5b5d 0a20 2020 206e 6f6e 5f6c 6f67 5f62  [].    non_log_b
-00014540: 6173 6564 5f73 7472 6561 6d73 203d 205b  ased_streams = [
-00014550: 5d0a 0a20 2020 2066 6f72 2073 7472 6561  ]..    for strea
-00014560: 6d20 696e 2073 7472 6561 6d73 5f74 6f5f  m in streams_to_
-00014570: 7379 6e63 3a0a 2020 2020 2020 2020 6966  sync:.        if
-00014580: 2069 735f 6c6f 675f 6261 7365 645f 7374   is_log_based_st
-00014590: 7265 616d 2873 7472 6561 6d29 3a0a 2020  ream(stream):.  
-000145a0: 2020 2020 2020 2020 2020 6c6f 675f 6261            log_ba
-000145b0: 7365 645f 7374 7265 616d 732e 6170 7065  sed_streams.appe
-000145c0: 6e64 2873 7472 6561 6d29 0a20 2020 2020  nd(stream).     
-000145d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000145e0: 2020 2020 206e 6f6e 5f6c 6f67 5f62 6173       non_log_bas
-000145f0: 6564 5f73 7472 6561 6d73 2e61 7070 656e  ed_streams.appen
-00014600: 6428 7374 7265 616d 290a 0a20 2020 2072  d(stream)..    r
-00014610: 6574 7572 6e20 6c6f 675f 6261 7365 645f  eturn log_based_
-00014620: 7374 7265 616d 732c 206e 6f6e 5f6c 6f67  streams, non_log
-00014630: 5f62 6173 6564 5f73 7472 6561 6d73 0a0a  _based_streams..
-00014640: 0a64 6566 2067 6574 5f73 7472 6561 6d73  .def get_streams
-00014650: 5f74 6f5f 7379 6e63 2873 7472 6561 6d73  _to_sync(streams
-00014660: 3a20 4c69 7374 5b44 6963 745d 2c20 7374  : List[Dict], st
-00014670: 6174 653a 2044 6963 7429 202d 3e20 4c69  ate: Dict) -> Li
-00014680: 7374 3a0a 2020 2020 2222 220a 2020 2020  st:.    """.    
-00014690: 4669 6c74 6572 2074 6865 2073 7472 6561  Filter the strea
-000146a0: 6d73 206c 6973 7420 746f 2072 6574 7572  ms list to retur
-000146b0: 6e20 6f6e 6c79 2074 686f 7365 2073 656c  n only those sel
-000146c0: 6563 7465 6420 666f 7220 7379 6e63 0a20  ected for sync. 
-000146d0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-000146e0: 2073 7472 6561 6d73 3a20 6c69 7374 206f   streams: list o
-000146f0: 6620 616c 6c20 6469 7363 6f76 6572 6564  f all discovered
-00014700: 2073 7472 6561 6d73 0a20 2020 2020 2020   streams.       
-00014710: 2073 7461 7465 3a20 7374 7265 616d 7320   state: streams 
-00014720: 7374 6174 650a 0a20 2020 2052 6574 7572  state..    Retur
-00014730: 6e73 3a20 6c69 7374 206f 6620 7365 6c65  ns: list of sele
-00014740: 6374 6564 2073 7472 6561 6d73 2c20 6f72  cted streams, or
-00014750: 6465 7265 6420 6672 6f6d 2073 7472 6561  dered from strea
-00014760: 6d73 2077 6974 686f 7574 2073 7461 7465  ms without state
-00014770: 2074 6f20 7468 6f73 6520 7769 7468 2073   to those with s
-00014780: 7461 7465 0a0a 2020 2020 2222 220a 2020  tate..    """.  
-00014790: 2020 2320 6765 7420 7365 6c65 6374 6564    # get selected
-000147a0: 2073 7472 6561 6d73 0a20 2020 2073 656c   streams.    sel
-000147b0: 6563 7465 645f 7374 7265 616d 7320 3d20  ected_streams = 
-000147c0: 5b73 7472 6561 6d20 666f 7220 7374 7265  [stream for stre
-000147d0: 616d 2069 6e20 7374 7265 616d 7320 6966  am in streams if
-000147e0: 2069 735f 7374 7265 616d 5f73 656c 6563   is_stream_selec
-000147f0: 7465 6428 7374 7265 616d 295d 0a0a 2020  ted(stream)]..  
-00014800: 2020 2320 7072 696f 7269 7469 7a65 2073    # prioritize s
-00014810: 7472 6561 6d73 2074 6861 7420 6861 7665  treams that have
-00014820: 206e 6f74 2062 6565 6e20 7072 6f63 6573   not been proces
-00014830: 7365 640a 2020 2020 7374 7265 616d 735f  sed.    streams_
-00014840: 7769 7468 5f73 7461 7465 203d 205b 5d0a  with_state = [].
-00014850: 2020 2020 7374 7265 616d 735f 7769 7468      streams_with
-00014860: 6f75 745f 7374 6174 6520 3d20 5b5d 0a0a  out_state = []..
-00014870: 2020 2020 666f 7220 7374 7265 616d 2069      for stream i
-00014880: 6e20 7365 6c65 6374 6564 5f73 7472 6561  n selected_strea
-00014890: 6d73 3a0a 2020 2020 2020 2020 6966 2073  ms:.        if s
-000148a0: 7461 7465 2e67 6574 2827 626f 6f6b 6d61  tate.get('bookma
-000148b0: 726b 7327 2c20 7b7d 292e 6765 7428 7374  rks', {}).get(st
-000148c0: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
-000148d0: 5f69 6427 5d29 3a0a 2020 2020 2020 2020  _id']):.        
-000148e0: 2020 2020 7374 7265 616d 735f 7769 7468      streams_with
-000148f0: 5f73 7461 7465 2e61 7070 656e 6428 7374  _state.append(st
-00014900: 7265 616d 290a 2020 2020 2020 2020 656c  ream).        el
-00014910: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00014920: 7374 7265 616d 735f 7769 7468 6f75 745f  streams_without_
-00014930: 7374 6174 652e 6170 7065 6e64 2873 7472  state.append(str
-00014940: 6561 6d29 0a0a 2020 2020 6f72 6465 7265  eam)..    ordere
-00014950: 645f 7374 7265 616d 7320 3d20 7374 7265  d_streams = stre
-00014960: 616d 735f 7769 7468 6f75 745f 7374 6174  ams_without_stat
-00014970: 6520 2b20 7374 7265 616d 735f 7769 7468  e + streams_with
-00014980: 5f73 7461 7465 0a0a 2020 2020 2320 4966  _state..    # If
-00014990: 2074 6865 2073 7461 7465 2073 6179 7320   the state says 
-000149a0: 7765 2077 6572 6520 696e 2074 6865 206d  we were in the m
-000149b0: 6964 646c 6520 6f66 2070 726f 6365 7373  iddle of process
-000149c0: 696e 6720 6120 7374 7265 616d 2c20 736b  ing a stream, sk
-000149d0: 6970 0a20 2020 2023 2074 6f20 7468 6174  ip.    # to that
-000149e0: 2073 7472 6561 6d2e 2054 6865 6e20 7072   stream. Then pr
-000149f0: 6f63 6573 7320 7374 7265 616d 7320 7769  ocess streams wi
-00014a00: 7468 6f75 7420 7072 696f 7220 7374 6174  thout prior stat
-00014a10: 6520 616e 6420 6669 6e61 6c6c 790a 2020  e and finally.  
-00014a20: 2020 2320 6d6f 7665 206f 6e74 6f20 7374    # move onto st
-00014a30: 7265 616d 7320 7769 7468 2073 7461 7465  reams with state
-00014a40: 2028 692e 652e 2068 6176 6520 6265 656e   (i.e. have been
-00014a50: 2073 796e 6365 6420 696e 2074 6865 2070   synced in the p
-00014a60: 6173 7429 0a20 2020 2063 7572 7265 6e74  ast).    current
-00014a70: 6c79 5f73 796e 6369 6e67 203d 2073 696e  ly_syncing = sin
-00014a80: 6765 722e 6765 745f 6375 7272 656e 746c  ger.get_currentl
-00014a90: 795f 7379 6e63 696e 6728 7374 6174 6529  y_syncing(state)
-00014aa0: 0a0a 2020 2020 6966 2063 7572 7265 6e74  ..    if current
-00014ab0: 6c79 5f73 796e 6369 6e67 3a0a 2020 2020  ly_syncing:.    
-00014ac0: 2020 2020 6375 7272 656e 746c 795f 7379      currently_sy
-00014ad0: 6e63 696e 675f 7374 7265 616d 203d 206c  ncing_stream = l
-00014ae0: 6973 7428 6669 6c74 6572 280a 2020 2020  ist(filter(.    
-00014af0: 2020 2020 2020 2020 6c61 6d62 6461 2073          lambda s
-00014b00: 3a20 735b 2774 6170 5f73 7472 6561 6d5f  : s['tap_stream_
-00014b10: 6964 275d 203d 3d20 6375 7272 656e 746c  id'] == currentl
-00014b20: 795f 7379 6e63 696e 672c 0a20 2020 2020  y_syncing,.     
-00014b30: 2020 2020 2020 206f 7264 6572 6564 5f73         ordered_s
-00014b40: 7472 6561 6d73 2929 0a20 2020 2020 2020  treams)).       
-00014b50: 206e 6f6e 5f63 7572 7265 6e74 6c79 5f73   non_currently_s
-00014b60: 796e 6369 6e67 5f73 7472 6561 6d73 203d  yncing_streams =
-00014b70: 206c 6973 7428 6669 6c74 6572 286c 616d   list(filter(lam
-00014b80: 6264 6120 733a 2073 5b27 7461 705f 7374  bda s: s['tap_st
-00014b90: 7265 616d 5f69 6427 5d20 213d 2063 7572  ream_id'] != cur
-00014ba0: 7265 6e74 6c79 5f73 796e 6369 6e67 2c20  rently_syncing, 
-00014bb0: 6f72 6465 7265 645f 7374 7265 616d 7329  ordered_streams)
-00014bc0: 290a 0a20 2020 2020 2020 2073 7472 6561  )..        strea
-00014bd0: 6d73 5f74 6f5f 7379 6e63 203d 2063 7572  ms_to_sync = cur
-00014be0: 7265 6e74 6c79 5f73 796e 6369 6e67 5f73  rently_syncing_s
-00014bf0: 7472 6561 6d20 2b20 6e6f 6e5f 6375 7272  tream + non_curr
-00014c00: 656e 746c 795f 7379 6e63 696e 675f 7374  ently_syncing_st
-00014c10: 7265 616d 730a 2020 2020 656c 7365 3a0a  reams.    else:.
-00014c20: 2020 2020 2020 2020 7374 7265 616d 735f          streams_
-00014c30: 746f 5f73 796e 6320 3d20 6f72 6465 7265  to_sync = ordere
-00014c40: 645f 7374 7265 616d 730a 0a20 2020 2072  d_streams..    r
-00014c50: 6574 7572 6e20 7374 7265 616d 735f 746f  eturn streams_to
-00014c60: 5f73 796e 630a 0000 0000 0000 0000 0000  _sync...........
-00014c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00014e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00014e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00014e80: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00014e90: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
-00014ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00014f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00014ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015000: 3237 206d 7469 6d65 3d31 3637 3634 3439  27 mtime=1676449
-00015010: 3233 382e 3431 3039 3433 0a00 0000 0000  238.410943......
-00015020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000150f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000151f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015200: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00015210: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
-00015220: 5f73 7472 6174 6567 6965 732f 0000 0000  _strategies/....
-00015230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015260: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
-00015270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00015280: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00015290: 3030 3000 3032 3232 3230 0020 3500 0000  000.022220. 5...
-000152a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000152f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015300: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00015310: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00015320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
-00015330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000153f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00015410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00015470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00015480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00015490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-000154a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000154f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00015510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000155f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015600: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00015610: 3136 362e 300a 0000 0000 0000 0000 0000  166.0...........
-00015620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000156f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000157f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015800: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00015810: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
-00015820: 5f73 7472 6174 6567 6965 732f 6368 616e  _strategies/chan
-00015830: 6765 5f73 7472 6561 6d73 2e70 7900 0000  ge_streams.py...
-00015840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00015870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00015880: 3030 3234 3334 3200 3030 3030 3030 3030  0024342.00000000
-00015890: 3030 3000 3032 3535 3632 0020 3000 0000  000.025562. 0...
+00013a00: 636c 6173 7320 496e 7661 6c69 6452 6570  class InvalidRep
+00013a10: 6c69 6361 7469 6f6e 4d65 7468 6f64 4578  licationMethodEx
+00013a20: 6365 7074 696f 6e28 4578 6365 7074 696f  ception(Exceptio
+00013a30: 6e29 3a0a 2020 2020 2222 2245 7863 6570  n):.    """Excep
+00013a40: 7469 6f6e 2066 6f72 2065 7272 6f72 7320  tion for errors 
+00013a50: 7265 6c61 7465 6420 746f 2072 6570 6c69  related to repli
+00013a60: 6361 7469 6f6e 206d 6574 686f 6473 2222  cation methods""
+00013a70: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+00013a80: 745f 5f28 7365 6c66 2c20 7265 706c 6963  t__(self, replic
+00013a90: 6174 696f 6e5f 6d65 7468 6f64 2c20 6d65  ation_method, me
+00013aa0: 7373 6167 653d 4e6f 6e65 293a 0a20 2020  ssage=None):.   
+00013ab0: 2020 2020 206d 7367 203d 2066 2249 6e76       msg = f"Inv
+00013ac0: 616c 6964 2072 6570 6c69 6361 7469 6f6e  alid replication
+00013ad0: 206d 6574 686f 6420 7b72 6570 6c69 6361   method {replica
+00013ae0: 7469 6f6e 5f6d 6574 686f 647d 2122 0a0a  tion_method}!"..
+00013af0: 2020 2020 2020 2020 6966 206d 6573 7361          if messa
+00013b00: 6765 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ge is not None:.
+00013b10: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
+00013b20: 3d20 6627 7b6d 7367 7d20 7b6d 6573 7361  = f'{msg} {messa
+00013b30: 6765 7d27 0a0a 2020 2020 2020 2020 7375  ge}'..        su
+00013b40: 7065 7228 292e 5f5f 696e 6974 5f5f 286d  per().__init__(m
+00013b50: 7367 290a 0a0a 636c 6173 7320 556e 7375  sg)...class Unsu
+00013b60: 7070 6f72 7465 644b 6579 5479 7065 4578  pportedKeyTypeEx
+00013b70: 6365 7074 696f 6e28 4578 6365 7074 696f  ception(Exceptio
+00013b80: 6e29 3a0a 2020 2020 2222 2252 6169 7365  n):.    """Raise
+00013b90: 6420 6966 206b 6579 2074 7970 6520 6973  d if key type is
+00013ba0: 2075 6e73 7570 706f 7274 6564 2222 220a   unsupported""".
+00013bb0: 0a63 6c61 7373 204d 6f6e 676f 4173 7365  .class MongoAsse
+00013bc0: 7274 696f 6e45 7863 6570 7469 6f6e 2845  rtionException(E
+00013bd0: 7863 6570 7469 6f6e 293a 0a20 2020 2022  xception):.    "
+00013be0: 2222 5261 6973 6564 2069 6620 4d6f 6e67  ""Raised if Mong
+00013bf0: 6f20 6578 6869 6269 7473 2069 6e63 6f72  o exhibits incor
+00013c00: 7265 6374 2062 6568 6176 696f 7222 2222  rect behavior"""
+00013c10: 0a0a 636c 6173 7320 4d6f 6e67 6f49 6e76  ..class MongoInv
+00013c20: 616c 6964 4461 7465 5469 6d65 4578 6365  alidDateTimeExce
+00013c30: 7074 696f 6e28 4578 6365 7074 696f 6e29  ption(Exception)
+00013c40: 3a0a 2020 2020 2222 2252 6169 7365 6420  :.    """Raised 
+00013c50: 6966 2077 6520 6669 6e64 2061 6e20 696e  if we find an in
+00013c60: 7661 6c69 6420 6461 7465 2d74 696d 6520  valid date-time 
+00013c70: 7468 6174 2077 6520 6361 6e27 7420 6861  that we can't ha
+00013c80: 6e64 6c65 2222 220a 0a63 6c61 7373 2053  ndle"""..class S
+00013c90: 796e 6345 7863 6570 7469 6f6e 2845 7863  yncException(Exc
+00013ca0: 6570 7469 6f6e 293a 0a20 2020 2022 2222  eption):.    """
+00013cb0: 5261 6973 6564 2069 6620 7765 2066 696e  Raised if we fin
+00013cc0: 6420 616e 2069 6e76 616c 6964 2064 6174  d an invalid dat
+00013cd0: 652d 7469 6d65 2074 6861 7420 7765 2063  e-time that we c
+00013ce0: 616e 2774 2068 616e 646c 6522 2222 0a0a  an't handle"""..
+00013cf0: 636c 6173 7320 4e6f 5265 6164 5072 6976  class NoReadPriv
+00013d00: 696c 6567 6545 7863 6570 7469 6f6e 2845  ilegeException(E
+00013d10: 7863 6570 7469 6f6e 293a 0a20 2020 2022  xception):.    "
+00013d20: 2222 5261 6973 6564 2069 6620 7468 6520  ""Raised if the 
+00013d30: 4442 2075 7365 7220 6861 7320 6e6f 2072  DB user has no r
+00013d40: 6561 6420 7072 6976 696c 6567 6520 6f6e  ead privilege on
+00013d50: 2074 6865 2044 4222 2222 0a20 2020 2064   the DB""".    d
+00013d60: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
+00013d70: 2c20 7573 6572 2c20 6462 5f6e 616d 6529  , user, db_name)
+00013d80: 3a0a 2020 2020 2020 2020 6d73 6720 3d20  :.        msg = 
+00013d90: 6622 5468 6520 7573 6572 2027 7b75 7365  f"The user '{use
+00013da0: 727d 2720 6861 7320 6e6f 2072 6561 6420  r}' has no read 
+00013db0: 7072 6976 696c 6567 6520 6f6e 2074 6865  privilege on the
+00013dc0: 2064 6174 6162 6173 6520 277b 6462 5f6e   database '{db_n
+00013dd0: 616d 657d 2721 220a 2020 2020 2020 2020  ame}'!".        
+00013de0: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
+00013df0: 286d 7367 290a 0a63 6c61 7373 2049 6e76  (msg)..class Inv
+00013e00: 616c 6964 5570 6461 7465 4275 6666 6572  alidUpdateBuffer
+00013e10: 5369 7a65 4572 726f 7228 4578 6365 7074  SizeError(Except
+00013e20: 696f 6e29 3a0a 2020 2020 2222 2252 6169  ion):.    """Rai
+00013e30: 7365 6420 6966 2074 6865 2067 6976 656e  sed if the given
+00013e40: 2075 7064 6174 6520 6275 6666 6572 2073   update buffer s
+00013e50: 697a 6520 7573 6564 2069 6e20 6c6f 675f  ize used in log_
+00013e60: 6261 7365 6420 6973 2069 6e76 616c 6964  based is invalid
+00013e70: 2222 220a 2020 2020 6465 6620 5f5f 696e  """.    def __in
+00013e80: 6974 5f5f 2873 656c 662c 2073 697a 652c  it__(self, size,
+00013e90: 2072 6561 736f 6e29 3a0a 2020 2020 2020   reason):.      
+00013ea0: 2020 6d73 6720 3d20 6622 496e 7661 6c69    msg = f"Invali
+00013eb0: 6420 7570 6461 7465 2062 7566 6665 7220  d update buffer 
+00013ec0: 7369 7a65 207b 7369 7a65 7d21 207b 7265  size {size}! {re
+00013ed0: 6173 6f6e 7d22 0a20 2020 2020 2020 2073  ason}".        s
+00013ee0: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
+00013ef0: 6d73 6729 0a0a 636c 6173 7320 496e 7661  msg)..class Inva
+00013f00: 6c69 6441 7761 6974 5469 6d65 4572 726f  lidAwaitTimeErro
+00013f10: 7228 4578 6365 7074 696f 6e29 3a0a 2020  r(Exception):.  
+00013f20: 2020 2222 2252 6169 7365 6420 6966 2074    """Raised if t
+00013f30: 6865 2067 6976 656e 2061 7761 6974 2074  he given await t
+00013f40: 696d 6520 7573 6564 2069 6e20 6c6f 675f  ime used in log_
+00013f50: 6261 7365 6420 6973 2069 6e76 616c 6964  based is invalid
+00013f60: 2222 220a 2020 2020 6465 6620 5f5f 696e  """.    def __in
+00013f70: 6974 5f5f 2873 656c 662c 2074 696d 655f  it__(self, time_
+00013f80: 6d73 2c20 7265 6173 6f6e 293a 0a20 2020  ms, reason):.   
+00013f90: 2020 2020 206d 7367 203d 2066 2249 6e76       msg = f"Inv
+00013fa0: 616c 6964 2061 7761 6974 2074 696d 6520  alid await time 
+00013fb0: 7b74 696d 655f 6d73 7d21 207b 7265 6173  {time_ms}! {reas
+00013fc0: 6f6e 7d22 0a20 2020 2020 2020 2073 7570  on}".        sup
+00013fd0: 6572 2829 2e5f 5f69 6e69 745f 5f28 6d73  er().__init__(ms
+00013fe0: 6729 0a0a 636c 6173 7320 496e 7661 6c69  g)..class Invali
+00013ff0: 644c 6f67 4261 7365 6446 756c 6c4c 6f61  dLogBasedFullLoa
+00014000: 644f 6e45 6d70 7479 5374 6174 6528 4578  dOnEmptyState(Ex
+00014010: 6365 7074 696f 6e29 3a0a 2020 2020 2222  ception):.    ""
+00014020: 2252 6169 7365 6420 6966 2074 6865 2067  "Raised if the g
+00014030: 6976 656e 206c 6f67 2062 6173 6564 2066  iven log based f
+00014040: 756c 6c20 6c6f 6164 206f 6e20 656d 7074  ull load on empt
+00014050: 7920 7374 6174 6520 696e 206c 6f67 5f62  y state in log_b
+00014060: 6173 6564 2069 6e76 616c 6964 2222 220a  ased invalid""".
+00014070: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+00014080: 2873 656c 662c 2066 756c 6c5f 6c6f 6164  (self, full_load
+00014090: 5f6f 6e5f 656d 7074 795f 7374 6174 652c  _on_empty_state,
+000140a0: 2072 6561 736f 6e29 202d 3e20 4e6f 6e65   reason) -> None
+000140b0: 3a0a 2020 2020 2020 2020 6d73 6720 3d20  :.        msg = 
+000140c0: 6622 496e 7661 6c69 6420 6675 6c6c 206c  f"Invalid full l
+000140d0: 6f61 6420 6f6e 2065 6d70 7479 2073 7461  oad on empty sta
+000140e0: 7465 2061 7267 207b 6675 6c6c 5f6c 6f61  te arg {full_loa
+000140f0: 645f 6f6e 5f65 6d70 7479 5f73 7461 7465  d_on_empty_state
+00014100: 7d21 207b 7265 6173 6f6e 7d22 0a20 2020  }! {reason}".   
+00014110: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+00014120: 6e69 745f 5f28 6d73 6729 0000 0000 0000  nit__(msg)......
+00014130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000141f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00014210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00014270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00014280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00014290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+000142a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000142f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00014310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000143f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014400: 3232 206d 7469 6d65 3d31 3637 3634 3530  22 mtime=1676450
+00014410: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
+00014420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000144f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000145f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014600: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00014610: 2f64 7a5f 6d6f 6e67 6f64 622f 7374 7265  /dz_mongodb/stre
+00014620: 616d 5f75 7469 6c73 2e70 7900 0000 0000  am_utils.py.....
+00014630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00014670: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00014680: 3030 3130 3134 3600 3030 3030 3030 3030  0010146.00000000
+00014690: 3030 3000 3032 3231 3032 0020 3000 0000  000.022102. 0...
+000146a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000146f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014700: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00014710: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00014720: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00014730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000147f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00014800: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
+00014810: 7974 686f 6e33 0a22 2222 0a4c 6973 7420  ython3.""".List 
+00014820: 6f66 2068 656c 7065 7220 6675 6e63 7469  of helper functi
+00014830: 6f6e 7320 666f 7220 7374 7265 616d 7320  ons for streams 
+00014840: 6f6e 6c79 0a22 2222 0a0a 6672 6f6d 2074  only."""..from t
+00014850: 7970 696e 6720 696d 706f 7274 2044 6963  yping import Dic
+00014860: 742c 204f 7074 696f 6e61 6c2c 204c 6973  t, Optional, Lis
+00014870: 742c 2054 7570 6c65 0a0a 696d 706f 7274  t, Tuple..import
+00014880: 2073 696e 6765 720a 6672 6f6d 2073 696e   singer.from sin
+00014890: 6765 7220 696d 706f 7274 206d 6574 6164  ger import metad
+000148a0: 6174 612c 2077 7269 7465 5f6d 6573 7361  ata, write_messa
+000148b0: 6765 2c20 5363 6865 6d61 4d65 7373 6167  ge, SchemaMessag
+000148c0: 650a 0a66 726f 6d20 647a 5f6d 6f6e 676f  e..from dz_mongo
+000148d0: 6462 2e73 796e 635f 7374 7261 7465 6769  db.sync_strategi
+000148e0: 6573 2e63 6f6d 6d6f 6e20 696d 706f 7274  es.common import
+000148f0: 2063 616c 6375 6c61 7465 5f64 6573 7469   calculate_desti
+00014900: 6e61 7469 6f6e 5f73 7472 6561 6d5f 6e61  nation_stream_na
+00014910: 6d65 0a0a 0a64 6566 2067 6574 5f72 6570  me...def get_rep
+00014920: 6c69 6361 7469 6f6e 5f6d 6574 686f 645f  lication_method_
+00014930: 6672 6f6d 5f73 7472 6561 6d28 7374 7265  from_stream(stre
+00014940: 616d 3a20 4469 6374 2920 2d3e 204f 7074  am: Dict) -> Opt
+00014950: 696f 6e61 6c5b 7374 725d 3a0a 2020 2020  ional[str]:.    
+00014960: 2222 220a 2020 2020 5365 6172 6368 2066  """.    Search f
+00014970: 6f72 2074 6865 2073 7472 6561 6d20 7265  or the stream re
+00014980: 706c 6963 6174 696f 6e20 6d65 7468 6f64  plication method
+00014990: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+000149a0: 2020 2073 7472 6561 6d3a 2073 7472 6561     stream: strea
+000149b0: 6d20 6469 6374 696f 6e61 7279 0a0a 2020  m dictionary..  
+000149c0: 2020 5265 7475 726e 733a 2072 6570 6c69    Returns: repli
+000149d0: 6361 7469 6f6e 206d 6574 686f 6420 6966  cation method if
+000149e0: 2064 6566 696e 6564 2c20 4e6f 6e65 206f   defined, None o
+000149f0: 7468 6572 7769 7365 0a0a 2020 2020 2222  therwise..    ""
+00014a00: 220a 2020 2020 6d64 5f6d 6170 203d 206d  ".    md_map = m
+00014a10: 6574 6164 6174 612e 746f 5f6d 6170 2873  etadata.to_map(s
+00014a20: 7472 6561 6d5b 276d 6574 6164 6174 6127  tream['metadata'
+00014a30: 5d29 0a20 2020 2072 6574 7572 6e20 6d65  ]).    return me
+00014a40: 7461 6461 7461 2e67 6574 286d 645f 6d61  tadata.get(md_ma
+00014a50: 702c 2028 292c 2027 7265 706c 6963 6174  p, (), 'replicat
+00014a60: 696f 6e2d 6d65 7468 6f64 2729 0a0a 0a64  ion-method')...d
+00014a70: 6566 2069 735f 6c6f 675f 6261 7365 645f  ef is_log_based_
+00014a80: 7374 7265 616d 2873 7472 6561 6d3a 2044  stream(stream: D
+00014a90: 6963 7429 202d 3e20 626f 6f6c 3a0a 2020  ict) -> bool:.  
+00014aa0: 2020 2222 220a 2020 2020 6368 6563 6b73    """.    checks
+00014ab0: 2069 6620 7374 7265 616d 2075 7365 7320   if stream uses 
+00014ac0: 6c6f 6720 6261 7365 6420 7265 706c 6963  log based replic
+00014ad0: 6174 696f 6e20 6d65 7468 6f64 0a20 2020  ation method.   
+00014ae0: 2052 6574 7572 6e73 3a20 5472 7565 2069   Returns: True i
+00014af0: 6620 4c4f 475f 4241 5345 442c 2046 616c  f LOG_BASED, Fal
+00014b00: 7365 206f 7468 6572 7769 7365 0a20 2020  se otherwise.   
+00014b10: 2022 2222 0a20 2020 2072 6574 7572 6e20   """.    return 
+00014b20: 6765 745f 7265 706c 6963 6174 696f 6e5f  get_replication_
+00014b30: 6d65 7468 6f64 5f66 726f 6d5f 7374 7265  method_from_stre
+00014b40: 616d 2873 7472 6561 6d29 203d 3d20 274c  am(stream) == 'L
+00014b50: 4f47 5f42 4153 4544 270a 0a0a 6465 6620  OG_BASED'...def 
+00014b60: 7772 6974 655f 7363 6865 6d61 5f6d 6573  write_schema_mes
+00014b70: 7361 6765 2873 7472 6561 6d3a 2044 6963  sage(stream: Dic
+00014b80: 7429 3a0a 2020 2020 2222 220a 2020 2020  t):.    """.    
+00014b90: 4372 6561 7465 7320 616e 6420 7772 6974  Creates and writ
+00014ba0: 6573 2061 2073 7472 6561 6d20 7363 6865  es a stream sche
+00014bb0: 6d61 206d 6573 7361 6765 2074 6f20 7374  ma message to st
+00014bc0: 646f 7574 0a20 2020 2041 7267 733a 0a20  dout.    Args:. 
+00014bd0: 2020 2020 2020 2073 7472 6561 6d3a 2073         stream: s
+00014be0: 7472 6561 6d20 6361 7461 6c6f 670a 2020  tream catalog.  
+00014bf0: 2020 2222 220a 2020 2020 7772 6974 655f    """.    write_
+00014c00: 6d65 7373 6167 6528 5363 6865 6d61 4d65  message(SchemaMe
+00014c10: 7373 6167 6528 0a20 2020 2020 2020 2073  ssage(.        s
+00014c20: 7472 6561 6d3d 6361 6c63 756c 6174 655f  tream=calculate_
+00014c30: 6465 7374 696e 6174 696f 6e5f 7374 7265  destination_stre
+00014c40: 616d 5f6e 616d 6528 7374 7265 616d 292c  am_name(stream),
+00014c50: 0a20 2020 2020 2020 2073 6368 656d 613d  .        schema=
+00014c60: 7374 7265 616d 5b27 7363 6865 6d61 275d  stream['schema']
+00014c70: 2c0a 2020 2020 2020 2020 6b65 795f 7072  ,.        key_pr
+00014c80: 6f70 6572 7469 6573 3d5b 275f 6964 275d  operties=['_id']
+00014c90: 2929 0a0a 0a64 6566 2069 735f 7374 7265  ))...def is_stre
+00014ca0: 616d 5f73 656c 6563 7465 6428 7374 7265  am_selected(stre
+00014cb0: 616d 3a20 4469 6374 2920 2d3e 2062 6f6f  am: Dict) -> boo
+00014cc0: 6c3a 0a20 2020 2022 2222 0a20 2020 2043  l:.    """.    C
+00014cd0: 6865 636b 7320 7468 6520 7374 7265 616d  hecks the stream
+00014ce0: 2773 206d 6574 6164 6174 6120 746f 2073  's metadata to s
+00014cf0: 6565 2069 6620 7374 7265 616d 2069 7320  ee if stream is 
+00014d00: 7365 6c65 6374 6564 2066 6f72 2073 796e  selected for syn
+00014d10: 630a 2020 2020 4172 6773 3a0a 2020 2020  c.    Args:.    
+00014d20: 2020 2020 7374 7265 616d 3a20 7374 7265      stream: stre
+00014d30: 616d 2064 6963 7469 6f6e 6172 790a 0a20  am dictionary.. 
+00014d40: 2020 2052 6574 7572 6e73 3a20 5472 7565     Returns: True
+00014d50: 2069 6620 7365 6c65 6374 6564 2c20 4661   if selected, Fa
+00014d60: 6c73 6520 6f74 6865 7277 6973 650a 0a20  lse otherwise.. 
+00014d70: 2020 2022 2222 0a20 2020 206d 6461 7461     """.    mdata
+00014d80: 203d 206d 6574 6164 6174 612e 746f 5f6d   = metadata.to_m
+00014d90: 6170 2873 7472 6561 6d5b 276d 6574 6164  ap(stream['metad
+00014da0: 6174 6127 5d29 0a20 2020 2069 735f 7365  ata']).    is_se
+00014db0: 6c65 6374 6564 203d 206d 6574 6164 6174  lected = metadat
+00014dc0: 612e 6765 7428 6d64 6174 612c 2028 292c  a.get(mdata, (),
+00014dd0: 2027 7365 6c65 6374 6564 2729 0a0a 2020   'selected')..  
+00014de0: 2020 7265 7475 726e 2069 735f 7365 6c65    return is_sele
+00014df0: 6374 6564 2069 7320 5472 7565 0a0a 0a64  cted is True...d
+00014e00: 6566 2073 7472 6561 6d73 5f6c 6973 745f  ef streams_list_
+00014e10: 746f 5f64 6963 7428 7374 7265 616d 733a  to_dict(streams:
+00014e20: 204c 6973 745b 4469 6374 5d29 202d 3e20   List[Dict]) -> 
+00014e30: 4469 6374 5b73 7472 2c20 4469 6374 5d3a  Dict[str, Dict]:
+00014e40: 0a20 2020 2022 2222 0a20 2020 2063 6f6e  .    """.    con
+00014e50: 7665 7274 7320 7468 6520 7374 7265 616d  verts the stream
+00014e60: 7320 6c69 7374 2074 6f20 6469 6374 696f  s list to dictio
+00014e70: 6e61 7279 206f 6620 7374 7265 616d 7320  nary of streams 
+00014e80: 7768 6572 6520 7468 6520 6b65 7973 2061  where the keys a
+00014e90: 7265 2074 6865 2074 6170 2073 7472 6561  re the tap strea
+00014ea0: 6d20 6964 730a 2020 2020 4172 6773 3a0a  m ids.    Args:.
+00014eb0: 2020 2020 2020 2020 7374 7265 616d 733a          streams:
+00014ec0: 2073 7472 6561 6d20 6c69 7374 0a0a 2020   stream list..  
+00014ed0: 2020 5265 7475 726e 733a 2064 6963 7469    Returns: dicti
+00014ee0: 6f6e 6172 7920 6f64 2073 7472 6561 6d73  onary od streams
+00014ef0: 0a0a 2020 2020 2222 220a 2020 2020 7265  ..    """.    re
+00014f00: 7475 726e 207b 7374 7265 616d 5b27 7461  turn {stream['ta
+00014f10: 705f 7374 7265 616d 5f69 6427 5d3a 2073  p_stream_id']: s
+00014f20: 7472 6561 6d20 666f 7220 7374 7265 616d  tream for stream
+00014f30: 2069 6e20 7374 7265 616d 737d 0a0a 0a64   in streams}...d
+00014f40: 6566 2066 696c 7465 725f 7374 7265 616d  ef filter_stream
+00014f50: 735f 6279 5f72 6570 6c69 6361 7469 6f6e  s_by_replication
+00014f60: 5f6d 6574 686f 6428 7374 7265 616d 735f  _method(streams_
+00014f70: 746f 5f73 796e 633a 204c 6973 745b 4469  to_sync: List[Di
+00014f80: 6374 5d29 202d 3e20 5475 706c 655b 4c69  ct]) -> Tuple[Li
+00014f90: 7374 5b44 6963 745d 2c20 4c69 7374 5b44  st[Dict], List[D
+00014fa0: 6963 745d 5d3a 0a20 2020 2022 2222 0a20  ict]]:.    """. 
+00014fb0: 2020 2044 6976 6964 6573 2074 6865 206c     Divides the l
+00014fc0: 6973 7420 6f66 2073 7472 6561 6d73 2069  ist of streams i
+00014fd0: 6e74 6f20 7477 6f20 6c69 7374 733a 206f  nto two lists: o
+00014fe0: 6e65 206f 6620 7374 7265 616d 7320 7468  ne of streams th
+00014ff0: 6174 2075 7365 206c 6f67 2062 6173 6564  at use log based
+00015000: 2061 6e64 2074 6865 206f 7468 6572 2074   and the other t
+00015010: 6861 7420 7573 650a 2020 2020 7472 6164  hat use.    trad
+00015020: 6974 696f 6e61 6c20 7265 706c 6963 6174  itional replicat
+00015030: 696f 6e20 6d65 7468 6f64 2c20 692e 6520  ion method, i.e 
+00015040: 6569 7468 6572 2046 756c 6c20 7461 626c  either Full tabl
+00015050: 6520 6f72 2049 6e63 7265 6d65 6e74 616c  e or Incremental
+00015060: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+00015070: 2020 2073 7472 6561 6d73 5f74 6f5f 7379     streams_to_sy
+00015080: 6e63 3a20 4c69 7374 206f 6620 7374 7265  nc: List of stre
+00015090: 616d 7320 7365 6c65 6374 6564 2074 6f20  ams selected to 
+000150a0: 7379 6e63 0a20 2020 2052 6574 7572 6e73  sync.    Returns
+000150b0: 3a20 5475 706c 6520 6f66 2074 776f 206c  : Tuple of two l
+000150c0: 6973 7473 2c20 6669 7273 7420 6973 206c  ists, first is l
+000150d0: 6f67 2062 6173 6564 2073 7472 6561 6d73  og based streams
+000150e0: 2061 6e64 2074 6865 2073 6563 6f6e 6420   and the second 
+000150f0: 6973 206c 6973 7420 6f66 2074 7261 6469  is list of tradi
+00015100: 7469 6f6e 616c 2073 7472 6561 6d73 0a0a  tional streams..
+00015110: 2020 2020 2222 220a 2020 2020 6c6f 675f      """.    log_
+00015120: 6261 7365 645f 7374 7265 616d 7320 3d20  based_streams = 
+00015130: 5b5d 0a20 2020 206e 6f6e 5f6c 6f67 5f62  [].    non_log_b
+00015140: 6173 6564 5f73 7472 6561 6d73 203d 205b  ased_streams = [
+00015150: 5d0a 0a20 2020 2066 6f72 2073 7472 6561  ]..    for strea
+00015160: 6d20 696e 2073 7472 6561 6d73 5f74 6f5f  m in streams_to_
+00015170: 7379 6e63 3a0a 2020 2020 2020 2020 6966  sync:.        if
+00015180: 2069 735f 6c6f 675f 6261 7365 645f 7374   is_log_based_st
+00015190: 7265 616d 2873 7472 6561 6d29 3a0a 2020  ream(stream):.  
+000151a0: 2020 2020 2020 2020 2020 6c6f 675f 6261            log_ba
+000151b0: 7365 645f 7374 7265 616d 732e 6170 7065  sed_streams.appe
+000151c0: 6e64 2873 7472 6561 6d29 0a20 2020 2020  nd(stream).     
+000151d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000151e0: 2020 2020 206e 6f6e 5f6c 6f67 5f62 6173       non_log_bas
+000151f0: 6564 5f73 7472 6561 6d73 2e61 7070 656e  ed_streams.appen
+00015200: 6428 7374 7265 616d 290a 0a20 2020 2072  d(stream)..    r
+00015210: 6574 7572 6e20 6c6f 675f 6261 7365 645f  eturn log_based_
+00015220: 7374 7265 616d 732c 206e 6f6e 5f6c 6f67  streams, non_log
+00015230: 5f62 6173 6564 5f73 7472 6561 6d73 0a0a  _based_streams..
+00015240: 0a64 6566 2067 6574 5f73 7472 6561 6d73  .def get_streams
+00015250: 5f74 6f5f 7379 6e63 2873 7472 6561 6d73  _to_sync(streams
+00015260: 3a20 4c69 7374 5b44 6963 745d 2c20 7374  : List[Dict], st
+00015270: 6174 653a 2044 6963 7429 202d 3e20 4c69  ate: Dict) -> Li
+00015280: 7374 3a0a 2020 2020 2222 220a 2020 2020  st:.    """.    
+00015290: 4669 6c74 6572 2074 6865 2073 7472 6561  Filter the strea
+000152a0: 6d73 206c 6973 7420 746f 2072 6574 7572  ms list to retur
+000152b0: 6e20 6f6e 6c79 2074 686f 7365 2073 656c  n only those sel
+000152c0: 6563 7465 6420 666f 7220 7379 6e63 0a20  ected for sync. 
+000152d0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+000152e0: 2073 7472 6561 6d73 3a20 6c69 7374 206f   streams: list o
+000152f0: 6620 616c 6c20 6469 7363 6f76 6572 6564  f all discovered
+00015300: 2073 7472 6561 6d73 0a20 2020 2020 2020   streams.       
+00015310: 2073 7461 7465 3a20 7374 7265 616d 7320   state: streams 
+00015320: 7374 6174 650a 0a20 2020 2052 6574 7572  state..    Retur
+00015330: 6e73 3a20 6c69 7374 206f 6620 7365 6c65  ns: list of sele
+00015340: 6374 6564 2073 7472 6561 6d73 2c20 6f72  cted streams, or
+00015350: 6465 7265 6420 6672 6f6d 2073 7472 6561  dered from strea
+00015360: 6d73 2077 6974 686f 7574 2073 7461 7465  ms without state
+00015370: 2074 6f20 7468 6f73 6520 7769 7468 2073   to those with s
+00015380: 7461 7465 0a0a 2020 2020 2222 220a 2020  tate..    """.  
+00015390: 2020 2320 6765 7420 7365 6c65 6374 6564    # get selected
+000153a0: 2073 7472 6561 6d73 0a20 2020 2073 656c   streams.    sel
+000153b0: 6563 7465 645f 7374 7265 616d 7320 3d20  ected_streams = 
+000153c0: 5b73 7472 6561 6d20 666f 7220 7374 7265  [stream for stre
+000153d0: 616d 2069 6e20 7374 7265 616d 7320 6966  am in streams if
+000153e0: 2069 735f 7374 7265 616d 5f73 656c 6563   is_stream_selec
+000153f0: 7465 6428 7374 7265 616d 295d 0a0a 2020  ted(stream)]..  
+00015400: 2020 2320 7072 696f 7269 7469 7a65 2073    # prioritize s
+00015410: 7472 6561 6d73 2074 6861 7420 6861 7665  treams that have
+00015420: 206e 6f74 2062 6565 6e20 7072 6f63 6573   not been proces
+00015430: 7365 640a 2020 2020 7374 7265 616d 735f  sed.    streams_
+00015440: 7769 7468 5f73 7461 7465 203d 205b 5d0a  with_state = [].
+00015450: 2020 2020 7374 7265 616d 735f 7769 7468      streams_with
+00015460: 6f75 745f 7374 6174 6520 3d20 5b5d 0a0a  out_state = []..
+00015470: 2020 2020 666f 7220 7374 7265 616d 2069      for stream i
+00015480: 6e20 7365 6c65 6374 6564 5f73 7472 6561  n selected_strea
+00015490: 6d73 3a0a 2020 2020 2020 2020 6966 2073  ms:.        if s
+000154a0: 7461 7465 2e67 6574 2827 626f 6f6b 6d61  tate.get('bookma
+000154b0: 726b 7327 2c20 7b7d 292e 6765 7428 7374  rks', {}).get(st
+000154c0: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
+000154d0: 5f69 6427 5d29 3a0a 2020 2020 2020 2020  _id']):.        
+000154e0: 2020 2020 7374 7265 616d 735f 7769 7468      streams_with
+000154f0: 5f73 7461 7465 2e61 7070 656e 6428 7374  _state.append(st
+00015500: 7265 616d 290a 2020 2020 2020 2020 656c  ream).        el
+00015510: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00015520: 7374 7265 616d 735f 7769 7468 6f75 745f  streams_without_
+00015530: 7374 6174 652e 6170 7065 6e64 2873 7472  state.append(str
+00015540: 6561 6d29 0a0a 2020 2020 6f72 6465 7265  eam)..    ordere
+00015550: 645f 7374 7265 616d 7320 3d20 7374 7265  d_streams = stre
+00015560: 616d 735f 7769 7468 6f75 745f 7374 6174  ams_without_stat
+00015570: 6520 2b20 7374 7265 616d 735f 7769 7468  e + streams_with
+00015580: 5f73 7461 7465 0a0a 2020 2020 2320 4966  _state..    # If
+00015590: 2074 6865 2073 7461 7465 2073 6179 7320   the state says 
+000155a0: 7765 2077 6572 6520 696e 2074 6865 206d  we were in the m
+000155b0: 6964 646c 6520 6f66 2070 726f 6365 7373  iddle of process
+000155c0: 696e 6720 6120 7374 7265 616d 2c20 736b  ing a stream, sk
+000155d0: 6970 0a20 2020 2023 2074 6f20 7468 6174  ip.    # to that
+000155e0: 2073 7472 6561 6d2e 2054 6865 6e20 7072   stream. Then pr
+000155f0: 6f63 6573 7320 7374 7265 616d 7320 7769  ocess streams wi
+00015600: 7468 6f75 7420 7072 696f 7220 7374 6174  thout prior stat
+00015610: 6520 616e 6420 6669 6e61 6c6c 790a 2020  e and finally.  
+00015620: 2020 2320 6d6f 7665 206f 6e74 6f20 7374    # move onto st
+00015630: 7265 616d 7320 7769 7468 2073 7461 7465  reams with state
+00015640: 2028 692e 652e 2068 6176 6520 6265 656e   (i.e. have been
+00015650: 2073 796e 6365 6420 696e 2074 6865 2070   synced in the p
+00015660: 6173 7429 0a20 2020 2063 7572 7265 6e74  ast).    current
+00015670: 6c79 5f73 796e 6369 6e67 203d 2073 696e  ly_syncing = sin
+00015680: 6765 722e 6765 745f 6375 7272 656e 746c  ger.get_currentl
+00015690: 795f 7379 6e63 696e 6728 7374 6174 6529  y_syncing(state)
+000156a0: 0a0a 2020 2020 6966 2063 7572 7265 6e74  ..    if current
+000156b0: 6c79 5f73 796e 6369 6e67 3a0a 2020 2020  ly_syncing:.    
+000156c0: 2020 2020 6375 7272 656e 746c 795f 7379      currently_sy
+000156d0: 6e63 696e 675f 7374 7265 616d 203d 206c  ncing_stream = l
+000156e0: 6973 7428 6669 6c74 6572 280a 2020 2020  ist(filter(.    
+000156f0: 2020 2020 2020 2020 6c61 6d62 6461 2073          lambda s
+00015700: 3a20 735b 2774 6170 5f73 7472 6561 6d5f  : s['tap_stream_
+00015710: 6964 275d 203d 3d20 6375 7272 656e 746c  id'] == currentl
+00015720: 795f 7379 6e63 696e 672c 0a20 2020 2020  y_syncing,.     
+00015730: 2020 2020 2020 206f 7264 6572 6564 5f73         ordered_s
+00015740: 7472 6561 6d73 2929 0a20 2020 2020 2020  treams)).       
+00015750: 206e 6f6e 5f63 7572 7265 6e74 6c79 5f73   non_currently_s
+00015760: 796e 6369 6e67 5f73 7472 6561 6d73 203d  yncing_streams =
+00015770: 206c 6973 7428 6669 6c74 6572 286c 616d   list(filter(lam
+00015780: 6264 6120 733a 2073 5b27 7461 705f 7374  bda s: s['tap_st
+00015790: 7265 616d 5f69 6427 5d20 213d 2063 7572  ream_id'] != cur
+000157a0: 7265 6e74 6c79 5f73 796e 6369 6e67 2c20  rently_syncing, 
+000157b0: 6f72 6465 7265 645f 7374 7265 616d 7329  ordered_streams)
+000157c0: 290a 0a20 2020 2020 2020 2073 7472 6561  )..        strea
+000157d0: 6d73 5f74 6f5f 7379 6e63 203d 2063 7572  ms_to_sync = cur
+000157e0: 7265 6e74 6c79 5f73 796e 6369 6e67 5f73  rently_syncing_s
+000157f0: 7472 6561 6d20 2b20 6e6f 6e5f 6375 7272  tream + non_curr
+00015800: 656e 746c 795f 7379 6e63 696e 675f 7374  ently_syncing_st
+00015810: 7265 616d 730a 2020 2020 656c 7365 3a0a  reams.    else:.
+00015820: 2020 2020 2020 2020 7374 7265 616d 735f          streams_
+00015830: 746f 5f73 796e 6320 3d20 6f72 6465 7265  to_sync = ordere
+00015840: 645f 7374 7265 616d 730a 0a20 2020 2072  d_streams..    r
+00015850: 6574 7572 6e20 7374 7265 616d 735f 746f  eturn streams_to
+00015860: 5f73 796e 630a 0000 0000 0000 0000 0000  _sync...........
+00015870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000158f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015900: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00015910: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00015920: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00015900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00015990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000159f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00015a00: 696d 706f 7274 2063 6f70 790a 696d 706f  import copy.impo
-00015a10: 7274 2074 696d 650a 696d 706f 7274 2073  rt time.import s
-00015a20: 696e 6765 720a 696d 706f 7274 2070 796d  inger.import pym
-00015a30: 6f6e 676f 0a0a 6672 6f6d 2074 7970 696e  ongo..from typin
-00015a40: 6720 696d 706f 7274 2053 6574 2c20 4469  g import Set, Di
-00015a50: 6374 2c20 4f70 7469 6f6e 616c 2c20 4765  ct, Optional, Ge
-00015a60: 6e65 7261 746f 720a 6672 6f6d 2070 796d  nerator.from pym
-00015a70: 6f6e 676f 2e63 6f6c 6c65 6374 696f 6e20  ongo.collection 
-00015a80: 696d 706f 7274 2043 6f6c 6c65 6374 696f  import Collectio
-00015a90: 6e0a 6672 6f6d 2070 796d 6f6e 676f 2e64  n.from pymongo.d
-00015aa0: 6174 6162 6173 6520 696d 706f 7274 2044  atabase import D
-00015ab0: 6174 6162 6173 650a 6672 6f6d 2073 696e  atabase.from sin
-00015ac0: 6765 7220 696d 706f 7274 2075 7469 6c73  ger import utils
-00015ad0: 0a0a 6672 6f6d 2064 7a5f 6d6f 6e67 6f64  ..from dz_mongod
-00015ae0: 622e 7379 6e63 5f73 7472 6174 6567 6965  b.sync_strategie
-00015af0: 7320 696d 706f 7274 2063 6f6d 6d6f 6e0a  s import common.
-00015b00: 0a4c 4f47 4745 5220 3d20 7369 6e67 6572  .LOGGER = singer
-00015b10: 2e67 6574 5f6c 6f67 6765 7228 2764 7a5f  .get_logger('dz_
-00015b20: 6d6f 6e67 6f64 6227 290a 0a52 4553 554d  mongodb')..RESUM
-00015b30: 455f 544f 4b45 4e5f 4b45 5920 3d20 2774  E_TOKEN_KEY = 't
-00015b40: 6f6b 656e 270a 4445 4641 554c 545f 4157  oken'.DEFAULT_AW
-00015b50: 4149 545f 5449 4d45 5f4d 5320 3d20 3130  AIT_TIME_MS = 10
-00015b60: 3030 2020 2320 7468 6520 7365 7276 6572  00  # the server
-00015b70: 2064 6566 6175 6c74 2068 7474 7073 3a2f   default https:/
-00015b80: 2f64 6f63 732e 6d6f 6e67 6f64 622e 636f  /docs.mongodb.co
-00015b90: 6d2f 6d61 6e75 616c 2f72 6566 6572 656e  m/manual/referen
-00015ba0: 6365 2f6d 6574 686f 642f 6462 2e77 6174  ce/method/db.wat
-00015bb0: 6368 2f23 6462 2e77 6174 6368 0a4d 494e  ch/#db.watch.MIN
-00015bc0: 5f55 5044 4154 455f 4255 4646 4552 5f4c  _UPDATE_BUFFER_L
-00015bd0: 454e 4754 4820 3d20 3120 2320 6465 6661  ENGTH = 1 # defa
-00015be0: 756c 740a 4d41 585f 5550 4441 5445 5f42  ult.MAX_UPDATE_B
-00015bf0: 5546 4645 525f 4c45 4e47 5448 203d 2063  UFFER_LENGTH = c
-00015c00: 6f6d 6d6f 6e2e 5550 4441 5445 5f42 4f4f  ommon.UPDATE_BOO
-00015c10: 4b4d 4152 4b5f 5045 5249 4f44 2023 2073  KMARK_PERIOD # s
-00015c20: 6574 206d 6178 2061 7320 7468 6520 7361  et max as the sa
-00015c30: 6d65 2076 616c 7565 2061 7320 626f 6f6b  me value as book
-00015c40: 6d61 726b 2070 6572 696f 6420 6173 2077  mark period as w
-00015c50: 6520 666c 7573 680a 2320 7468 6520 6275  e flush.# the bu
-00015c60: 6666 6572 2061 6e79 7761 7920 6166 7465  ffer anyway afte
-00015c70: 7220 6576 6572 7920 5550 4441 5445 5f42  r every UPDATE_B
-00015c80: 4f4f 4b4d 4152 4b5f 5045 5249 4f44 0a0a  OOKMARK_PERIOD..
-00015c90: 0a64 6566 2075 7064 6174 655f 626f 6f6b  .def update_book
-00015ca0: 6d61 726b 7328 7374 6174 653a 2044 6963  marks(state: Dic
-00015cb0: 742c 2074 6170 5f73 7472 6561 6d5f 6964  t, tap_stream_id
-00015cc0: 733a 2053 6574 5b73 7472 5d2c 2074 6f6b  s: Set[str], tok
-00015cd0: 656e 3a20 4469 6374 2920 2d3e 2044 6963  en: Dict) -> Dic
-00015ce0: 743a 0a20 2020 2022 2222 0a20 2020 2055  t:.    """.    U
-00015cf0: 7064 6174 6573 2074 6865 2073 7472 6561  pdates the strea
-00015d00: 6d20 7374 6174 6520 6279 2072 652d 7365  m state by re-se
-00015d10: 7474 696e 6720 7468 6520 6368 616e 6765  tting the change
-00015d20: 5374 7265 616d 2074 6f6b 656e 0a20 2020  Stream token.   
-00015d30: 2041 7267 733a 0a20 2020 2020 2020 2073   Args:.        s
-00015d40: 7461 7465 3a20 5374 6174 6520 6469 6374  tate: State dict
-00015d50: 696f 6e61 7279 0a20 2020 2020 2020 2074  ionary.        t
-00015d60: 6170 5f73 7472 6561 6d5f 6964 733a 2073  ap_stream_ids: s
-00015d70: 6574 206f 6620 7374 7265 616d 7327 2049  et of streams' I
-00015d80: 440a 2020 2020 2020 2020 746f 6b65 6e3a  D.        token:
-00015d90: 2072 6573 756d 6520 746f 6b65 6e20 6672   resume token fr
-00015da0: 6f6d 2063 6861 6e67 6553 7472 6561 6d0a  om changeStream.
-00015db0: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
-00015dc0: 2020 2020 2020 7374 6174 653a 2075 7064        state: upd
-00015dd0: 6174 6564 2073 7461 7465 0a20 2020 2022  ated state.    "
-00015de0: 2222 0a20 2020 2066 6f72 2073 7472 6561  "".    for strea
-00015df0: 6d20 696e 2074 6170 5f73 7472 6561 6d5f  m in tap_stream_
-00015e00: 6964 733a 0a20 2020 2020 2020 2073 7461  ids:.        sta
-00015e10: 7465 203d 2073 696e 6765 722e 7772 6974  te = singer.writ
-00015e20: 655f 626f 6f6b 6d61 726b 2873 7461 7465  e_bookmark(state
-00015e30: 2c20 7374 7265 616d 2c20 5245 5355 4d45  , stream, RESUME
-00015e40: 5f54 4f4b 454e 5f4b 4559 2c20 746f 6b65  _TOKEN_KEY, toke
-00015e50: 6e29 0a0a 2020 2020 7265 7475 726e 2073  n)..    return s
-00015e60: 7461 7465 0a0a 0a64 6566 2067 6574 5f62  tate...def get_b
-00015e70: 7566 6665 725f 726f 7773 5f66 726f 6d5f  uffer_rows_from_
-00015e80: 6462 2863 6f6c 6c65 6374 696f 6e3a 2043  db(collection: C
-00015e90: 6f6c 6c65 6374 696f 6e2c 0a20 2020 2020  ollection,.     
-00015ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015eb0: 2020 2020 2020 2075 7064 6174 655f 6275         update_bu
-00015ec0: 6666 6572 3a20 5365 742c 0a20 2020 2020  ffer: Set,.     
-00015ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ee0: 2020 2020 2020 2029 202d 3e20 4765 6e65         ) -> Gene
-00015ef0: 7261 746f 723a 0a20 2020 2022 2222 0a20  rator:.    """. 
-00015f00: 2020 2046 6574 6368 6573 2074 6865 2066     Fetches the f
-00015f10: 756c 6c20 646f 6375 6d65 6e74 7320 6f66  ull documents of
-00015f20: 2074 6865 2049 4473 2069 6e20 7468 6520   the IDs in the 
-00015f30: 6275 6666 6572 2066 726f 6d20 7468 6520  buffer from the 
-00015f40: 4442 0a20 2020 2041 7267 733a 0a20 2020  DB.    Args:.   
-00015f50: 2020 2020 2063 6f6c 6c65 6374 696f 6e3a       collection:
-00015f60: 204d 6f6e 676f 4442 2043 6f6c 6c65 6374   MongoDB Collect
-00015f70: 696f 6e20 696e 7374 616e 6365 0a20 2020  ion instance.   
-00015f80: 2020 2020 2075 7064 6174 655f 6275 6666       update_buff
-00015f90: 6572 3a20 4120 7365 7420 6f66 2049 4473  er: A set of IDs
-00015fa0: 2077 686f 7365 2064 6f63 756d 656e 7473   whose documents
-00015fb0: 206e 6565 6473 2074 6f20 6265 2066 6574   needs to be fet
-00015fc0: 6368 6564 0a20 2020 2052 6574 7572 6e73  ched.    Returns
-00015fd0: 3a0a 2020 2020 2020 2020 6765 6e65 7261  :.        genera
-00015fe0: 746f 723a 2069 7420 6361 6e20 6265 2065  tor: it can be e
-00015ff0: 6d70 7479 0a20 2020 2022 2222 0a20 2020  mpty.    """.   
-00016000: 2071 7565 7279 203d 207b 275f 6964 273a   query = {'_id':
-00016010: 207b 2724 696e 273a 206c 6973 7428 7570   {'$in': list(up
-00016020: 6461 7465 5f62 7566 6665 7229 7d7d 0a0a  date_buffer)}}..
-00016030: 2020 2020 7769 7468 2063 6f6c 6c65 6374      with collect
-00016040: 696f 6e2e 6669 6e64 2871 7565 7279 2920  ion.find(query) 
-00016050: 6173 2063 7572 736f 723a 0a20 2020 2020  as cursor:.     
-00016060: 2020 2079 6965 6c64 2066 726f 6d20 6375     yield from cu
-00016070: 7273 6f72 0a0a 0a64 6566 2067 6574 5f74  rsor...def get_t
-00016080: 6f6b 656e 5f66 726f 6d5f 7374 6174 6528  oken_from_state(
-00016090: 7374 7265 616d 735f 746f 5f73 796e 633a  streams_to_sync:
-000160a0: 2053 6574 5b73 7472 5d2c 2073 7461 7465   Set[str], state
-000160b0: 3a20 4469 6374 2920 2d3e 204f 7074 696f  : Dict) -> Optio
-000160c0: 6e61 6c5b 4469 6374 5d3a 0a20 2020 2022  nal[Dict]:.    "
-000160d0: 2222 0a20 2020 2045 7874 7261 6374 2074  "".    Extract t
-000160e0: 6865 2073 6d61 6c6c 6573 7420 6e6f 6e20  he smallest non 
-000160f0: 6e75 6c6c 2072 6573 756d 6520 746f 6b65  null resume toke
-00016100: 6e0a 2020 2020 4172 6773 3a0a 2020 2020  n.    Args:.    
-00016110: 2020 2020 7374 7265 616d 735f 746f 5f73      streams_to_s
-00016120: 796e 633a 2073 6574 206f 6620 6c6f 6720  ync: set of log 
-00016130: 6261 7365 6420 7374 7265 616d 730a 2020  based streams.  
-00016140: 2020 2020 2020 7374 6174 653a 2073 7461        state: sta
-00016150: 7465 2064 6963 7469 6f6e 6172 790a 0a20  te dictionary.. 
-00016160: 2020 2052 6574 7572 6e73 3a20 7265 7375     Returns: resu
-00016170: 6d65 2074 6f6b 656e 2069 6620 666f 756e  me token if foun
-00016180: 642c 204e 6f6e 6520 6f74 6865 7277 6973  d, None otherwis
-00016190: 650a 0a20 2020 2022 2222 0a20 2020 2074  e..    """.    t
-000161a0: 6f6b 656e 5f73 6f72 7465 6420 3d20 736f  oken_sorted = so
-000161b0: 7274 6564 285b 7374 7265 616d 5f73 7461  rted([stream_sta
-000161c0: 7465 5b52 4553 554d 455f 544f 4b45 4e5f  te[RESUME_TOKEN_
-000161d0: 4b45 595d 0a20 2020 2020 2020 2020 2020  KEY].           
-000161e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000161f0: 666f 7220 7374 7265 616d 5f6e 616d 652c  for stream_name,
-00016200: 2073 7472 6561 6d5f 7374 6174 6520 696e   stream_state in
-00016210: 2073 7461 7465 2e67 6574 2827 626f 6f6b   state.get('book
-00016220: 6d61 726b 7327 2c20 7b7d 292e 6974 656d  marks', {}).item
-00016230: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-00016240: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00016250: 6620 7374 7265 616d 5f6e 616d 6520 696e  f stream_name in
-00016260: 2073 7472 6561 6d73 5f74 6f5f 7379 6e63   streams_to_sync
-00016270: 2061 6e64 2073 7472 6561 6d5f 7374 6174   and stream_stat
-00016280: 652e 6765 7428 5245 5355 4d45 5f54 4f4b  e.get(RESUME_TOK
-00016290: 454e 5f4b 4559 2920 6973 206e 6f74 204e  EN_KEY) is not N
-000162a0: 6f6e 655d 2c0a 2020 2020 2020 2020 2020  one],.          
-000162b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162c0: 6b65 793d 6c61 6d62 6461 206b 6579 3a20  key=lambda key: 
-000162d0: 6b65 795b 275f 6461 7461 275d 290a 0a20  key['_data']).. 
-000162e0: 2020 2072 6574 7572 6e20 746f 6b65 6e5f     return token_
-000162f0: 736f 7274 6564 5b30 5d20 6966 2074 6f6b  sorted[0] if tok
-00016300: 656e 5f73 6f72 7465 6420 656c 7365 204e  en_sorted else N
-00016310: 6f6e 650a 0a0a 6465 6620 7379 6e63 5f64  one...def sync_d
-00016320: 6174 6162 6173 6528 6461 7461 6261 7365  atabase(database
-00016330: 3a20 4461 7461 6261 7365 2c0a 2020 2020  : Database,.    
-00016340: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00016350: 7265 616d 735f 746f 5f73 796e 633a 2044  reams_to_sync: D
-00016360: 6963 745b 7374 722c 2044 6963 745d 2c0a  ict[str, Dict],.
-00016370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016380: 2020 7374 6174 653a 2044 6963 742c 0a20    state: Dict,. 
-00016390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000163a0: 2075 7064 6174 655f 6275 6666 6572 5f73   update_buffer_s
-000163b0: 697a 653a 2069 6e74 2c0a 2020 2020 2020  ize: int,.      
-000163c0: 2020 2020 2020 2020 2020 2020 6177 6169              awai
-000163d0: 745f 7469 6d65 5f6d 733a 2069 6e74 2c0a  t_time_ms: int,.
-000163e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000163f0: 2020 6675 6c6c 5f6c 6f61 645f 6f6e 5f65    full_load_on_e
-00016400: 6d70 7479 5f73 7461 7465 3a20 626f 6f6c  mpty_state: bool
-00016410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016420: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-00016430: 2020 2222 220a 2020 2020 5379 6e63 7320    """.    Syncs 
-00016440: 7468 6520 7265 636f 7264 7320 6672 6f6d  the records from
-00016450: 2074 6865 2067 6976 656e 2063 6f6c 6c65   the given colle
-00016460: 6374 696f 6e20 7573 696e 6720 4368 616e  ction using Chan
-00016470: 6765 5374 7265 616d 730a 2020 2020 4172  geStreams.    Ar
-00016480: 6773 3a0a 2020 2020 2020 2020 6461 7461  gs:.        data
-00016490: 6261 7365 3a20 4d6f 6e67 6f44 4220 4461  base: MongoDB Da
-000164a0: 7461 6261 7365 2069 6e73 7461 6e63 6520  tabase instance 
-000164b0: 746f 2073 796e 630a 2020 2020 2020 2020  to sync.        
-000164c0: 7374 7265 616d 735f 746f 5f73 796e 633a  streams_to_sync:
-000164d0: 2044 6963 7420 6f66 2073 7472 6561 6d20   Dict of stream 
-000164e0: 6469 6374 696f 6e61 7279 2077 6974 6820  dictionary with 
-000164f0: 616c 6c20 7468 6520 7374 7265 616d 2064  all the stream d
-00016500: 6574 6169 6c73 0a20 2020 2020 2020 2073  etails.        s
-00016510: 7461 7465 3a20 7374 6174 6520 6469 6374  tate: state dict
-00016520: 696f 6e61 7279 0a20 2020 2020 2020 2075  ionary.        u
-00016530: 7064 6174 655f 6275 6666 6572 5f73 697a  pdate_buffer_siz
-00016540: 653a 2074 6865 2073 697a 6520 6f66 2062  e: the size of b
-00016550: 7566 6665 7220 7573 6564 2074 6f20 686f  uffer used to ho
-00016560: 6c64 2064 6574 6563 7465 6420 7570 6461  ld detected upda
-00016570: 7465 730a 2020 2020 2020 2020 6177 6169  tes.        awai
-00016580: 745f 7469 6d65 5f6d 733a 2020 7468 6520  t_time_ms:  the 
-00016590: 6d61 7869 6d75 6d20 7469 6d65 2069 6e20  maximum time in 
-000165a0: 6d69 6c6c 6973 6563 6f6e 6473 2066 6f72  milliseconds for
-000165b0: 2074 6865 206c 6f67 2062 6173 6564 2074   the log based t
-000165c0: 6f20 7761 6974 2066 6f72 2063 6861 6e67  o wait for chang
-000165d0: 6573 2062 6566 6f72 6520 6578 6974 696e  es before exitin
-000165e0: 670a 2020 2020 2222 220a 2020 2020 4c4f  g.    """.    LO
-000165f0: 4747 4552 2e69 6e66 6f28 2753 7461 7274  GGER.info('Start
-00016600: 696e 6720 4c6f 6742 6173 6564 2073 796e  ing LogBased syn
-00016610: 6320 666f 7220 7374 7265 616d 7320 2225  c for streams "%
-00016620: 7322 2069 6e20 6461 7461 6261 7365 2022  s" in database "
-00016630: 2573 2227 2c20 6c69 7374 2873 7472 6561  %s"', list(strea
-00016640: 6d73 5f74 6f5f 7379 6e63 2e6b 6579 7328  ms_to_sync.keys(
-00016650: 2929 2c20 6461 7461 6261 7365 2e6e 616d  )), database.nam
-00016660: 6529 0a0a 2020 2020 726f 7773 5f73 6176  e)..    rows_sav
-00016670: 6564 203d 207b 7d0a 2020 2020 7374 6172  ed = {}.    star
-00016680: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
-00016690: 6d65 2829 0a20 2020 2075 7064 6174 655f  me().    update_
-000166a0: 6275 6666 6572 203d 207b 7d0a 2020 2020  buffer = {}.    
-000166b0: 6675 6c6c 5f6c 6f61 6420 3d20 6c69 7374  full_load = list
-000166c0: 2829 0a0a 2020 2020 666f 7220 7374 7265  ()..    for stre
-000166d0: 616d 5f69 6420 696e 2073 7472 6561 6d73  am_id in streams
-000166e0: 5f74 6f5f 7379 6e63 3a0a 2020 2020 2020  _to_sync:.      
-000166f0: 2020 7570 6461 7465 5f62 7566 6665 725b    update_buffer[
-00016700: 7374 7265 616d 5f69 645d 203d 2073 6574  stream_id] = set
-00016710: 2829 0a20 2020 2020 2020 2072 6f77 735f  ().        rows_
-00016720: 7361 7665 645b 7374 7265 616d 5f69 645d  saved[stream_id]
-00016730: 203d 2030 0a20 2020 2020 2020 2069 6620   = 0.        if 
-00016740: 6675 6c6c 5f6c 6f61 645f 6f6e 5f65 6d70  full_load_on_emp
-00016750: 7479 5f73 7461 7465 3a0a 2020 2020 2020  ty_state:.      
-00016760: 2020 2020 2020 2320 6765 7420 7374 7265        # get stre
-00016770: 616d 7320 7768 6572 6520 6e6f 2070 7265  ams where no pre
-00016780: 7669 6f75 7320 746f 6b65 6e20 6578 6973  vious token exis
-00016790: 7473 2069 6e20 7374 6174 650a 2020 2020  ts in state.    
-000167a0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-000167b0: 696e 6765 722e 6765 745f 626f 6f6b 6d61  inger.get_bookma
-000167c0: 726b 2873 7461 7465 2c20 7374 7265 616d  rk(state, stream
-000167d0: 5f69 642c 2027 746f 6b65 6e27 293a 0a20  _id, 'token'):. 
-000167e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000167f0: 756c 6c5f 6c6f 6164 2e61 7070 656e 6428  ull_load.append(
-00016800: 7374 7265 616d 5f69 6429 0a0a 0a20 2020  stream_id)...   
-00016810: 2073 7472 6561 6d5f 6964 7320 3d20 7365   stream_ids = se
-00016820: 7428 7374 7265 616d 735f 746f 5f73 796e  t(streams_to_syn
-00016830: 632e 6b65 7973 2829 290a 0a20 2020 2023  c.keys())..    #
-00016840: 2070 6572 666f 726d 2066 756c 6c20 6c6f   perform full lo
-00016850: 6164 2069 6620 6e6f 2070 7265 7669 6f75  ad if no previou
-00016860: 7320 746f 6b65 6e20 6578 6973 7473 0a20  s token exists. 
-00016870: 2020 2069 6620 6675 6c6c 5f6c 6f61 645f     if full_load_
-00016880: 6f6e 5f65 6d70 7479 5f73 7461 7465 3a0a  on_empty_state:.
-00016890: 2020 2020 2020 2020 666f 7220 7461 705f          for tap_
-000168a0: 7374 7265 616d 5f69 6420 696e 2066 756c  stream_id in ful
-000168b0: 6c5f 6c6f 6164 3a0a 2020 2020 2020 2020  l_load:.        
-000168c0: 2020 2020 7461 626c 655f 6e61 6d65 203d      table_name =
-000168d0: 2073 7472 6561 6d73 5f74 6f5f 7379 6e63   streams_to_sync
-000168e0: 5b74 6170 5f73 7472 6561 6d5f 6964 5d2e  [tap_stream_id].
-000168f0: 6765 7428 2774 6162 6c65 5f6e 616d 6527  get('table_name'
-00016900: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-00016910: 6c6c 6563 7469 6f6e 203d 2064 6174 6162  llection = datab
-00016920: 6173 655b 7461 626c 655f 6e61 6d65 5d0a  ase[table_name].
-00016930: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
-00016940: 4f44 4f3a 2061 6464 2062 6174 6368 6573  ODO: add batches
-00016950: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
-00016960: 6820 636f 6c6c 6563 7469 6f6e 2e66 696e  h collection.fin
-00016970: 6428 736f 7274 3d5b 2822 5f69 6422 2c20  d(sort=[("_id", 
-00016980: 7079 6d6f 6e67 6f2e 4153 4345 4e44 494e  pymongo.ASCENDIN
-00016990: 4729 5d29 2061 7320 6375 7273 6f72 3a0a  G)]) as cursor:.
-000169a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169b0: 666f 7220 726f 7720 696e 2063 7572 736f  for row in curso
-000169c0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-000169d0: 2020 2020 2020 2072 6f77 735f 7361 7665         rows_save
-000169e0: 645b 7461 705f 7374 7265 616d 5f69 645d  d[tap_stream_id]
-000169f0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-00016a00: 2020 2020 2020 2020 2020 7369 6e67 6572            singer
-00016a10: 2e77 7269 7465 5f6d 6573 7361 6765 2863  .write_message(c
-00016a20: 6f6d 6d6f 6e2e 726f 775f 746f 5f73 696e  ommon.row_to_sin
-00016a30: 6765 725f 7265 636f 7264 2873 7472 6561  ger_record(strea
-00016a40: 6d3d 7374 7265 616d 735f 746f 5f73 796e  m=streams_to_syn
-00016a50: 635b 7461 705f 7374 7265 616d 5f69 645d  c[tap_stream_id]
-00016a60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00016a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016aa0: 2020 2020 2020 726f 773d 726f 772c 0a20        row=row,. 
-00016ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00015a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00015a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00015a80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00015a90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00015aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00015b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c00: 3238 206d 7469 6d65 3d31 3638 3737 3732  28 mtime=1687772
+00015c10: 3038 372e 3433 3132 3735 310a 0000 0000  087.4312751.....
+00015c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00015e10: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
+00015e20: 5f73 7472 6174 6567 6965 732f 0000 0000  _strategies/....
+00015e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015e60: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
+00015e70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00015e80: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
+00015e90: 3030 3000 3032 3232 3231 0020 3500 0000  000.022221. 5...
+00015ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00015f10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00015f20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00015f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00015ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00016010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00016070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00016080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00016090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+000160a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000160b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000160c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000160d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000160e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000160f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00016110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000161f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016200: 3232 206d 7469 6d65 3d31 3637 3634 3530  22 mtime=1676450
+00016210: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
+00016220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000162f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000163f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016400: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00016410: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
+00016420: 5f73 7472 6174 6567 6965 732f 6368 616e  _strategies/chan
+00016430: 6765 5f73 7472 6561 6d73 2e70 7900 0000  ge_streams.py...
+00016440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00016470: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00016480: 3030 3234 3334 3200 3030 3030 3030 3030  0024342.00000000
+00016490: 3030 3000 3032 3535 3633 0020 3000 0000  000.025563. 0...
+000164a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000164f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016500: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00016510: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00016520: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00016530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000165f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016600: 696d 706f 7274 2063 6f70 790a 696d 706f  import copy.impo
+00016610: 7274 2074 696d 650a 696d 706f 7274 2073  rt time.import s
+00016620: 696e 6765 720a 696d 706f 7274 2070 796d  inger.import pym
+00016630: 6f6e 676f 0a0a 6672 6f6d 2074 7970 696e  ongo..from typin
+00016640: 6720 696d 706f 7274 2053 6574 2c20 4469  g import Set, Di
+00016650: 6374 2c20 4f70 7469 6f6e 616c 2c20 4765  ct, Optional, Ge
+00016660: 6e65 7261 746f 720a 6672 6f6d 2070 796d  nerator.from pym
+00016670: 6f6e 676f 2e63 6f6c 6c65 6374 696f 6e20  ongo.collection 
+00016680: 696d 706f 7274 2043 6f6c 6c65 6374 696f  import Collectio
+00016690: 6e0a 6672 6f6d 2070 796d 6f6e 676f 2e64  n.from pymongo.d
+000166a0: 6174 6162 6173 6520 696d 706f 7274 2044  atabase import D
+000166b0: 6174 6162 6173 650a 6672 6f6d 2073 696e  atabase.from sin
+000166c0: 6765 7220 696d 706f 7274 2075 7469 6c73  ger import utils
+000166d0: 0a0a 6672 6f6d 2064 7a5f 6d6f 6e67 6f64  ..from dz_mongod
+000166e0: 622e 7379 6e63 5f73 7472 6174 6567 6965  b.sync_strategie
+000166f0: 7320 696d 706f 7274 2063 6f6d 6d6f 6e0a  s import common.
+00016700: 0a4c 4f47 4745 5220 3d20 7369 6e67 6572  .LOGGER = singer
+00016710: 2e67 6574 5f6c 6f67 6765 7228 2764 7a5f  .get_logger('dz_
+00016720: 6d6f 6e67 6f64 6227 290a 0a52 4553 554d  mongodb')..RESUM
+00016730: 455f 544f 4b45 4e5f 4b45 5920 3d20 2774  E_TOKEN_KEY = 't
+00016740: 6f6b 656e 270a 4445 4641 554c 545f 4157  oken'.DEFAULT_AW
+00016750: 4149 545f 5449 4d45 5f4d 5320 3d20 3130  AIT_TIME_MS = 10
+00016760: 3030 2020 2320 7468 6520 7365 7276 6572  00  # the server
+00016770: 2064 6566 6175 6c74 2068 7474 7073 3a2f   default https:/
+00016780: 2f64 6f63 732e 6d6f 6e67 6f64 622e 636f  /docs.mongodb.co
+00016790: 6d2f 6d61 6e75 616c 2f72 6566 6572 656e  m/manual/referen
+000167a0: 6365 2f6d 6574 686f 642f 6462 2e77 6174  ce/method/db.wat
+000167b0: 6368 2f23 6462 2e77 6174 6368 0a4d 494e  ch/#db.watch.MIN
+000167c0: 5f55 5044 4154 455f 4255 4646 4552 5f4c  _UPDATE_BUFFER_L
+000167d0: 454e 4754 4820 3d20 3120 2320 6465 6661  ENGTH = 1 # defa
+000167e0: 756c 740a 4d41 585f 5550 4441 5445 5f42  ult.MAX_UPDATE_B
+000167f0: 5546 4645 525f 4c45 4e47 5448 203d 2063  UFFER_LENGTH = c
+00016800: 6f6d 6d6f 6e2e 5550 4441 5445 5f42 4f4f  ommon.UPDATE_BOO
+00016810: 4b4d 4152 4b5f 5045 5249 4f44 2023 2073  KMARK_PERIOD # s
+00016820: 6574 206d 6178 2061 7320 7468 6520 7361  et max as the sa
+00016830: 6d65 2076 616c 7565 2061 7320 626f 6f6b  me value as book
+00016840: 6d61 726b 2070 6572 696f 6420 6173 2077  mark period as w
+00016850: 6520 666c 7573 680a 2320 7468 6520 6275  e flush.# the bu
+00016860: 6666 6572 2061 6e79 7761 7920 6166 7465  ffer anyway afte
+00016870: 7220 6576 6572 7920 5550 4441 5445 5f42  r every UPDATE_B
+00016880: 4f4f 4b4d 4152 4b5f 5045 5249 4f44 0a0a  OOKMARK_PERIOD..
+00016890: 0a64 6566 2075 7064 6174 655f 626f 6f6b  .def update_book
+000168a0: 6d61 726b 7328 7374 6174 653a 2044 6963  marks(state: Dic
+000168b0: 742c 2074 6170 5f73 7472 6561 6d5f 6964  t, tap_stream_id
+000168c0: 733a 2053 6574 5b73 7472 5d2c 2074 6f6b  s: Set[str], tok
+000168d0: 656e 3a20 4469 6374 2920 2d3e 2044 6963  en: Dict) -> Dic
+000168e0: 743a 0a20 2020 2022 2222 0a20 2020 2055  t:.    """.    U
+000168f0: 7064 6174 6573 2074 6865 2073 7472 6561  pdates the strea
+00016900: 6d20 7374 6174 6520 6279 2072 652d 7365  m state by re-se
+00016910: 7474 696e 6720 7468 6520 6368 616e 6765  tting the change
+00016920: 5374 7265 616d 2074 6f6b 656e 0a20 2020  Stream token.   
+00016930: 2041 7267 733a 0a20 2020 2020 2020 2073   Args:.        s
+00016940: 7461 7465 3a20 5374 6174 6520 6469 6374  tate: State dict
+00016950: 696f 6e61 7279 0a20 2020 2020 2020 2074  ionary.        t
+00016960: 6170 5f73 7472 6561 6d5f 6964 733a 2073  ap_stream_ids: s
+00016970: 6574 206f 6620 7374 7265 616d 7327 2049  et of streams' I
+00016980: 440a 2020 2020 2020 2020 746f 6b65 6e3a  D.        token:
+00016990: 2072 6573 756d 6520 746f 6b65 6e20 6672   resume token fr
+000169a0: 6f6d 2063 6861 6e67 6553 7472 6561 6d0a  om changeStream.
+000169b0: 0a20 2020 2052 6574 7572 6e73 3a0a 2020  .    Returns:.  
+000169c0: 2020 2020 2020 7374 6174 653a 2075 7064        state: upd
+000169d0: 6174 6564 2073 7461 7465 0a20 2020 2022  ated state.    "
+000169e0: 2222 0a20 2020 2066 6f72 2073 7472 6561  "".    for strea
+000169f0: 6d20 696e 2074 6170 5f73 7472 6561 6d5f  m in tap_stream_
+00016a00: 6964 733a 0a20 2020 2020 2020 2073 7461  ids:.        sta
+00016a10: 7465 203d 2073 696e 6765 722e 7772 6974  te = singer.writ
+00016a20: 655f 626f 6f6b 6d61 726b 2873 7461 7465  e_bookmark(state
+00016a30: 2c20 7374 7265 616d 2c20 5245 5355 4d45  , stream, RESUME
+00016a40: 5f54 4f4b 454e 5f4b 4559 2c20 746f 6b65  _TOKEN_KEY, toke
+00016a50: 6e29 0a0a 2020 2020 7265 7475 726e 2073  n)..    return s
+00016a60: 7461 7465 0a0a 0a64 6566 2067 6574 5f62  tate...def get_b
+00016a70: 7566 6665 725f 726f 7773 5f66 726f 6d5f  uffer_rows_from_
+00016a80: 6462 2863 6f6c 6c65 6374 696f 6e3a 2043  db(collection: C
+00016a90: 6f6c 6c65 6374 696f 6e2c 0a20 2020 2020  ollection,.     
+00016aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ab0: 2020 2020 2020 2075 7064 6174 655f 6275         update_bu
+00016ac0: 6666 6572 3a20 5365 742c 0a20 2020 2020  ffer: Set,.     
 00016ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016af0: 2020 2074 696d 655f 6578 7472 6163 7465     time_extracte
-00016b00: 643d 7574 696c 732e 6e6f 7728 292c 0a20  d=utils.now(),. 
-00016b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b50: 2020 2074 696d 655f 6465 6c65 7465 643d     time_deleted=
-00016b60: 4e6f 6e65 2929 0a0a 2020 2020 2320 496e  None))..    # In
-00016b70: 6974 2061 2063 7572 736f 7220 746f 206c  it a cursor to l
-00016b80: 6973 7465 6e20 666f 7220 6368 616e 6765  isten for change
-00016b90: 7320 6672 6f6d 2074 6865 206c 6173 7420  s from the last 
-00016ba0: 7361 7665 6420 7265 7375 6d65 2074 6f6b  saved resume tok
-00016bb0: 656e 0a20 2020 2023 2069 6620 7468 6572  en.    # if ther
-00016bc0: 6520 6172 6520 6e6f 2063 6861 6e67 6573  e are no changes
-00016bd0: 2061 6674 6572 204d 4158 5f41 5741 4954   after MAX_AWAIT
-00016be0: 5f54 494d 455f 4d53 2c20 7468 656e 2077  _TIME_MS, then w
-00016bf0: 6527 6c6c 2065 7869 740a 2020 2020 7769  e'll exit.    wi
-00016c00: 7468 2064 6174 6162 6173 652e 7761 7463  th database.watc
-00016c10: 6828 0a20 2020 2020 2020 2020 2020 205b  h(.            [
-00016c20: 7b27 246d 6174 6368 273a 207b 0a20 2020  {'$match': {.   
-00016c30: 2020 2020 2020 2020 2020 2020 2027 246f               '$o
-00016c40: 7227 3a20 5b0a 2020 2020 2020 2020 2020  r': [.          
-00016c50: 2020 2020 2020 2020 2020 7b27 6f70 6572            {'oper
-00016c60: 6174 696f 6e54 7970 6527 3a20 2769 6e73  ationType': 'ins
-00016c70: 6572 7427 7d2c 207b 276f 7065 7261 7469  ert'}, {'operati
-00016c80: 6f6e 5479 7065 273a 2027 7570 6461 7465  onType': 'update
-00016c90: 277d 2c20 7b27 6f70 6572 6174 696f 6e54  '}, {'operationT
-00016ca0: 7970 6527 3a20 2764 656c 6574 6527 7d0a  ype': 'delete'}.
-00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cc0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00016cd0: 2020 2027 2461 6e64 273a 205b 0a20 2020     '$and': [.   
-00016ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cf0: 2023 2077 6174 6368 2063 6f6c 6c65 6374   # watch collect
-00016d00: 696f 6e73 206f 6620 7365 6c65 6374 6564  ions of selected
-00016d10: 2073 7472 6561 6d73 0a20 2020 2020 2020   streams.       
-00016d20: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
-00016d30: 732e 636f 6c6c 273a 207b 2724 696e 273a  s.coll': {'$in':
-00016d40: 205b 7661 6c5b 2774 6162 6c65 5f6e 616d   [val['table_nam
-00016d50: 6527 5d20 666f 7220 7661 6c20 696e 2073  e'] for val in s
-00016d60: 7472 6561 6d73 5f74 6f5f 7379 6e63 2e76  treams_to_sync.v
-00016d70: 616c 7565 7328 295d 7d7d 0a20 2020 2020  alues()]}}.     
-00016d80: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-00016d90: 2020 2020 2020 2020 207d 7d5d 2c0a 2020           }}],.  
-00016da0: 2020 2020 2020 2020 2020 6d61 785f 6177            max_aw
-00016db0: 6169 745f 7469 6d65 5f6d 733d 6177 6169  ait_time_ms=awai
-00016dc0: 745f 7469 6d65 5f6d 732c 0a20 2020 2020  t_time_ms,.     
-00016dd0: 2020 2020 2020 2073 7461 7274 5f61 6674         start_aft
-00016de0: 6572 3d67 6574 5f74 6f6b 656e 5f66 726f  er=get_token_fro
-00016df0: 6d5f 7374 6174 6528 7374 7265 616d 5f69  m_state(stream_i
-00016e00: 6473 2c20 7374 6174 6529 0a20 2020 2029  ds, state).    )
-00016e10: 2061 7320 6375 7273 6f72 3a0a 2020 2020   as cursor:.    
-00016e20: 2020 2020 7768 696c 6520 6375 7273 6f72      while cursor
-00016e30: 2e61 6c69 7665 3a0a 0a20 2020 2020 2020  .alive:..       
-00016e40: 2020 2020 2063 6861 6e67 6520 3d20 6375       change = cu
-00016e50: 7273 6f72 2e74 7279 5f6e 6578 7428 290a  rsor.try_next().
-00016e60: 0a20 2020 2020 2020 2020 2020 2023 204e  .            # N
-00016e70: 6f74 6520 7468 6174 2074 6865 2043 6861  ote that the Cha
-00016e80: 6e67 6553 7472 6561 6d27 7320 7265 7375  ngeStream's resu
-00016e90: 6d65 2074 6f6b 656e 206d 6179 2062 6520  me token may be 
-00016ea0: 7570 6461 7465 640a 2020 2020 2020 2020  updated.        
-00016eb0: 2020 2020 2320 6576 656e 2077 6865 6e20      # even when 
-00016ec0: 6e6f 2063 6861 6e67 6573 2061 7265 2072  no changes are r
-00016ed0: 6574 7572 6e65 642e 0a0a 2020 2020 2020  eturned...      
-00016ee0: 2020 2020 2020 2320 546f 6b65 6e20 6361        # Token ca
-00016ef0: 6e20 6c6f 6f6b 206c 696b 6520 696e 204d  n look like in M
-00016f00: 6f6e 676f 4442 2034 2e32 3a0a 2020 2020  ongoDB 4.2:.    
-00016f10: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-00016f20: 7b27 5f64 6174 6127 3a20 2741 5f4c 4f4e  {'_data': 'A_LON
-00016f30: 475f 4845 585f 4445 4349 4d41 4c5f 5354  G_HEX_DECIMAL_ST
-00016f40: 5249 4e47 277d 0a20 2020 2020 2020 2020  RING'}.         
-00016f50: 2020 2023 2020 2020 6f72 207b 275f 6461     #    or {'_da
-00016f60: 7461 273a 2027 415f 4c4f 4e47 5f48 4558  ta': 'A_LONG_HEX
-00016f70: 5f44 4543 494d 414c 5f53 5452 494e 4727  _DECIMAL_STRING'
-00016f80: 2c20 275f 7479 7065 4269 7473 273a 2062  , '_typeBits': b
-00016f90: 2753 4f4d 455f 4845 5827 7d0a 0a20 2020  'SOME_HEX'}..   
-00016fa0: 2020 2020 2020 2020 2023 2047 6574 2074           # Get t
-00016fb0: 6865 2027 5f64 6174 6127 206f 6e6c 7920  he '_data' only 
-00016fc0: 6672 6f6d 2072 6573 756d 6520 746f 6b65  from resume toke
-00016fd0: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
-00016fe0: 746f 6b65 6e20 6361 6e20 636f 6e74 6169  token can contai
-00016ff0: 6e20 6120 7072 6f70 6572 7479 2027 5f74  n a property '_t
-00017000: 7970 6542 6974 7327 206f 6620 7479 7065  ypeBits' of type
-00017010: 2062 7974 6573 2077 6869 6368 2063 616e   bytes which can
-00017020: 6e6f 7420 6265 206a 736f 6e0a 2020 2020  not be json.    
-00017030: 2020 2020 2020 2020 2320 7365 7269 616c          # serial
-00017040: 697a 6564 2077 6865 6e20 6372 6561 7469  ized when creati
-00017050: 6e67 2074 6865 2073 7461 7465 2e0a 2020  ng the state..  
-00017060: 2020 2020 2020 2020 2020 2320 275f 6461            # '_da
-00017070: 7461 2720 6973 2065 6e6f 7567 6820 746f  ta' is enough to
-00017080: 2072 6573 756d 6520 4c4f 475f 4241 5345   resume LOG_BASE
-00017090: 440a 2020 2020 2020 2020 2020 2020 7265  D.            re
-000170a0: 7375 6d65 5f74 6f6b 656e 203d 207b 0a20  sume_token = {. 
-000170b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-000170c0: 5f64 6174 6127 3a20 6375 7273 6f72 2e72  _data': cursor.r
-000170d0: 6573 756d 655f 746f 6b65 6e5b 275f 6461  esume_token['_da
-000170e0: 7461 275d 0a20 2020 2020 2020 2020 2020  ta'].           
-000170f0: 207d 0a0a 2020 2020 2020 2020 2020 2020   }..            
-00017100: 2320 4166 7465 7220 4d41 585f 4157 4149  # After MAX_AWAI
-00017110: 545f 5449 4d45 5f4d 5320 6861 7320 656c  T_TIME_MS has el
-00017120: 6170 7365 642c 2074 6865 2063 7572 736f  apsed, the curso
-00017130: 7220 7769 6c6c 2072 6574 7572 6e20 4e6f  r will return No
-00017140: 6e65 2e0a 2020 2020 2020 2020 2020 2020  ne..            
-00017150: 2320 7772 6974 6520 7374 6174 6520 616e  # write state an
-00017160: 6420 6578 6974 0a20 2020 2020 2020 2020  d exit.         
-00017170: 2020 2069 6620 6368 616e 6765 2069 7320     if change is 
-00017180: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00017190: 2020 2020 2020 4c4f 4747 4552 2e69 6e66        LOGGER.inf
-000171a0: 6f28 274e 6f20 6368 616e 6765 2073 7472  o('No change str
-000171b0: 6561 6d73 2061 6674 6572 2025 732c 2075  eams after %s, u
-000171c0: 7064 6174 696e 6720 626f 6f6b 6d61 726b  pdating bookmark
-000171d0: 2061 6e64 2065 7869 7469 6e67 2e2e 2e27   and exiting...'
-000171e0: 2c20 6177 6169 745f 7469 6d65 5f6d 7329  , await_time_ms)
-000171f0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017200: 2020 7374 6174 6520 3d20 7570 6461 7465    state = update
-00017210: 5f62 6f6f 6b6d 6172 6b73 2873 7461 7465  _bookmarks(state
-00017220: 2c20 7374 7265 616d 5f69 6473 2c20 7265  , stream_ids, re
-00017230: 7375 6d65 5f74 6f6b 656e 290a 2020 2020  sume_token).    
-00017240: 2020 2020 2020 2020 2020 2020 7369 6e67              sing
-00017250: 6572 2e77 7269 7465 5f6d 6573 7361 6765  er.write_message
-00017260: 2873 696e 6765 722e 5374 6174 654d 6573  (singer.StateMes
-00017270: 7361 6765 2876 616c 7565 3d63 6f70 792e  sage(value=copy.
-00017280: 6465 6570 636f 7079 2873 7461 7465 2929  deepcopy(state))
-00017290: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000172a0: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
-000172b0: 2020 2020 2020 6461 7461 6261 7365 5f6e        database_n
-000172c0: 616d 6520 3d20 6368 616e 6765 5b22 6e73  ame = change["ns
-000172d0: 225d 5b22 6462 225d 0a20 2020 2020 2020  "]["db"].       
-000172e0: 2020 2020 2023 2072 656d 6f76 6520 7468       # remove th
-000172f0: 6520 7072 6566 6978 2066 726f 6d20 7468  e prefix from th
-00017300: 6520 6461 7461 6261 7365 206e 616d 650a  e database name.
-00017310: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00017320: 6261 7365 5f6e 616d 6520 3d20 6461 7461  base_name = data
-00017330: 6261 7365 5f6e 616d 652e 7370 6c69 7428  base_name.split(
-00017340: 275f 272c 2031 295b 2d31 5d0a 2020 2020  '_', 1)[-1].    
-00017350: 2020 2020 2020 2020 7461 705f 7374 7265          tap_stre
-00017360: 616d 5f69 6420 3d20 6627 7b64 6174 6162  am_id = f'{datab
-00017370: 6173 655f 6e61 6d65 7d2d 7b63 6861 6e67  ase_name}-{chang
-00017380: 655b 226e 7322 5d5b 2263 6f6c 6c22 5d7d  e["ns"]["coll"]}
-00017390: 270a 0a20 2020 2020 2020 2020 2020 206f  '..            o
-000173a0: 7065 7261 7469 6f6e 203d 2063 6861 6e67  peration = chang
-000173b0: 655b 276f 7065 7261 7469 6f6e 5479 7065  e['operationType
-000173c0: 275d 0a0a 2020 2020 2020 2020 2020 2020  ']..            
-000173d0: 6966 206f 7065 7261 7469 6f6e 203d 3d20  if operation == 
-000173e0: 2769 6e73 6572 7427 3a0a 2020 2020 2020  'insert':.      
-000173f0: 2020 2020 2020 2020 2020 7369 6e67 6572            singer
-00017400: 2e77 7269 7465 5f6d 6573 7361 6765 2863  .write_message(c
-00017410: 6f6d 6d6f 6e2e 726f 775f 746f 5f73 696e  ommon.row_to_sin
-00017420: 6765 725f 7265 636f 7264 2873 7472 6561  ger_record(strea
-00017430: 6d3d 7374 7265 616d 735f 746f 5f73 796e  m=streams_to_syn
-00017440: 635b 7461 705f 7374 7265 616d 5f69 645d  c[tap_stream_id]
-00017450: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00017460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017490: 2020 2072 6f77 3d63 6861 6e67 655b 2766     row=change['f
-000174a0: 756c 6c44 6f63 756d 656e 7427 5d2c 0a20  ullDocument'],. 
-000174b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000174f0: 7469 6d65 5f65 7874 7261 6374 6564 3d75  time_extracted=u
-00017500: 7469 6c73 2e6e 6f77 2829 2c0a 2020 2020  tils.now(),.    
-00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017540: 2020 2020 2020 2020 2020 2020 2074 696d               tim
-00017550: 655f 6465 6c65 7465 643d 4e6f 6e65 2929  e_deleted=None))
-00017560: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017570: 2020 726f 7773 5f73 6176 6564 5b74 6170    rows_saved[tap
-00017580: 5f73 7472 6561 6d5f 6964 5d20 2b3d 2031  _stream_id] += 1
-00017590: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-000175a0: 6966 206f 7065 7261 7469 6f6e 203d 3d20  if operation == 
-000175b0: 2775 7064 6174 6527 3a0a 2020 2020 2020  'update':.      
-000175c0: 2020 2020 2020 2020 2020 2320 7570 6461            # upda
-000175d0: 7465 206f 7065 7261 7469 6f6e 206f 6e6c  te operation onl
-000175e0: 7920 7265 7475 726e 205f 6964 2061 6e64  y return _id and
-000175f0: 2075 7064 6174 6564 2066 6965 6c64 7320   updated fields 
-00017600: 696e 2074 6865 2072 6f77 2c0a 2020 2020  in the row,.    
-00017610: 2020 2020 2020 2020 2020 2020 2320 736f              # so
-00017620: 2073 6176 696e 6720 5f69 6420 666f 7220   saving _id for 
-00017630: 6e6f 7720 756e 7469 6c20 7765 2066 6574  now until we fet
-00017640: 6368 2074 6865 2064 6f63 756d 656e 7420  ch the document 
-00017650: 7768 656e 2069 7427 7320 7469 6d65 2074  when it's time t
-00017660: 6f20 666c 7573 6820 7468 6520 6275 6666  o flush the buff
-00017670: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
-00017680: 2020 2075 7064 6174 655f 6275 6666 6572     update_buffer
-00017690: 5b74 6170 5f73 7472 6561 6d5f 6964 5d2e  [tap_stream_id].
-000176a0: 6164 6428 6368 616e 6765 5b27 646f 6375  add(change['docu
-000176b0: 6d65 6e74 4b65 7927 5d5b 275f 6964 275d  mentKey']['_id']
-000176c0: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
-000176d0: 6c69 6620 6f70 6572 6174 696f 6e20 3d3d  lif operation ==
-000176e0: 2027 6465 6c65 7465 273a 0a20 2020 2020   'delete':.     
-000176f0: 2020 2020 2020 2020 2020 2023 2072 656d             # rem
-00017700: 6f76 6520 7570 6461 7465 2066 726f 6d20  ove update from 
-00017710: 6275 6666 6572 2069 6620 7468 6174 2064  buffer if that d
-00017720: 6f63 756d 656e 7420 6861 7320 6265 656e  ocument has been
-00017730: 2064 656c 6574 6564 0a20 2020 2020 2020   deleted.       
-00017740: 2020 2020 2020 2020 2075 7064 6174 655f           update_
-00017750: 6275 6666 6572 5b74 6170 5f73 7472 6561  buffer[tap_strea
-00017760: 6d5f 6964 5d2e 6469 7363 6172 6428 6368  m_id].discard(ch
-00017770: 616e 6765 5b27 646f 6375 6d65 6e74 4b65  ange['documentKe
-00017780: 7927 5d5b 275f 6964 275d 290a 0a20 2020  y']['_id'])..   
-00017790: 2020 2020 2020 2020 2020 2020 2023 2044               # D
-000177a0: 656c 6574 6520 6f70 7320 6f6e 6c79 2063  elete ops only c
-000177b0: 6f6e 7461 696e 2074 6865 205f 6964 206f  ontain the _id o
-000177c0: 6620 7468 6520 726f 7720 6465 6c65 7465  f the row delete
-000177d0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-000177e0: 2020 7369 6e67 6572 2e77 7269 7465 5f6d    singer.write_m
-000177f0: 6573 7361 6765 2863 6f6d 6d6f 6e2e 726f  essage(common.ro
-00017800: 775f 746f 5f73 696e 6765 725f 7265 636f  w_to_singer_reco
-00017810: 7264 280a 2020 2020 2020 2020 2020 2020  rd(.            
-00017820: 2020 2020 2020 2020 7374 7265 616d 3d73          stream=s
-00017830: 7472 6561 6d73 5f74 6f5f 7379 6e63 5b74  treams_to_sync[t
-00017840: 6170 5f73 7472 6561 6d5f 6964 5d2c 0a20  ap_stream_id],. 
-00017850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017860: 2020 2072 6f77 3d7b 275f 6964 273a 2063     row={'_id': c
-00017870: 6861 6e67 655b 2764 6f63 756d 656e 744b  hange['documentK
-00017880: 6579 275d 5b27 5f69 6427 5d7d 2c0a 2020  ey']['_id']},.  
-00017890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178a0: 2020 7469 6d65 5f65 7874 7261 6374 6564    time_extracted
-000178b0: 3d75 7469 6c73 2e6e 6f77 2829 2c0a 2020  =utils.now(),.  
-000178c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178d0: 2020 7469 6d65 5f64 656c 6574 6564 3d63    time_deleted=c
-000178e0: 6861 6e67 655b 0a20 2020 2020 2020 2020  hange[.         
-000178f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00017900: 636c 7573 7465 7254 696d 6527 5d2e 6173  clusterTime'].as
-00017910: 5f64 6174 6574 696d 6528 2929 2920 2023  _datetime()))  #
-00017920: 2072 6574 7572 6e73 2070 7974 686f 6e27   returns python'
-00017930: 7320 6461 7465 7469 6d65 2e64 6174 6574  s datetime.datet
-00017940: 696d 6520 696e 7374 616e 6365 2069 6e20  ime instance in 
-00017950: 5554 430a 0a20 2020 2020 2020 2020 2020  UTC..           
-00017960: 2020 2020 2072 6f77 735f 7361 7665 645b       rows_saved[
-00017970: 7461 705f 7374 7265 616d 5f69 645d 202b  tap_stream_id] +
-00017980: 3d20 310a 0a20 2020 2020 2020 2020 2020  = 1..           
-00017990: 2023 2075 7064 6174 6520 7468 6520 7374   # update the st
-000179a0: 6174 6573 206f 6620 616c 6c20 7374 7265  ates of all stre
-000179b0: 616d 730a 2020 2020 2020 2020 2020 2020  ams.            
-000179c0: 7374 6174 6520 3d20 7570 6461 7465 5f62  state = update_b
-000179d0: 6f6f 6b6d 6172 6b73 2873 7461 7465 2c20  ookmarks(state, 
-000179e0: 7374 7265 616d 5f69 6473 2c20 7265 7375  stream_ids, resu
-000179f0: 6d65 5f74 6f6b 656e 290a 0a20 2020 2020  me_token)..     
-00017a00: 2020 2020 2020 2023 2066 6c75 7368 2062         # flush b
-00017a10: 7566 6665 7220 6966 2069 7420 6861 7320  uffer if it has 
-00017a20: 6669 6c6c 6564 2075 7020 6f72 2066 6c75  filled up or flu
-00017a30: 7368 2061 6e64 2077 7269 7465 2073 7461  sh and write sta
-00017a40: 7465 2065 7665 7279 2055 5044 4154 455f  te every UPDATE_
-00017a50: 424f 4f4b 4d41 524b 5f50 4552 494f 4420  BOOKMARK_PERIOD 
-00017a60: 6d65 7373 6167 6573 0a20 2020 2020 2020  messages.       
-00017a70: 2020 2020 2069 6620 7375 6d28 6c65 6e28       if sum(len(
-00017a80: 7374 7265 616d 5f62 7566 6665 7229 2066  stream_buffer) f
-00017a90: 6f72 2073 7472 6561 6d5f 6275 6666 6572  or stream_buffer
-00017aa0: 2069 6e20 7570 6461 7465 5f62 7566 6665   in update_buffe
-00017ab0: 722e 7661 6c75 6573 2829 2920 3e3d 2075  r.values()) >= u
-00017ac0: 7064 6174 655f 6275 6666 6572 5f73 697a  pdate_buffer_siz
-00017ad0: 6520 6f72 205c 0a20 2020 2020 2020 2020  e or \.         
-00017ae0: 2020 2020 2020 2020 2020 2073 756d 2872             sum(r
-00017af0: 6f77 735f 7361 7665 642e 7661 6c75 6573  ows_saved.values
-00017b00: 2829 2920 2520 636f 6d6d 6f6e 2e55 5044  ()) % common.UPD
-00017b10: 4154 455f 424f 4f4b 4d41 524b 5f50 4552  ATE_BOOKMARK_PER
-00017b20: 494f 4420 3d3d 2030 3a0a 0a20 2020 2020  IOD == 0:..     
-00017b30: 2020 2020 2020 2020 2020 204c 4f47 4745             LOGGE
-00017b40: 522e 6465 6275 6728 2746 6c75 7368 696e  R.debug('Flushin
-00017b50: 6720 7570 6461 7465 2062 7566 6665 7220  g update buffer 
-00017b60: 2e2e 2e27 290a 0a20 2020 2020 2020 2020  ...')..         
-00017b70: 2020 2020 2020 2066 6c75 7368 5f62 7566         flush_buf
-00017b80: 6665 7228 7570 6461 7465 5f62 7566 6665  fer(update_buffe
-00017b90: 722c 2073 7472 6561 6d73 5f74 6f5f 7379  r, streams_to_sy
-00017ba0: 6e63 2c20 6461 7461 6261 7365 2c20 726f  nc, database, ro
-00017bb0: 7773 5f73 6176 6564 290a 0a20 2020 2020  ws_saved)..     
-00017bc0: 2020 2020 2020 2020 2020 2069 6620 7375             if su
-00017bd0: 6d28 726f 7773 5f73 6176 6564 2e76 616c  m(rows_saved.val
-00017be0: 7565 7328 2929 2025 2063 6f6d 6d6f 6e2e  ues()) % common.
-00017bf0: 5550 4441 5445 5f42 4f4f 4b4d 4152 4b5f  UPDATE_BOOKMARK_
-00017c00: 5045 5249 4f44 203d 3d20 303a 0a20 2020  PERIOD == 0:.   
-00017c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c20: 2023 2077 7269 7465 2073 7461 7465 0a20   # write state. 
-00017c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c40: 2020 2073 696e 6765 722e 7772 6974 655f     singer.write_
-00017c50: 6d65 7373 6167 6528 7369 6e67 6572 2e53  message(singer.S
-00017c60: 7461 7465 4d65 7373 6167 6528 7661 6c75  tateMessage(valu
-00017c70: 653d 636f 7079 2e64 6565 7063 6f70 7928  e=copy.deepcopy(
-00017c80: 7374 6174 6529 2929 0a0a 2020 2020 2320  state)))..    # 
-00017c90: 666c 7573 6820 6275 6666 6572 2069 6620  flush buffer if 
-00017ca0: 6669 6e69 7368 6564 2077 6974 6820 6368  finished with ch
-00017cb0: 616e 6765 5374 7265 616d 730a 2020 2020  angeStreams.    
-00017cc0: 666c 7573 685f 6275 6666 6572 2875 7064  flush_buffer(upd
-00017cd0: 6174 655f 6275 6666 6572 2c20 7374 7265  ate_buffer, stre
-00017ce0: 616d 735f 746f 5f73 796e 632c 2064 6174  ams_to_sync, dat
-00017cf0: 6162 6173 652c 2072 6f77 735f 7361 7665  abase, rows_save
-00017d00: 6429 0a0a 2020 2020 666f 7220 7374 7265  d)..    for stre
-00017d10: 616d 5f69 6420 696e 2073 7472 6561 6d5f  am_id in stream_
-00017d20: 6964 733a 0a20 2020 2020 2020 2063 6f6d  ids:.        com
-00017d30: 6d6f 6e2e 434f 554e 5453 5b73 7472 6561  mon.COUNTS[strea
-00017d40: 6d5f 6964 5d20 2b3d 2072 6f77 735f 7361  m_id] += rows_sa
-00017d50: 7665 645b 7374 7265 616d 5f69 645d 0a20  ved[stream_id]. 
-00017d60: 2020 2020 2020 2063 6f6d 6d6f 6e2e 5449         common.TI
-00017d70: 4d45 535b 7374 7265 616d 5f69 645d 202b  MES[stream_id] +
-00017d80: 3d20 7469 6d65 2e74 696d 6528 2920 2d20  = time.time() - 
-00017d90: 7374 6172 745f 7469 6d65 0a20 2020 2020  start_time.     
-00017da0: 2020 204c 4f47 4745 522e 696e 666f 2827     LOGGER.info('
-00017db0: 5379 6e63 6420 2573 2072 6563 6f72 6473  Syncd %s records
-00017dc0: 2066 6f72 2025 7327 2c20 726f 7773 5f73   for %s', rows_s
-00017dd0: 6176 6564 5b73 7472 6561 6d5f 6964 5d2c  aved[stream_id],
-00017de0: 2073 7472 6561 6d5f 6964 290a 0a0a 6465   stream_id)...de
-00017df0: 6620 666c 7573 685f 6275 6666 6572 2862  f flush_buffer(b
-00017e00: 7566 6665 723a 2044 6963 745b 7374 722c  uffer: Dict[str,
-00017e10: 2053 6574 5d2c 2073 7472 6561 6d73 3a20   Set], streams: 
-00017e20: 4469 6374 5b73 7472 2c20 4469 6374 5d2c  Dict[str, Dict],
-00017e30: 2064 6174 6162 6173 653a 2044 6174 6162   database: Datab
-00017e40: 6173 652c 2072 6f77 735f 7361 7665 643a  ase, rows_saved:
-00017e50: 2044 6963 745b 7374 722c 2069 6e74 5d29   Dict[str, int])
-00017e60: 3a0a 2020 2020 2222 220a 2020 2020 466c  :.    """.    Fl
-00017e70: 7573 6820 616e 6420 7265 7365 7420 7468  ush and reset th
-00017e80: 6520 6769 7665 6e20 6275 6666 6572 2c20  e given buffer, 
-00017e90: 6974 2069 6e63 7265 6d65 6e74 7320 7468  it increments th
-00017ea0: 6520 726f 775f 7361 7665 6420 636f 756e  e row_saved coun
-00017eb0: 7420 696e 2074 6865 2067 6976 656e 2072  t in the given r
-00017ec0: 6f77 735f 7361 7665 6420 6469 6374 696f  ows_saved dictio
-00017ed0: 6e61 7279 0a20 2020 2041 7267 733a 0a20  nary.    Args:. 
-00017ee0: 2020 2020 2020 2064 6174 6162 6173 653a         database:
-00017ef0: 206d 6f6e 676f 4442 2044 4220 696e 7374   mongoDB DB inst
-00017f00: 616e 6365 0a20 2020 2020 2020 2062 7566  ance.        buf
-00017f10: 6665 723a 2041 2073 6574 206f 6620 726f  fer: A set of ro
-00017f20: 7773 2074 6f20 666c 7573 6820 7065 7220  ws to flush per 
-00017f30: 7374 7265 616d 0a20 2020 2020 2020 2073  stream.        s
-00017f40: 7472 6561 6d73 3a20 7374 7265 616d 7320  treams: streams 
-00017f50: 7768 6f73 6520 726f 7773 2074 6f20 666c  whose rows to fl
-00017f60: 7573 680a 2020 2020 2020 2020 726f 7773  ush.        rows
-00017f70: 5f73 6176 6564 3a20 6d61 7020 6f66 2073  _saved: map of s
-00017f80: 7472 6561 6d73 2074 6f20 6e75 6d62 6572  treams to number
-00017f90: 206f 6620 726f 7773 2073 6176 6564 2c20   of rows saved, 
-00017fa0: 7468 6973 2064 6963 7469 6f6e 6172 7920  this dictionary 
-00017fb0: 6e65 6564 7320 746f 2062 6520 696e 6372  needs to be incr
-00017fc0: 656d 656e 7465 640a 2020 2020 5265 7475  emented.    Retu
-00017fd0: 726e 733a 0a0a 2020 2020 2222 220a 2020  rns:..    """.  
-00017fe0: 2020 2320 666c 7573 6820 616c 6c20 7374    # flush all st
-00017ff0: 7265 616d 7320 6275 6666 6572 730a 2020  reams buffers.  
-00018000: 2020 666f 7220 7374 7265 616d 5f69 642c    for stream_id,
-00018010: 2073 7472 6561 6d5f 6275 6666 6572 2069   stream_buffer i
-00018020: 6e20 6275 6666 6572 2e69 7465 6d73 2829  n buffer.items()
-00018030: 3a0a 0a20 2020 2020 2020 2069 6620 7374  :..        if st
-00018040: 7265 616d 5f62 7566 6665 723a 0a20 2020  ream_buffer:.   
-00018050: 2020 2020 2020 2020 2073 7472 6561 6d20           stream 
-00018060: 3d20 7374 7265 616d 735b 7374 7265 616d  = streams[stream
-00018070: 5f69 645d 0a0a 2020 2020 2020 2020 2020  _id]..          
-00018080: 2020 666f 7220 6275 6666 6572 6564 5f72    for buffered_r
-00018090: 6f77 2069 6e20 6765 745f 6275 6666 6572  ow in get_buffer
-000180a0: 5f72 6f77 735f 6672 6f6d 5f64 6228 6461  _rows_from_db(da
-000180b0: 7461 6261 7365 5b73 7472 6561 6d5b 2774  tabase[stream['t
-000180c0: 6162 6c65 5f6e 616d 6527 5d5d 2c0a 2020  able_name']],.  
+00016ae0: 2020 2020 2020 2029 202d 3e20 4765 6e65         ) -> Gene
+00016af0: 7261 746f 723a 0a20 2020 2022 2222 0a20  rator:.    """. 
+00016b00: 2020 2046 6574 6368 6573 2074 6865 2066     Fetches the f
+00016b10: 756c 6c20 646f 6375 6d65 6e74 7320 6f66  ull documents of
+00016b20: 2074 6865 2049 4473 2069 6e20 7468 6520   the IDs in the 
+00016b30: 6275 6666 6572 2066 726f 6d20 7468 6520  buffer from the 
+00016b40: 4442 0a20 2020 2041 7267 733a 0a20 2020  DB.    Args:.   
+00016b50: 2020 2020 2063 6f6c 6c65 6374 696f 6e3a       collection:
+00016b60: 204d 6f6e 676f 4442 2043 6f6c 6c65 6374   MongoDB Collect
+00016b70: 696f 6e20 696e 7374 616e 6365 0a20 2020  ion instance.   
+00016b80: 2020 2020 2075 7064 6174 655f 6275 6666       update_buff
+00016b90: 6572 3a20 4120 7365 7420 6f66 2049 4473  er: A set of IDs
+00016ba0: 2077 686f 7365 2064 6f63 756d 656e 7473   whose documents
+00016bb0: 206e 6565 6473 2074 6f20 6265 2066 6574   needs to be fet
+00016bc0: 6368 6564 0a20 2020 2052 6574 7572 6e73  ched.    Returns
+00016bd0: 3a0a 2020 2020 2020 2020 6765 6e65 7261  :.        genera
+00016be0: 746f 723a 2069 7420 6361 6e20 6265 2065  tor: it can be e
+00016bf0: 6d70 7479 0a20 2020 2022 2222 0a20 2020  mpty.    """.   
+00016c00: 2071 7565 7279 203d 207b 275f 6964 273a   query = {'_id':
+00016c10: 207b 2724 696e 273a 206c 6973 7428 7570   {'$in': list(up
+00016c20: 6461 7465 5f62 7566 6665 7229 7d7d 0a0a  date_buffer)}}..
+00016c30: 2020 2020 7769 7468 2063 6f6c 6c65 6374      with collect
+00016c40: 696f 6e2e 6669 6e64 2871 7565 7279 2920  ion.find(query) 
+00016c50: 6173 2063 7572 736f 723a 0a20 2020 2020  as cursor:.     
+00016c60: 2020 2079 6965 6c64 2066 726f 6d20 6375     yield from cu
+00016c70: 7273 6f72 0a0a 0a64 6566 2067 6574 5f74  rsor...def get_t
+00016c80: 6f6b 656e 5f66 726f 6d5f 7374 6174 6528  oken_from_state(
+00016c90: 7374 7265 616d 735f 746f 5f73 796e 633a  streams_to_sync:
+00016ca0: 2053 6574 5b73 7472 5d2c 2073 7461 7465   Set[str], state
+00016cb0: 3a20 4469 6374 2920 2d3e 204f 7074 696f  : Dict) -> Optio
+00016cc0: 6e61 6c5b 4469 6374 5d3a 0a20 2020 2022  nal[Dict]:.    "
+00016cd0: 2222 0a20 2020 2045 7874 7261 6374 2074  "".    Extract t
+00016ce0: 6865 2073 6d61 6c6c 6573 7420 6e6f 6e20  he smallest non 
+00016cf0: 6e75 6c6c 2072 6573 756d 6520 746f 6b65  null resume toke
+00016d00: 6e0a 2020 2020 4172 6773 3a0a 2020 2020  n.    Args:.    
+00016d10: 2020 2020 7374 7265 616d 735f 746f 5f73      streams_to_s
+00016d20: 796e 633a 2073 6574 206f 6620 6c6f 6720  ync: set of log 
+00016d30: 6261 7365 6420 7374 7265 616d 730a 2020  based streams.  
+00016d40: 2020 2020 2020 7374 6174 653a 2073 7461        state: sta
+00016d50: 7465 2064 6963 7469 6f6e 6172 790a 0a20  te dictionary.. 
+00016d60: 2020 2052 6574 7572 6e73 3a20 7265 7375     Returns: resu
+00016d70: 6d65 2074 6f6b 656e 2069 6620 666f 756e  me token if foun
+00016d80: 642c 204e 6f6e 6520 6f74 6865 7277 6973  d, None otherwis
+00016d90: 650a 0a20 2020 2022 2222 0a20 2020 2074  e..    """.    t
+00016da0: 6f6b 656e 5f73 6f72 7465 6420 3d20 736f  oken_sorted = so
+00016db0: 7274 6564 285b 7374 7265 616d 5f73 7461  rted([stream_sta
+00016dc0: 7465 5b52 4553 554d 455f 544f 4b45 4e5f  te[RESUME_TOKEN_
+00016dd0: 4b45 595d 0a20 2020 2020 2020 2020 2020  KEY].           
+00016de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016df0: 666f 7220 7374 7265 616d 5f6e 616d 652c  for stream_name,
+00016e00: 2073 7472 6561 6d5f 7374 6174 6520 696e   stream_state in
+00016e10: 2073 7461 7465 2e67 6574 2827 626f 6f6b   state.get('book
+00016e20: 6d61 726b 7327 2c20 7b7d 292e 6974 656d  marks', {}).item
+00016e30: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+00016e40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00016e50: 6620 7374 7265 616d 5f6e 616d 6520 696e  f stream_name in
+00016e60: 2073 7472 6561 6d73 5f74 6f5f 7379 6e63   streams_to_sync
+00016e70: 2061 6e64 2073 7472 6561 6d5f 7374 6174   and stream_stat
+00016e80: 652e 6765 7428 5245 5355 4d45 5f54 4f4b  e.get(RESUME_TOK
+00016e90: 454e 5f4b 4559 2920 6973 206e 6f74 204e  EN_KEY) is not N
+00016ea0: 6f6e 655d 2c0a 2020 2020 2020 2020 2020  one],.          
+00016eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ec0: 6b65 793d 6c61 6d62 6461 206b 6579 3a20  key=lambda key: 
+00016ed0: 6b65 795b 275f 6461 7461 275d 290a 0a20  key['_data']).. 
+00016ee0: 2020 2072 6574 7572 6e20 746f 6b65 6e5f     return token_
+00016ef0: 736f 7274 6564 5b30 5d20 6966 2074 6f6b  sorted[0] if tok
+00016f00: 656e 5f73 6f72 7465 6420 656c 7365 204e  en_sorted else N
+00016f10: 6f6e 650a 0a0a 6465 6620 7379 6e63 5f64  one...def sync_d
+00016f20: 6174 6162 6173 6528 6461 7461 6261 7365  atabase(database
+00016f30: 3a20 4461 7461 6261 7365 2c0a 2020 2020  : Database,.    
+00016f40: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00016f50: 7265 616d 735f 746f 5f73 796e 633a 2044  reams_to_sync: D
+00016f60: 6963 745b 7374 722c 2044 6963 745d 2c0a  ict[str, Dict],.
+00016f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f80: 2020 7374 6174 653a 2044 6963 742c 0a20    state: Dict,. 
+00016f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016fa0: 2075 7064 6174 655f 6275 6666 6572 5f73   update_buffer_s
+00016fb0: 697a 653a 2069 6e74 2c0a 2020 2020 2020  ize: int,.      
+00016fc0: 2020 2020 2020 2020 2020 2020 6177 6169              awai
+00016fd0: 745f 7469 6d65 5f6d 733a 2069 6e74 2c0a  t_time_ms: int,.
+00016fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ff0: 2020 6675 6c6c 5f6c 6f61 645f 6f6e 5f65    full_load_on_e
+00017000: 6d70 7479 5f73 7461 7465 3a20 626f 6f6c  mpty_state: bool
+00017010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017020: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00017030: 2020 2222 220a 2020 2020 5379 6e63 7320    """.    Syncs 
+00017040: 7468 6520 7265 636f 7264 7320 6672 6f6d  the records from
+00017050: 2074 6865 2067 6976 656e 2063 6f6c 6c65   the given colle
+00017060: 6374 696f 6e20 7573 696e 6720 4368 616e  ction using Chan
+00017070: 6765 5374 7265 616d 730a 2020 2020 4172  geStreams.    Ar
+00017080: 6773 3a0a 2020 2020 2020 2020 6461 7461  gs:.        data
+00017090: 6261 7365 3a20 4d6f 6e67 6f44 4220 4461  base: MongoDB Da
+000170a0: 7461 6261 7365 2069 6e73 7461 6e63 6520  tabase instance 
+000170b0: 746f 2073 796e 630a 2020 2020 2020 2020  to sync.        
+000170c0: 7374 7265 616d 735f 746f 5f73 796e 633a  streams_to_sync:
+000170d0: 2044 6963 7420 6f66 2073 7472 6561 6d20   Dict of stream 
+000170e0: 6469 6374 696f 6e61 7279 2077 6974 6820  dictionary with 
+000170f0: 616c 6c20 7468 6520 7374 7265 616d 2064  all the stream d
+00017100: 6574 6169 6c73 0a20 2020 2020 2020 2073  etails.        s
+00017110: 7461 7465 3a20 7374 6174 6520 6469 6374  tate: state dict
+00017120: 696f 6e61 7279 0a20 2020 2020 2020 2075  ionary.        u
+00017130: 7064 6174 655f 6275 6666 6572 5f73 697a  pdate_buffer_siz
+00017140: 653a 2074 6865 2073 697a 6520 6f66 2062  e: the size of b
+00017150: 7566 6665 7220 7573 6564 2074 6f20 686f  uffer used to ho
+00017160: 6c64 2064 6574 6563 7465 6420 7570 6461  ld detected upda
+00017170: 7465 730a 2020 2020 2020 2020 6177 6169  tes.        awai
+00017180: 745f 7469 6d65 5f6d 733a 2020 7468 6520  t_time_ms:  the 
+00017190: 6d61 7869 6d75 6d20 7469 6d65 2069 6e20  maximum time in 
+000171a0: 6d69 6c6c 6973 6563 6f6e 6473 2066 6f72  milliseconds for
+000171b0: 2074 6865 206c 6f67 2062 6173 6564 2074   the log based t
+000171c0: 6f20 7761 6974 2066 6f72 2063 6861 6e67  o wait for chang
+000171d0: 6573 2062 6566 6f72 6520 6578 6974 696e  es before exitin
+000171e0: 670a 2020 2020 2222 220a 2020 2020 4c4f  g.    """.    LO
+000171f0: 4747 4552 2e69 6e66 6f28 2753 7461 7274  GGER.info('Start
+00017200: 696e 6720 4c6f 6742 6173 6564 2073 796e  ing LogBased syn
+00017210: 6320 666f 7220 7374 7265 616d 7320 2225  c for streams "%
+00017220: 7322 2069 6e20 6461 7461 6261 7365 2022  s" in database "
+00017230: 2573 2227 2c20 6c69 7374 2873 7472 6561  %s"', list(strea
+00017240: 6d73 5f74 6f5f 7379 6e63 2e6b 6579 7328  ms_to_sync.keys(
+00017250: 2929 2c20 6461 7461 6261 7365 2e6e 616d  )), database.nam
+00017260: 6529 0a0a 2020 2020 726f 7773 5f73 6176  e)..    rows_sav
+00017270: 6564 203d 207b 7d0a 2020 2020 7374 6172  ed = {}.    star
+00017280: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
+00017290: 6d65 2829 0a20 2020 2075 7064 6174 655f  me().    update_
+000172a0: 6275 6666 6572 203d 207b 7d0a 2020 2020  buffer = {}.    
+000172b0: 6675 6c6c 5f6c 6f61 6420 3d20 6c69 7374  full_load = list
+000172c0: 2829 0a0a 2020 2020 666f 7220 7374 7265  ()..    for stre
+000172d0: 616d 5f69 6420 696e 2073 7472 6561 6d73  am_id in streams
+000172e0: 5f74 6f5f 7379 6e63 3a0a 2020 2020 2020  _to_sync:.      
+000172f0: 2020 7570 6461 7465 5f62 7566 6665 725b    update_buffer[
+00017300: 7374 7265 616d 5f69 645d 203d 2073 6574  stream_id] = set
+00017310: 2829 0a20 2020 2020 2020 2072 6f77 735f  ().        rows_
+00017320: 7361 7665 645b 7374 7265 616d 5f69 645d  saved[stream_id]
+00017330: 203d 2030 0a20 2020 2020 2020 2069 6620   = 0.        if 
+00017340: 6675 6c6c 5f6c 6f61 645f 6f6e 5f65 6d70  full_load_on_emp
+00017350: 7479 5f73 7461 7465 3a0a 2020 2020 2020  ty_state:.      
+00017360: 2020 2020 2020 2320 6765 7420 7374 7265        # get stre
+00017370: 616d 7320 7768 6572 6520 6e6f 2070 7265  ams where no pre
+00017380: 7669 6f75 7320 746f 6b65 6e20 6578 6973  vious token exis
+00017390: 7473 2069 6e20 7374 6174 650a 2020 2020  ts in state.    
+000173a0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+000173b0: 696e 6765 722e 6765 745f 626f 6f6b 6d61  inger.get_bookma
+000173c0: 726b 2873 7461 7465 2c20 7374 7265 616d  rk(state, stream
+000173d0: 5f69 642c 2027 746f 6b65 6e27 293a 0a20  _id, 'token'):. 
+000173e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000173f0: 756c 6c5f 6c6f 6164 2e61 7070 656e 6428  ull_load.append(
+00017400: 7374 7265 616d 5f69 6429 0a0a 0a20 2020  stream_id)...   
+00017410: 2073 7472 6561 6d5f 6964 7320 3d20 7365   stream_ids = se
+00017420: 7428 7374 7265 616d 735f 746f 5f73 796e  t(streams_to_syn
+00017430: 632e 6b65 7973 2829 290a 0a20 2020 2023  c.keys())..    #
+00017440: 2070 6572 666f 726d 2066 756c 6c20 6c6f   perform full lo
+00017450: 6164 2069 6620 6e6f 2070 7265 7669 6f75  ad if no previou
+00017460: 7320 746f 6b65 6e20 6578 6973 7473 0a20  s token exists. 
+00017470: 2020 2069 6620 6675 6c6c 5f6c 6f61 645f     if full_load_
+00017480: 6f6e 5f65 6d70 7479 5f73 7461 7465 3a0a  on_empty_state:.
+00017490: 2020 2020 2020 2020 666f 7220 7461 705f          for tap_
+000174a0: 7374 7265 616d 5f69 6420 696e 2066 756c  stream_id in ful
+000174b0: 6c5f 6c6f 6164 3a0a 2020 2020 2020 2020  l_load:.        
+000174c0: 2020 2020 7461 626c 655f 6e61 6d65 203d      table_name =
+000174d0: 2073 7472 6561 6d73 5f74 6f5f 7379 6e63   streams_to_sync
+000174e0: 5b74 6170 5f73 7472 6561 6d5f 6964 5d2e  [tap_stream_id].
+000174f0: 6765 7428 2774 6162 6c65 5f6e 616d 6527  get('table_name'
+00017500: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+00017510: 6c6c 6563 7469 6f6e 203d 2064 6174 6162  llection = datab
+00017520: 6173 655b 7461 626c 655f 6e61 6d65 5d0a  ase[table_name].
+00017530: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
+00017540: 4f44 4f3a 2061 6464 2062 6174 6368 6573  ODO: add batches
+00017550: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
+00017560: 6820 636f 6c6c 6563 7469 6f6e 2e66 696e  h collection.fin
+00017570: 6428 736f 7274 3d5b 2822 5f69 6422 2c20  d(sort=[("_id", 
+00017580: 7079 6d6f 6e67 6f2e 4153 4345 4e44 494e  pymongo.ASCENDIN
+00017590: 4729 5d29 2061 7320 6375 7273 6f72 3a0a  G)]) as cursor:.
+000175a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000175b0: 666f 7220 726f 7720 696e 2063 7572 736f  for row in curso
+000175c0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+000175d0: 2020 2020 2020 2072 6f77 735f 7361 7665         rows_save
+000175e0: 645b 7461 705f 7374 7265 616d 5f69 645d  d[tap_stream_id]
+000175f0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+00017600: 2020 2020 2020 2020 2020 7369 6e67 6572            singer
+00017610: 2e77 7269 7465 5f6d 6573 7361 6765 2863  .write_message(c
+00017620: 6f6d 6d6f 6e2e 726f 775f 746f 5f73 696e  ommon.row_to_sin
+00017630: 6765 725f 7265 636f 7264 2873 7472 6561  ger_record(strea
+00017640: 6d3d 7374 7265 616d 735f 746f 5f73 796e  m=streams_to_syn
+00017650: 635b 7461 705f 7374 7265 616d 5f69 645d  c[tap_stream_id]
+00017660: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176a0: 2020 2020 2020 726f 773d 726f 772c 0a20        row=row,. 
+000176b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176f0: 2020 2074 696d 655f 6578 7472 6163 7465     time_extracte
+00017700: 643d 7574 696c 732e 6e6f 7728 292c 0a20  d=utils.now(),. 
+00017710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017750: 2020 2074 696d 655f 6465 6c65 7465 643d     time_deleted=
+00017760: 4e6f 6e65 2929 0a0a 2020 2020 2320 496e  None))..    # In
+00017770: 6974 2061 2063 7572 736f 7220 746f 206c  it a cursor to l
+00017780: 6973 7465 6e20 666f 7220 6368 616e 6765  isten for change
+00017790: 7320 6672 6f6d 2074 6865 206c 6173 7420  s from the last 
+000177a0: 7361 7665 6420 7265 7375 6d65 2074 6f6b  saved resume tok
+000177b0: 656e 0a20 2020 2023 2069 6620 7468 6572  en.    # if ther
+000177c0: 6520 6172 6520 6e6f 2063 6861 6e67 6573  e are no changes
+000177d0: 2061 6674 6572 204d 4158 5f41 5741 4954   after MAX_AWAIT
+000177e0: 5f54 494d 455f 4d53 2c20 7468 656e 2077  _TIME_MS, then w
+000177f0: 6527 6c6c 2065 7869 740a 2020 2020 7769  e'll exit.    wi
+00017800: 7468 2064 6174 6162 6173 652e 7761 7463  th database.watc
+00017810: 6828 0a20 2020 2020 2020 2020 2020 205b  h(.            [
+00017820: 7b27 246d 6174 6368 273a 207b 0a20 2020  {'$match': {.   
+00017830: 2020 2020 2020 2020 2020 2020 2027 246f               '$o
+00017840: 7227 3a20 5b0a 2020 2020 2020 2020 2020  r': [.          
+00017850: 2020 2020 2020 2020 2020 7b27 6f70 6572            {'oper
+00017860: 6174 696f 6e54 7970 6527 3a20 2769 6e73  ationType': 'ins
+00017870: 6572 7427 7d2c 207b 276f 7065 7261 7469  ert'}, {'operati
+00017880: 6f6e 5479 7065 273a 2027 7570 6461 7465  onType': 'update
+00017890: 277d 2c20 7b27 6f70 6572 6174 696f 6e54  '}, {'operationT
+000178a0: 7970 6527 3a20 2764 656c 6574 6527 7d0a  ype': 'delete'}.
+000178b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000178c0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+000178d0: 2020 2027 2461 6e64 273a 205b 0a20 2020     '$and': [.   
+000178e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000178f0: 2023 2077 6174 6368 2063 6f6c 6c65 6374   # watch collect
+00017900: 696f 6e73 206f 6620 7365 6c65 6374 6564  ions of selected
+00017910: 2073 7472 6561 6d73 0a20 2020 2020 2020   streams.       
+00017920: 2020 2020 2020 2020 2020 2020 207b 276e               {'n
+00017930: 732e 636f 6c6c 273a 207b 2724 696e 273a  s.coll': {'$in':
+00017940: 205b 7661 6c5b 2774 6162 6c65 5f6e 616d   [val['table_nam
+00017950: 6527 5d20 666f 7220 7661 6c20 696e 2073  e'] for val in s
+00017960: 7472 6561 6d73 5f74 6f5f 7379 6e63 2e76  treams_to_sync.v
+00017970: 616c 7565 7328 295d 7d7d 0a20 2020 2020  alues()]}}.     
+00017980: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00017990: 2020 2020 2020 2020 207d 7d5d 2c0a 2020           }}],.  
+000179a0: 2020 2020 2020 2020 2020 6d61 785f 6177            max_aw
+000179b0: 6169 745f 7469 6d65 5f6d 733d 6177 6169  ait_time_ms=awai
+000179c0: 745f 7469 6d65 5f6d 732c 0a20 2020 2020  t_time_ms,.     
+000179d0: 2020 2020 2020 2073 7461 7274 5f61 6674         start_aft
+000179e0: 6572 3d67 6574 5f74 6f6b 656e 5f66 726f  er=get_token_fro
+000179f0: 6d5f 7374 6174 6528 7374 7265 616d 5f69  m_state(stream_i
+00017a00: 6473 2c20 7374 6174 6529 0a20 2020 2029  ds, state).    )
+00017a10: 2061 7320 6375 7273 6f72 3a0a 2020 2020   as cursor:.    
+00017a20: 2020 2020 7768 696c 6520 6375 7273 6f72      while cursor
+00017a30: 2e61 6c69 7665 3a0a 0a20 2020 2020 2020  .alive:..       
+00017a40: 2020 2020 2063 6861 6e67 6520 3d20 6375       change = cu
+00017a50: 7273 6f72 2e74 7279 5f6e 6578 7428 290a  rsor.try_next().
+00017a60: 0a20 2020 2020 2020 2020 2020 2023 204e  .            # N
+00017a70: 6f74 6520 7468 6174 2074 6865 2043 6861  ote that the Cha
+00017a80: 6e67 6553 7472 6561 6d27 7320 7265 7375  ngeStream's resu
+00017a90: 6d65 2074 6f6b 656e 206d 6179 2062 6520  me token may be 
+00017aa0: 7570 6461 7465 640a 2020 2020 2020 2020  updated.        
+00017ab0: 2020 2020 2320 6576 656e 2077 6865 6e20      # even when 
+00017ac0: 6e6f 2063 6861 6e67 6573 2061 7265 2072  no changes are r
+00017ad0: 6574 7572 6e65 642e 0a0a 2020 2020 2020  eturned...      
+00017ae0: 2020 2020 2020 2320 546f 6b65 6e20 6361        # Token ca
+00017af0: 6e20 6c6f 6f6b 206c 696b 6520 696e 204d  n look like in M
+00017b00: 6f6e 676f 4442 2034 2e32 3a0a 2020 2020  ongoDB 4.2:.    
+00017b10: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+00017b20: 7b27 5f64 6174 6127 3a20 2741 5f4c 4f4e  {'_data': 'A_LON
+00017b30: 475f 4845 585f 4445 4349 4d41 4c5f 5354  G_HEX_DECIMAL_ST
+00017b40: 5249 4e47 277d 0a20 2020 2020 2020 2020  RING'}.         
+00017b50: 2020 2023 2020 2020 6f72 207b 275f 6461     #    or {'_da
+00017b60: 7461 273a 2027 415f 4c4f 4e47 5f48 4558  ta': 'A_LONG_HEX
+00017b70: 5f44 4543 494d 414c 5f53 5452 494e 4727  _DECIMAL_STRING'
+00017b80: 2c20 275f 7479 7065 4269 7473 273a 2062  , '_typeBits': b
+00017b90: 2753 4f4d 455f 4845 5827 7d0a 0a20 2020  'SOME_HEX'}..   
+00017ba0: 2020 2020 2020 2020 2023 2047 6574 2074           # Get t
+00017bb0: 6865 2027 5f64 6174 6127 206f 6e6c 7920  he '_data' only 
+00017bc0: 6672 6f6d 2072 6573 756d 6520 746f 6b65  from resume toke
+00017bd0: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
+00017be0: 746f 6b65 6e20 6361 6e20 636f 6e74 6169  token can contai
+00017bf0: 6e20 6120 7072 6f70 6572 7479 2027 5f74  n a property '_t
+00017c00: 7970 6542 6974 7327 206f 6620 7479 7065  ypeBits' of type
+00017c10: 2062 7974 6573 2077 6869 6368 2063 616e   bytes which can
+00017c20: 6e6f 7420 6265 206a 736f 6e0a 2020 2020  not be json.    
+00017c30: 2020 2020 2020 2020 2320 7365 7269 616c          # serial
+00017c40: 697a 6564 2077 6865 6e20 6372 6561 7469  ized when creati
+00017c50: 6e67 2074 6865 2073 7461 7465 2e0a 2020  ng the state..  
+00017c60: 2020 2020 2020 2020 2020 2320 275f 6461            # '_da
+00017c70: 7461 2720 6973 2065 6e6f 7567 6820 746f  ta' is enough to
+00017c80: 2072 6573 756d 6520 4c4f 475f 4241 5345   resume LOG_BASE
+00017c90: 440a 2020 2020 2020 2020 2020 2020 7265  D.            re
+00017ca0: 7375 6d65 5f74 6f6b 656e 203d 207b 0a20  sume_token = {. 
+00017cb0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00017cc0: 5f64 6174 6127 3a20 6375 7273 6f72 2e72  _data': cursor.r
+00017cd0: 6573 756d 655f 746f 6b65 6e5b 275f 6461  esume_token['_da
+00017ce0: 7461 275d 0a20 2020 2020 2020 2020 2020  ta'].           
+00017cf0: 207d 0a0a 2020 2020 2020 2020 2020 2020   }..            
+00017d00: 2320 4166 7465 7220 4d41 585f 4157 4149  # After MAX_AWAI
+00017d10: 545f 5449 4d45 5f4d 5320 6861 7320 656c  T_TIME_MS has el
+00017d20: 6170 7365 642c 2074 6865 2063 7572 736f  apsed, the curso
+00017d30: 7220 7769 6c6c 2072 6574 7572 6e20 4e6f  r will return No
+00017d40: 6e65 2e0a 2020 2020 2020 2020 2020 2020  ne..            
+00017d50: 2320 7772 6974 6520 7374 6174 6520 616e  # write state an
+00017d60: 6420 6578 6974 0a20 2020 2020 2020 2020  d exit.         
+00017d70: 2020 2069 6620 6368 616e 6765 2069 7320     if change is 
+00017d80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00017d90: 2020 2020 2020 4c4f 4747 4552 2e69 6e66        LOGGER.inf
+00017da0: 6f28 274e 6f20 6368 616e 6765 2073 7472  o('No change str
+00017db0: 6561 6d73 2061 6674 6572 2025 732c 2075  eams after %s, u
+00017dc0: 7064 6174 696e 6720 626f 6f6b 6d61 726b  pdating bookmark
+00017dd0: 2061 6e64 2065 7869 7469 6e67 2e2e 2e27   and exiting...'
+00017de0: 2c20 6177 6169 745f 7469 6d65 5f6d 7329  , await_time_ms)
+00017df0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017e00: 2020 7374 6174 6520 3d20 7570 6461 7465    state = update
+00017e10: 5f62 6f6f 6b6d 6172 6b73 2873 7461 7465  _bookmarks(state
+00017e20: 2c20 7374 7265 616d 5f69 6473 2c20 7265  , stream_ids, re
+00017e30: 7375 6d65 5f74 6f6b 656e 290a 2020 2020  sume_token).    
+00017e40: 2020 2020 2020 2020 2020 2020 7369 6e67              sing
+00017e50: 6572 2e77 7269 7465 5f6d 6573 7361 6765  er.write_message
+00017e60: 2873 696e 6765 722e 5374 6174 654d 6573  (singer.StateMes
+00017e70: 7361 6765 2876 616c 7565 3d63 6f70 792e  sage(value=copy.
+00017e80: 6465 6570 636f 7079 2873 7461 7465 2929  deepcopy(state))
+00017e90: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00017ea0: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
+00017eb0: 2020 2020 2020 6461 7461 6261 7365 5f6e        database_n
+00017ec0: 616d 6520 3d20 6368 616e 6765 5b22 6e73  ame = change["ns
+00017ed0: 225d 5b22 6462 225d 0a20 2020 2020 2020  "]["db"].       
+00017ee0: 2020 2020 2023 2072 656d 6f76 6520 7468       # remove th
+00017ef0: 6520 7072 6566 6978 2066 726f 6d20 7468  e prefix from th
+00017f00: 6520 6461 7461 6261 7365 206e 616d 650a  e database name.
+00017f10: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00017f20: 6261 7365 5f6e 616d 6520 3d20 6461 7461  base_name = data
+00017f30: 6261 7365 5f6e 616d 652e 7370 6c69 7428  base_name.split(
+00017f40: 275f 272c 2031 295b 2d31 5d0a 2020 2020  '_', 1)[-1].    
+00017f50: 2020 2020 2020 2020 7461 705f 7374 7265          tap_stre
+00017f60: 616d 5f69 6420 3d20 6627 7b64 6174 6162  am_id = f'{datab
+00017f70: 6173 655f 6e61 6d65 7d2d 7b63 6861 6e67  ase_name}-{chang
+00017f80: 655b 226e 7322 5d5b 2263 6f6c 6c22 5d7d  e["ns"]["coll"]}
+00017f90: 270a 0a20 2020 2020 2020 2020 2020 206f  '..            o
+00017fa0: 7065 7261 7469 6f6e 203d 2063 6861 6e67  peration = chang
+00017fb0: 655b 276f 7065 7261 7469 6f6e 5479 7065  e['operationType
+00017fc0: 275d 0a0a 2020 2020 2020 2020 2020 2020  ']..            
+00017fd0: 6966 206f 7065 7261 7469 6f6e 203d 3d20  if operation == 
+00017fe0: 2769 6e73 6572 7427 3a0a 2020 2020 2020  'insert':.      
+00017ff0: 2020 2020 2020 2020 2020 7369 6e67 6572            singer
+00018000: 2e77 7269 7465 5f6d 6573 7361 6765 2863  .write_message(c
+00018010: 6f6d 6d6f 6e2e 726f 775f 746f 5f73 696e  ommon.row_to_sin
+00018020: 6765 725f 7265 636f 7264 2873 7472 6561  ger_record(strea
+00018030: 6d3d 7374 7265 616d 735f 746f 5f73 796e  m=streams_to_syn
+00018040: 635b 7461 705f 7374 7265 616d 5f69 645d  c[tap_stream_id]
+00018050: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018090: 2020 2072 6f77 3d63 6861 6e67 655b 2766     row=change['f
+000180a0: 756c 6c44 6f63 756d 656e 7427 5d2c 0a20  ullDocument'],. 
+000180b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000180d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000180e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000180f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018100: 2020 2020 2020 7374 7265 616d 5f62 7566        stream_buf
-00018110: 6665 7229 3a0a 2020 2020 2020 2020 2020  fer):.          
-00018120: 2020 2020 2020 7265 636f 7264 5f6d 6573        record_mes
-00018130: 7361 6765 203d 2063 6f6d 6d6f 6e2e 726f  sage = common.ro
-00018140: 775f 746f 5f73 696e 6765 725f 7265 636f  w_to_singer_reco
-00018150: 7264 2873 7472 6561 6d3d 7374 7265 616d  rd(stream=stream
-00018160: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00018170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018190: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000181a0: 6f77 3d62 7566 6665 7265 645f 726f 772c  ow=buffered_row,
-000181b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000181c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181e0: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-000181f0: 6d65 5f65 7874 7261 6374 6564 3d75 7469  me_extracted=uti
-00018200: 6c73 2e6e 6f77 2829 2c0a 2020 2020 2020  ls.now(),.      
-00018210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018240: 2020 2020 2020 2074 696d 655f 6465 6c65         time_dele
-00018250: 7465 643d 4e6f 6e65 290a 2020 2020 2020  ted=None).      
-00018260: 2020 2020 2020 2020 2020 7369 6e67 6572            singer
-00018270: 2e77 7269 7465 5f6d 6573 7361 6765 2872  .write_message(r
-00018280: 6563 6f72 645f 6d65 7373 6167 6529 0a0a  ecord_message)..
-00018290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182a0: 726f 7773 5f73 6176 6564 5b73 7472 6561  rows_saved[strea
-000182b0: 6d5f 6964 5d20 2b3d 2031 0a0a 2020 2020  m_id] += 1..    
-000182c0: 2020 2020 2020 2020 6275 6666 6572 5b73          buffer[s
-000182d0: 7472 6561 6d5f 6964 5d2e 636c 6561 7228  tream_id].clear(
-000182e0: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
-000182f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000183a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000183b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000183c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000183d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000183e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000183f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00018410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00018470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00018480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00018490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-000184a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000184b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000184c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000184d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000184e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000184f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00018510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000185a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000185b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000185c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000185d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000185e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000185f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018600: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00018610: 3137 312e 300a 0000 0000 0000 0000 0000  171.0...........
-00018620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000186f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000187f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018800: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00018810: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
-00018820: 5f73 7472 6174 6567 6965 732f 636f 6d6d  _strategies/comm
-00018830: 6f6e 2e70 7900 0000 0000 0000 0000 0000  on.py...........
-00018840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00018870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00018880: 3030 3232 3236 3100 3030 3030 3030 3030  0022261.00000000
-00018890: 3030 3000 3032 3430 3635 0020 3000 0000  000.024065. 0...
-000188a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000188b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000188c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000188d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000188e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000188f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018900: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00018910: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00018920: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
-00018930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000189a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000189b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000189c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000189d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000189e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000189f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00018a00: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
-00018a10: 7974 686f 6e33 0a69 6d70 6f72 7420 6261  ython3.import ba
-00018a20: 7365 3634 0a69 6d70 6f72 7420 6461 7465  se64.import date
-00018a30: 7469 6d65 0a69 6d70 6f72 7420 7469 6d65  time.import time
-00018a40: 0a69 6d70 6f72 7420 7575 6964 0a69 6d70  .import uuid.imp
-00018a50: 6f72 7420 6273 6f6e 0a69 6d70 6f72 7420  ort bson.import 
-00018a60: 7369 6e67 6572 0a69 6d70 6f72 7420 7079  singer.import py
-00018a70: 747a 0a69 6d70 6f72 7420 747a 6c6f 6361  tz.import tzloca
-00018a80: 6c0a 0a66 726f 6d20 7479 7069 6e67 2069  l..from typing i
-00018a90: 6d70 6f72 7420 4469 6374 2c20 416e 792c  mport Dict, Any,
-00018aa0: 204f 7074 696f 6e61 6c0a 6672 6f6d 2062   Optional.from b
-00018ab0: 736f 6e20 696d 706f 7274 206f 626a 6563  son import objec
-00018ac0: 7469 642c 2074 696d 6573 7461 6d70 2c20  tid, timestamp, 
-00018ad0: 6461 7465 7469 6d65 2061 7320 6273 6f6e  datetime as bson
-00018ae0: 5f64 6174 6574 696d 650a 6672 6f6d 2073  _datetime.from s
-00018af0: 696e 6765 7220 696d 706f 7274 2075 7469  inger import uti
-00018b00: 6c73 2c20 6d65 7461 6461 7461 0a66 726f  ls, metadata.fro
-00018b10: 6d20 7465 726d 696e 616c 7461 626c 6573  m terminaltables
-00018b20: 2069 6d70 6f72 7420 4173 6369 6954 6162   import AsciiTab
-00018b30: 6c65 0a0a 6672 6f6d 2064 7a5f 6d6f 6e67  le..from dz_mong
-00018b40: 6f64 622e 6572 726f 7273 2069 6d70 6f72  odb.errors impor
-00018b50: 7420 4d6f 6e67 6f49 6e76 616c 6964 4461  t MongoInvalidDa
-00018b60: 7465 5469 6d65 4578 6365 7074 696f 6e2c  teTimeException,
-00018b70: 2053 796e 6345 7863 6570 7469 6f6e 2c20   SyncException, 
-00018b80: 556e 7375 7070 6f72 7465 644b 6579 5479  UnsupportedKeyTy
-00018b90: 7065 4578 6365 7074 696f 6e0a 0a53 4443  peException..SDC
-00018ba0: 5f44 454c 4554 4544 5f41 5420 3d20 225f  _DELETED_AT = "_
-00018bb0: 7364 635f 6465 6c65 7465 645f 6174 220a  sdc_deleted_at".
-00018bc0: 494e 434c 5544 455f 5343 4845 4d41 535f  INCLUDE_SCHEMAS_
-00018bd0: 494e 5f44 4553 5449 4e41 5449 4f4e 5f53  IN_DESTINATION_S
-00018be0: 5452 4541 4d5f 4e41 4d45 203d 2046 616c  TREAM_NAME = Fal
-00018bf0: 7365 0a55 5044 4154 455f 424f 4f4b 4d41  se.UPDATE_BOOKMA
-00018c00: 524b 5f50 4552 494f 4420 3d20 3130 3030  RK_PERIOD = 1000
-00018c10: 0a43 4f55 4e54 5320 3d20 7b7d 0a54 494d  .COUNTS = {}.TIM
-00018c20: 4553 203d 207b 7d0a 5343 4845 4d41 5f43  ES = {}.SCHEMA_C
-00018c30: 4f55 4e54 203d 207b 7d0a 5343 4845 4d41  OUNT = {}.SCHEMA
-00018c40: 5f54 494d 4553 203d 207b 7d0a 0a0a 6465  _TIMES = {}...de
-00018c50: 6620 6361 6c63 756c 6174 655f 6465 7374  f calculate_dest
-00018c60: 696e 6174 696f 6e5f 7374 7265 616d 5f6e  ination_stream_n
-00018c70: 616d 6528 7374 7265 616d 3a20 4469 6374  ame(stream: Dict
-00018c80: 2920 2d3e 2073 7472 3a0a 2020 2020 2222  ) -> str:.    ""
-00018c90: 220a 2020 2020 4275 696c 6473 2074 6865  ".    Builds the
-00018ca0: 2072 6967 6874 2073 7472 6561 6d20 6e61   right stream na
-00018cb0: 6d65 2074 6f20 6265 2077 7269 7474 656e  me to be written
-00018cc0: 2069 6e20 7369 6e67 6572 206d 6573 7361   in singer messa
-00018cd0: 6765 730a 2020 2020 4172 6773 3a0a 2020  ges.    Args:.  
-00018ce0: 2020 2020 2020 7374 7265 616d 3a20 7374        stream: st
-00018cf0: 7265 616d 2064 6963 7469 6f6e 6172 790a  ream dictionary.
-00018d00: 0a20 2020 2052 6574 7572 6e73 3a20 7374  .    Returns: st
-00018d10: 7220 686f 6c64 696e 6720 7468 6520 7374  r holding the st
-00018d20: 7265 616d 206e 616d 650a 2020 2020 2222  ream name.    ""
-00018d30: 220a 2020 2020 735f 6d64 203d 206d 6574  ".    s_md = met
-00018d40: 6164 6174 612e 746f 5f6d 6170 2873 7472  adata.to_map(str
-00018d50: 6561 6d5b 276d 6574 6164 6174 6127 5d29  eam['metadata'])
-00018d60: 0a20 2020 2069 6620 494e 434c 5544 455f  .    if INCLUDE_
-00018d70: 5343 4845 4d41 535f 494e 5f44 4553 5449  SCHEMAS_IN_DESTI
-00018d80: 4e41 5449 4f4e 5f53 5452 4541 4d5f 4e41  NATION_STREAM_NA
-00018d90: 4d45 3a0a 2020 2020 2020 2020 7265 7475  ME:.        retu
-00018da0: 726e 2066 227b 735f 6d64 2e67 6574 2828  rn f"{s_md.get((
-00018db0: 292c 207b 7d29 2e67 6574 2827 6461 7461  ), {}).get('data
-00018dc0: 6261 7365 2d6e 616d 6527 297d 2d7b 7374  base-name')}-{st
-00018dd0: 7265 616d 5b27 7374 7265 616d 275d 7d22  ream['stream']}"
-00018de0: 0a0a 2020 2020 7265 7475 726e 2073 7472  ..    return str
-00018df0: 6561 6d5b 2773 7472 6561 6d27 5d0a 0a0a  eam['stream']...
-00018e00: 6465 6620 6765 745f 7374 7265 616d 5f76  def get_stream_v
-00018e10: 6572 7369 6f6e 2874 6170 5f73 7472 6561  ersion(tap_strea
-00018e20: 6d5f 6964 3a20 7374 722c 2073 7461 7465  m_id: str, state
-00018e30: 3a20 4469 6374 2920 2d3e 2069 6e74 3a0a  : Dict) -> int:.
-00018e40: 2020 2020 2222 220a 2020 2020 4765 7420      """.    Get 
-00018e50: 7468 6520 7374 7265 616d 2076 6572 7369  the stream versi
-00018e60: 6f6e 2062 7920 6569 7468 6572 2065 7874  on by either ext
-00018e70: 7261 6374 696e 6720 6974 2066 726f 6d20  racting it from 
-00018e80: 7468 6520 7374 6174 6520 6f72 2067 656e  the state or gen
-00018e90: 6572 6174 696e 6720 6120 6e65 7720 6f6e  erating a new on
-00018ea0: 650a 2020 2020 4172 6773 3a0a 2020 2020  e.    Args:.    
-00018eb0: 2020 2020 7461 705f 7374 7265 616d 5f69      tap_stream_i
-00018ec0: 643a 2073 7472 6561 6d20 4944 2074 6f20  d: stream ID to 
-00018ed0: 6765 7420 7665 7273 696f 6e20 666f 720a  get version for.
-00018ee0: 2020 2020 2020 2020 7374 6174 653a 2073          state: s
-00018ef0: 7461 7465 2064 6963 7469 6f6e 6172 7920  tate dictionary 
-00018f00: 746f 2065 7874 7261 6374 2076 6572 7369  to extract versi
-00018f10: 6f6e 2066 726f 6d20 6966 2065 7869 7374  on from if exist
-00018f20: 730a 0a20 2020 2052 6574 7572 6e73 3a20  s..    Returns: 
-00018f30: 7665 7273 696f 6e20 6173 2061 6e20 696e  version as an in
-00018f40: 7465 6765 720a 0a20 2020 2022 2222 0a20  teger..    """. 
-00018f50: 2020 2073 7472 6561 6d5f 7665 7273 696f     stream_versio
-00018f60: 6e20 3d20 7369 6e67 6572 2e67 6574 5f62  n = singer.get_b
-00018f70: 6f6f 6b6d 6172 6b28 7374 6174 652c 2074  ookmark(state, t
-00018f80: 6170 5f73 7472 6561 6d5f 6964 2c20 2776  ap_stream_id, 'v
-00018f90: 6572 7369 6f6e 2729 0a0a 2020 2020 6966  ersion')..    if
-00018fa0: 2073 7472 6561 6d5f 7665 7273 696f 6e20   stream_version 
-00018fb0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00018fc0: 2073 7472 6561 6d5f 7665 7273 696f 6e20   stream_version 
-00018fd0: 3d20 696e 7428 7469 6d65 2e74 696d 6528  = int(time.time(
-00018fe0: 2920 2a20 3130 3030 290a 0a20 2020 2072  ) * 1000)..    r
-00018ff0: 6574 7572 6e20 7374 7265 616d 5f76 6572  eturn stream_ver
-00019000: 7369 6f6e 0a0a 0a64 6566 2063 6c61 7373  sion...def class
-00019010: 5f74 6f5f 7374 7269 6e67 286b 6579 5f76  _to_string(key_v
-00019020: 616c 7565 3a20 416e 792c 206b 6579 5f74  alue: Any, key_t
-00019030: 7970 653a 2073 7472 2920 2d3e 2073 7472  ype: str) -> str
-00019040: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
-00019050: 6e76 6572 7473 2073 7065 6369 6669 6320  nverts specific 
-00019060: 7479 7065 7320 746f 2073 7472 696e 6720  types to string 
-00019070: 6571 7569 7661 6c65 6e74 0a20 2020 2054  equivalent.    T
-00019080: 6865 2073 7570 706f 7274 6564 2074 7970  he supported typ
-00019090: 6573 2061 7265 3a20 6461 7465 7469 6d65  es are: datetime
-000190a0: 2c20 6273 6f6e 2054 696d 6573 7461 6d70  , bson Timestamp
-000190b0: 2c20 6279 7465 732c 2069 6e74 2c20 496e  , bytes, int, In
-000190c0: 7436 342c 2066 6c6f 6174 2c20 4f62 6a65  t64, float, Obje
-000190d0: 6374 4964 2c20 7374 7220 616e 6420 5555  ctId, str and UU
-000190e0: 4944 0a20 2020 2041 7267 733a 0a20 2020  ID.    Args:.   
-000190f0: 2020 2020 206b 6579 5f76 616c 7565 3a20       key_value: 
-00019100: 5468 6520 7661 6c75 6520 746f 2063 6f6e  The value to con
-00019110: 7665 7274 2074 6f20 7374 7269 6e67 0a20  vert to string. 
-00019120: 2020 2020 2020 206b 6579 5f74 7970 653a         key_type:
-00019130: 2074 6865 2076 616c 7565 2074 7970 650a   the value type.
-00019140: 0a20 2020 2052 6574 7572 6e73 3a20 7374  .    Returns: st
-00019150: 7269 6e67 2065 7175 6976 616c 656e 7420  ring equivalent 
-00019160: 6f66 206b 6579 2076 616c 7565 0a20 2020  of key value.   
-00019170: 2052 6169 7365 733a 2055 6e73 7570 706f   Raises: Unsuppo
-00019180: 7274 6564 4b65 7954 7970 6545 7863 6570  rtedKeyTypeExcep
-00019190: 7469 6f6e 2069 6620 6b65 795f 7479 7065  tion if key_type
-000191a0: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
-000191b0: 640a 2020 2020 2222 220a 2020 2020 6966  d.    """.    if
-000191c0: 206b 6579 5f74 7970 6520 3d3d 2027 6461   key_type == 'da
-000191d0: 7465 7469 6d65 273a 0a20 2020 2020 2020  tetime':.       
-000191e0: 2069 6620 6b65 795f 7661 6c75 652e 747a   if key_value.tz
-000191f0: 696e 666f 2069 7320 4e6f 6e65 3a0a 2020  info is None:.  
-00019200: 2020 2020 2020 2020 2020 7469 6d65 7a6f            timezo
-00019210: 6e65 203d 2074 7a6c 6f63 616c 2e67 6574  ne = tzlocal.get
-00019220: 5f6c 6f63 616c 7a6f 6e65 2829 0a20 2020  _localzone().   
-00019230: 2020 2020 2020 2020 206c 6f63 616c 5f64           local_d
-00019240: 6174 6574 696d 6520 3d20 7469 6d65 7a6f  atetime = timezo
-00019250: 6e65 2e6c 6f63 616c 697a 6528 6b65 795f  ne.localize(key_
-00019260: 7661 6c75 6529 0a20 2020 2020 2020 2020  value).         
-00019270: 2020 2075 7463 5f64 6174 6574 696d 6520     utc_datetime 
-00019280: 3d20 6c6f 6361 6c5f 6461 7465 7469 6d65  = local_datetime
-00019290: 2e61 7374 696d 657a 6f6e 6528 7079 747a  .astimezone(pytz
-000192a0: 2e55 5443 290a 2020 2020 2020 2020 656c  .UTC).        el
-000192b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000192c0: 7574 635f 6461 7465 7469 6d65 203d 206b  utc_datetime = k
-000192d0: 6579 5f76 616c 7565 2e61 7374 696d 657a  ey_value.astimez
-000192e0: 6f6e 6528 7079 747a 2e55 5443 290a 0a20  one(pytz.UTC).. 
-000192f0: 2020 2020 2020 2072 6574 7572 6e20 7574         return ut
-00019300: 696c 732e 7374 7266 7469 6d65 2875 7463  ils.strftime(utc
-00019310: 5f64 6174 6574 696d 6529 0a0a 2020 2020  _datetime)..    
-00019320: 6966 206b 6579 5f74 7970 6520 3d3d 2027  if key_type == '
-00019330: 5469 6d65 7374 616d 7027 3a0a 2020 2020  Timestamp':.    
-00019340: 2020 2020 7265 7475 726e 2066 277b 6b65      return f'{ke
-00019350: 795f 7661 6c75 652e 7469 6d65 7d2e 7b6b  y_value.time}.{k
-00019360: 6579 5f76 616c 7565 2e69 6e63 7d27 0a0a  ey_value.inc}'..
-00019370: 2020 2020 6966 206b 6579 5f74 7970 6520      if key_type 
-00019380: 3d3d 2027 6279 7465 7327 3a0a 2020 2020  == 'bytes':.    
-00019390: 2020 2020 7265 7475 726e 2062 6173 6536      return base6
-000193a0: 342e 6236 3465 6e63 6f64 6528 6b65 795f  4.b64encode(key_
-000193b0: 7661 6c75 6529 2e64 6563 6f64 6528 2775  value).decode('u
-000193c0: 7466 2d38 2729 0a0a 2020 2020 6966 206b  tf-8')..    if k
-000193d0: 6579 5f74 7970 6520 696e 205b 2769 6e74  ey_type in ['int
-000193e0: 272c 2027 496e 7436 3427 2c20 2766 6c6f  ', 'Int64', 'flo
-000193f0: 6174 272c 2027 4f62 6a65 6374 4964 272c  at', 'ObjectId',
-00019400: 2027 7374 7227 2c20 2755 5549 4427 5d3a   'str', 'UUID']:
-00019410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00019420: 7374 7228 6b65 795f 7661 6c75 6529 0a0a  str(key_value)..
-00019430: 2020 2020 7261 6973 6520 556e 7375 7070      raise Unsupp
-00019440: 6f72 7465 644b 6579 5479 7065 4578 6365  ortedKeyTypeExce
-00019450: 7074 696f 6e28 6622 7b6b 6579 5f74 7970  ption(f"{key_typ
-00019460: 657d 2069 7320 6e6f 7420 6120 7375 7070  e} is not a supp
-00019470: 6f72 7465 6420 6b65 7920 7479 7065 2229  orted key type")
-00019480: 0a0a 0a64 6566 2073 7472 696e 675f 746f  ...def string_to
-00019490: 5f63 6c61 7373 2873 7472 5f76 616c 7565  _class(str_value
-000194a0: 3a20 7374 722c 2074 7970 655f 7661 6c75  : str, type_valu
-000194b0: 653a 2073 7472 2920 2d3e 2041 6e79 3a0a  e: str) -> Any:.
-000194c0: 2020 2020 2222 220a 2020 2020 436f 6e76      """.    Conv
-000194d0: 6572 7473 2074 6865 2073 7472 696e 6720  erts the string 
-000194e0: 7661 6c75 6520 696e 746f 2074 6865 2067  value into the g
-000194f0: 6976 656e 2074 7970 6520 6966 2073 7570  iven type if sup
-00019500: 706f 7274 6564 2e0a 2020 2020 5468 6520  ported..    The 
-00019510: 7375 7070 6f72 7465 6420 7479 7065 7320  supported types 
-00019520: 6172 653a 2055 5549 442c 2064 6174 6574  are: UUID, datet
-00019530: 696d 652c 2069 6e74 2c20 496e 7436 342c  ime, int, Int64,
-00019540: 2066 6c6f 6174 2c20 4f62 6a65 6374 4964   float, ObjectId
-00019550: 2c20 5469 6d65 7374 616d 702c 2062 7974  , Timestamp, byt
-00019560: 6573 2c20 7374 720a 2020 2020 4172 6773  es, str.    Args
-00019570: 3a0a 2020 2020 2020 2020 7374 725f 7661  :.        str_va
-00019580: 6c75 653a 2074 6865 2073 7472 696e 6720  lue: the string 
-00019590: 7661 6c75 6520 746f 2063 6f6e 7665 7274  value to convert
-000195a0: 0a20 2020 2020 2020 2074 7970 655f 7661  .        type_va
-000195b0: 6c75 653a 2074 6865 2076 616c 7565 2074  lue: the value t
-000195c0: 7970 650a 0a20 2020 2052 6574 7572 6e73  ype..    Returns
-000195d0: 3a20 636f 6e76 6572 7465 6420 7374 7269  : converted stri
-000195e0: 6e67 2076 616c 7565 0a20 2020 2052 6169  ng value.    Rai
-000195f0: 7365 733a 2055 6e73 7570 706f 7274 6564  ses: Unsupported
-00019600: 4b65 7954 7970 6545 7863 6570 7469 6f6e  KeyTypeException
-00019610: 2069 6620 6b65 7920 6973 2075 6e73 7570   if key is unsup
-00019620: 706f 7274 6564 0a20 2020 2022 2222 0a0a  ported.    """..
-00019630: 2020 2020 636f 6e76 6572 7369 6f6e 203d      conversion =
-00019640: 207b 0a20 2020 2020 2020 2027 5555 4944   {.        'UUID
-00019650: 273a 2075 7569 642e 5555 4944 2c0a 2020  ': uuid.UUID,.  
-00019660: 2020 2020 2020 2764 6174 6574 696d 6527        'datetime'
-00019670: 3a20 7369 6e67 6572 2e75 7469 6c73 2e73  : singer.utils.s
-00019680: 7472 7074 696d 655f 7769 7468 5f74 7a2c  trptime_with_tz,
-00019690: 0a20 2020 2020 2020 2027 696e 7427 3a20  .        'int': 
-000196a0: 696e 742c 0a20 2020 2020 2020 2027 496e  int,.        'In
-000196b0: 7436 3427 3a20 6273 6f6e 2e69 6e74 3634  t64': bson.int64
-000196c0: 2e49 6e74 3634 2c0a 2020 2020 2020 2020  .Int64,.        
-000196d0: 2766 6c6f 6174 273a 2073 7472 2c0a 2020  'float': str,.  
-000196e0: 2020 2020 2020 274f 626a 6563 7449 6427        'ObjectId'
-000196f0: 3a20 6f62 6a65 6374 6964 2e4f 626a 6563  : objectid.Objec
-00019700: 7449 642c 0a20 2020 2020 2020 2027 5469  tId,.        'Ti
-00019710: 6d65 7374 616d 7027 3a20 6c61 6d62 6461  mestamp': lambda
-00019720: 2076 616c 3a20 286c 616d 6264 6120 7370   val: (lambda sp
-00019730: 6c69 745f 7661 6c75 653d 7661 6c2e 7370  lit_value=val.sp
-00019740: 6c69 7428 272e 2729 3a0a 2020 2020 2020  lit('.'):.      
-00019750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019760: 2020 2020 2020 2020 2020 2020 6273 6f6e              bson
-00019770: 2e74 696d 6573 7461 6d70 2e54 696d 6573  .timestamp.Times
-00019780: 7461 6d70 2869 6e74 2873 706c 6974 5f76  tamp(int(split_v
-00019790: 616c 7565 5b30 5d29 2c20 696e 7428 7370  alue[0]), int(sp
-000197a0: 6c69 745f 7661 6c75 655b 315d 2929 2928  lit_value[1])))(
-000197b0: 292c 0a20 2020 2020 2020 2027 6279 7465  ),.        'byte
-000197c0: 7327 3a20 6c61 6d62 6461 2076 616c 3a20  s': lambda val: 
-000197d0: 6261 7365 3634 2e62 3634 6465 636f 6465  base64.b64decode
-000197e0: 2876 616c 2e65 6e63 6f64 6528 2929 2c0a  (val.encode()),.
-000197f0: 2020 2020 2020 2020 2773 7472 273a 2073          'str': s
-00019800: 7472 2c0a 2020 2020 7d0a 0a20 2020 2069  tr,.    }..    i
-00019810: 6620 7479 7065 5f76 616c 7565 2069 6e20  f type_value in 
-00019820: 636f 6e76 6572 7369 6f6e 3a0a 2020 2020  conversion:.    
-00019830: 2020 2020 7265 7475 726e 2063 6f6e 7665      return conve
-00019840: 7273 696f 6e5b 7479 7065 5f76 616c 7565  rsion[type_value
-00019850: 5d28 7374 725f 7661 6c75 6529 0a0a 2020  ](str_value)..  
-00019860: 2020 7261 6973 6520 556e 7375 7070 6f72    raise Unsuppor
-00019870: 7465 644b 6579 5479 7065 4578 6365 7074  tedKeyTypeExcept
-00019880: 696f 6e28 6622 7b74 7970 655f 7661 6c75  ion(f"{type_valu
-00019890: 657d 2069 7320 6e6f 7420 6120 7375 7070  e} is not a supp
-000198a0: 6f72 7465 6420 6b65 7920 7479 7065 2229  orted key type")
-000198b0: 0a0a 0a64 6566 2073 6166 655f 7472 616e  ...def safe_tran
-000198c0: 7366 6f72 6d5f 6461 7465 7469 6d65 2876  sform_datetime(v
-000198d0: 616c 7565 3a20 6461 7465 7469 6d65 2e64  alue: datetime.d
-000198e0: 6174 6574 696d 652c 2070 6174 6829 3a0a  atetime, path):.
-000198f0: 2020 2020 2222 220a 2020 2020 5361 6665      """.    Safe
-00019900: 6c79 2074 7261 6e73 666f 726d 2064 6174  ly transform dat
-00019910: 6574 696d 6520 6672 6f6d 206c 6f63 616c  etime from local
-00019920: 2074 7a20 746f 2055 5443 2069 6620 6170   tz to UTC if ap
-00019930: 706c 6963 6162 6c65 0a20 2020 2041 7267  plicable.    Arg
-00019940: 733a 0a20 2020 2020 2020 2076 616c 7565  s:.        value
-00019950: 3a20 6461 7465 7469 6d65 2076 616c 7565  : datetime value
-00019960: 2074 6f20 7472 616e 7366 6f72 6d0a 2020   to transform.  
-00019970: 2020 2020 2020 7061 7468 3a0a 0a20 2020        path:..   
-00019980: 2052 6574 7572 6e73 3a20 7574 6320 6461   Returns: utc da
-00019990: 7465 7469 6d65 2061 7320 7374 7269 6e67  tetime as string
-000199a0: 0a0a 2020 2020 2222 220a 2020 2020 7469  ..    """.    ti
-000199b0: 6d65 7a6f 6e65 203d 2074 7a6c 6f63 616c  mezone = tzlocal
-000199c0: 2e67 6574 5f6c 6f63 616c 7a6f 6e65 2829  .get_localzone()
-000199d0: 0a20 2020 2074 7279 3a0a 2020 2020 2020  .    try:.      
-000199e0: 2020 6c6f 6361 6c5f 6461 7465 7469 6d65    local_datetime
-000199f0: 203d 2074 696d 657a 6f6e 652e 6c6f 6361   = timezone.loca
-00019a00: 6c69 7a65 2876 616c 7565 290a 2020 2020  lize(value).    
-00019a10: 2020 2020 7574 635f 6461 7465 7469 6d65      utc_datetime
-00019a20: 203d 206c 6f63 616c 5f64 6174 6574 696d   = local_datetim
-00019a30: 652e 6173 7469 6d65 7a6f 6e65 2870 7974  e.astimezone(pyt
-00019a40: 7a2e 5554 4329 0a20 2020 2065 7863 6570  z.UTC).    excep
-00019a50: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00019a60: 783a 0a20 2020 2020 2020 2069 6620 7374  x:.        if st
-00019a70: 7228 6578 2920 3d3d 2022 7965 6172 2069  r(ex) == "year i
-00019a80: 7320 6f75 7420 6f66 2072 616e 6765 2220  s out of range" 
-00019a90: 616e 6420 7661 6c75 652e 7965 6172 203d  and value.year =
-00019aa0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-00019ab0: 2023 204e 423a 2053 696e 6365 2064 6174   # NB: Since dat
-00019ac0: 6574 696d 6573 2061 7265 2070 6572 7369  etimes are persi
-00019ad0: 7374 6564 2061 7320 7374 7269 6e67 732c  sted as strings,
-00019ae0: 2069 7420 646f 6573 6e27 740a 2020 2020   it doesn't.    
-00019af0: 2020 2020 2020 2020 2320 6d61 6b65 2073          # make s
-00019b00: 656e 7365 2074 6f20 626c 6f77 2075 7020  ense to blow up 
-00019b10: 6f6e 2069 6e76 616c 6964 2050 7974 686f  on invalid Pytho
-00019b20: 6e20 6461 7465 7469 6d65 7320 2865 2e67  n datetimes (e.g
-00019b30: 2e2c 0a20 2020 2020 2020 2020 2020 2023  .,.            #
-00019b40: 2079 6561 723d 3029 2e20 496e 2074 6869   year=0). In thi
-00019b50: 7320 6361 7365 2077 6527 7265 2066 6f72  s case we're for
-00019b60: 6d61 7474 696e 6720 6974 2061 7320 6120  matting it as a 
-00019b70: 7374 7269 6e67 2061 6e64 0a20 2020 2020  string and.     
-00019b80: 2020 2020 2020 2023 2070 6173 7369 6e67         # passing
-00019b90: 2069 7420 616c 6f6e 6720 646f 776e 2074   it along down t
-00019ba0: 6865 2070 6970 656c 696e 652e 0a20 2020  he pipeline..   
-00019bb0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00019bc0: 6622 7b76 616c 7565 2e79 6561 723a 3034  f"{value.year:04
-00019bd0: 647d 2d7b 7661 6c75 652e 6d6f 6e74 683a  d}-{value.month:
-00019be0: 3032 647d 2d7b 7661 6c75 652e 6461 793a  02d}-{value.day:
-00019bf0: 3032 647d 547b 7661 6c75 652e 686f 7572  02d}T{value.hour
-00019c00: 3a30 3264 7d3a 7b76 616c 7565 2e6d 696e  :02d}:{value.min
-00019c10: 7574 653a 3032 647d 3a22 205c 0a20 2020  ute:02d}:" \.   
-00019c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019c30: 6622 7b76 616c 7565 2e73 6563 6f6e 643a  f"{value.second:
-00019c40: 3032 647d 2e7b 7661 6c75 652e 6d69 6372  02d}.{value.micr
-00019c50: 6f73 6563 6f6e 643a 3036 647d 5a22 0a20  osecond:06d}Z". 
-00019c60: 2020 2020 2020 2072 6169 7365 204d 6f6e         raise Mon
-00019c70: 676f 496e 7661 6c69 6444 6174 6554 696d  goInvalidDateTim
-00019c80: 6545 7863 6570 7469 6f6e 2866 2246 6f75  eException(f"Fou
-00019c90: 6e64 2069 6e76 616c 6964 2064 6174 6574  nd invalid datet
-00019ca0: 696d 6520 6174 205b 7b27 2e27 2e6a 6f69  ime at [{'.'.joi
-00019cb0: 6e28 6d61 7028 7374 722c 2070 6174 6829  n(map(str, path)
-00019cc0: 297d 5d3a 207b 7661 6c75 657d 2229 2066  )}]: {value}") f
-00019cd0: 726f 6d20 6578 0a20 2020 2072 6574 7572  rom ex.    retur
-00019ce0: 6e20 7574 696c 732e 7374 7266 7469 6d65  n utils.strftime
-00019cf0: 2875 7463 5f64 6174 6574 696d 6529 0a0a  (utc_datetime)..
-00019d00: 0a64 6566 2074 7261 6e73 666f 726d 5f76  .def transform_v
-00019d10: 616c 7565 2876 616c 7565 3a20 416e 792c  alue(value: Any,
-00019d20: 2070 6174 6829 202d 3e20 416e 793a 0a20   path) -> Any:. 
-00019d30: 2020 2022 2222 0a20 2020 2074 7261 6e73     """.    trans
-00019d40: 666f 726d 2076 616c 7565 7320 746f 206a  form values to j
-00019d50: 736f 6e20 6672 6965 6e64 6c79 206f 6e65  son friendly one
-00019d60: 730a 2020 2020 4172 6773 3a0a 2020 2020  s.    Args:.    
-00019d70: 2020 2020 7661 6c75 653a 2076 616c 7565      value: value
-00019d80: 2074 6f20 7472 616e 7366 6f72 6d0a 2020   to transform.  
-00019d90: 2020 2020 2020 7061 7468 3a0a 0a20 2020        path:..   
-00019da0: 2052 6574 7572 6e73 3a20 7472 616e 7366   Returns: transf
-00019db0: 6f72 6d65 6420 7661 6c75 650a 0a20 2020  ormed value..   
-00019dc0: 2022 2222 0a20 2020 2063 6f6e 7665 7273   """.    convers
-00019dd0: 696f 6e20 3d20 7b0a 2020 2020 2020 2020  ion = {.        
-00019de0: 6c69 7374 3a20 6c61 6d62 6461 2076 616c  list: lambda val
-00019df0: 2c20 7061 743a 206c 6973 7428 6d61 7028  , pat: list(map(
-00019e00: 6c61 6d62 6461 2076 3a20 7472 616e 7366  lambda v: transf
-00019e10: 6f72 6d5f 7661 6c75 6528 765b 315d 2c20  orm_value(v[1], 
-00019e20: 7061 7420 2b20 5b76 5b30 5d5d 292c 2065  pat + [v[0]]), e
-00019e30: 6e75 6d65 7261 7465 2876 616c 2929 292c  numerate(val))),
-00019e40: 0a20 2020 2020 2020 2064 6963 743a 206c  .        dict: l
-00019e50: 616d 6264 6120 7661 6c2c 2070 6174 3a20  ambda val, pat: 
-00019e60: 7b6b 3a20 7472 616e 7366 6f72 6d5f 7661  {k: transform_va
-00019e70: 6c75 6528 762c 2070 6174 202b 205b 6b5d  lue(v, pat + [k]
-00019e80: 2920 666f 7220 6b2c 2076 2069 6e20 7661  ) for k, v in va
-00019e90: 6c2e 6974 656d 7328 297d 2c0a 2020 2020  l.items()},.    
-00019ea0: 2020 2020 7575 6964 2e55 5549 443a 206c      uuid.UUID: l
-00019eb0: 616d 6264 6120 7661 6c2c 205f 3a20 636c  ambda val, _: cl
-00019ec0: 6173 735f 746f 5f73 7472 696e 6728 7661  ass_to_string(va
-00019ed0: 6c2c 2027 5555 4944 2729 2c0a 2020 2020  l, 'UUID'),.    
-00019ee0: 2020 2020 6f62 6a65 6374 6964 2e4f 626a      objectid.Obj
-00019ef0: 6563 7449 643a 206c 616d 6264 6120 7661  ectId: lambda va
-00019f00: 6c2c 205f 3a20 636c 6173 735f 746f 5f73  l, _: class_to_s
-00019f10: 7472 696e 6728 7661 6c2c 2027 4f62 6a65  tring(val, 'Obje
-00019f20: 6374 4964 2729 2c0a 2020 2020 2020 2020  ctId'),.        
-00019f30: 6273 6f6e 5f64 6174 6574 696d 652e 6461  bson_datetime.da
-00019f40: 7465 7469 6d65 3a20 7361 6665 5f74 7261  tetime: safe_tra
-00019f50: 6e73 666f 726d 5f64 6174 6574 696d 652c  nsform_datetime,
-00019f60: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
-00019f70: 6d70 2e54 696d 6573 7461 6d70 3a20 6c61  mp.Timestamp: la
-00019f80: 6d62 6461 2076 616c 2c20 5f3a 2075 7469  mbda val, _: uti
-00019f90: 6c73 2e73 7472 6674 696d 6528 7661 6c2e  ls.strftime(val.
-00019fa0: 6173 5f64 6174 6574 696d 6528 2929 2c0a  as_datetime()),.
-00019fb0: 2020 2020 2020 2020 6273 6f6e 2e69 6e74          bson.int
-00019fc0: 3634 2e49 6e74 3634 3a20 6c61 6d62 6461  64.Int64: lambda
-00019fd0: 2076 616c 2c20 5f3a 2063 6c61 7373 5f74   val, _: class_t
-00019fe0: 6f5f 7374 7269 6e67 2876 616c 2c20 2749  o_string(val, 'I
-00019ff0: 6e74 3634 2729 2c0a 2020 2020 2020 2020  nt64'),.        
-0001a000: 6279 7465 733a 206c 616d 6264 6120 7661  bytes: lambda va
-0001a010: 6c2c 205f 3a20 636c 6173 735f 746f 5f73  l, _: class_to_s
-0001a020: 7472 696e 6728 7661 6c2c 2027 6279 7465  tring(val, 'byte
-0001a030: 7327 292c 0a20 2020 2020 2020 2064 6174  s'),.        dat
-0001a040: 6574 696d 652e 6461 7465 7469 6d65 3a20  etime.datetime: 
-0001a050: 6c61 6d62 6461 2076 616c 2c20 5f3a 2063  lambda val, _: c
-0001a060: 6c61 7373 5f74 6f5f 7374 7269 6e67 2876  lass_to_string(v
-0001a070: 616c 2c20 2764 6174 6574 696d 6527 292c  al, 'datetime'),
-0001a080: 0a20 2020 2020 2020 2062 736f 6e2e 6465  .        bson.de
-0001a090: 6369 6d61 6c31 3238 2e44 6563 696d 616c  cimal128.Decimal
-0001a0a0: 3132 383a 206c 616d 6264 6120 7661 6c2c  128: lambda val,
-0001a0b0: 205f 3a20 7661 6c2e 746f 5f64 6563 696d   _: val.to_decim
-0001a0c0: 616c 2829 2c0a 2020 2020 2020 2020 6273  al(),.        bs
-0001a0d0: 6f6e 2e72 6567 6578 2e52 6567 6578 3a20  on.regex.Regex: 
-0001a0e0: 6c61 6d62 6461 2076 616c 2c20 5f3a 2064  lambda val, _: d
-0001a0f0: 6963 7428 7061 7474 6572 6e3d 7661 6c2e  ict(pattern=val.
-0001a100: 7061 7474 6572 6e2c 2066 6c61 6773 3d76  pattern, flags=v
-0001a110: 616c 2e66 6c61 6773 292c 0a20 2020 2020  al.flags),.     
-0001a120: 2020 2062 736f 6e2e 636f 6465 2e43 6f64     bson.code.Cod
-0001a130: 653a 206c 616d 6264 6120 7661 6c2c 205f  e: lambda val, _
-0001a140: 3a20 6469 6374 2876 616c 7565 3d73 7472  : dict(value=str
-0001a150: 2876 616c 292c 2073 636f 7065 3d73 7472  (val), scope=str
-0001a160: 2876 616c 2e73 636f 7065 2929 2069 6620  (val.scope)) if 
-0001a170: 7661 6c2e 7363 6f70 6520 656c 7365 2073  val.scope else s
-0001a180: 7472 2876 616c 292c 0a20 2020 2020 2020  tr(val),.       
-0001a190: 2062 736f 6e2e 6462 7265 662e 4442 5265   bson.dbref.DBRe
-0001a1a0: 663a 206c 616d 6264 6120 7661 6c2c 205f  f: lambda val, _
-0001a1b0: 3a20 6469 6374 2869 643d 7374 7228 7661  : dict(id=str(va
-0001a1c0: 6c2e 6964 292c 2063 6f6c 6c65 6374 696f  l.id), collectio
-0001a1d0: 6e3d 7661 6c2e 636f 6c6c 6563 7469 6f6e  n=val.collection
-0001a1e0: 2c20 6461 7461 6261 7365 3d76 616c 2e64  , database=val.d
-0001a1f0: 6174 6162 6173 6529 2c0a 2020 2020 7d0a  atabase),.    }.
-0001a200: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-0001a210: 6365 2876 616c 7565 2c20 7475 706c 6528  ce(value, tuple(
-0001a220: 636f 6e76 6572 7369 6f6e 2e6b 6579 7328  conversion.keys(
-0001a230: 2929 293a 0a20 2020 2020 2020 2072 6574  ))):.        ret
-0001a240: 7572 6e20 636f 6e76 6572 7369 6f6e 5b74  urn conversion[t
-0001a250: 7970 6528 7661 6c75 6529 5d28 7661 6c75  ype(value)](valu
-0001a260: 652c 2070 6174 6829 0a0a 2020 2020 7265  e, path)..    re
-0001a270: 7475 726e 2076 616c 7565 0a0a 0a64 6566  turn value...def
-0001a280: 2072 6f77 5f74 6f5f 7369 6e67 6572 5f72   row_to_singer_r
-0001a290: 6563 6f72 6428 7374 7265 616d 3a20 4469  ecord(stream: Di
-0001a2a0: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
-0001a2b0: 2020 2020 2020 2020 2020 2020 2072 6f77               row
-0001a2c0: 3a20 4469 6374 2c0a 2020 2020 2020 2020  : Dict,.        
-0001a2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a2e0: 2074 696d 655f 6578 7472 6163 7465 643a   time_extracted:
-0001a2f0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
-0001a300: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-0001a310: 2020 2020 2020 2020 2020 2020 2074 696d               tim
-0001a320: 655f 6465 6c65 7465 643a 204f 7074 696f  e_deleted: Optio
-0001a330: 6e61 6c5b 6461 7465 7469 6d65 2e64 6174  nal[datetime.dat
-0001a340: 6574 696d 655d 2c0a 2020 2020 2020 2020  etime],.        
+000180f0: 7469 6d65 5f65 7874 7261 6374 6564 3d75  time_extracted=u
+00018100: 7469 6c73 2e6e 6f77 2829 2c0a 2020 2020  tils.now(),.    
+00018110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018140: 2020 2020 2020 2020 2020 2020 2074 696d               tim
+00018150: 655f 6465 6c65 7465 643d 4e6f 6e65 2929  e_deleted=None))
+00018160: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018170: 2020 726f 7773 5f73 6176 6564 5b74 6170    rows_saved[tap
+00018180: 5f73 7472 6561 6d5f 6964 5d20 2b3d 2031  _stream_id] += 1
+00018190: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+000181a0: 6966 206f 7065 7261 7469 6f6e 203d 3d20  if operation == 
+000181b0: 2775 7064 6174 6527 3a0a 2020 2020 2020  'update':.      
+000181c0: 2020 2020 2020 2020 2020 2320 7570 6461            # upda
+000181d0: 7465 206f 7065 7261 7469 6f6e 206f 6e6c  te operation onl
+000181e0: 7920 7265 7475 726e 205f 6964 2061 6e64  y return _id and
+000181f0: 2075 7064 6174 6564 2066 6965 6c64 7320   updated fields 
+00018200: 696e 2074 6865 2072 6f77 2c0a 2020 2020  in the row,.    
+00018210: 2020 2020 2020 2020 2020 2020 2320 736f              # so
+00018220: 2073 6176 696e 6720 5f69 6420 666f 7220   saving _id for 
+00018230: 6e6f 7720 756e 7469 6c20 7765 2066 6574  now until we fet
+00018240: 6368 2074 6865 2064 6f63 756d 656e 7420  ch the document 
+00018250: 7768 656e 2069 7427 7320 7469 6d65 2074  when it's time t
+00018260: 6f20 666c 7573 6820 7468 6520 6275 6666  o flush the buff
+00018270: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
+00018280: 2020 2075 7064 6174 655f 6275 6666 6572     update_buffer
+00018290: 5b74 6170 5f73 7472 6561 6d5f 6964 5d2e  [tap_stream_id].
+000182a0: 6164 6428 6368 616e 6765 5b27 646f 6375  add(change['docu
+000182b0: 6d65 6e74 4b65 7927 5d5b 275f 6964 275d  mentKey']['_id']
+000182c0: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
+000182d0: 6c69 6620 6f70 6572 6174 696f 6e20 3d3d  lif operation ==
+000182e0: 2027 6465 6c65 7465 273a 0a20 2020 2020   'delete':.     
+000182f0: 2020 2020 2020 2020 2020 2023 2072 656d             # rem
+00018300: 6f76 6520 7570 6461 7465 2066 726f 6d20  ove update from 
+00018310: 6275 6666 6572 2069 6620 7468 6174 2064  buffer if that d
+00018320: 6f63 756d 656e 7420 6861 7320 6265 656e  ocument has been
+00018330: 2064 656c 6574 6564 0a20 2020 2020 2020   deleted.       
+00018340: 2020 2020 2020 2020 2075 7064 6174 655f           update_
+00018350: 6275 6666 6572 5b74 6170 5f73 7472 6561  buffer[tap_strea
+00018360: 6d5f 6964 5d2e 6469 7363 6172 6428 6368  m_id].discard(ch
+00018370: 616e 6765 5b27 646f 6375 6d65 6e74 4b65  ange['documentKe
+00018380: 7927 5d5b 275f 6964 275d 290a 0a20 2020  y']['_id'])..   
+00018390: 2020 2020 2020 2020 2020 2020 2023 2044               # D
+000183a0: 656c 6574 6520 6f70 7320 6f6e 6c79 2063  elete ops only c
+000183b0: 6f6e 7461 696e 2074 6865 205f 6964 206f  ontain the _id o
+000183c0: 6620 7468 6520 726f 7720 6465 6c65 7465  f the row delete
+000183d0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+000183e0: 2020 7369 6e67 6572 2e77 7269 7465 5f6d    singer.write_m
+000183f0: 6573 7361 6765 2863 6f6d 6d6f 6e2e 726f  essage(common.ro
+00018400: 775f 746f 5f73 696e 6765 725f 7265 636f  w_to_singer_reco
+00018410: 7264 280a 2020 2020 2020 2020 2020 2020  rd(.            
+00018420: 2020 2020 2020 2020 7374 7265 616d 3d73          stream=s
+00018430: 7472 6561 6d73 5f74 6f5f 7379 6e63 5b74  treams_to_sync[t
+00018440: 6170 5f73 7472 6561 6d5f 6964 5d2c 0a20  ap_stream_id],. 
+00018450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018460: 2020 2072 6f77 3d7b 275f 6964 273a 2063     row={'_id': c
+00018470: 6861 6e67 655b 2764 6f63 756d 656e 744b  hange['documentK
+00018480: 6579 275d 5b27 5f69 6427 5d7d 2c0a 2020  ey']['_id']},.  
+00018490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184a0: 2020 7469 6d65 5f65 7874 7261 6374 6564    time_extracted
+000184b0: 3d75 7469 6c73 2e6e 6f77 2829 2c0a 2020  =utils.now(),.  
+000184c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184d0: 2020 7469 6d65 5f64 656c 6574 6564 3d63    time_deleted=c
+000184e0: 6861 6e67 655b 0a20 2020 2020 2020 2020  hange[.         
+000184f0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00018500: 636c 7573 7465 7254 696d 6527 5d2e 6173  clusterTime'].as
+00018510: 5f64 6174 6574 696d 6528 2929 2920 2023  _datetime()))  #
+00018520: 2072 6574 7572 6e73 2070 7974 686f 6e27   returns python'
+00018530: 7320 6461 7465 7469 6d65 2e64 6174 6574  s datetime.datet
+00018540: 696d 6520 696e 7374 616e 6365 2069 6e20  ime instance in 
+00018550: 5554 430a 0a20 2020 2020 2020 2020 2020  UTC..           
+00018560: 2020 2020 2072 6f77 735f 7361 7665 645b       rows_saved[
+00018570: 7461 705f 7374 7265 616d 5f69 645d 202b  tap_stream_id] +
+00018580: 3d20 310a 0a20 2020 2020 2020 2020 2020  = 1..           
+00018590: 2023 2075 7064 6174 6520 7468 6520 7374   # update the st
+000185a0: 6174 6573 206f 6620 616c 6c20 7374 7265  ates of all stre
+000185b0: 616d 730a 2020 2020 2020 2020 2020 2020  ams.            
+000185c0: 7374 6174 6520 3d20 7570 6461 7465 5f62  state = update_b
+000185d0: 6f6f 6b6d 6172 6b73 2873 7461 7465 2c20  ookmarks(state, 
+000185e0: 7374 7265 616d 5f69 6473 2c20 7265 7375  stream_ids, resu
+000185f0: 6d65 5f74 6f6b 656e 290a 0a20 2020 2020  me_token)..     
+00018600: 2020 2020 2020 2023 2066 6c75 7368 2062         # flush b
+00018610: 7566 6665 7220 6966 2069 7420 6861 7320  uffer if it has 
+00018620: 6669 6c6c 6564 2075 7020 6f72 2066 6c75  filled up or flu
+00018630: 7368 2061 6e64 2077 7269 7465 2073 7461  sh and write sta
+00018640: 7465 2065 7665 7279 2055 5044 4154 455f  te every UPDATE_
+00018650: 424f 4f4b 4d41 524b 5f50 4552 494f 4420  BOOKMARK_PERIOD 
+00018660: 6d65 7373 6167 6573 0a20 2020 2020 2020  messages.       
+00018670: 2020 2020 2069 6620 7375 6d28 6c65 6e28       if sum(len(
+00018680: 7374 7265 616d 5f62 7566 6665 7229 2066  stream_buffer) f
+00018690: 6f72 2073 7472 6561 6d5f 6275 6666 6572  or stream_buffer
+000186a0: 2069 6e20 7570 6461 7465 5f62 7566 6665   in update_buffe
+000186b0: 722e 7661 6c75 6573 2829 2920 3e3d 2075  r.values()) >= u
+000186c0: 7064 6174 655f 6275 6666 6572 5f73 697a  pdate_buffer_siz
+000186d0: 6520 6f72 205c 0a20 2020 2020 2020 2020  e or \.         
+000186e0: 2020 2020 2020 2020 2020 2073 756d 2872             sum(r
+000186f0: 6f77 735f 7361 7665 642e 7661 6c75 6573  ows_saved.values
+00018700: 2829 2920 2520 636f 6d6d 6f6e 2e55 5044  ()) % common.UPD
+00018710: 4154 455f 424f 4f4b 4d41 524b 5f50 4552  ATE_BOOKMARK_PER
+00018720: 494f 4420 3d3d 2030 3a0a 0a20 2020 2020  IOD == 0:..     
+00018730: 2020 2020 2020 2020 2020 204c 4f47 4745             LOGGE
+00018740: 522e 6465 6275 6728 2746 6c75 7368 696e  R.debug('Flushin
+00018750: 6720 7570 6461 7465 2062 7566 6665 7220  g update buffer 
+00018760: 2e2e 2e27 290a 0a20 2020 2020 2020 2020  ...')..         
+00018770: 2020 2020 2020 2066 6c75 7368 5f62 7566         flush_buf
+00018780: 6665 7228 7570 6461 7465 5f62 7566 6665  fer(update_buffe
+00018790: 722c 2073 7472 6561 6d73 5f74 6f5f 7379  r, streams_to_sy
+000187a0: 6e63 2c20 6461 7461 6261 7365 2c20 726f  nc, database, ro
+000187b0: 7773 5f73 6176 6564 290a 0a20 2020 2020  ws_saved)..     
+000187c0: 2020 2020 2020 2020 2020 2069 6620 7375             if su
+000187d0: 6d28 726f 7773 5f73 6176 6564 2e76 616c  m(rows_saved.val
+000187e0: 7565 7328 2929 2025 2063 6f6d 6d6f 6e2e  ues()) % common.
+000187f0: 5550 4441 5445 5f42 4f4f 4b4d 4152 4b5f  UPDATE_BOOKMARK_
+00018800: 5045 5249 4f44 203d 3d20 303a 0a20 2020  PERIOD == 0:.   
+00018810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018820: 2023 2077 7269 7465 2073 7461 7465 0a20   # write state. 
+00018830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018840: 2020 2073 696e 6765 722e 7772 6974 655f     singer.write_
+00018850: 6d65 7373 6167 6528 7369 6e67 6572 2e53  message(singer.S
+00018860: 7461 7465 4d65 7373 6167 6528 7661 6c75  tateMessage(valu
+00018870: 653d 636f 7079 2e64 6565 7063 6f70 7928  e=copy.deepcopy(
+00018880: 7374 6174 6529 2929 0a0a 2020 2020 2320  state)))..    # 
+00018890: 666c 7573 6820 6275 6666 6572 2069 6620  flush buffer if 
+000188a0: 6669 6e69 7368 6564 2077 6974 6820 6368  finished with ch
+000188b0: 616e 6765 5374 7265 616d 730a 2020 2020  angeStreams.    
+000188c0: 666c 7573 685f 6275 6666 6572 2875 7064  flush_buffer(upd
+000188d0: 6174 655f 6275 6666 6572 2c20 7374 7265  ate_buffer, stre
+000188e0: 616d 735f 746f 5f73 796e 632c 2064 6174  ams_to_sync, dat
+000188f0: 6162 6173 652c 2072 6f77 735f 7361 7665  abase, rows_save
+00018900: 6429 0a0a 2020 2020 666f 7220 7374 7265  d)..    for stre
+00018910: 616d 5f69 6420 696e 2073 7472 6561 6d5f  am_id in stream_
+00018920: 6964 733a 0a20 2020 2020 2020 2063 6f6d  ids:.        com
+00018930: 6d6f 6e2e 434f 554e 5453 5b73 7472 6561  mon.COUNTS[strea
+00018940: 6d5f 6964 5d20 2b3d 2072 6f77 735f 7361  m_id] += rows_sa
+00018950: 7665 645b 7374 7265 616d 5f69 645d 0a20  ved[stream_id]. 
+00018960: 2020 2020 2020 2063 6f6d 6d6f 6e2e 5449         common.TI
+00018970: 4d45 535b 7374 7265 616d 5f69 645d 202b  MES[stream_id] +
+00018980: 3d20 7469 6d65 2e74 696d 6528 2920 2d20  = time.time() - 
+00018990: 7374 6172 745f 7469 6d65 0a20 2020 2020  start_time.     
+000189a0: 2020 204c 4f47 4745 522e 696e 666f 2827     LOGGER.info('
+000189b0: 5379 6e63 6420 2573 2072 6563 6f72 6473  Syncd %s records
+000189c0: 2066 6f72 2025 7327 2c20 726f 7773 5f73   for %s', rows_s
+000189d0: 6176 6564 5b73 7472 6561 6d5f 6964 5d2c  aved[stream_id],
+000189e0: 2073 7472 6561 6d5f 6964 290a 0a0a 6465   stream_id)...de
+000189f0: 6620 666c 7573 685f 6275 6666 6572 2862  f flush_buffer(b
+00018a00: 7566 6665 723a 2044 6963 745b 7374 722c  uffer: Dict[str,
+00018a10: 2053 6574 5d2c 2073 7472 6561 6d73 3a20   Set], streams: 
+00018a20: 4469 6374 5b73 7472 2c20 4469 6374 5d2c  Dict[str, Dict],
+00018a30: 2064 6174 6162 6173 653a 2044 6174 6162   database: Datab
+00018a40: 6173 652c 2072 6f77 735f 7361 7665 643a  ase, rows_saved:
+00018a50: 2044 6963 745b 7374 722c 2069 6e74 5d29   Dict[str, int])
+00018a60: 3a0a 2020 2020 2222 220a 2020 2020 466c  :.    """.    Fl
+00018a70: 7573 6820 616e 6420 7265 7365 7420 7468  ush and reset th
+00018a80: 6520 6769 7665 6e20 6275 6666 6572 2c20  e given buffer, 
+00018a90: 6974 2069 6e63 7265 6d65 6e74 7320 7468  it increments th
+00018aa0: 6520 726f 775f 7361 7665 6420 636f 756e  e row_saved coun
+00018ab0: 7420 696e 2074 6865 2067 6976 656e 2072  t in the given r
+00018ac0: 6f77 735f 7361 7665 6420 6469 6374 696f  ows_saved dictio
+00018ad0: 6e61 7279 0a20 2020 2041 7267 733a 0a20  nary.    Args:. 
+00018ae0: 2020 2020 2020 2064 6174 6162 6173 653a         database:
+00018af0: 206d 6f6e 676f 4442 2044 4220 696e 7374   mongoDB DB inst
+00018b00: 616e 6365 0a20 2020 2020 2020 2062 7566  ance.        buf
+00018b10: 6665 723a 2041 2073 6574 206f 6620 726f  fer: A set of ro
+00018b20: 7773 2074 6f20 666c 7573 6820 7065 7220  ws to flush per 
+00018b30: 7374 7265 616d 0a20 2020 2020 2020 2073  stream.        s
+00018b40: 7472 6561 6d73 3a20 7374 7265 616d 7320  treams: streams 
+00018b50: 7768 6f73 6520 726f 7773 2074 6f20 666c  whose rows to fl
+00018b60: 7573 680a 2020 2020 2020 2020 726f 7773  ush.        rows
+00018b70: 5f73 6176 6564 3a20 6d61 7020 6f66 2073  _saved: map of s
+00018b80: 7472 6561 6d73 2074 6f20 6e75 6d62 6572  treams to number
+00018b90: 206f 6620 726f 7773 2073 6176 6564 2c20   of rows saved, 
+00018ba0: 7468 6973 2064 6963 7469 6f6e 6172 7920  this dictionary 
+00018bb0: 6e65 6564 7320 746f 2062 6520 696e 6372  needs to be incr
+00018bc0: 656d 656e 7465 640a 2020 2020 5265 7475  emented.    Retu
+00018bd0: 726e 733a 0a0a 2020 2020 2222 220a 2020  rns:..    """.  
+00018be0: 2020 2320 666c 7573 6820 616c 6c20 7374    # flush all st
+00018bf0: 7265 616d 7320 6275 6666 6572 730a 2020  reams buffers.  
+00018c00: 2020 666f 7220 7374 7265 616d 5f69 642c    for stream_id,
+00018c10: 2073 7472 6561 6d5f 6275 6666 6572 2069   stream_buffer i
+00018c20: 6e20 6275 6666 6572 2e69 7465 6d73 2829  n buffer.items()
+00018c30: 3a0a 0a20 2020 2020 2020 2069 6620 7374  :..        if st
+00018c40: 7265 616d 5f62 7566 6665 723a 0a20 2020  ream_buffer:.   
+00018c50: 2020 2020 2020 2020 2073 7472 6561 6d20           stream 
+00018c60: 3d20 7374 7265 616d 735b 7374 7265 616d  = streams[stream
+00018c70: 5f69 645d 0a0a 2020 2020 2020 2020 2020  _id]..          
+00018c80: 2020 666f 7220 6275 6666 6572 6564 5f72    for buffered_r
+00018c90: 6f77 2069 6e20 6765 745f 6275 6666 6572  ow in get_buffer
+00018ca0: 5f72 6f77 735f 6672 6f6d 5f64 6228 6461  _rows_from_db(da
+00018cb0: 7461 6261 7365 5b73 7472 6561 6d5b 2774  tabase[stream['t
+00018cc0: 6162 6c65 5f6e 616d 6527 5d5d 2c0a 2020  able_name']],.  
+00018cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d00: 2020 2020 2020 7374 7265 616d 5f62 7566        stream_buf
+00018d10: 6665 7229 3a0a 2020 2020 2020 2020 2020  fer):.          
+00018d20: 2020 2020 2020 7265 636f 7264 5f6d 6573        record_mes
+00018d30: 7361 6765 203d 2063 6f6d 6d6f 6e2e 726f  sage = common.ro
+00018d40: 775f 746f 5f73 696e 6765 725f 7265 636f  w_to_singer_reco
+00018d50: 7264 2873 7472 6561 6d3d 7374 7265 616d  rd(stream=stream
+00018d60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00018da0: 6f77 3d62 7566 6665 7265 645f 726f 772c  ow=buffered_row,
+00018db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018de0: 2020 2020 2020 2020 2020 2020 2020 7469                ti
+00018df0: 6d65 5f65 7874 7261 6374 6564 3d75 7469  me_extracted=uti
+00018e00: 6c73 2e6e 6f77 2829 2c0a 2020 2020 2020  ls.now(),.      
+00018e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e40: 2020 2020 2020 2074 696d 655f 6465 6c65         time_dele
+00018e50: 7465 643d 4e6f 6e65 290a 2020 2020 2020  ted=None).      
+00018e60: 2020 2020 2020 2020 2020 7369 6e67 6572            singer
+00018e70: 2e77 7269 7465 5f6d 6573 7361 6765 2872  .write_message(r
+00018e80: 6563 6f72 645f 6d65 7373 6167 6529 0a0a  ecord_message)..
+00018e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ea0: 726f 7773 5f73 6176 6564 5b73 7472 6561  rows_saved[strea
+00018eb0: 6d5f 6964 5d20 2b3d 2031 0a0a 2020 2020  m_id] += 1..    
+00018ec0: 2020 2020 2020 2020 6275 6666 6572 5b73          buffer[s
+00018ed0: 7472 6561 6d5f 6964 5d2e 636c 6561 7228  tream_id].clear(
+00018ee0: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
+00018ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00018ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00019010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00019070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00019080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00019090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+000190a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000190b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000190c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000190d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000190e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000190f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00019110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000191a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000191b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000191c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000191d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000191e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000191f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019200: 3232 206d 7469 6d65 3d31 3637 3634 3530  22 mtime=1676450
+00019210: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
+00019220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000192f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000193f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019400: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00019410: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
+00019420: 5f73 7472 6174 6567 6965 732f 636f 6d6d  _strategies/comm
+00019430: 6f6e 2e70 7900 0000 0000 0000 0000 0000  on.py...........
+00019440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00019470: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00019480: 3030 3232 3236 3100 3030 3030 3030 3030  0022261.00000000
+00019490: 3030 3000 3032 3430 3636 0020 3000 0000  000.024066. 0...
+000194a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000194f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019500: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00019510: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00019520: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00019530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000195f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00019600: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
+00019610: 7974 686f 6e33 0a69 6d70 6f72 7420 6261  ython3.import ba
+00019620: 7365 3634 0a69 6d70 6f72 7420 6461 7465  se64.import date
+00019630: 7469 6d65 0a69 6d70 6f72 7420 7469 6d65  time.import time
+00019640: 0a69 6d70 6f72 7420 7575 6964 0a69 6d70  .import uuid.imp
+00019650: 6f72 7420 6273 6f6e 0a69 6d70 6f72 7420  ort bson.import 
+00019660: 7369 6e67 6572 0a69 6d70 6f72 7420 7079  singer.import py
+00019670: 747a 0a69 6d70 6f72 7420 747a 6c6f 6361  tz.import tzloca
+00019680: 6c0a 0a66 726f 6d20 7479 7069 6e67 2069  l..from typing i
+00019690: 6d70 6f72 7420 4469 6374 2c20 416e 792c  mport Dict, Any,
+000196a0: 204f 7074 696f 6e61 6c0a 6672 6f6d 2062   Optional.from b
+000196b0: 736f 6e20 696d 706f 7274 206f 626a 6563  son import objec
+000196c0: 7469 642c 2074 696d 6573 7461 6d70 2c20  tid, timestamp, 
+000196d0: 6461 7465 7469 6d65 2061 7320 6273 6f6e  datetime as bson
+000196e0: 5f64 6174 6574 696d 650a 6672 6f6d 2073  _datetime.from s
+000196f0: 696e 6765 7220 696d 706f 7274 2075 7469  inger import uti
+00019700: 6c73 2c20 6d65 7461 6461 7461 0a66 726f  ls, metadata.fro
+00019710: 6d20 7465 726d 696e 616c 7461 626c 6573  m terminaltables
+00019720: 2069 6d70 6f72 7420 4173 6369 6954 6162   import AsciiTab
+00019730: 6c65 0a0a 6672 6f6d 2064 7a5f 6d6f 6e67  le..from dz_mong
+00019740: 6f64 622e 6572 726f 7273 2069 6d70 6f72  odb.errors impor
+00019750: 7420 4d6f 6e67 6f49 6e76 616c 6964 4461  t MongoInvalidDa
+00019760: 7465 5469 6d65 4578 6365 7074 696f 6e2c  teTimeException,
+00019770: 2053 796e 6345 7863 6570 7469 6f6e 2c20   SyncException, 
+00019780: 556e 7375 7070 6f72 7465 644b 6579 5479  UnsupportedKeyTy
+00019790: 7065 4578 6365 7074 696f 6e0a 0a53 4443  peException..SDC
+000197a0: 5f44 454c 4554 4544 5f41 5420 3d20 225f  _DELETED_AT = "_
+000197b0: 7364 635f 6465 6c65 7465 645f 6174 220a  sdc_deleted_at".
+000197c0: 494e 434c 5544 455f 5343 4845 4d41 535f  INCLUDE_SCHEMAS_
+000197d0: 494e 5f44 4553 5449 4e41 5449 4f4e 5f53  IN_DESTINATION_S
+000197e0: 5452 4541 4d5f 4e41 4d45 203d 2046 616c  TREAM_NAME = Fal
+000197f0: 7365 0a55 5044 4154 455f 424f 4f4b 4d41  se.UPDATE_BOOKMA
+00019800: 524b 5f50 4552 494f 4420 3d20 3130 3030  RK_PERIOD = 1000
+00019810: 0a43 4f55 4e54 5320 3d20 7b7d 0a54 494d  .COUNTS = {}.TIM
+00019820: 4553 203d 207b 7d0a 5343 4845 4d41 5f43  ES = {}.SCHEMA_C
+00019830: 4f55 4e54 203d 207b 7d0a 5343 4845 4d41  OUNT = {}.SCHEMA
+00019840: 5f54 494d 4553 203d 207b 7d0a 0a0a 6465  _TIMES = {}...de
+00019850: 6620 6361 6c63 756c 6174 655f 6465 7374  f calculate_dest
+00019860: 696e 6174 696f 6e5f 7374 7265 616d 5f6e  ination_stream_n
+00019870: 616d 6528 7374 7265 616d 3a20 4469 6374  ame(stream: Dict
+00019880: 2920 2d3e 2073 7472 3a0a 2020 2020 2222  ) -> str:.    ""
+00019890: 220a 2020 2020 4275 696c 6473 2074 6865  ".    Builds the
+000198a0: 2072 6967 6874 2073 7472 6561 6d20 6e61   right stream na
+000198b0: 6d65 2074 6f20 6265 2077 7269 7474 656e  me to be written
+000198c0: 2069 6e20 7369 6e67 6572 206d 6573 7361   in singer messa
+000198d0: 6765 730a 2020 2020 4172 6773 3a0a 2020  ges.    Args:.  
+000198e0: 2020 2020 2020 7374 7265 616d 3a20 7374        stream: st
+000198f0: 7265 616d 2064 6963 7469 6f6e 6172 790a  ream dictionary.
+00019900: 0a20 2020 2052 6574 7572 6e73 3a20 7374  .    Returns: st
+00019910: 7220 686f 6c64 696e 6720 7468 6520 7374  r holding the st
+00019920: 7265 616d 206e 616d 650a 2020 2020 2222  ream name.    ""
+00019930: 220a 2020 2020 735f 6d64 203d 206d 6574  ".    s_md = met
+00019940: 6164 6174 612e 746f 5f6d 6170 2873 7472  adata.to_map(str
+00019950: 6561 6d5b 276d 6574 6164 6174 6127 5d29  eam['metadata'])
+00019960: 0a20 2020 2069 6620 494e 434c 5544 455f  .    if INCLUDE_
+00019970: 5343 4845 4d41 535f 494e 5f44 4553 5449  SCHEMAS_IN_DESTI
+00019980: 4e41 5449 4f4e 5f53 5452 4541 4d5f 4e41  NATION_STREAM_NA
+00019990: 4d45 3a0a 2020 2020 2020 2020 7265 7475  ME:.        retu
+000199a0: 726e 2066 227b 735f 6d64 2e67 6574 2828  rn f"{s_md.get((
+000199b0: 292c 207b 7d29 2e67 6574 2827 6461 7461  ), {}).get('data
+000199c0: 6261 7365 2d6e 616d 6527 297d 2d7b 7374  base-name')}-{st
+000199d0: 7265 616d 5b27 7374 7265 616d 275d 7d22  ream['stream']}"
+000199e0: 0a0a 2020 2020 7265 7475 726e 2073 7472  ..    return str
+000199f0: 6561 6d5b 2773 7472 6561 6d27 5d0a 0a0a  eam['stream']...
+00019a00: 6465 6620 6765 745f 7374 7265 616d 5f76  def get_stream_v
+00019a10: 6572 7369 6f6e 2874 6170 5f73 7472 6561  ersion(tap_strea
+00019a20: 6d5f 6964 3a20 7374 722c 2073 7461 7465  m_id: str, state
+00019a30: 3a20 4469 6374 2920 2d3e 2069 6e74 3a0a  : Dict) -> int:.
+00019a40: 2020 2020 2222 220a 2020 2020 4765 7420      """.    Get 
+00019a50: 7468 6520 7374 7265 616d 2076 6572 7369  the stream versi
+00019a60: 6f6e 2062 7920 6569 7468 6572 2065 7874  on by either ext
+00019a70: 7261 6374 696e 6720 6974 2066 726f 6d20  racting it from 
+00019a80: 7468 6520 7374 6174 6520 6f72 2067 656e  the state or gen
+00019a90: 6572 6174 696e 6720 6120 6e65 7720 6f6e  erating a new on
+00019aa0: 650a 2020 2020 4172 6773 3a0a 2020 2020  e.    Args:.    
+00019ab0: 2020 2020 7461 705f 7374 7265 616d 5f69      tap_stream_i
+00019ac0: 643a 2073 7472 6561 6d20 4944 2074 6f20  d: stream ID to 
+00019ad0: 6765 7420 7665 7273 696f 6e20 666f 720a  get version for.
+00019ae0: 2020 2020 2020 2020 7374 6174 653a 2073          state: s
+00019af0: 7461 7465 2064 6963 7469 6f6e 6172 7920  tate dictionary 
+00019b00: 746f 2065 7874 7261 6374 2076 6572 7369  to extract versi
+00019b10: 6f6e 2066 726f 6d20 6966 2065 7869 7374  on from if exist
+00019b20: 730a 0a20 2020 2052 6574 7572 6e73 3a20  s..    Returns: 
+00019b30: 7665 7273 696f 6e20 6173 2061 6e20 696e  version as an in
+00019b40: 7465 6765 720a 0a20 2020 2022 2222 0a20  teger..    """. 
+00019b50: 2020 2073 7472 6561 6d5f 7665 7273 696f     stream_versio
+00019b60: 6e20 3d20 7369 6e67 6572 2e67 6574 5f62  n = singer.get_b
+00019b70: 6f6f 6b6d 6172 6b28 7374 6174 652c 2074  ookmark(state, t
+00019b80: 6170 5f73 7472 6561 6d5f 6964 2c20 2776  ap_stream_id, 'v
+00019b90: 6572 7369 6f6e 2729 0a0a 2020 2020 6966  ersion')..    if
+00019ba0: 2073 7472 6561 6d5f 7665 7273 696f 6e20   stream_version 
+00019bb0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00019bc0: 2073 7472 6561 6d5f 7665 7273 696f 6e20   stream_version 
+00019bd0: 3d20 696e 7428 7469 6d65 2e74 696d 6528  = int(time.time(
+00019be0: 2920 2a20 3130 3030 290a 0a20 2020 2072  ) * 1000)..    r
+00019bf0: 6574 7572 6e20 7374 7265 616d 5f76 6572  eturn stream_ver
+00019c00: 7369 6f6e 0a0a 0a64 6566 2063 6c61 7373  sion...def class
+00019c10: 5f74 6f5f 7374 7269 6e67 286b 6579 5f76  _to_string(key_v
+00019c20: 616c 7565 3a20 416e 792c 206b 6579 5f74  alue: Any, key_t
+00019c30: 7970 653a 2073 7472 2920 2d3e 2073 7472  ype: str) -> str
+00019c40: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
+00019c50: 6e76 6572 7473 2073 7065 6369 6669 6320  nverts specific 
+00019c60: 7479 7065 7320 746f 2073 7472 696e 6720  types to string 
+00019c70: 6571 7569 7661 6c65 6e74 0a20 2020 2054  equivalent.    T
+00019c80: 6865 2073 7570 706f 7274 6564 2074 7970  he supported typ
+00019c90: 6573 2061 7265 3a20 6461 7465 7469 6d65  es are: datetime
+00019ca0: 2c20 6273 6f6e 2054 696d 6573 7461 6d70  , bson Timestamp
+00019cb0: 2c20 6279 7465 732c 2069 6e74 2c20 496e  , bytes, int, In
+00019cc0: 7436 342c 2066 6c6f 6174 2c20 4f62 6a65  t64, float, Obje
+00019cd0: 6374 4964 2c20 7374 7220 616e 6420 5555  ctId, str and UU
+00019ce0: 4944 0a20 2020 2041 7267 733a 0a20 2020  ID.    Args:.   
+00019cf0: 2020 2020 206b 6579 5f76 616c 7565 3a20       key_value: 
+00019d00: 5468 6520 7661 6c75 6520 746f 2063 6f6e  The value to con
+00019d10: 7665 7274 2074 6f20 7374 7269 6e67 0a20  vert to string. 
+00019d20: 2020 2020 2020 206b 6579 5f74 7970 653a         key_type:
+00019d30: 2074 6865 2076 616c 7565 2074 7970 650a   the value type.
+00019d40: 0a20 2020 2052 6574 7572 6e73 3a20 7374  .    Returns: st
+00019d50: 7269 6e67 2065 7175 6976 616c 656e 7420  ring equivalent 
+00019d60: 6f66 206b 6579 2076 616c 7565 0a20 2020  of key value.   
+00019d70: 2052 6169 7365 733a 2055 6e73 7570 706f   Raises: Unsuppo
+00019d80: 7274 6564 4b65 7954 7970 6545 7863 6570  rtedKeyTypeExcep
+00019d90: 7469 6f6e 2069 6620 6b65 795f 7479 7065  tion if key_type
+00019da0: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+00019db0: 640a 2020 2020 2222 220a 2020 2020 6966  d.    """.    if
+00019dc0: 206b 6579 5f74 7970 6520 3d3d 2027 6461   key_type == 'da
+00019dd0: 7465 7469 6d65 273a 0a20 2020 2020 2020  tetime':.       
+00019de0: 2069 6620 6b65 795f 7661 6c75 652e 747a   if key_value.tz
+00019df0: 696e 666f 2069 7320 4e6f 6e65 3a0a 2020  info is None:.  
+00019e00: 2020 2020 2020 2020 2020 7469 6d65 7a6f            timezo
+00019e10: 6e65 203d 2074 7a6c 6f63 616c 2e67 6574  ne = tzlocal.get
+00019e20: 5f6c 6f63 616c 7a6f 6e65 2829 0a20 2020  _localzone().   
+00019e30: 2020 2020 2020 2020 206c 6f63 616c 5f64           local_d
+00019e40: 6174 6574 696d 6520 3d20 7469 6d65 7a6f  atetime = timezo
+00019e50: 6e65 2e6c 6f63 616c 697a 6528 6b65 795f  ne.localize(key_
+00019e60: 7661 6c75 6529 0a20 2020 2020 2020 2020  value).         
+00019e70: 2020 2075 7463 5f64 6174 6574 696d 6520     utc_datetime 
+00019e80: 3d20 6c6f 6361 6c5f 6461 7465 7469 6d65  = local_datetime
+00019e90: 2e61 7374 696d 657a 6f6e 6528 7079 747a  .astimezone(pytz
+00019ea0: 2e55 5443 290a 2020 2020 2020 2020 656c  .UTC).        el
+00019eb0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00019ec0: 7574 635f 6461 7465 7469 6d65 203d 206b  utc_datetime = k
+00019ed0: 6579 5f76 616c 7565 2e61 7374 696d 657a  ey_value.astimez
+00019ee0: 6f6e 6528 7079 747a 2e55 5443 290a 0a20  one(pytz.UTC).. 
+00019ef0: 2020 2020 2020 2072 6574 7572 6e20 7574         return ut
+00019f00: 696c 732e 7374 7266 7469 6d65 2875 7463  ils.strftime(utc
+00019f10: 5f64 6174 6574 696d 6529 0a0a 2020 2020  _datetime)..    
+00019f20: 6966 206b 6579 5f74 7970 6520 3d3d 2027  if key_type == '
+00019f30: 5469 6d65 7374 616d 7027 3a0a 2020 2020  Timestamp':.    
+00019f40: 2020 2020 7265 7475 726e 2066 277b 6b65      return f'{ke
+00019f50: 795f 7661 6c75 652e 7469 6d65 7d2e 7b6b  y_value.time}.{k
+00019f60: 6579 5f76 616c 7565 2e69 6e63 7d27 0a0a  ey_value.inc}'..
+00019f70: 2020 2020 6966 206b 6579 5f74 7970 6520      if key_type 
+00019f80: 3d3d 2027 6279 7465 7327 3a0a 2020 2020  == 'bytes':.    
+00019f90: 2020 2020 7265 7475 726e 2062 6173 6536      return base6
+00019fa0: 342e 6236 3465 6e63 6f64 6528 6b65 795f  4.b64encode(key_
+00019fb0: 7661 6c75 6529 2e64 6563 6f64 6528 2775  value).decode('u
+00019fc0: 7466 2d38 2729 0a0a 2020 2020 6966 206b  tf-8')..    if k
+00019fd0: 6579 5f74 7970 6520 696e 205b 2769 6e74  ey_type in ['int
+00019fe0: 272c 2027 496e 7436 3427 2c20 2766 6c6f  ', 'Int64', 'flo
+00019ff0: 6174 272c 2027 4f62 6a65 6374 4964 272c  at', 'ObjectId',
+0001a000: 2027 7374 7227 2c20 2755 5549 4427 5d3a   'str', 'UUID']:
+0001a010: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001a020: 7374 7228 6b65 795f 7661 6c75 6529 0a0a  str(key_value)..
+0001a030: 2020 2020 7261 6973 6520 556e 7375 7070      raise Unsupp
+0001a040: 6f72 7465 644b 6579 5479 7065 4578 6365  ortedKeyTypeExce
+0001a050: 7074 696f 6e28 6622 7b6b 6579 5f74 7970  ption(f"{key_typ
+0001a060: 657d 2069 7320 6e6f 7420 6120 7375 7070  e} is not a supp
+0001a070: 6f72 7465 6420 6b65 7920 7479 7065 2229  orted key type")
+0001a080: 0a0a 0a64 6566 2073 7472 696e 675f 746f  ...def string_to
+0001a090: 5f63 6c61 7373 2873 7472 5f76 616c 7565  _class(str_value
+0001a0a0: 3a20 7374 722c 2074 7970 655f 7661 6c75  : str, type_valu
+0001a0b0: 653a 2073 7472 2920 2d3e 2041 6e79 3a0a  e: str) -> Any:.
+0001a0c0: 2020 2020 2222 220a 2020 2020 436f 6e76      """.    Conv
+0001a0d0: 6572 7473 2074 6865 2073 7472 696e 6720  erts the string 
+0001a0e0: 7661 6c75 6520 696e 746f 2074 6865 2067  value into the g
+0001a0f0: 6976 656e 2074 7970 6520 6966 2073 7570  iven type if sup
+0001a100: 706f 7274 6564 2e0a 2020 2020 5468 6520  ported..    The 
+0001a110: 7375 7070 6f72 7465 6420 7479 7065 7320  supported types 
+0001a120: 6172 653a 2055 5549 442c 2064 6174 6574  are: UUID, datet
+0001a130: 696d 652c 2069 6e74 2c20 496e 7436 342c  ime, int, Int64,
+0001a140: 2066 6c6f 6174 2c20 4f62 6a65 6374 4964   float, ObjectId
+0001a150: 2c20 5469 6d65 7374 616d 702c 2062 7974  , Timestamp, byt
+0001a160: 6573 2c20 7374 720a 2020 2020 4172 6773  es, str.    Args
+0001a170: 3a0a 2020 2020 2020 2020 7374 725f 7661  :.        str_va
+0001a180: 6c75 653a 2074 6865 2073 7472 696e 6720  lue: the string 
+0001a190: 7661 6c75 6520 746f 2063 6f6e 7665 7274  value to convert
+0001a1a0: 0a20 2020 2020 2020 2074 7970 655f 7661  .        type_va
+0001a1b0: 6c75 653a 2074 6865 2076 616c 7565 2074  lue: the value t
+0001a1c0: 7970 650a 0a20 2020 2052 6574 7572 6e73  ype..    Returns
+0001a1d0: 3a20 636f 6e76 6572 7465 6420 7374 7269  : converted stri
+0001a1e0: 6e67 2076 616c 7565 0a20 2020 2052 6169  ng value.    Rai
+0001a1f0: 7365 733a 2055 6e73 7570 706f 7274 6564  ses: Unsupported
+0001a200: 4b65 7954 7970 6545 7863 6570 7469 6f6e  KeyTypeException
+0001a210: 2069 6620 6b65 7920 6973 2075 6e73 7570   if key is unsup
+0001a220: 706f 7274 6564 0a20 2020 2022 2222 0a0a  ported.    """..
+0001a230: 2020 2020 636f 6e76 6572 7369 6f6e 203d      conversion =
+0001a240: 207b 0a20 2020 2020 2020 2027 5555 4944   {.        'UUID
+0001a250: 273a 2075 7569 642e 5555 4944 2c0a 2020  ': uuid.UUID,.  
+0001a260: 2020 2020 2020 2764 6174 6574 696d 6527        'datetime'
+0001a270: 3a20 7369 6e67 6572 2e75 7469 6c73 2e73  : singer.utils.s
+0001a280: 7472 7074 696d 655f 7769 7468 5f74 7a2c  trptime_with_tz,
+0001a290: 0a20 2020 2020 2020 2027 696e 7427 3a20  .        'int': 
+0001a2a0: 696e 742c 0a20 2020 2020 2020 2027 496e  int,.        'In
+0001a2b0: 7436 3427 3a20 6273 6f6e 2e69 6e74 3634  t64': bson.int64
+0001a2c0: 2e49 6e74 3634 2c0a 2020 2020 2020 2020  .Int64,.        
+0001a2d0: 2766 6c6f 6174 273a 2073 7472 2c0a 2020  'float': str,.  
+0001a2e0: 2020 2020 2020 274f 626a 6563 7449 6427        'ObjectId'
+0001a2f0: 3a20 6f62 6a65 6374 6964 2e4f 626a 6563  : objectid.Objec
+0001a300: 7449 642c 0a20 2020 2020 2020 2027 5469  tId,.        'Ti
+0001a310: 6d65 7374 616d 7027 3a20 6c61 6d62 6461  mestamp': lambda
+0001a320: 2076 616c 3a20 286c 616d 6264 6120 7370   val: (lambda sp
+0001a330: 6c69 745f 7661 6c75 653d 7661 6c2e 7370  lit_value=val.sp
+0001a340: 6c69 7428 272e 2729 3a0a 2020 2020 2020  lit('.'):.      
 0001a350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a360: 2076 6572 7369 6f6e 3a20 4f70 7469 6f6e   version: Option
-0001a370: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
-0001a380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a390: 2020 2020 2020 2020 2029 202d 3e20 7369           ) -> si
-0001a3a0: 6e67 6572 2e52 6563 6f72 644d 6573 7361  nger.RecordMessa
-0001a3b0: 6765 3a0a 2020 2020 2222 220a 2020 2020  ge:.    """.    
-0001a3c0: 5472 616e 7366 6f72 6d73 2072 6f77 2074  Transforms row t
-0001a3d0: 6f20 7369 6e67 6572 2072 6563 6f72 6420  o singer record 
-0001a3e0: 6d65 7373 6167 650a 2020 2020 4172 6773  message.    Args
-0001a3f0: 3a0a 2020 2020 2020 2020 7469 6d65 5f64  :.        time_d
-0001a400: 656c 6574 6564 3a20 4461 7465 7469 6d65  eleted: Datetime
-0001a410: 2077 6865 6e20 726f 7720 676f 7420 6465   when row got de
-0001a420: 6c65 7465 640a 2020 2020 2020 2020 7374  leted.        st
-0001a430: 7265 616d 3a20 7374 7265 616d 2064 6574  ream: stream det
-0001a440: 6169 6c73 0a20 2020 2020 2020 2072 6f77  ails.        row
-0001a450: 3a20 4442 2072 6f77 0a20 2020 2020 2020  : DB row.       
-0001a460: 2076 6572 7369 6f6e 3a20 7374 7265 616d   version: stream
-0001a470: 2076 6572 7369 6f6e 0a20 2020 2020 2020   version.       
-0001a480: 2074 696d 655f 6578 7472 6163 7465 643a   time_extracted:
-0001a490: 2044 6174 6574 696d 6520 7768 656e 2072   Datetime when r
-0001a4a0: 6f77 2077 6173 2065 7874 7261 6374 6564  ow was extracted
-0001a4b0: 0a0a 2020 2020 5265 7475 726e 733a 2053  ..    Returns: S
-0001a4c0: 696e 6765 7220 5265 636f 7264 4d65 7373  inger RecordMess
-0001a4d0: 6167 6520 696e 7374 616e 6365 0a0a 2020  age instance..  
-0001a4e0: 2020 2222 220a 0a20 2020 2069 6620 7665    """..    if ve
-0001a4f0: 7273 696f 6e20 6973 204e 6f6e 653a 0a20  rsion is None:. 
-0001a500: 2020 2020 2020 2076 6572 7369 6f6e 203d         version =
-0001a510: 2069 6e74 2874 696d 652e 7469 6d65 2829   int(time.time()
-0001a520: 202a 2031 3030 3029 0a0a 2020 2020 7472   * 1000)..    tr
-0001a530: 793a 0a20 2020 2020 2020 2072 6f77 5f74  y:.        row_t
-0001a540: 6f5f 7065 7273 6973 7420 3d20 7b6b 3a20  o_persist = {k: 
-0001a550: 7472 616e 7366 6f72 6d5f 7661 6c75 6528  transform_value(
-0001a560: 762c 205b 6b5d 2920 666f 7220 6b2c 2076  v, [k]) for k, v
-0001a570: 2069 6e20 726f 772e 6974 656d 7328 290a   in row.items().
-0001a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a590: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0001a5a0: 2069 7369 6e73 7461 6e63 6528 762c 2028   isinstance(v, (
-0001a5b0: 6273 6f6e 2e6d 696e 5f6b 6579 2e4d 696e  bson.min_key.Min
-0001a5c0: 4b65 792c 2062 736f 6e2e 6d61 785f 6b65  Key, bson.max_ke
-0001a5d0: 792e 4d61 784b 6579 2929 7d0a 2020 2020  y.MaxKey))}.    
-0001a5e0: 6578 6365 7074 204d 6f6e 676f 496e 7661  except MongoInva
-0001a5f0: 6c69 6444 6174 6554 696d 6545 7863 6570  lidDateTimeExcep
-0001a600: 7469 6f6e 2061 7320 6578 3a0a 2020 2020  tion as ex:.    
-0001a610: 2020 2020 7261 6973 6520 5379 6e63 4578      raise SyncEx
-0001a620: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
-0001a630: 2020 2020 2066 2245 7272 6f72 2073 796e       f"Error syn
-0001a640: 6369 6e67 2063 6f6c 6c65 6374 696f 6e20  cing collection 
-0001a650: 7b73 7472 6561 6d5b 2774 6170 5f73 7472  {stream['tap_str
-0001a660: 6561 6d5f 6964 275d 7d2c 206f 626a 6563  eam_id']}, objec
-0001a670: 7420 4944 207b 726f 775b 275f 6964 275d  t ID {row['_id']
-0001a680: 7d20 2d20 7b65 787d 2229 2066 726f 6d20  } - {ex}") from 
-0001a690: 6578 0a0a 2020 2020 726f 775f 746f 5f70  ex..    row_to_p
-0001a6a0: 6572 7369 7374 203d 207b 0a20 2020 2020  ersist = {.     
-0001a6b0: 2020 2027 5f69 6427 3a20 726f 775f 746f     '_id': row_to
-0001a6c0: 5f70 6572 7369 7374 5b27 5f69 6427 5d2c  _persist['_id'],
-0001a6d0: 0a20 2020 2020 2020 2027 646f 6375 6d65  .        'docume
-0001a6e0: 6e74 273a 2072 6f77 5f74 6f5f 7065 7273  nt': row_to_pers
-0001a6f0: 6973 742c 0a20 2020 2020 2020 2053 4443  ist,.        SDC
-0001a700: 5f44 454c 4554 4544 5f41 543a 2075 7469  _DELETED_AT: uti
-0001a710: 6c73 2e73 7472 6674 696d 6528 7469 6d65  ls.strftime(time
-0001a720: 5f64 656c 6574 6564 2920 6966 2074 696d  _deleted) if tim
-0001a730: 655f 6465 6c65 7465 6420 656c 7365 204e  e_deleted else N
-0001a740: 6f6e 650a 2020 2020 7d0a 0a20 2020 2072  one.    }..    r
-0001a750: 6574 7572 6e20 7369 6e67 6572 2e52 6563  eturn singer.Rec
-0001a760: 6f72 644d 6573 7361 6765 280a 2020 2020  ordMessage(.    
-0001a770: 2020 2020 7374 7265 616d 3d63 616c 6375      stream=calcu
-0001a780: 6c61 7465 5f64 6573 7469 6e61 7469 6f6e  late_destination
-0001a790: 5f73 7472 6561 6d5f 6e61 6d65 2873 7472  _stream_name(str
-0001a7a0: 6561 6d29 2c0a 2020 2020 2020 2020 7265  eam),.        re
-0001a7b0: 636f 7264 3d72 6f77 5f74 6f5f 7065 7273  cord=row_to_pers
-0001a7c0: 6973 742c 0a20 2020 2020 2020 2076 6572  ist,.        ver
-0001a7d0: 7369 6f6e 3d76 6572 7369 6f6e 2c0a 2020  sion=version,.  
-0001a7e0: 2020 2020 2020 7469 6d65 5f65 7874 7261        time_extra
-0001a7f0: 6374 6564 3d74 696d 655f 6578 7472 6163  cted=time_extrac
-0001a800: 7465 6429 0a0a 0a64 6566 2067 6574 5f73  ted)...def get_s
-0001a810: 796e 635f 7375 6d6d 6172 7928 6361 7461  ync_summary(cata
-0001a820: 6c6f 6729 2d3e 7374 723a 0a20 2020 2022  log)->str:.    "
-0001a830: 2222 0a20 2020 2042 7569 6c64 7320 6120  "".    Builds a 
-0001a840: 7375 6d6d 6172 7920 6f66 2073 796e 6320  summary of sync 
-0001a850: 666f 7220 616c 6c20 7374 7265 616d 730a  for all streams.
-0001a860: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0001a870: 2020 6361 7461 6c6f 673a 2064 6963 7469    catalog: dicti
-0001a880: 6f6e 6172 7920 7769 7468 2061 6c6c 2074  onary with all t
-0001a890: 6865 2073 7472 6561 6d73 2064 6574 6169  he streams detai
-0001a8a0: 6c73 0a0a 2020 2020 5265 7475 726e 733a  ls..    Returns:
-0001a8b0: 2073 756d 6d61 7279 2074 6162 6c65 2061   summary table a
-0001a8c0: 7320 7374 7269 6e67 0a0a 2020 2020 2222  s string..    ""
-0001a8d0: 220a 2020 2020 6865 6164 6572 7320 3d20  ".    headers = 
-0001a8e0: 5b5b 2764 6174 6162 6173 6527 2c0a 2020  [['database',.  
-0001a8f0: 2020 2020 2020 2020 2020 2020 2020 2763                'c
-0001a900: 6f6c 6c65 6374 696f 6e27 2c0a 2020 2020  ollection',.    
-0001a910: 2020 2020 2020 2020 2020 2020 2772 6570              'rep
-0001a920: 6c69 6361 7469 6f6e 206d 6574 686f 6427  lication method'
-0001a930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a940: 2020 2774 6f74 616c 2072 6563 6f72 6473    'total records
-0001a950: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0001a960: 2020 2027 7772 6974 6520 7370 6565 6427     'write speed'
-0001a970: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a980: 2020 2774 6f74 616c 2074 696d 6527 2c0a    'total time',.
-0001a990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a9a0: 2773 6368 656d 6173 2077 7269 7474 656e  'schemas written
-0001a9b0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0001a9c0: 2020 2027 7363 6865 6d61 2062 7569 6c64     'schema build
-0001a9d0: 2064 7572 6174 696f 6e27 2c0a 2020 2020   duration',.    
-0001a9e0: 2020 2020 2020 2020 2020 2020 2770 6572              'per
-0001a9f0: 6365 6e74 2062 7569 6c64 696e 6720 7363  cent building sc
-0001aa00: 6865 6d61 7327 5d5d 0a0a 2020 2020 726f  hemas']]..    ro
-0001aa10: 7773 203d 205b 5d0a 2020 2020 666f 7220  ws = [].    for 
-0001aa20: 7374 7265 616d 5f69 642c 2073 7472 6561  stream_id, strea
-0001aa30: 6d5f 636f 756e 7420 696e 2043 4f55 4e54  m_count in COUNT
-0001aa40: 532e 6974 656d 7328 293a 0a20 2020 2020  S.items():.     
-0001aa50: 2020 2073 7472 6561 6d20 3d20 5b78 2066     stream = [x f
-0001aa60: 6f72 2078 2069 6e20 6361 7461 6c6f 675b  or x in catalog[
-0001aa70: 2773 7472 6561 6d73 275d 2069 6620 785b  'streams'] if x[
-0001aa80: 2774 6170 5f73 7472 6561 6d5f 6964 275d  'tap_stream_id']
-0001aa90: 203d 3d20 7374 7265 616d 5f69 645d 5b30   == stream_id][0
-0001aaa0: 5d0a 2020 2020 2020 2020 636f 6c6c 6563  ].        collec
-0001aab0: 7469 6f6e 5f6e 616d 6520 3d20 7374 7265  tion_name = stre
-0001aac0: 616d 2e67 6574 2822 7461 626c 655f 6e61  am.get("table_na
-0001aad0: 6d65 2229 0a20 2020 2020 2020 206d 645f  me").        md_
-0001aae0: 6d61 7020 3d20 6d65 7461 6461 7461 2e74  map = metadata.t
-0001aaf0: 6f5f 6d61 7028 7374 7265 616d 5b27 6d65  o_map(stream['me
-0001ab00: 7461 6461 7461 275d 290a 2020 2020 2020  tadata']).      
-0001ab10: 2020 6462 5f6e 616d 6520 3d20 6d65 7461    db_name = meta
-0001ab20: 6461 7461 2e67 6574 286d 645f 6d61 702c  data.get(md_map,
-0001ab30: 2028 292c 2027 6461 7461 6261 7365 2d6e   (), 'database-n
-0001ab40: 616d 6527 290a 2020 2020 2020 2020 7265  ame').        re
-0001ab50: 706c 6963 6174 696f 6e5f 6d65 7468 6f64  plication_method
-0001ab60: 203d 206d 6574 6164 6174 612e 6765 7428   = metadata.get(
-0001ab70: 6d64 5f6d 6170 2c20 2829 2c20 2772 6570  md_map, (), 'rep
-0001ab80: 6c69 6361 7469 6f6e 2d6d 6574 686f 6427  lication-method'
-0001ab90: 290a 0a20 2020 2020 2020 2073 7472 6561  )..        strea
-0001aba0: 6d5f 7469 6d65 203d 2054 494d 4553 5b73  m_time = TIMES[s
-0001abb0: 7472 6561 6d5f 6964 5d0a 2020 2020 2020  tream_id].      
-0001abc0: 2020 7363 6865 6d61 735f 7772 6974 7465    schemas_writte
-0001abd0: 6e20 3d20 5343 4845 4d41 5f43 4f55 4e54  n = SCHEMA_COUNT
-0001abe0: 5b73 7472 6561 6d5f 6964 5d0a 2020 2020  [stream_id].    
-0001abf0: 2020 2020 7363 6865 6d61 5f64 7572 6174      schema_durat
-0001ac00: 696f 6e20 3d20 5343 4845 4d41 5f54 494d  ion = SCHEMA_TIM
-0001ac10: 4553 5b73 7472 6561 6d5f 6964 5d0a 0a20  ES[stream_id].. 
-0001ac20: 2020 2020 2020 2069 6620 7374 7265 616d         if stream
-0001ac30: 5f74 696d 6520 3d3d 2030 3a0a 2020 2020  _time == 0:.    
-0001ac40: 2020 2020 2020 2020 7374 7265 616d 5f74          stream_t
-0001ac50: 696d 6520 3d20 302e 3030 3030 3031 0a0a  ime = 0.000001..
-0001ac60: 2020 2020 2020 2020 726f 7773 2e61 7070          rows.app
-0001ac70: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
-0001ac80: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-0001ac90: 2020 2064 625f 6e61 6d65 2c0a 2020 2020     db_name,.    
-0001aca0: 2020 2020 2020 2020 2020 2020 636f 6c6c              coll
-0001acb0: 6563 7469 6f6e 5f6e 616d 652c 0a20 2020  ection_name,.   
-0001acc0: 2020 2020 2020 2020 2020 2020 2072 6570               rep
-0001acd0: 6c69 6361 7469 6f6e 5f6d 6574 686f 642c  lication_method,
-0001ace0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001acf0: 2066 277b 7374 7265 616d 5f63 6f75 6e74   f'{stream_count
-0001ad00: 7d20 7265 636f 7264 7327 2c0a 2020 2020  } records',.    
-0001ad10: 2020 2020 2020 2020 2020 2020 6627 7b73              f'{s
-0001ad20: 7472 6561 6d5f 636f 756e 7420 2f20 666c  tream_count / fl
-0001ad30: 6f61 7428 7374 7265 616d 5f74 696d 6529  oat(stream_time)
-0001ad40: 3a2e 3166 7d20 7265 636f 7264 732f 7365  :.1f} records/se
-0001ad50: 636f 6e64 272c 0a20 2020 2020 2020 2020  cond',.         
-0001ad60: 2020 2020 2020 2066 277b 7374 7265 616d         f'{stream
-0001ad70: 5f74 696d 653a 2e35 667d 2073 6563 6f6e  _time:.5f} secon
-0001ad80: 6473 272c 0a20 2020 2020 2020 2020 2020  ds',.           
-0001ad90: 2020 2020 2066 277b 7363 6865 6d61 735f       f'{schemas_
-0001ada0: 7772 6974 7465 6e7d 2073 6368 656d 6173  written} schemas
-0001adb0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0001adc0: 2020 2066 277b 7363 6865 6d61 5f64 7572     f'{schema_dur
-0001add0: 6174 696f 6e3a 2e35 667d 2073 6563 6f6e  ation:.5f} secon
-0001ade0: 6473 272c 0a20 2020 2020 2020 2020 2020  ds',.           
-0001adf0: 2020 2020 2066 277b 3130 3020 2a20 7363       f'{100 * sc
-0001ae00: 6865 6d61 5f64 7572 6174 696f 6e20 2f20  hema_duration / 
-0001ae10: 666c 6f61 7428 7374 7265 616d 5f74 696d  float(stream_tim
-0001ae20: 6529 3a2e 3266 7d25 270a 2020 2020 2020  e):.2f}%'.      
-0001ae30: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0001ae40: 290a 0a20 2020 2064 6174 6120 3d20 6865  )..    data = he
-0001ae50: 6164 6572 7320 2b20 726f 7773 0a20 2020  aders + rows.   
-0001ae60: 2074 6162 6c65 203d 2041 7363 6969 5461   table = AsciiTa
-0001ae70: 626c 6528 6461 7461 2c20 7469 746c 653d  ble(data, title=
-0001ae80: 2753 796e 6320 5375 6d6d 6172 7927 290a  'Sync Summary').
-0001ae90: 0a20 2020 2072 6574 7572 6e20 275c 6e5c  .    return '\n\
-0001aea0: 6e27 202b 2074 6162 6c65 2e74 6162 6c65  n' + table.table
-0001aeb0: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
-0001aec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001af90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001afa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001afb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001afc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001afd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001afe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001aff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0001b010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0001b070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001b080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0001b090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-0001b0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001b110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b200: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-0001b210: 3136 362e 300a 0000 0000 0000 0000 0000  166.0...........
-0001b220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b400: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-0001b410: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
-0001b420: 5f73 7472 6174 6567 6965 732f 6675 6c6c  _strategies/full
-0001b430: 5f74 6162 6c65 2e70 7900 0000 0000 0000  _table.py.......
-0001b440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0001b470: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0001b480: 3030 3133 3730 3700 3030 3030 3030 3030  0013707.00000000
-0001b490: 3030 3000 3032 3437 3133 0020 3000 0000  000.024713. 0...
-0001b4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b500: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-0001b510: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-0001b520: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
-0001b530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b600: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
-0001b610: 7974 686f 6e33 0a69 6d70 6f72 7420 636f  ython3.import co
-0001b620: 7079 0a69 6d70 6f72 7420 7469 6d65 0a69  py.import time.i
-0001b630: 6d70 6f72 7420 7079 6d6f 6e67 6f0a 696d  mport pymongo.im
-0001b640: 706f 7274 2073 696e 6765 720a 0a66 726f  port singer..fro
-0001b650: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
-0001b660: 4f70 7469 6f6e 616c 2c20 4469 6374 0a66  Optional, Dict.f
-0001b670: 726f 6d20 7079 6d6f 6e67 6f2e 636f 6c6c  rom pymongo.coll
-0001b680: 6563 7469 6f6e 2069 6d70 6f72 7420 436f  ection import Co
-0001b690: 6c6c 6563 7469 6f6e 0a66 726f 6d20 7369  llection.from si
-0001b6a0: 6e67 6572 2069 6d70 6f72 7420 7574 696c  nger import util
-0001b6b0: 730a 0a66 726f 6d20 647a 5f6d 6f6e 676f  s..from dz_mongo
-0001b6c0: 6462 2e73 796e 635f 7374 7261 7465 6769  db.sync_strategi
-0001b6d0: 6573 2069 6d70 6f72 7420 636f 6d6d 6f6e  es import common
-0001b6e0: 0a0a 4c4f 4747 4552 203d 2073 696e 6765  ..LOGGER = singe
-0001b6f0: 722e 6765 745f 6c6f 6767 6572 2827 647a  r.get_logger('dz
-0001b700: 5f6d 6f6e 676f 6462 2729 0a0a 0a64 6566  _mongodb')...def
-0001b710: 2067 6574 5f6d 6178 5f69 645f 7661 6c75   get_max_id_valu
-0001b720: 6528 636f 6c6c 6563 7469 6f6e 3a20 436f  e(collection: Co
-0001b730: 6c6c 6563 7469 6f6e 2920 2d3e 204f 7074  llection) -> Opt
-0001b740: 696f 6e61 6c5b 7374 725d 3a0a 2020 2020  ional[str]:.    
-0001b750: 2222 220a 2020 2020 4669 6e64 7320 616e  """.    Finds an
-0001b760: 6420 7265 7475 726e 7320 7468 6520 6d61  d returns the ma
-0001b770: 7869 6d75 6d20 4944 2069 6e20 7468 6520  ximum ID in the 
-0001b780: 636f 6c6c 6563 7469 6f6e 2069 6620 6578  collection if ex
-0001b790: 6973 7473 204e 6f6e 6520 6f74 6865 7277  ists None otherw
-0001b7a0: 6973 650a 2020 2020 4172 6773 3a0a 2020  ise.    Args:.  
-0001b7b0: 2020 2020 2020 636f 6c6c 6563 7469 6f6e        collection
-0001b7c0: 3a20 4d6f 6e67 6f44 4220 436f 6c6c 6563  : MongoDB Collec
-0001b7d0: 7469 6f6e 2069 6e73 7461 6e63 650a 0a20  tion instance.. 
-0001b7e0: 2020 2052 6574 7572 6e73 3a20 4d61 7820     Returns: Max 
-0001b7f0: 4944 206f 7220 4e6f 6e65 0a0a 2020 2020  ID or None..    
-0001b800: 2222 220a 2020 2020 726f 7720 3d20 636f  """.    row = co
-0001b810: 6c6c 6563 7469 6f6e 2e66 696e 645f 6f6e  llection.find_on
-0001b820: 6528 736f 7274 3d5b 2822 5f69 6422 2c20  e(sort=[("_id", 
-0001b830: 7079 6d6f 6e67 6f2e 4445 5343 454e 4449  pymongo.DESCENDI
-0001b840: 4e47 295d 290a 2020 2020 6966 2072 6f77  NG)]).    if row
-0001b850: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001b860: 2072 6f77 5b27 5f69 6427 5d0a 0a20 2020   row['_id']..   
-0001b870: 204c 4f47 4745 522e 696e 666f 2822 4e6f   LOGGER.info("No
-0001b880: 206d 6178 2069 6420 666f 756e 6420 666f   max id found fo
-0001b890: 7220 636f 6c6c 6563 7469 6f6e 3a20 636f  r collection: co
-0001b8a0: 6c6c 6563 7469 6f6e 2069 7320 6c69 6b65  llection is like
-0001b8b0: 6c79 2065 6d70 7479 2229 0a20 2020 2072  ly empty").    r
-0001b8c0: 6574 7572 6e20 4e6f 6e65 0a0a 0a64 6566  eturn None...def
-0001b8d0: 2073 796e 635f 636f 6c6c 6563 7469 6f6e   sync_collection
-0001b8e0: 2863 6f6c 6c65 6374 696f 6e3a 2043 6f6c  (collection: Col
-0001b8f0: 6c65 6374 696f 6e2c 2073 7472 6561 6d3a  lection, stream:
-0001b900: 2044 6963 742c 2073 7461 7465 3a20 4469   Dict, state: Di
-0001b910: 6374 2920 2d3e 204e 6f6e 653a 0a20 2020  ct) -> None:.   
-0001b920: 2022 2222 0a20 2020 2053 796e 6320 636f   """.    Sync co
-0001b930: 6c6c 6563 7469 6f6e 2072 6563 6f72 6473  llection records
-0001b940: 2069 6e63 7265 6d65 6e74 616c 6c79 0a20   incrementally. 
-0001b950: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0001b960: 2063 6f6c 6c65 6374 696f 6e3a 204d 6f6e   collection: Mon
-0001b970: 676f 4442 2063 6f6c 6c65 6374 696f 6e20  goDB collection 
-0001b980: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
-0001b990: 2073 7472 6561 6d3a 2064 6963 7469 6f6e   stream: diction
-0001b9a0: 6172 7920 6f66 2061 6c6c 2073 7472 6561  ary of all strea
-0001b9b0: 6d20 6465 7461 696c 730a 2020 2020 2020  m details.      
-0001b9c0: 2020 7374 6174 653a 2074 6865 2074 6170    state: the tap
-0001b9d0: 2073 7461 7465 0a20 2020 2022 2222 0a20   state.    """. 
-0001b9e0: 2020 204c 4f47 4745 522e 696e 666f 2827     LOGGER.info('
-0001b9f0: 5374 6172 7469 6e67 2066 756c 6c20 7461  Starting full ta
-0001ba00: 626c 6520 7379 6e63 2066 6f72 2025 7327  ble sync for %s'
-0001ba10: 2c20 7374 7265 616d 5b27 7461 705f 7374  , stream['tap_st
-0001ba20: 7265 616d 5f69 6427 5d29 0a0a 2020 2020  ream_id'])..    
-0001ba30: 2320 6265 666f 7265 2077 7269 7469 6e67  # before writing
-0001ba40: 2074 6865 2074 6162 6c65 2076 6572 7369   the table versi
-0001ba50: 6f6e 2074 6f20 7374 6174 652c 2063 6865  on to state, che
-0001ba60: 636b 2069 6620 7765 2068 6164 206f 6e65  ck if we had one
-0001ba70: 2074 6f20 6265 6769 6e20 7769 7468 0a20   to begin with. 
-0001ba80: 2020 2066 6972 7374 5f72 756e 203d 2073     first_run = s
-0001ba90: 696e 6765 722e 6765 745f 626f 6f6b 6d61  inger.get_bookma
-0001baa0: 726b 2873 7461 7465 2c20 7374 7265 616d  rk(state, stream
-0001bab0: 5b27 7461 705f 7374 7265 616d 5f69 6427  ['tap_stream_id'
-0001bac0: 5d2c 2027 7665 7273 696f 6e27 2920 6973  ], 'version') is
-0001bad0: 204e 6f6e 650a 0a20 2020 2023 206c 6173   None..    # las
-0001bae0: 7420 7275 6e20 7761 7320 696e 7465 7272  t run was interr
-0001baf0: 7570 7465 6420 6966 2074 6865 7265 2069  upted if there i
-0001bb00: 7320 6120 6c61 7374 5f69 645f 6665 7463  s a last_id_fetc
-0001bb10: 6865 6420 626f 6f6b 6d61 726b 0a20 2020  hed bookmark.   
-0001bb20: 2023 2070 6963 6b20 6120 6e65 7720 7461   # pick a new ta
-0001bb30: 626c 6520 7665 7273 696f 6e20 6966 206c  ble version if l
-0001bb40: 6173 7420 7275 6e20 7761 736e 2774 2069  ast run wasn't i
-0001bb50: 6e74 6572 7275 7074 6564 0a20 2020 2069  nterrupted.    i
-0001bb60: 6620 7369 6e67 6572 2e67 6574 5f62 6f6f  f singer.get_boo
-0001bb70: 6b6d 6172 6b28 7374 6174 652c 2073 7472  kmark(state, str
-0001bb80: 6561 6d5b 2774 6170 5f73 7472 6561 6d5f  eam['tap_stream_
-0001bb90: 6964 275d 2c20 276c 6173 745f 6964 5f66  id'], 'last_id_f
-0001bba0: 6574 6368 6564 2729 2069 7320 6e6f 7420  etched') is not 
-0001bbb0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7374  None:.        st
-0001bbc0: 7265 616d 5f76 6572 7369 6f6e 203d 2073  ream_version = s
-0001bbd0: 696e 6765 722e 6765 745f 626f 6f6b 6d61  inger.get_bookma
-0001bbe0: 726b 2873 7461 7465 2c20 7374 7265 616d  rk(state, stream
-0001bbf0: 5b27 7461 705f 7374 7265 616d 5f69 6427  ['tap_stream_id'
-0001bc00: 5d2c 2027 7665 7273 696f 6e27 290a 2020  ], 'version').  
-0001bc10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001bc20: 7374 7265 616d 5f76 6572 7369 6f6e 203d  stream_version =
-0001bc30: 2069 6e74 2874 696d 652e 7469 6d65 2829   int(time.time()
-0001bc40: 202a 2031 3030 3029 0a0a 2020 2020 7374   * 1000)..    st
-0001bc50: 6174 6520 3d20 7369 6e67 6572 2e77 7269  ate = singer.wri
-0001bc60: 7465 5f62 6f6f 6b6d 6172 6b28 7374 6174  te_bookmark(stat
-0001bc70: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0001bc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc90: 2020 2020 2073 7472 6561 6d5b 2774 6170       stream['tap
-0001bca0: 5f73 7472 6561 6d5f 6964 275d 2c0a 2020  _stream_id'],.  
-0001bcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcd0: 2776 6572 7369 6f6e 272c 0a20 2020 2020  'version',.     
-0001bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcf0: 2020 2020 2020 2020 2020 2020 2073 7472               str
-0001bd00: 6561 6d5f 7665 7273 696f 6e29 0a20 2020  eam_version).   
-0001bd10: 2073 696e 6765 722e 7772 6974 655f 6d65   singer.write_me
-0001bd20: 7373 6167 6528 7369 6e67 6572 2e53 7461  ssage(singer.Sta
-0001bd30: 7465 4d65 7373 6167 6528 7661 6c75 653d  teMessage(value=
-0001bd40: 636f 7079 2e64 6565 7063 6f70 7928 7374  copy.deepcopy(st
-0001bd50: 6174 6529 2929 0a0a 2020 2020 6163 7469  ate)))..    acti
-0001bd60: 7661 7465 5f76 6572 7369 6f6e 5f6d 6573  vate_version_mes
-0001bd70: 7361 6765 203d 2073 696e 6765 722e 4163  sage = singer.Ac
-0001bd80: 7469 7661 7465 5665 7273 696f 6e4d 6573  tivateVersionMes
-0001bd90: 7361 6765 280a 2020 2020 2020 2020 7374  sage(.        st
-0001bda0: 7265 616d 3d63 6f6d 6d6f 6e2e 6361 6c63  ream=common.calc
-0001bdb0: 756c 6174 655f 6465 7374 696e 6174 696f  ulate_destinatio
-0001bdc0: 6e5f 7374 7265 616d 5f6e 616d 6528 7374  n_stream_name(st
-0001bdd0: 7265 616d 292c 0a20 2020 2020 2020 2076  ream),.        v
-0001bde0: 6572 7369 6f6e 3d73 7472 6561 6d5f 7665  ersion=stream_ve
-0001bdf0: 7273 696f 6e0a 2020 2020 290a 0a20 2020  rsion.    )..   
-0001be00: 2023 2046 6f72 2074 6865 2069 6e69 7469   # For the initi
-0001be10: 616c 2072 6570 6c69 6361 7469 6f6e 2c20  al replication, 
-0001be20: 656d 6974 2061 6e20 4143 5449 5641 5445  emit an ACTIVATE
-0001be30: 5f56 4552 5349 4f4e 206d 6573 7361 6765  _VERSION message
-0001be40: 0a20 2020 2023 2061 7420 7468 6520 6265  .    # at the be
-0001be50: 6769 6e6e 696e 6720 736f 2074 6865 2072  ginning so the r
-0001be60: 6563 6f72 6473 2073 686f 7720 7570 2072  ecords show up r
-0001be70: 6967 6874 2061 7761 792e 0a20 2020 2069  ight away..    i
-0001be80: 6620 6669 7273 745f 7275 6e3a 0a20 2020  f first_run:.   
-0001be90: 2020 2020 2073 696e 6765 722e 7772 6974       singer.writ
-0001bea0: 655f 6d65 7373 6167 6528 6163 7469 7661  e_message(activa
-0001beb0: 7465 5f76 6572 7369 6f6e 5f6d 6573 7361  te_version_messa
-0001bec0: 6765 290a 0a20 2020 2069 6620 7369 6e67  ge)..    if sing
-0001bed0: 6572 2e67 6574 5f62 6f6f 6b6d 6172 6b28  er.get_bookmark(
-0001bee0: 7374 6174 652c 2073 7472 6561 6d5b 2774  state, stream['t
-0001bef0: 6170 5f73 7472 6561 6d5f 6964 275d 2c20  ap_stream_id'], 
-0001bf00: 276d 6178 5f69 645f 7661 6c75 6527 293a  'max_id_value'):
-0001bf10: 0a20 2020 2020 2020 2023 2054 6865 7265  .        # There
-0001bf20: 2069 7320 6120 626f 6f6b 6d61 726b 0a20   is a bookmark. 
-0001bf30: 2020 2020 2020 206d 6178 5f69 645f 7661         max_id_va
-0001bf40: 6c75 6520 3d20 636f 6d6d 6f6e 2e73 7472  lue = common.str
-0001bf50: 696e 675f 746f 5f63 6c61 7373 2873 696e  ing_to_class(sin
-0001bf60: 6765 722e 6765 745f 626f 6f6b 6d61 726b  ger.get_bookmark
-0001bf70: 2873 7461 7465 2c20 7374 7265 616d 5b27  (state, stream['
-0001bf80: 7461 705f 7374 7265 616d 5f69 6427 5d2c  tap_stream_id'],
-0001bf90: 2027 6d61 785f 6964 5f76 616c 7565 2729   'max_id_value')
-0001bfa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001bfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bfd0: 7369 6e67 6572 2e67 6574 5f62 6f6f 6b6d  singer.get_bookm
-0001bfe0: 6172 6b28 7374 6174 652c 2073 7472 6561  ark(state, strea
-0001bff0: 6d5b 2774 6170 5f73 7472 6561 6d5f 6964  m['tap_stream_id
-0001c000: 275d 2c20 276d 6178 5f69 645f 7479 7065  '], 'max_id_type
-0001c010: 2729 290a 2020 2020 656c 7365 3a0a 2020  ')).    else:.  
-0001c020: 2020 2020 2020 6d61 785f 6964 5f76 616c        max_id_val
-0001c030: 7565 203d 2067 6574 5f6d 6178 5f69 645f  ue = get_max_id_
-0001c040: 7661 6c75 6528 636f 6c6c 6563 7469 6f6e  value(collection
-0001c050: 290a 0a20 2020 206c 6173 745f 6964 5f66  )..    last_id_f
-0001c060: 6574 6368 6564 203d 2073 696e 6765 722e  etched = singer.
-0001c070: 6765 745f 626f 6f6b 6d61 726b 2873 7461  get_bookmark(sta
-0001c080: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
-0001c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0a0: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0001c0b0: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
-0001c0c0: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
-0001c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0f0: 2027 6c61 7374 5f69 645f 6665 7463 6865   'last_id_fetche
-0001c100: 6427 290a 0a20 2020 2069 6620 6d61 785f  d')..    if max_
-0001c110: 6964 5f76 616c 7565 3a0a 2020 2020 2020  id_value:.      
-0001c120: 2020 2320 5772 6974 6520 7468 6520 626f    # Write the bo
-0001c130: 6f6b 6d61 726b 2069 6620 6d61 785f 6964  okmark if max_id
-0001c140: 5f76 616c 7565 2069 7320 6465 6669 6e65  _value is define
-0001c150: 640a 2020 2020 2020 2020 7374 6174 6520  d.        state 
-0001c160: 3d20 7369 6e67 6572 2e77 7269 7465 5f62  = singer.write_b
-0001c170: 6f6f 6b6d 6172 6b28 7374 6174 652c 0a20  ookmark(state,. 
-0001c180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c1a0: 2020 2020 2073 7472 6561 6d5b 2774 6170       stream['tap
-0001c1b0: 5f73 7472 6561 6d5f 6964 275d 2c0a 2020  _stream_id'],.  
-0001c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c1e0: 2020 2020 276d 6178 5f69 645f 7661 6c75      'max_id_valu
-0001c1f0: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-0001c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c210: 2020 2020 2020 2020 2020 636f 6d6d 6f6e            common
-0001c220: 2e63 6c61 7373 5f74 6f5f 7374 7269 6e67  .class_to_string
-0001c230: 286d 6178 5f69 645f 7661 6c75 652c 0a20  (max_id_value,. 
-0001c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c270: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-0001c280: 6964 5f76 616c 7565 2e5f 5f63 6c61 7373  id_value.__class
-0001c290: 5f5f 2e5f 5f6e 616d 655f 5f29 290a 2020  __.__name__)).  
-0001c2a0: 2020 2020 2020 7374 6174 6520 3d20 7369        state = si
-0001c2b0: 6e67 6572 2e77 7269 7465 5f62 6f6f 6b6d  nger.write_bookm
-0001c2c0: 6172 6b28 7374 6174 652c 0a20 2020 2020  ark(state,.     
-0001c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2f0: 2073 7472 6561 6d5b 2774 6170 5f73 7472   stream['tap_str
-0001c300: 6561 6d5f 6964 275d 2c0a 2020 2020 2020  eam_id'],.      
-0001c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c330: 276d 6178 5f69 645f 7479 7065 272c 0a20  'max_id_type',. 
-0001c340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c360: 2020 2020 206d 6178 5f69 645f 7661 6c75       max_id_valu
-0001c370: 652e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  e.__class__.__na
-0001c380: 6d65 5f5f 290a 0a20 2020 2066 696e 645f  me__)..    find_
-0001c390: 6669 6c74 6572 203d 207b 2724 6c74 6527  filter = {'$lte'
-0001c3a0: 3a20 6d61 785f 6964 5f76 616c 7565 7d0a  : max_id_value}.
-0001c3b0: 2020 2020 6966 206c 6173 745f 6964 5f66      if last_id_f
-0001c3c0: 6574 6368 6564 3a0a 2020 2020 2020 2020  etched:.        
-0001c3d0: 6669 6e64 5f66 696c 7465 725b 2724 6774  find_filter['$gt
-0001c3e0: 6527 5d20 3d20 636f 6d6d 6f6e 2e73 7472  e'] = common.str
-0001c3f0: 696e 675f 746f 5f63 6c61 7373 286c 6173  ing_to_class(las
-0001c400: 745f 6964 5f66 6574 6368 6564 2c20 7369  t_id_fetched, si
-0001c410: 6e67 6572 2e67 6574 5f62 6f6f 6b6d 6172  nger.get_bookmar
-0001c420: 6b28 7374 6174 652c 0a20 2020 2020 2020  k(state,.       
-0001c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c480: 2020 2073 7472 6561 6d5b 2774 6170 5f73     stream['tap_s
-0001c490: 7472 6561 6d5f 6964 275d 2c0a 2020 2020  tream_id'],.    
-0001c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4f0: 2020 2020 2020 276c 6173 745f 6964 5f66        'last_id_f
-0001c500: 6574 6368 6564 5f74 7970 6527 2929 0a0a  etched_type'))..
-0001c510: 2020 2020 4c4f 4747 4552 2e69 6e66 6f28      LOGGER.info(
-0001c520: 2751 7565 7279 696e 6720 2573 2077 6974  'Querying %s wit
-0001c530: 683a 2025 7327 2c20 7374 7265 616d 5b27  h: %s', stream['
-0001c540: 7461 705f 7374 7265 616d 5f69 6427 5d2c  tap_stream_id'],
-0001c550: 2064 6963 7428 6669 6e64 3d66 696e 645f   dict(find=find_
-0001c560: 6669 6c74 6572 2929 0a0a 2020 2020 7769  filter))..    wi
-0001c570: 7468 2063 6f6c 6c65 6374 696f 6e2e 6669  th collection.fi
-0001c580: 6e64 287b 275f 6964 273a 2066 696e 645f  nd({'_id': find_
-0001c590: 6669 6c74 6572 7d2c 0a20 2020 2020 2020  filter},.       
-0001c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c5b0: 2020 736f 7274 3d5b 2822 5f69 6422 2c20    sort=[("_id", 
-0001c5c0: 7079 6d6f 6e67 6f2e 4153 4345 4e44 494e  pymongo.ASCENDIN
-0001c5d0: 4729 5d29 2061 7320 6375 7273 6f72 3a0a  G)]) as cursor:.
-0001c5e0: 2020 2020 2020 2020 726f 7773 5f73 6176          rows_sav
-0001c5f0: 6564 203d 2030 0a20 2020 2020 2020 2073  ed = 0.        s
-0001c600: 7461 7274 5f74 696d 6520 3d20 7469 6d65  tart_time = time
-0001c610: 2e74 696d 6528 290a 0a20 2020 2020 2020  .time()..       
-0001c620: 2066 6f72 2072 6f77 2069 6e20 6375 7273   for row in curs
-0001c630: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-0001c640: 726f 7773 5f73 6176 6564 202b 3d20 310a  rows_saved += 1.
-0001c650: 0a20 2020 2020 2020 2020 2020 2073 696e  .            sin
-0001c660: 6765 722e 7772 6974 655f 6d65 7373 6167  ger.write_messag
-0001c670: 6528 636f 6d6d 6f6e 2e72 6f77 5f74 6f5f  e(common.row_to_
-0001c680: 7369 6e67 6572 5f72 6563 6f72 6428 7374  singer_record(st
-0001c690: 7265 616d 3d73 7472 6561 6d2c 0a20 2020  ream=stream,.   
-0001c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6d0: 2020 2020 2020 2020 2020 726f 773d 726f            row=ro
-0001c6e0: 772c 0a20 2020 2020 2020 2020 2020 2020  w,.             
-0001c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c720: 7469 6d65 5f65 7874 7261 6374 6564 3d75  time_extracted=u
-0001c730: 7469 6c73 2e6e 6f77 2829 2c0a 2020 2020  tils.now(),.    
-0001c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c770: 2020 2020 2020 2020 2074 696d 655f 6465           time_de
-0001c780: 6c65 7465 643d 4e6f 6e65 2c0a 2020 2020  leted=None,.    
-0001c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7c0: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
-0001c7d0: 3d73 7472 6561 6d5f 7665 7273 696f 6e29  =stream_version)
-0001c7e0: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
-0001c7f0: 7461 7465 203d 2073 696e 6765 722e 7772  tate = singer.wr
-0001c800: 6974 655f 626f 6f6b 6d61 726b 2873 7461  ite_bookmark(sta
-0001c810: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
-0001c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c830: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0001c840: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
-0001c850: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
-0001c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c880: 2027 6c61 7374 5f69 645f 6665 7463 6865   'last_id_fetche
-0001c890: 6427 2c0a 2020 2020 2020 2020 2020 2020  d',.            
-0001c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8b0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0001c8c0: 6d6d 6f6e 2e63 6c61 7373 5f74 6f5f 7374  mmon.class_to_st
-0001c8d0: 7269 6e67 2872 6f77 5b27 5f69 6427 5d2c  ring(row['_id'],
-0001c8e0: 2072 6f77 5b27 5f69 6427 5d2e 5f5f 636c   row['_id'].__cl
-0001c8f0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2929  ass__.__name__))
-0001c900: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-0001c910: 7465 203d 2073 696e 6765 722e 7772 6974  te = singer.writ
-0001c920: 655f 626f 6f6b 6d61 726b 2873 7461 7465  e_bookmark(state
-0001c930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c950: 2020 2020 2020 2020 2020 2020 7374 7265              stre
-0001c960: 616d 5b27 7461 705f 7374 7265 616d 5f69  am['tap_stream_i
-0001c970: 6427 5d2c 0a20 2020 2020 2020 2020 2020  d'],.           
-0001c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c990: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0001c9a0: 6c61 7374 5f69 645f 6665 7463 6865 645f  last_id_fetched_
-0001c9b0: 7479 7065 272c 0a20 2020 2020 2020 2020  type',.         
-0001c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9e0: 2072 6f77 5b27 5f69 6427 5d2e 5f5f 636c   row['_id'].__cl
-0001c9f0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 290a  ass__.__name__).
-0001ca00: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001ca10: 726f 7773 5f73 6176 6564 2025 2063 6f6d  rows_saved % com
-0001ca20: 6d6f 6e2e 5550 4441 5445 5f42 4f4f 4b4d  mon.UPDATE_BOOKM
-0001ca30: 4152 4b5f 5045 5249 4f44 203d 3d20 303a  ARK_PERIOD == 0:
-0001ca40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ca50: 2073 696e 6765 722e 7772 6974 655f 6d65   singer.write_me
-0001ca60: 7373 6167 6528 7369 6e67 6572 2e53 7461  ssage(singer.Sta
-0001ca70: 7465 4d65 7373 6167 6528 7661 6c75 653d  teMessage(value=
-0001ca80: 636f 7079 2e64 6565 7063 6f70 7928 7374  copy.deepcopy(st
-0001ca90: 6174 6529 2929 0a0a 2020 2020 2020 2020  ate)))..        
-0001caa0: 636f 6d6d 6f6e 2e43 4f55 4e54 535b 7374  common.COUNTS[st
-0001cab0: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
-0001cac0: 5f69 6427 5d5d 202b 3d20 726f 7773 5f73  _id']] += rows_s
-0001cad0: 6176 6564 0a20 2020 2020 2020 2063 6f6d  aved.        com
-0001cae0: 6d6f 6e2e 5449 4d45 535b 7374 7265 616d  mon.TIMES[stream
-0001caf0: 5b27 7461 705f 7374 7265 616d 5f69 6427  ['tap_stream_id'
-0001cb00: 5d5d 202b 3d20 7469 6d65 2e74 696d 6528  ]] += time.time(
-0001cb10: 2920 2d20 7374 6172 745f 7469 6d65 0a0a  ) - start_time..
-0001cb20: 2020 2020 2320 636c 6561 7220 6d61 7820      # clear max 
-0001cb30: 706b 2076 616c 7565 2061 6e64 206c 6173  pk value and las
-0001cb40: 7420 706b 2066 6574 6368 6564 2075 706f  t pk fetched upo
-0001cb50: 6e20 7375 6363 6573 7366 756c 2073 796e  n successful syn
-0001cb60: 630a 2020 2020 7369 6e67 6572 2e63 6c65  c.    singer.cle
-0001cb70: 6172 5f62 6f6f 6b6d 6172 6b28 7374 6174  ar_bookmark(stat
-0001cb80: 652c 2073 7472 6561 6d5b 2774 6170 5f73  e, stream['tap_s
-0001cb90: 7472 6561 6d5f 6964 275d 2c20 276d 6178  tream_id'], 'max
-0001cba0: 5f69 645f 7661 6c75 6527 290a 2020 2020  _id_value').    
-0001cbb0: 7369 6e67 6572 2e63 6c65 6172 5f62 6f6f  singer.clear_boo
-0001cbc0: 6b6d 6172 6b28 7374 6174 652c 2073 7472  kmark(state, str
-0001cbd0: 6561 6d5b 2774 6170 5f73 7472 6561 6d5f  eam['tap_stream_
-0001cbe0: 6964 275d 2c20 276d 6178 5f69 645f 7479  id'], 'max_id_ty
-0001cbf0: 7065 2729 0a20 2020 2073 696e 6765 722e  pe').    singer.
-0001cc00: 636c 6561 725f 626f 6f6b 6d61 726b 2873  clear_bookmark(s
-0001cc10: 7461 7465 2c20 7374 7265 616d 5b27 7461  tate, stream['ta
-0001cc20: 705f 7374 7265 616d 5f69 6427 5d2c 2027  p_stream_id'], '
-0001cc30: 6c61 7374 5f69 645f 6665 7463 6865 6427  last_id_fetched'
-0001cc40: 290a 2020 2020 7369 6e67 6572 2e63 6c65  ).    singer.cle
-0001cc50: 6172 5f62 6f6f 6b6d 6172 6b28 7374 6174  ar_bookmark(stat
-0001cc60: 652c 2073 7472 6561 6d5b 2774 6170 5f73  e, stream['tap_s
-0001cc70: 7472 6561 6d5f 6964 275d 2c20 276c 6173  tream_id'], 'las
-0001cc80: 745f 6964 5f66 6574 6368 6564 5f74 7970  t_id_fetched_typ
-0001cc90: 6527 290a 0a20 2020 2073 696e 6765 722e  e')..    singer.
-0001cca0: 7772 6974 655f 626f 6f6b 6d61 726b 2873  write_bookmark(s
-0001ccb0: 7461 7465 2c0a 2020 2020 2020 2020 2020  tate,.          
-0001ccc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ccd0: 7374 7265 616d 5b27 7461 705f 7374 7265  stream['tap_stre
-0001cce0: 616d 5f69 6427 5d2c 0a20 2020 2020 2020  am_id'],.       
-0001ccf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd00: 2020 2027 696e 6974 6961 6c5f 6675 6c6c     'initial_full
-0001cd10: 5f74 6162 6c65 5f63 6f6d 706c 6574 6527  _table_complete'
-0001cd20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001cd30: 2020 2020 2020 2020 2020 2020 5472 7565              True
-0001cd40: 290a 0a20 2020 2073 696e 6765 722e 7772  )..    singer.wr
-0001cd50: 6974 655f 6d65 7373 6167 6528 6163 7469  ite_message(acti
-0001cd60: 7661 7465 5f76 6572 7369 6f6e 5f6d 6573  vate_version_mes
-0001cd70: 7361 6765 290a 0a20 2020 204c 4f47 4745  sage)..    LOGGE
-0001cd80: 522e 696e 666f 2827 5379 6e63 6420 2573  R.info('Syncd %s
-0001cd90: 2072 6563 6f72 6473 2066 6f72 2025 7327   records for %s'
-0001cda0: 2c20 726f 7773 5f73 6176 6564 2c20 7374  , rows_saved, st
-0001cdb0: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
-0001cdc0: 5f69 6427 5d29 0a00 0000 0000 0000 0000  _id'])..........
-0001cdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0001ce10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ce60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0001ce70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001ce80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0001ce90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-0001cea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ceb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ced0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001cf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001cff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d000: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-0001d010: 3136 362e 300a 0000 0000 0000 0000 0000  166.0...........
-0001d020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d200: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-0001d210: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
-0001d220: 5f73 7472 6174 6567 6965 732f 696e 6372  _strategies/incr
-0001d230: 656d 656e 7461 6c2e 7079 0000 0000 0000  emental.py......
-0001d240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0001d270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0001d280: 3030 3131 3034 3000 3030 3030 3030 3030  0011040.00000000
-0001d290: 3030 3000 3032 3530 3637 0020 3000 0000  000.025067. 0...
-0001d2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d300: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-0001d310: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-0001d320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
-0001d330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001d400: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
-0001d410: 7974 686f 6e33 0a69 6d70 6f72 7420 636f  ython3.import co
-0001d420: 7079 0a69 6d70 6f72 7420 7469 6d65 0a69  py.import time.i
-0001d430: 6d70 6f72 7420 7079 6d6f 6e67 6f0a 696d  mport pymongo.im
-0001d440: 706f 7274 2073 696e 6765 720a 0a66 726f  port singer..fro
-0001d450: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
-0001d460: 4469 6374 2c20 4f70 7469 6f6e 616c 0a66  Dict, Optional.f
-0001d470: 726f 6d20 7079 6d6f 6e67 6f2e 636f 6c6c  rom pymongo.coll
-0001d480: 6563 7469 6f6e 2069 6d70 6f72 7420 436f  ection import Co
-0001d490: 6c6c 6563 7469 6f6e 0a66 726f 6d20 7369  llection.from si
-0001d4a0: 6e67 6572 2069 6d70 6f72 7420 6d65 7461  nger import meta
-0001d4b0: 6461 7461 2c20 7574 696c 730a 0a66 726f  data, utils..fro
-0001d4c0: 6d20 647a 5f6d 6f6e 676f 6462 2e73 796e  m dz_mongodb.syn
-0001d4d0: 635f 7374 7261 7465 6769 6573 2069 6d70  c_strategies imp
-0001d4e0: 6f72 7420 636f 6d6d 6f6e 0a0a 4c4f 4747  ort common..LOGG
-0001d4f0: 4552 203d 2073 696e 6765 722e 6765 745f  ER = singer.get_
-0001d500: 6c6f 6767 6572 2827 647a 5f6d 6f6e 676f  logger('dz_mongo
-0001d510: 6462 2729 0a0a 0a64 6566 2075 7064 6174  db')...def updat
-0001d520: 655f 626f 6f6b 6d61 726b 2872 6f77 3a20  e_bookmark(row: 
-0001d530: 4469 6374 2c20 7374 6174 653a 2044 6963  Dict, state: Dic
-0001d540: 742c 2074 6170 5f73 7472 6561 6d5f 6964  t, tap_stream_id
-0001d550: 3a20 7374 722c 2072 6570 6c69 6361 7469  : str, replicati
-0001d560: 6f6e 5f6b 6579 5f6e 616d 653a 2073 7472  on_key_name: str
-0001d570: 2920 2d3e 204e 6f6e 653a 0a20 2020 2022  ) -> None:.    "
-0001d580: 2222 0a20 2020 2055 7064 6174 6573 2072  "".    Updates r
-0001d590: 6570 6c69 6361 7469 6f6e 206b 6579 2061  eplication key a
-0001d5a0: 6e64 2074 7970 6520 7661 6c75 6573 2069  nd type values i
-0001d5b0: 6e20 7374 6174 6520 626f 6f6b 6d61 726b  n state bookmark
-0001d5c0: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-0001d5d0: 2020 2072 6f77 3a20 4442 2072 6563 6f72     row: DB recor
-0001d5e0: 640a 2020 2020 2020 2020 7374 6174 653a  d.        state:
-0001d5f0: 2064 6963 7469 6f6e 6172 7920 6f66 2062   dictionary of b
-0001d600: 6f6f 6b6d 6172 6b73 0a20 2020 2020 2020  ookmarks.       
-0001d610: 2074 6170 5f73 7472 6561 6d5f 6964 3a20   tap_stream_id: 
-0001d620: 7374 7265 616d 2049 440a 2020 2020 2020  stream ID.      
-0001d630: 2020 7265 706c 6963 6174 696f 6e5f 6b65    replication_ke
-0001d640: 795f 6e61 6d65 3a20 7265 706c 6963 6174  y_name: replicat
-0001d650: 696f 6e20 6b65 790a 2020 2020 2222 220a  ion key.    """.
-0001d660: 2020 2020 7265 706c 6963 6174 696f 6e5f      replication_
-0001d670: 6b65 795f 7661 6c75 6520 3d20 726f 772e  key_value = row.
-0001d680: 6765 7428 7265 706c 6963 6174 696f 6e5f  get(replication_
-0001d690: 6b65 795f 6e61 6d65 290a 0a20 2020 2069  key_name)..    i
-0001d6a0: 6620 7265 706c 6963 6174 696f 6e5f 6b65  f replication_ke
-0001d6b0: 795f 7661 6c75 653a 0a20 2020 2020 2020  y_value:.       
-0001d6c0: 2072 6570 6c69 6361 7469 6f6e 5f6b 6579   replication_key
-0001d6d0: 5f74 7970 6520 3d20 7265 706c 6963 6174  _type = replicat
-0001d6e0: 696f 6e5f 6b65 795f 7661 6c75 652e 5f5f  ion_key_value.__
-0001d6f0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-0001d700: 0a0a 2020 2020 2020 2020 7265 706c 6963  ..        replic
-0001d710: 6174 696f 6e5f 6b65 795f 7661 6c75 655f  ation_key_value_
-0001d720: 626f 6f6b 6d61 726b 203d 2063 6f6d 6d6f  bookmark = commo
-0001d730: 6e2e 636c 6173 735f 746f 5f73 7472 696e  n.class_to_strin
-0001d740: 6728 7265 706c 6963 6174 696f 6e5f 6b65  g(replication_ke
-0001d750: 795f 7661 6c75 652c 2072 6570 6c69 6361  y_value, replica
-0001d760: 7469 6f6e 5f6b 6579 5f74 7970 6529 0a0a  tion_key_type)..
-0001d770: 2020 2020 2020 2020 7374 6174 6520 3d20          state = 
-0001d780: 7369 6e67 6572 2e77 7269 7465 5f62 6f6f  singer.write_boo
-0001d790: 6b6d 6172 6b28 7374 6174 652c 0a20 2020  kmark(state,.   
-0001d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d7c0: 2020 2074 6170 5f73 7472 6561 6d5f 6964     tap_stream_id
-0001d7d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001d7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d7f0: 2020 2020 2020 2020 2772 6570 6c69 6361          'replica
-0001d800: 7469 6f6e 5f6b 6579 5f76 616c 7565 272c  tion_key_value',
-0001d810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d830: 2020 2020 2020 2072 6570 6c69 6361 7469         replicati
-0001d840: 6f6e 5f6b 6579 5f76 616c 7565 5f62 6f6f  on_key_value_boo
-0001d850: 6b6d 6172 6b29 0a0a 2020 2020 2020 2020  kmark)..        
-0001d860: 7369 6e67 6572 2e77 7269 7465 5f62 6f6f  singer.write_boo
-0001d870: 6b6d 6172 6b28 7374 6174 652c 0a20 2020  kmark(state,.   
-0001d880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d890: 2020 2020 2020 2020 2020 2074 6170 5f73             tap_s
-0001d8a0: 7472 6561 6d5f 6964 2c0a 2020 2020 2020  tream_id,.      
-0001d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8c0: 2020 2020 2020 2020 2772 6570 6c69 6361          'replica
-0001d8d0: 7469 6f6e 5f6b 6579 5f74 7970 6527 2c0a  tion_key_type',.
-0001d8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8f0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001d900: 706c 6963 6174 696f 6e5f 6b65 795f 7479  plication_key_ty
-0001d910: 7065 290a 0a0a 6465 6620 7379 6e63 5f63  pe)...def sync_c
-0001d920: 6f6c 6c65 6374 696f 6e28 636f 6c6c 6563  ollection(collec
-0001d930: 7469 6f6e 3a20 436f 6c6c 6563 7469 6f6e  tion: Collection
-0001d940: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001d950: 2020 2020 2020 7374 7265 616d 3a20 4469        stream: Di
-0001d960: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
-0001d970: 2020 2020 2020 2020 7374 6174 653a 204f          state: O
-0001d980: 7074 696f 6e61 6c5b 4469 6374 5d2c 0a20  ptional[Dict],. 
-0001d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d9a0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
-0001d9b0: 2020 2222 220a 2020 2020 5379 6e63 7320    """.    Syncs 
-0001d9c0: 7468 6520 7374 7265 616d 2072 6563 6f72  the stream recor
-0001d9d0: 6473 2069 6e63 7265 6d65 6e74 616c 6c79  ds incrementally
-0001d9e0: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
-0001d9f0: 2020 2063 6f6c 6c65 6374 696f 6e3a 204d     collection: M
-0001da00: 6f6e 676f 4442 2063 6f6c 6c65 6374 696f  ongoDB collectio
-0001da10: 6e20 696e 7374 616e 6365 0a20 2020 2020  n instance.     
-0001da20: 2020 2073 7472 6561 6d3a 2073 7472 6561     stream: strea
-0001da30: 6d20 6469 6374 696f 6e61 7279 0a20 2020  m dictionary.   
-0001da40: 2020 2020 2073 7461 7465 3a20 7374 6174       state: stat
-0001da50: 6520 6469 6374 696f 6e61 7279 2069 6620  e dictionary if 
-0001da60: 6578 6973 7473 0a20 2020 2022 2222 0a20  exists.    """. 
-0001da70: 2020 204c 4f47 4745 522e 696e 666f 2827     LOGGER.info('
-0001da80: 5374 6172 7469 6e67 2069 6e63 7265 6d65  Starting increme
-0001da90: 6e74 616c 2073 796e 6320 666f 7220 2573  ntal sync for %s
-0001daa0: 272c 2073 7472 6561 6d5b 2774 6170 5f73  ', stream['tap_s
-0001dab0: 7472 6561 6d5f 6964 275d 290a 0a20 2020  tream_id'])..   
-0001dac0: 2023 2062 6566 6f72 6520 7772 6974 696e   # before writin
-0001dad0: 6720 7468 6520 7461 626c 6520 7665 7273  g the table vers
-0001dae0: 696f 6e20 746f 2073 7461 7465 2c20 6368  ion to state, ch
-0001daf0: 6563 6b20 6966 2077 6520 6861 6420 6f6e  eck if we had on
-0001db00: 6520 746f 2062 6567 696e 2077 6974 680a  e to begin with.
-0001db10: 2020 2020 6669 7273 745f 7275 6e20 3d20      first_run = 
-0001db20: 7369 6e67 6572 2e67 6574 5f62 6f6f 6b6d  singer.get_bookm
-0001db30: 6172 6b28 7374 6174 652c 2073 7472 6561  ark(state, strea
-0001db40: 6d5b 2774 6170 5f73 7472 6561 6d5f 6964  m['tap_stream_id
-0001db50: 275d 2c20 2776 6572 7369 6f6e 2729 2069  '], 'version') i
-0001db60: 7320 4e6f 6e65 0a0a 2020 2020 2320 7069  s None..    # pi
-0001db70: 636b 2061 206e 6577 2074 6162 6c65 2076  ck a new table v
-0001db80: 6572 7369 6f6e 2069 6620 6c61 7374 2072  ersion if last r
-0001db90: 756e 2077 6173 6e27 7420 696e 7465 7272  un wasn't interr
-0001dba0: 7570 7465 640a 2020 2020 6966 2066 6972  upted.    if fir
-0001dbb0: 7374 5f72 756e 3a0a 2020 2020 2020 2020  st_run:.        
-0001dbc0: 7374 7265 616d 5f76 6572 7369 6f6e 203d  stream_version =
-0001dbd0: 2069 6e74 2874 696d 652e 7469 6d65 2829   int(time.time()
-0001dbe0: 202a 2031 3030 3029 0a20 2020 2065 6c73   * 1000).    els
-0001dbf0: 653a 0a20 2020 2020 2020 2073 7472 6561  e:.        strea
-0001dc00: 6d5f 7665 7273 696f 6e20 3d20 7369 6e67  m_version = sing
-0001dc10: 6572 2e67 6574 5f62 6f6f 6b6d 6172 6b28  er.get_bookmark(
-0001dc20: 7374 6174 652c 2073 7472 6561 6d5b 2774  state, stream['t
-0001dc30: 6170 5f73 7472 6561 6d5f 6964 275d 2c20  ap_stream_id'], 
-0001dc40: 2776 6572 7369 6f6e 2729 0a0a 2020 2020  'version')..    
-0001dc50: 7374 6174 6520 3d20 7369 6e67 6572 2e77  state = singer.w
-0001dc60: 7269 7465 5f62 6f6f 6b6d 6172 6b28 7374  rite_bookmark(st
-0001dc70: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-0001dc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc90: 2020 2020 2020 2073 7472 6561 6d5b 2774         stream['t
-0001dca0: 6170 5f73 7472 6561 6d5f 6964 275d 2c0a  ap_stream_id'],.
-0001dcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dcd0: 2020 2776 6572 7369 6f6e 272c 0a20 2020    'version',.   
-0001dce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dcf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001dd00: 7472 6561 6d5f 7665 7273 696f 6e29 0a0a  tream_version)..
-0001dd10: 2020 2020 6163 7469 7661 7465 5f76 6572      activate_ver
-0001dd20: 7369 6f6e 5f6d 6573 7361 6765 203d 2073  sion_message = s
-0001dd30: 696e 6765 722e 4163 7469 7661 7465 5665  inger.ActivateVe
-0001dd40: 7273 696f 6e4d 6573 7361 6765 280a 2020  rsionMessage(.  
-0001dd50: 2020 2020 2020 7374 7265 616d 3d63 6f6d        stream=com
-0001dd60: 6d6f 6e2e 6361 6c63 756c 6174 655f 6465  mon.calculate_de
-0001dd70: 7374 696e 6174 696f 6e5f 7374 7265 616d  stination_stream
-0001dd80: 5f6e 616d 6528 7374 7265 616d 292c 0a20  _name(stream),. 
-0001dd90: 2020 2020 2020 2076 6572 7369 6f6e 3d73         version=s
-0001dda0: 7472 6561 6d5f 7665 7273 696f 6e0a 2020  tream_version.  
-0001ddb0: 2020 290a 0a20 2020 2023 2046 6f72 2074    )..    # For t
-0001ddc0: 6865 2069 6e69 7469 616c 2072 6570 6c69  he initial repli
-0001ddd0: 6361 7469 6f6e 2c20 656d 6974 2061 6e20  cation, emit an 
-0001dde0: 4143 5449 5641 5445 5f56 4552 5349 4f4e  ACTIVATE_VERSION
-0001ddf0: 206d 6573 7361 6765 0a20 2020 2023 2061   message.    # a
-0001de00: 7420 7468 6520 6265 6769 6e6e 696e 6720  t the beginning 
-0001de10: 736f 2074 6865 2072 6563 6f72 6473 2073  so the records s
-0001de20: 686f 7720 7570 2072 6967 6874 2061 7761  how up right awa
-0001de30: 792e 0a20 2020 2069 6620 6669 7273 745f  y..    if first_
-0001de40: 7275 6e3a 0a20 2020 2020 2020 2073 696e  run:.        sin
-0001de50: 6765 722e 7772 6974 655f 6d65 7373 6167  ger.write_messag
-0001de60: 6528 6163 7469 7661 7465 5f76 6572 7369  e(activate_versi
-0001de70: 6f6e 5f6d 6573 7361 6765 290a 0a20 2020  on_message)..   
-0001de80: 2023 2067 6574 2072 6570 6c69 6361 7469   # get replicati
-0001de90: 6f6e 206b 6579 2c20 616e 6420 626f 6f6b  on key, and book
-0001dea0: 6d61 726b 6564 2076 616c 7565 2f74 7970  marked value/typ
-0001deb0: 650a 2020 2020 7374 7265 616d 5f73 7461  e.    stream_sta
-0001dec0: 7465 203d 2073 7461 7465 2e67 6574 2827  te = state.get('
-0001ded0: 626f 6f6b 6d61 726b 7327 2c20 7b7d 292e  bookmarks', {}).
-0001dee0: 6765 7428 7374 7265 616d 5b27 7461 705f  get(stream['tap_
-0001def0: 7374 7265 616d 5f69 6427 5d2c 207b 7d29  stream_id'], {})
-0001df00: 0a0a 2020 2020 7265 706c 6963 6174 696f  ..    replicatio
-0001df10: 6e5f 6b65 795f 6e61 6d65 203d 206d 6574  n_key_name = met
-0001df20: 6164 6174 612e 746f 5f6d 6170 2873 7472  adata.to_map(str
-0001df30: 6561 6d5b 276d 6574 6164 6174 6127 5d29  eam['metadata'])
-0001df40: 2e67 6574 2828 2929 2e67 6574 2827 7265  .get(()).get('re
-0001df50: 706c 6963 6174 696f 6e2d 6b65 7927 290a  plication-key').
-0001df60: 0a20 2020 2023 2077 7269 7465 2073 7461  .    # write sta
-0001df70: 7465 206d 6573 7361 6765 0a20 2020 2073  te message.    s
-0001df80: 696e 6765 722e 7772 6974 655f 6d65 7373  inger.write_mess
-0001df90: 6167 6528 7369 6e67 6572 2e53 7461 7465  age(singer.State
-0001dfa0: 4d65 7373 6167 6528 7661 6c75 653d 636f  Message(value=co
-0001dfb0: 7079 2e64 6565 7063 6f70 7928 7374 6174  py.deepcopy(stat
-0001dfc0: 6529 2929 0a0a 2020 2020 2320 6372 6561  e)))..    # crea
-0001dfd0: 7465 2071 7565 7279 0a20 2020 2066 696e  te query.    fin
-0001dfe0: 645f 6669 6c74 6572 203d 207b 7d0a 0a20  d_filter = {}.. 
-0001dff0: 2020 2069 6620 7374 7265 616d 5f73 7461     if stream_sta
-0001e000: 7465 2e67 6574 2827 7265 706c 6963 6174  te.get('replicat
-0001e010: 696f 6e5f 6b65 795f 7661 6c75 6527 293a  ion_key_value'):
-0001e020: 0a20 2020 2020 2020 2066 696e 645f 6669  .        find_fi
-0001e030: 6c74 6572 5b72 6570 6c69 6361 7469 6f6e  lter[replication
-0001e040: 5f6b 6579 5f6e 616d 655d 203d 207b 7d0a  _key_name] = {}.
-0001e050: 2020 2020 2020 2020 6669 6e64 5f66 696c          find_fil
-0001e060: 7465 725b 7265 706c 6963 6174 696f 6e5f  ter[replication_
-0001e070: 6b65 795f 6e61 6d65 5d5b 2724 6774 6527  key_name]['$gte'
-0001e080: 5d20 3d20 636f 6d6d 6f6e 2e73 7472 696e  ] = common.strin
-0001e090: 675f 746f 5f63 6c61 7373 2873 7472 6561  g_to_class(strea
-0001e0a0: 6d5f 7374 6174 652e 6765 7428 2772 6570  m_state.get('rep
-0001e0b0: 6c69 6361 7469 6f6e 5f6b 6579 5f76 616c  lication_key_val
-0001e0c0: 7565 2729 2c0a 2020 2020 2020 2020 2020  ue'),.          
-0001e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e110: 2073 7472 6561 6d5f 7374 6174 652e 6765   stream_state.ge
-0001e120: 7428 2772 6570 6c69 6361 7469 6f6e 5f6b  t('replication_k
-0001e130: 6579 5f74 7970 6527 2929 0a0a 2020 2020  ey_type'))..    
-0001e140: 2320 6c6f 6720 7175 6572 790a 2020 2020  # log query.    
-0001e150: 4c4f 4747 4552 2e69 6e66 6f28 2751 7565  LOGGER.info('Que
-0001e160: 7279 696e 6720 2573 2077 6974 683a 2025  rying %s with: %
-0001e170: 7327 2c20 7374 7265 616d 5b27 7461 705f  s', stream['tap_
-0001e180: 7374 7265 616d 5f69 6427 5d2c 2064 6963  stream_id'], dic
-0001e190: 7428 6669 6e64 3d66 696e 645f 6669 6c74  t(find=find_filt
-0001e1a0: 6572 2929 0a0a 2020 2020 7769 7468 2063  er))..    with c
-0001e1b0: 6f6c 6c65 6374 696f 6e2e 6669 6e64 2866  ollection.find(f
-0001e1c0: 696e 645f 6669 6c74 6572 2c0a 2020 2020  ind_filter,.    
-0001e1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e1e0: 2020 2020 2073 6f72 743d 5b28 7265 706c       sort=[(repl
-0001e1f0: 6963 6174 696f 6e5f 6b65 795f 6e61 6d65  ication_key_name
-0001e200: 2c20 7079 6d6f 6e67 6f2e 4153 4345 4e44  , pymongo.ASCEND
-0001e210: 494e 4729 5d29 2061 7320 6375 7273 6f72  ING)]) as cursor
-0001e220: 3a0a 2020 2020 2020 2020 726f 7773 5f73  :.        rows_s
-0001e230: 6176 6564 203d 2030 0a20 2020 2020 2020  aved = 0.       
-0001e240: 2073 7461 7274 5f74 696d 6520 3d20 7469   start_time = ti
-0001e250: 6d65 2e74 696d 6528 290a 0a20 2020 2020  me.time()..     
-0001e260: 2020 2066 6f72 2072 6f77 2069 6e20 6375     for row in cu
-0001e270: 7273 6f72 3a0a 0a20 2020 2020 2020 2020  rsor:..         
-0001e280: 2020 2073 696e 6765 722e 7772 6974 655f     singer.write_
-0001e290: 6d65 7373 6167 6528 636f 6d6d 6f6e 2e72  message(common.r
-0001e2a0: 6f77 5f74 6f5f 7369 6e67 6572 5f72 6563  ow_to_singer_rec
-0001e2b0: 6f72 6428 7374 7265 616d 3d73 7472 6561  ord(stream=strea
-0001e2c0: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
-0001e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e300: 726f 773d 726f 772c 0a20 2020 2020 2020  row=row,.       
-0001e310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e340: 2020 2020 2020 7469 6d65 5f65 7874 7261        time_extra
-0001e350: 6374 6564 3d75 7469 6c73 2e6e 6f77 2829  cted=utils.now()
-0001e360: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001e370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e390: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0001e3a0: 696d 655f 6465 6c65 7465 643d 4e6f 6e65  ime_deleted=None
-0001e3b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001e3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e3e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0001e3f0: 6572 7369 6f6e 3d73 7472 6561 6d5f 7665  ersion=stream_ve
-0001e400: 7273 696f 6e29 290a 2020 2020 2020 2020  rsion)).        
-0001e410: 2020 2020 726f 7773 5f73 6176 6564 202b      rows_saved +
-0001e420: 3d20 310a 0a20 2020 2020 2020 2020 2020  = 1..           
-0001e430: 2075 7064 6174 655f 626f 6f6b 6d61 726b   update_bookmark
-0001e440: 2872 6f77 2c20 7374 6174 652c 2073 7472  (row, state, str
-0001e450: 6561 6d5b 2774 6170 5f73 7472 6561 6d5f  eam['tap_stream_
-0001e460: 6964 275d 2c20 7265 706c 6963 6174 696f  id'], replicatio
-0001e470: 6e5f 6b65 795f 6e61 6d65 290a 0a20 2020  n_key_name)..   
-0001e480: 2020 2020 2020 2020 2069 6620 726f 7773           if rows
-0001e490: 5f73 6176 6564 2025 2063 6f6d 6d6f 6e2e  _saved % common.
-0001e4a0: 5550 4441 5445 5f42 4f4f 4b4d 4152 4b5f  UPDATE_BOOKMARK_
-0001e4b0: 5045 5249 4f44 203d 3d20 303a 0a20 2020  PERIOD == 0:.   
-0001e4c0: 2020 2020 2020 2020 2020 2020 2073 696e               sin
-0001e4d0: 6765 722e 7772 6974 655f 6d65 7373 6167  ger.write_messag
-0001e4e0: 6528 7369 6e67 6572 2e53 7461 7465 4d65  e(singer.StateMe
-0001e4f0: 7373 6167 6528 7661 6c75 653d 636f 7079  ssage(value=copy
-0001e500: 2e64 6565 7063 6f70 7928 7374 6174 6529  .deepcopy(state)
-0001e510: 2929 0a0a 2020 2020 2020 2020 636f 6d6d  ))..        comm
-0001e520: 6f6e 2e43 4f55 4e54 535b 7374 7265 616d  on.COUNTS[stream
-0001e530: 5b27 7461 705f 7374 7265 616d 5f69 6427  ['tap_stream_id'
-0001e540: 5d5d 202b 3d20 726f 7773 5f73 6176 6564  ]] += rows_saved
-0001e550: 0a20 2020 2020 2020 2063 6f6d 6d6f 6e2e  .        common.
-0001e560: 5449 4d45 535b 7374 7265 616d 5b27 7461  TIMES[stream['ta
-0001e570: 705f 7374 7265 616d 5f69 6427 5d5d 202b  p_stream_id']] +
-0001e580: 3d20 7469 6d65 2e74 696d 6528 2920 2d20  = time.time() - 
-0001e590: 7374 6172 745f 7469 6d65 0a0a 2020 2020  start_time..    
-0001e5a0: 7369 6e67 6572 2e77 7269 7465 5f6d 6573  singer.write_mes
-0001e5b0: 7361 6765 2861 6374 6976 6174 655f 7665  sage(activate_ve
-0001e5c0: 7273 696f 6e5f 6d65 7373 6167 6529 0a0a  rsion_message)..
-0001e5d0: 2020 2020 4c4f 4747 4552 2e69 6e66 6f28      LOGGER.info(
-0001e5e0: 2753 796e 6364 2025 7320 7265 636f 7264  'Syncd %s record
-0001e5f0: 7320 666f 7220 2573 272c 2072 6f77 735f  s for %s', rows_
-0001e600: 7361 7665 642c 2073 7472 6561 6d5b 2774  saved, stream['t
-0001e610: 6170 5f73 7472 6561 6d5f 6964 275d 290a  ap_stream_id']).
-0001e620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0001e810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0001e870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001e880: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-0001e890: 3030 3000 3031 3032 3131 0020 7800 0000  000.010211. x...
-0001e8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001e910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001e9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea00: 3237 206d 7469 6d65 3d31 3637 3634 3439  27 mtime=1676449
-0001ea10: 3233 382e 3430 3938 3037 0a00 0000 0000  238.409807......
-0001ea20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ea90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ec00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-0001ec10: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
-0001ec20: 696e 666f 2f00 0000 0000 0000 0000 0000  info/...........
-0001ec30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ec40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ec60: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
-0001ec70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0001ec80: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-0001ec90: 3030 3000 3032 3035 3034 0020 3500 0000  000.020504. 5...
-0001eca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ecb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ecc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ecd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ece0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ed00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-0001ed10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-0001ed20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
-0001ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ed40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ed50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ee00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-0001ee10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ee20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ee60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-0001ee70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-0001ee80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0001ee90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-0001eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-0001ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001efd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001efe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f000: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-0001f010: 3233 382e 300a 0000 0000 0000 0000 0000  238.0...........
-0001f020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f200: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-0001f210: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
-0001f220: 696e 666f 2f50 4b47 2d49 4e46 4f00 0000  info/PKG-INFO...
+0001a360: 2020 2020 2020 2020 2020 2020 6273 6f6e              bson
+0001a370: 2e74 696d 6573 7461 6d70 2e54 696d 6573  .timestamp.Times
+0001a380: 7461 6d70 2869 6e74 2873 706c 6974 5f76  tamp(int(split_v
+0001a390: 616c 7565 5b30 5d29 2c20 696e 7428 7370  alue[0]), int(sp
+0001a3a0: 6c69 745f 7661 6c75 655b 315d 2929 2928  lit_value[1])))(
+0001a3b0: 292c 0a20 2020 2020 2020 2027 6279 7465  ),.        'byte
+0001a3c0: 7327 3a20 6c61 6d62 6461 2076 616c 3a20  s': lambda val: 
+0001a3d0: 6261 7365 3634 2e62 3634 6465 636f 6465  base64.b64decode
+0001a3e0: 2876 616c 2e65 6e63 6f64 6528 2929 2c0a  (val.encode()),.
+0001a3f0: 2020 2020 2020 2020 2773 7472 273a 2073          'str': s
+0001a400: 7472 2c0a 2020 2020 7d0a 0a20 2020 2069  tr,.    }..    i
+0001a410: 6620 7479 7065 5f76 616c 7565 2069 6e20  f type_value in 
+0001a420: 636f 6e76 6572 7369 6f6e 3a0a 2020 2020  conversion:.    
+0001a430: 2020 2020 7265 7475 726e 2063 6f6e 7665      return conve
+0001a440: 7273 696f 6e5b 7479 7065 5f76 616c 7565  rsion[type_value
+0001a450: 5d28 7374 725f 7661 6c75 6529 0a0a 2020  ](str_value)..  
+0001a460: 2020 7261 6973 6520 556e 7375 7070 6f72    raise Unsuppor
+0001a470: 7465 644b 6579 5479 7065 4578 6365 7074  tedKeyTypeExcept
+0001a480: 696f 6e28 6622 7b74 7970 655f 7661 6c75  ion(f"{type_valu
+0001a490: 657d 2069 7320 6e6f 7420 6120 7375 7070  e} is not a supp
+0001a4a0: 6f72 7465 6420 6b65 7920 7479 7065 2229  orted key type")
+0001a4b0: 0a0a 0a64 6566 2073 6166 655f 7472 616e  ...def safe_tran
+0001a4c0: 7366 6f72 6d5f 6461 7465 7469 6d65 2876  sform_datetime(v
+0001a4d0: 616c 7565 3a20 6461 7465 7469 6d65 2e64  alue: datetime.d
+0001a4e0: 6174 6574 696d 652c 2070 6174 6829 3a0a  atetime, path):.
+0001a4f0: 2020 2020 2222 220a 2020 2020 5361 6665      """.    Safe
+0001a500: 6c79 2074 7261 6e73 666f 726d 2064 6174  ly transform dat
+0001a510: 6574 696d 6520 6672 6f6d 206c 6f63 616c  etime from local
+0001a520: 2074 7a20 746f 2055 5443 2069 6620 6170   tz to UTC if ap
+0001a530: 706c 6963 6162 6c65 0a20 2020 2041 7267  plicable.    Arg
+0001a540: 733a 0a20 2020 2020 2020 2076 616c 7565  s:.        value
+0001a550: 3a20 6461 7465 7469 6d65 2076 616c 7565  : datetime value
+0001a560: 2074 6f20 7472 616e 7366 6f72 6d0a 2020   to transform.  
+0001a570: 2020 2020 2020 7061 7468 3a0a 0a20 2020        path:..   
+0001a580: 2052 6574 7572 6e73 3a20 7574 6320 6461   Returns: utc da
+0001a590: 7465 7469 6d65 2061 7320 7374 7269 6e67  tetime as string
+0001a5a0: 0a0a 2020 2020 2222 220a 2020 2020 7469  ..    """.    ti
+0001a5b0: 6d65 7a6f 6e65 203d 2074 7a6c 6f63 616c  mezone = tzlocal
+0001a5c0: 2e67 6574 5f6c 6f63 616c 7a6f 6e65 2829  .get_localzone()
+0001a5d0: 0a20 2020 2074 7279 3a0a 2020 2020 2020  .    try:.      
+0001a5e0: 2020 6c6f 6361 6c5f 6461 7465 7469 6d65    local_datetime
+0001a5f0: 203d 2074 696d 657a 6f6e 652e 6c6f 6361   = timezone.loca
+0001a600: 6c69 7a65 2876 616c 7565 290a 2020 2020  lize(value).    
+0001a610: 2020 2020 7574 635f 6461 7465 7469 6d65      utc_datetime
+0001a620: 203d 206c 6f63 616c 5f64 6174 6574 696d   = local_datetim
+0001a630: 652e 6173 7469 6d65 7a6f 6e65 2870 7974  e.astimezone(pyt
+0001a640: 7a2e 5554 4329 0a20 2020 2065 7863 6570  z.UTC).    excep
+0001a650: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
+0001a660: 783a 0a20 2020 2020 2020 2069 6620 7374  x:.        if st
+0001a670: 7228 6578 2920 3d3d 2022 7965 6172 2069  r(ex) == "year i
+0001a680: 7320 6f75 7420 6f66 2072 616e 6765 2220  s out of range" 
+0001a690: 616e 6420 7661 6c75 652e 7965 6172 203d  and value.year =
+0001a6a0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0001a6b0: 2023 204e 423a 2053 696e 6365 2064 6174   # NB: Since dat
+0001a6c0: 6574 696d 6573 2061 7265 2070 6572 7369  etimes are persi
+0001a6d0: 7374 6564 2061 7320 7374 7269 6e67 732c  sted as strings,
+0001a6e0: 2069 7420 646f 6573 6e27 740a 2020 2020   it doesn't.    
+0001a6f0: 2020 2020 2020 2020 2320 6d61 6b65 2073          # make s
+0001a700: 656e 7365 2074 6f20 626c 6f77 2075 7020  ense to blow up 
+0001a710: 6f6e 2069 6e76 616c 6964 2050 7974 686f  on invalid Pytho
+0001a720: 6e20 6461 7465 7469 6d65 7320 2865 2e67  n datetimes (e.g
+0001a730: 2e2c 0a20 2020 2020 2020 2020 2020 2023  .,.            #
+0001a740: 2079 6561 723d 3029 2e20 496e 2074 6869   year=0). In thi
+0001a750: 7320 6361 7365 2077 6527 7265 2066 6f72  s case we're for
+0001a760: 6d61 7474 696e 6720 6974 2061 7320 6120  matting it as a 
+0001a770: 7374 7269 6e67 2061 6e64 0a20 2020 2020  string and.     
+0001a780: 2020 2020 2020 2023 2070 6173 7369 6e67         # passing
+0001a790: 2069 7420 616c 6f6e 6720 646f 776e 2074   it along down t
+0001a7a0: 6865 2070 6970 656c 696e 652e 0a20 2020  he pipeline..   
+0001a7b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001a7c0: 6622 7b76 616c 7565 2e79 6561 723a 3034  f"{value.year:04
+0001a7d0: 647d 2d7b 7661 6c75 652e 6d6f 6e74 683a  d}-{value.month:
+0001a7e0: 3032 647d 2d7b 7661 6c75 652e 6461 793a  02d}-{value.day:
+0001a7f0: 3032 647d 547b 7661 6c75 652e 686f 7572  02d}T{value.hour
+0001a800: 3a30 3264 7d3a 7b76 616c 7565 2e6d 696e  :02d}:{value.min
+0001a810: 7574 653a 3032 647d 3a22 205c 0a20 2020  ute:02d}:" \.   
+0001a820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a830: 6622 7b76 616c 7565 2e73 6563 6f6e 643a  f"{value.second:
+0001a840: 3032 647d 2e7b 7661 6c75 652e 6d69 6372  02d}.{value.micr
+0001a850: 6f73 6563 6f6e 643a 3036 647d 5a22 0a20  osecond:06d}Z". 
+0001a860: 2020 2020 2020 2072 6169 7365 204d 6f6e         raise Mon
+0001a870: 676f 496e 7661 6c69 6444 6174 6554 696d  goInvalidDateTim
+0001a880: 6545 7863 6570 7469 6f6e 2866 2246 6f75  eException(f"Fou
+0001a890: 6e64 2069 6e76 616c 6964 2064 6174 6574  nd invalid datet
+0001a8a0: 696d 6520 6174 205b 7b27 2e27 2e6a 6f69  ime at [{'.'.joi
+0001a8b0: 6e28 6d61 7028 7374 722c 2070 6174 6829  n(map(str, path)
+0001a8c0: 297d 5d3a 207b 7661 6c75 657d 2229 2066  )}]: {value}") f
+0001a8d0: 726f 6d20 6578 0a20 2020 2072 6574 7572  rom ex.    retur
+0001a8e0: 6e20 7574 696c 732e 7374 7266 7469 6d65  n utils.strftime
+0001a8f0: 2875 7463 5f64 6174 6574 696d 6529 0a0a  (utc_datetime)..
+0001a900: 0a64 6566 2074 7261 6e73 666f 726d 5f76  .def transform_v
+0001a910: 616c 7565 2876 616c 7565 3a20 416e 792c  alue(value: Any,
+0001a920: 2070 6174 6829 202d 3e20 416e 793a 0a20   path) -> Any:. 
+0001a930: 2020 2022 2222 0a20 2020 2074 7261 6e73     """.    trans
+0001a940: 666f 726d 2076 616c 7565 7320 746f 206a  form values to j
+0001a950: 736f 6e20 6672 6965 6e64 6c79 206f 6e65  son friendly one
+0001a960: 730a 2020 2020 4172 6773 3a0a 2020 2020  s.    Args:.    
+0001a970: 2020 2020 7661 6c75 653a 2076 616c 7565      value: value
+0001a980: 2074 6f20 7472 616e 7366 6f72 6d0a 2020   to transform.  
+0001a990: 2020 2020 2020 7061 7468 3a0a 0a20 2020        path:..   
+0001a9a0: 2052 6574 7572 6e73 3a20 7472 616e 7366   Returns: transf
+0001a9b0: 6f72 6d65 6420 7661 6c75 650a 0a20 2020  ormed value..   
+0001a9c0: 2022 2222 0a20 2020 2063 6f6e 7665 7273   """.    convers
+0001a9d0: 696f 6e20 3d20 7b0a 2020 2020 2020 2020  ion = {.        
+0001a9e0: 6c69 7374 3a20 6c61 6d62 6461 2076 616c  list: lambda val
+0001a9f0: 2c20 7061 743a 206c 6973 7428 6d61 7028  , pat: list(map(
+0001aa00: 6c61 6d62 6461 2076 3a20 7472 616e 7366  lambda v: transf
+0001aa10: 6f72 6d5f 7661 6c75 6528 765b 315d 2c20  orm_value(v[1], 
+0001aa20: 7061 7420 2b20 5b76 5b30 5d5d 292c 2065  pat + [v[0]]), e
+0001aa30: 6e75 6d65 7261 7465 2876 616c 2929 292c  numerate(val))),
+0001aa40: 0a20 2020 2020 2020 2064 6963 743a 206c  .        dict: l
+0001aa50: 616d 6264 6120 7661 6c2c 2070 6174 3a20  ambda val, pat: 
+0001aa60: 7b6b 3a20 7472 616e 7366 6f72 6d5f 7661  {k: transform_va
+0001aa70: 6c75 6528 762c 2070 6174 202b 205b 6b5d  lue(v, pat + [k]
+0001aa80: 2920 666f 7220 6b2c 2076 2069 6e20 7661  ) for k, v in va
+0001aa90: 6c2e 6974 656d 7328 297d 2c0a 2020 2020  l.items()},.    
+0001aaa0: 2020 2020 7575 6964 2e55 5549 443a 206c      uuid.UUID: l
+0001aab0: 616d 6264 6120 7661 6c2c 205f 3a20 636c  ambda val, _: cl
+0001aac0: 6173 735f 746f 5f73 7472 696e 6728 7661  ass_to_string(va
+0001aad0: 6c2c 2027 5555 4944 2729 2c0a 2020 2020  l, 'UUID'),.    
+0001aae0: 2020 2020 6f62 6a65 6374 6964 2e4f 626a      objectid.Obj
+0001aaf0: 6563 7449 643a 206c 616d 6264 6120 7661  ectId: lambda va
+0001ab00: 6c2c 205f 3a20 636c 6173 735f 746f 5f73  l, _: class_to_s
+0001ab10: 7472 696e 6728 7661 6c2c 2027 4f62 6a65  tring(val, 'Obje
+0001ab20: 6374 4964 2729 2c0a 2020 2020 2020 2020  ctId'),.        
+0001ab30: 6273 6f6e 5f64 6174 6574 696d 652e 6461  bson_datetime.da
+0001ab40: 7465 7469 6d65 3a20 7361 6665 5f74 7261  tetime: safe_tra
+0001ab50: 6e73 666f 726d 5f64 6174 6574 696d 652c  nsform_datetime,
+0001ab60: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
+0001ab70: 6d70 2e54 696d 6573 7461 6d70 3a20 6c61  mp.Timestamp: la
+0001ab80: 6d62 6461 2076 616c 2c20 5f3a 2075 7469  mbda val, _: uti
+0001ab90: 6c73 2e73 7472 6674 696d 6528 7661 6c2e  ls.strftime(val.
+0001aba0: 6173 5f64 6174 6574 696d 6528 2929 2c0a  as_datetime()),.
+0001abb0: 2020 2020 2020 2020 6273 6f6e 2e69 6e74          bson.int
+0001abc0: 3634 2e49 6e74 3634 3a20 6c61 6d62 6461  64.Int64: lambda
+0001abd0: 2076 616c 2c20 5f3a 2063 6c61 7373 5f74   val, _: class_t
+0001abe0: 6f5f 7374 7269 6e67 2876 616c 2c20 2749  o_string(val, 'I
+0001abf0: 6e74 3634 2729 2c0a 2020 2020 2020 2020  nt64'),.        
+0001ac00: 6279 7465 733a 206c 616d 6264 6120 7661  bytes: lambda va
+0001ac10: 6c2c 205f 3a20 636c 6173 735f 746f 5f73  l, _: class_to_s
+0001ac20: 7472 696e 6728 7661 6c2c 2027 6279 7465  tring(val, 'byte
+0001ac30: 7327 292c 0a20 2020 2020 2020 2064 6174  s'),.        dat
+0001ac40: 6574 696d 652e 6461 7465 7469 6d65 3a20  etime.datetime: 
+0001ac50: 6c61 6d62 6461 2076 616c 2c20 5f3a 2063  lambda val, _: c
+0001ac60: 6c61 7373 5f74 6f5f 7374 7269 6e67 2876  lass_to_string(v
+0001ac70: 616c 2c20 2764 6174 6574 696d 6527 292c  al, 'datetime'),
+0001ac80: 0a20 2020 2020 2020 2062 736f 6e2e 6465  .        bson.de
+0001ac90: 6369 6d61 6c31 3238 2e44 6563 696d 616c  cimal128.Decimal
+0001aca0: 3132 383a 206c 616d 6264 6120 7661 6c2c  128: lambda val,
+0001acb0: 205f 3a20 7661 6c2e 746f 5f64 6563 696d   _: val.to_decim
+0001acc0: 616c 2829 2c0a 2020 2020 2020 2020 6273  al(),.        bs
+0001acd0: 6f6e 2e72 6567 6578 2e52 6567 6578 3a20  on.regex.Regex: 
+0001ace0: 6c61 6d62 6461 2076 616c 2c20 5f3a 2064  lambda val, _: d
+0001acf0: 6963 7428 7061 7474 6572 6e3d 7661 6c2e  ict(pattern=val.
+0001ad00: 7061 7474 6572 6e2c 2066 6c61 6773 3d76  pattern, flags=v
+0001ad10: 616c 2e66 6c61 6773 292c 0a20 2020 2020  al.flags),.     
+0001ad20: 2020 2062 736f 6e2e 636f 6465 2e43 6f64     bson.code.Cod
+0001ad30: 653a 206c 616d 6264 6120 7661 6c2c 205f  e: lambda val, _
+0001ad40: 3a20 6469 6374 2876 616c 7565 3d73 7472  : dict(value=str
+0001ad50: 2876 616c 292c 2073 636f 7065 3d73 7472  (val), scope=str
+0001ad60: 2876 616c 2e73 636f 7065 2929 2069 6620  (val.scope)) if 
+0001ad70: 7661 6c2e 7363 6f70 6520 656c 7365 2073  val.scope else s
+0001ad80: 7472 2876 616c 292c 0a20 2020 2020 2020  tr(val),.       
+0001ad90: 2062 736f 6e2e 6462 7265 662e 4442 5265   bson.dbref.DBRe
+0001ada0: 663a 206c 616d 6264 6120 7661 6c2c 205f  f: lambda val, _
+0001adb0: 3a20 6469 6374 2869 643d 7374 7228 7661  : dict(id=str(va
+0001adc0: 6c2e 6964 292c 2063 6f6c 6c65 6374 696f  l.id), collectio
+0001add0: 6e3d 7661 6c2e 636f 6c6c 6563 7469 6f6e  n=val.collection
+0001ade0: 2c20 6461 7461 6261 7365 3d76 616c 2e64  , database=val.d
+0001adf0: 6174 6162 6173 6529 2c0a 2020 2020 7d0a  atabase),.    }.
+0001ae00: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+0001ae10: 6365 2876 616c 7565 2c20 7475 706c 6528  ce(value, tuple(
+0001ae20: 636f 6e76 6572 7369 6f6e 2e6b 6579 7328  conversion.keys(
+0001ae30: 2929 293a 0a20 2020 2020 2020 2072 6574  ))):.        ret
+0001ae40: 7572 6e20 636f 6e76 6572 7369 6f6e 5b74  urn conversion[t
+0001ae50: 7970 6528 7661 6c75 6529 5d28 7661 6c75  ype(value)](valu
+0001ae60: 652c 2070 6174 6829 0a0a 2020 2020 7265  e, path)..    re
+0001ae70: 7475 726e 2076 616c 7565 0a0a 0a64 6566  turn value...def
+0001ae80: 2072 6f77 5f74 6f5f 7369 6e67 6572 5f72   row_to_singer_r
+0001ae90: 6563 6f72 6428 7374 7265 616d 3a20 4469  ecord(stream: Di
+0001aea0: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
+0001aeb0: 2020 2020 2020 2020 2020 2020 2072 6f77               row
+0001aec0: 3a20 4469 6374 2c0a 2020 2020 2020 2020  : Dict,.        
+0001aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aee0: 2074 696d 655f 6578 7472 6163 7465 643a   time_extracted:
+0001aef0: 2064 6174 6574 696d 652e 6461 7465 7469   datetime.dateti
+0001af00: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0001af10: 2020 2020 2020 2020 2020 2020 2074 696d               tim
+0001af20: 655f 6465 6c65 7465 643a 204f 7074 696f  e_deleted: Optio
+0001af30: 6e61 6c5b 6461 7465 7469 6d65 2e64 6174  nal[datetime.dat
+0001af40: 6574 696d 655d 2c0a 2020 2020 2020 2020  etime],.        
+0001af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af60: 2076 6572 7369 6f6e 3a20 4f70 7469 6f6e   version: Option
+0001af70: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
+0001af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af90: 2020 2020 2020 2020 2029 202d 3e20 7369           ) -> si
+0001afa0: 6e67 6572 2e52 6563 6f72 644d 6573 7361  nger.RecordMessa
+0001afb0: 6765 3a0a 2020 2020 2222 220a 2020 2020  ge:.    """.    
+0001afc0: 5472 616e 7366 6f72 6d73 2072 6f77 2074  Transforms row t
+0001afd0: 6f20 7369 6e67 6572 2072 6563 6f72 6420  o singer record 
+0001afe0: 6d65 7373 6167 650a 2020 2020 4172 6773  message.    Args
+0001aff0: 3a0a 2020 2020 2020 2020 7469 6d65 5f64  :.        time_d
+0001b000: 656c 6574 6564 3a20 4461 7465 7469 6d65  eleted: Datetime
+0001b010: 2077 6865 6e20 726f 7720 676f 7420 6465   when row got de
+0001b020: 6c65 7465 640a 2020 2020 2020 2020 7374  leted.        st
+0001b030: 7265 616d 3a20 7374 7265 616d 2064 6574  ream: stream det
+0001b040: 6169 6c73 0a20 2020 2020 2020 2072 6f77  ails.        row
+0001b050: 3a20 4442 2072 6f77 0a20 2020 2020 2020  : DB row.       
+0001b060: 2076 6572 7369 6f6e 3a20 7374 7265 616d   version: stream
+0001b070: 2076 6572 7369 6f6e 0a20 2020 2020 2020   version.       
+0001b080: 2074 696d 655f 6578 7472 6163 7465 643a   time_extracted:
+0001b090: 2044 6174 6574 696d 6520 7768 656e 2072   Datetime when r
+0001b0a0: 6f77 2077 6173 2065 7874 7261 6374 6564  ow was extracted
+0001b0b0: 0a0a 2020 2020 5265 7475 726e 733a 2053  ..    Returns: S
+0001b0c0: 696e 6765 7220 5265 636f 7264 4d65 7373  inger RecordMess
+0001b0d0: 6167 6520 696e 7374 616e 6365 0a0a 2020  age instance..  
+0001b0e0: 2020 2222 220a 0a20 2020 2069 6620 7665    """..    if ve
+0001b0f0: 7273 696f 6e20 6973 204e 6f6e 653a 0a20  rsion is None:. 
+0001b100: 2020 2020 2020 2076 6572 7369 6f6e 203d         version =
+0001b110: 2069 6e74 2874 696d 652e 7469 6d65 2829   int(time.time()
+0001b120: 202a 2031 3030 3029 0a0a 2020 2020 7472   * 1000)..    tr
+0001b130: 793a 0a20 2020 2020 2020 2072 6f77 5f74  y:.        row_t
+0001b140: 6f5f 7065 7273 6973 7420 3d20 7b6b 3a20  o_persist = {k: 
+0001b150: 7472 616e 7366 6f72 6d5f 7661 6c75 6528  transform_value(
+0001b160: 762c 205b 6b5d 2920 666f 7220 6b2c 2076  v, [k]) for k, v
+0001b170: 2069 6e20 726f 772e 6974 656d 7328 290a   in row.items().
+0001b180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b190: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001b1a0: 2069 7369 6e73 7461 6e63 6528 762c 2028   isinstance(v, (
+0001b1b0: 6273 6f6e 2e6d 696e 5f6b 6579 2e4d 696e  bson.min_key.Min
+0001b1c0: 4b65 792c 2062 736f 6e2e 6d61 785f 6b65  Key, bson.max_ke
+0001b1d0: 792e 4d61 784b 6579 2929 7d0a 2020 2020  y.MaxKey))}.    
+0001b1e0: 6578 6365 7074 204d 6f6e 676f 496e 7661  except MongoInva
+0001b1f0: 6c69 6444 6174 6554 696d 6545 7863 6570  lidDateTimeExcep
+0001b200: 7469 6f6e 2061 7320 6578 3a0a 2020 2020  tion as ex:.    
+0001b210: 2020 2020 7261 6973 6520 5379 6e63 4578      raise SyncEx
+0001b220: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
+0001b230: 2020 2020 2066 2245 7272 6f72 2073 796e       f"Error syn
+0001b240: 6369 6e67 2063 6f6c 6c65 6374 696f 6e20  cing collection 
+0001b250: 7b73 7472 6561 6d5b 2774 6170 5f73 7472  {stream['tap_str
+0001b260: 6561 6d5f 6964 275d 7d2c 206f 626a 6563  eam_id']}, objec
+0001b270: 7420 4944 207b 726f 775b 275f 6964 275d  t ID {row['_id']
+0001b280: 7d20 2d20 7b65 787d 2229 2066 726f 6d20  } - {ex}") from 
+0001b290: 6578 0a0a 2020 2020 726f 775f 746f 5f70  ex..    row_to_p
+0001b2a0: 6572 7369 7374 203d 207b 0a20 2020 2020  ersist = {.     
+0001b2b0: 2020 2027 5f69 6427 3a20 726f 775f 746f     '_id': row_to
+0001b2c0: 5f70 6572 7369 7374 5b27 5f69 6427 5d2c  _persist['_id'],
+0001b2d0: 0a20 2020 2020 2020 2027 646f 6375 6d65  .        'docume
+0001b2e0: 6e74 273a 2072 6f77 5f74 6f5f 7065 7273  nt': row_to_pers
+0001b2f0: 6973 742c 0a20 2020 2020 2020 2053 4443  ist,.        SDC
+0001b300: 5f44 454c 4554 4544 5f41 543a 2075 7469  _DELETED_AT: uti
+0001b310: 6c73 2e73 7472 6674 696d 6528 7469 6d65  ls.strftime(time
+0001b320: 5f64 656c 6574 6564 2920 6966 2074 696d  _deleted) if tim
+0001b330: 655f 6465 6c65 7465 6420 656c 7365 204e  e_deleted else N
+0001b340: 6f6e 650a 2020 2020 7d0a 0a20 2020 2072  one.    }..    r
+0001b350: 6574 7572 6e20 7369 6e67 6572 2e52 6563  eturn singer.Rec
+0001b360: 6f72 644d 6573 7361 6765 280a 2020 2020  ordMessage(.    
+0001b370: 2020 2020 7374 7265 616d 3d63 616c 6375      stream=calcu
+0001b380: 6c61 7465 5f64 6573 7469 6e61 7469 6f6e  late_destination
+0001b390: 5f73 7472 6561 6d5f 6e61 6d65 2873 7472  _stream_name(str
+0001b3a0: 6561 6d29 2c0a 2020 2020 2020 2020 7265  eam),.        re
+0001b3b0: 636f 7264 3d72 6f77 5f74 6f5f 7065 7273  cord=row_to_pers
+0001b3c0: 6973 742c 0a20 2020 2020 2020 2076 6572  ist,.        ver
+0001b3d0: 7369 6f6e 3d76 6572 7369 6f6e 2c0a 2020  sion=version,.  
+0001b3e0: 2020 2020 2020 7469 6d65 5f65 7874 7261        time_extra
+0001b3f0: 6374 6564 3d74 696d 655f 6578 7472 6163  cted=time_extrac
+0001b400: 7465 6429 0a0a 0a64 6566 2067 6574 5f73  ted)...def get_s
+0001b410: 796e 635f 7375 6d6d 6172 7928 6361 7461  ync_summary(cata
+0001b420: 6c6f 6729 2d3e 7374 723a 0a20 2020 2022  log)->str:.    "
+0001b430: 2222 0a20 2020 2042 7569 6c64 7320 6120  "".    Builds a 
+0001b440: 7375 6d6d 6172 7920 6f66 2073 796e 6320  summary of sync 
+0001b450: 666f 7220 616c 6c20 7374 7265 616d 730a  for all streams.
+0001b460: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0001b470: 2020 6361 7461 6c6f 673a 2064 6963 7469    catalog: dicti
+0001b480: 6f6e 6172 7920 7769 7468 2061 6c6c 2074  onary with all t
+0001b490: 6865 2073 7472 6561 6d73 2064 6574 6169  he streams detai
+0001b4a0: 6c73 0a0a 2020 2020 5265 7475 726e 733a  ls..    Returns:
+0001b4b0: 2073 756d 6d61 7279 2074 6162 6c65 2061   summary table a
+0001b4c0: 7320 7374 7269 6e67 0a0a 2020 2020 2222  s string..    ""
+0001b4d0: 220a 2020 2020 6865 6164 6572 7320 3d20  ".    headers = 
+0001b4e0: 5b5b 2764 6174 6162 6173 6527 2c0a 2020  [['database',.  
+0001b4f0: 2020 2020 2020 2020 2020 2020 2020 2763                'c
+0001b500: 6f6c 6c65 6374 696f 6e27 2c0a 2020 2020  ollection',.    
+0001b510: 2020 2020 2020 2020 2020 2020 2772 6570              'rep
+0001b520: 6c69 6361 7469 6f6e 206d 6574 686f 6427  lication method'
+0001b530: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001b540: 2020 2774 6f74 616c 2072 6563 6f72 6473    'total records
+0001b550: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0001b560: 2020 2027 7772 6974 6520 7370 6565 6427     'write speed'
+0001b570: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001b580: 2020 2774 6f74 616c 2074 696d 6527 2c0a    'total time',.
+0001b590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5a0: 2773 6368 656d 6173 2077 7269 7474 656e  'schemas written
+0001b5b0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0001b5c0: 2020 2027 7363 6865 6d61 2062 7569 6c64     'schema build
+0001b5d0: 2064 7572 6174 696f 6e27 2c0a 2020 2020   duration',.    
+0001b5e0: 2020 2020 2020 2020 2020 2020 2770 6572              'per
+0001b5f0: 6365 6e74 2062 7569 6c64 696e 6720 7363  cent building sc
+0001b600: 6865 6d61 7327 5d5d 0a0a 2020 2020 726f  hemas']]..    ro
+0001b610: 7773 203d 205b 5d0a 2020 2020 666f 7220  ws = [].    for 
+0001b620: 7374 7265 616d 5f69 642c 2073 7472 6561  stream_id, strea
+0001b630: 6d5f 636f 756e 7420 696e 2043 4f55 4e54  m_count in COUNT
+0001b640: 532e 6974 656d 7328 293a 0a20 2020 2020  S.items():.     
+0001b650: 2020 2073 7472 6561 6d20 3d20 5b78 2066     stream = [x f
+0001b660: 6f72 2078 2069 6e20 6361 7461 6c6f 675b  or x in catalog[
+0001b670: 2773 7472 6561 6d73 275d 2069 6620 785b  'streams'] if x[
+0001b680: 2774 6170 5f73 7472 6561 6d5f 6964 275d  'tap_stream_id']
+0001b690: 203d 3d20 7374 7265 616d 5f69 645d 5b30   == stream_id][0
+0001b6a0: 5d0a 2020 2020 2020 2020 636f 6c6c 6563  ].        collec
+0001b6b0: 7469 6f6e 5f6e 616d 6520 3d20 7374 7265  tion_name = stre
+0001b6c0: 616d 2e67 6574 2822 7461 626c 655f 6e61  am.get("table_na
+0001b6d0: 6d65 2229 0a20 2020 2020 2020 206d 645f  me").        md_
+0001b6e0: 6d61 7020 3d20 6d65 7461 6461 7461 2e74  map = metadata.t
+0001b6f0: 6f5f 6d61 7028 7374 7265 616d 5b27 6d65  o_map(stream['me
+0001b700: 7461 6461 7461 275d 290a 2020 2020 2020  tadata']).      
+0001b710: 2020 6462 5f6e 616d 6520 3d20 6d65 7461    db_name = meta
+0001b720: 6461 7461 2e67 6574 286d 645f 6d61 702c  data.get(md_map,
+0001b730: 2028 292c 2027 6461 7461 6261 7365 2d6e   (), 'database-n
+0001b740: 616d 6527 290a 2020 2020 2020 2020 7265  ame').        re
+0001b750: 706c 6963 6174 696f 6e5f 6d65 7468 6f64  plication_method
+0001b760: 203d 206d 6574 6164 6174 612e 6765 7428   = metadata.get(
+0001b770: 6d64 5f6d 6170 2c20 2829 2c20 2772 6570  md_map, (), 'rep
+0001b780: 6c69 6361 7469 6f6e 2d6d 6574 686f 6427  lication-method'
+0001b790: 290a 0a20 2020 2020 2020 2073 7472 6561  )..        strea
+0001b7a0: 6d5f 7469 6d65 203d 2054 494d 4553 5b73  m_time = TIMES[s
+0001b7b0: 7472 6561 6d5f 6964 5d0a 2020 2020 2020  tream_id].      
+0001b7c0: 2020 7363 6865 6d61 735f 7772 6974 7465    schemas_writte
+0001b7d0: 6e20 3d20 5343 4845 4d41 5f43 4f55 4e54  n = SCHEMA_COUNT
+0001b7e0: 5b73 7472 6561 6d5f 6964 5d0a 2020 2020  [stream_id].    
+0001b7f0: 2020 2020 7363 6865 6d61 5f64 7572 6174      schema_durat
+0001b800: 696f 6e20 3d20 5343 4845 4d41 5f54 494d  ion = SCHEMA_TIM
+0001b810: 4553 5b73 7472 6561 6d5f 6964 5d0a 0a20  ES[stream_id].. 
+0001b820: 2020 2020 2020 2069 6620 7374 7265 616d         if stream
+0001b830: 5f74 696d 6520 3d3d 2030 3a0a 2020 2020  _time == 0:.    
+0001b840: 2020 2020 2020 2020 7374 7265 616d 5f74          stream_t
+0001b850: 696d 6520 3d20 302e 3030 3030 3031 0a0a  ime = 0.000001..
+0001b860: 2020 2020 2020 2020 726f 7773 2e61 7070          rows.app
+0001b870: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
+0001b880: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0001b890: 2020 2064 625f 6e61 6d65 2c0a 2020 2020     db_name,.    
+0001b8a0: 2020 2020 2020 2020 2020 2020 636f 6c6c              coll
+0001b8b0: 6563 7469 6f6e 5f6e 616d 652c 0a20 2020  ection_name,.   
+0001b8c0: 2020 2020 2020 2020 2020 2020 2072 6570               rep
+0001b8d0: 6c69 6361 7469 6f6e 5f6d 6574 686f 642c  lication_method,
+0001b8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b8f0: 2066 277b 7374 7265 616d 5f63 6f75 6e74   f'{stream_count
+0001b900: 7d20 7265 636f 7264 7327 2c0a 2020 2020  } records',.    
+0001b910: 2020 2020 2020 2020 2020 2020 6627 7b73              f'{s
+0001b920: 7472 6561 6d5f 636f 756e 7420 2f20 666c  tream_count / fl
+0001b930: 6f61 7428 7374 7265 616d 5f74 696d 6529  oat(stream_time)
+0001b940: 3a2e 3166 7d20 7265 636f 7264 732f 7365  :.1f} records/se
+0001b950: 636f 6e64 272c 0a20 2020 2020 2020 2020  cond',.         
+0001b960: 2020 2020 2020 2066 277b 7374 7265 616d         f'{stream
+0001b970: 5f74 696d 653a 2e35 667d 2073 6563 6f6e  _time:.5f} secon
+0001b980: 6473 272c 0a20 2020 2020 2020 2020 2020  ds',.           
+0001b990: 2020 2020 2066 277b 7363 6865 6d61 735f       f'{schemas_
+0001b9a0: 7772 6974 7465 6e7d 2073 6368 656d 6173  written} schemas
+0001b9b0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
+0001b9c0: 2020 2066 277b 7363 6865 6d61 5f64 7572     f'{schema_dur
+0001b9d0: 6174 696f 6e3a 2e35 667d 2073 6563 6f6e  ation:.5f} secon
+0001b9e0: 6473 272c 0a20 2020 2020 2020 2020 2020  ds',.           
+0001b9f0: 2020 2020 2066 277b 3130 3020 2a20 7363       f'{100 * sc
+0001ba00: 6865 6d61 5f64 7572 6174 696f 6e20 2f20  hema_duration / 
+0001ba10: 666c 6f61 7428 7374 7265 616d 5f74 696d  float(stream_tim
+0001ba20: 6529 3a2e 3266 7d25 270a 2020 2020 2020  e):.2f}%'.      
+0001ba30: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+0001ba40: 290a 0a20 2020 2064 6174 6120 3d20 6865  )..    data = he
+0001ba50: 6164 6572 7320 2b20 726f 7773 0a20 2020  aders + rows.   
+0001ba60: 2074 6162 6c65 203d 2041 7363 6969 5461   table = AsciiTa
+0001ba70: 626c 6528 6461 7461 2c20 7469 746c 653d  ble(data, title=
+0001ba80: 2753 796e 6320 5375 6d6d 6172 7927 290a  'Sync Summary').
+0001ba90: 0a20 2020 2072 6574 7572 6e20 275c 6e5c  .    return '\n\
+0001baa0: 6e27 202b 2074 6162 6c65 2e74 6162 6c65  n' + table.table
+0001bab0: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+0001bac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001baf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bc00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0001bc10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bc60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0001bc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001bc80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0001bc90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0001bca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0001bd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be00: 3232 206d 7469 6d65 3d31 3637 3634 3530  22 mtime=1676450
+0001be10: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
+0001be20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001be90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001beb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001bff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c000: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+0001c010: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
+0001c020: 5f73 7472 6174 6567 6965 732f 6675 6c6c  _strategies/full
+0001c030: 5f74 6162 6c65 2e70 7900 0000 0000 0000  _table.py.......
+0001c040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+0001c070: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+0001c080: 3030 3133 3730 3700 3030 3030 3030 3030  0013707.00000000
+0001c090: 3030 3000 3032 3437 3134 0020 3000 0000  000.024714. 0...
+0001c0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c100: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+0001c110: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+0001c120: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0001c130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001c200: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
+0001c210: 7974 686f 6e33 0a69 6d70 6f72 7420 636f  ython3.import co
+0001c220: 7079 0a69 6d70 6f72 7420 7469 6d65 0a69  py.import time.i
+0001c230: 6d70 6f72 7420 7079 6d6f 6e67 6f0a 696d  mport pymongo.im
+0001c240: 706f 7274 2073 696e 6765 720a 0a66 726f  port singer..fro
+0001c250: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
+0001c260: 4f70 7469 6f6e 616c 2c20 4469 6374 0a66  Optional, Dict.f
+0001c270: 726f 6d20 7079 6d6f 6e67 6f2e 636f 6c6c  rom pymongo.coll
+0001c280: 6563 7469 6f6e 2069 6d70 6f72 7420 436f  ection import Co
+0001c290: 6c6c 6563 7469 6f6e 0a66 726f 6d20 7369  llection.from si
+0001c2a0: 6e67 6572 2069 6d70 6f72 7420 7574 696c  nger import util
+0001c2b0: 730a 0a66 726f 6d20 647a 5f6d 6f6e 676f  s..from dz_mongo
+0001c2c0: 6462 2e73 796e 635f 7374 7261 7465 6769  db.sync_strategi
+0001c2d0: 6573 2069 6d70 6f72 7420 636f 6d6d 6f6e  es import common
+0001c2e0: 0a0a 4c4f 4747 4552 203d 2073 696e 6765  ..LOGGER = singe
+0001c2f0: 722e 6765 745f 6c6f 6767 6572 2827 647a  r.get_logger('dz
+0001c300: 5f6d 6f6e 676f 6462 2729 0a0a 0a64 6566  _mongodb')...def
+0001c310: 2067 6574 5f6d 6178 5f69 645f 7661 6c75   get_max_id_valu
+0001c320: 6528 636f 6c6c 6563 7469 6f6e 3a20 436f  e(collection: Co
+0001c330: 6c6c 6563 7469 6f6e 2920 2d3e 204f 7074  llection) -> Opt
+0001c340: 696f 6e61 6c5b 7374 725d 3a0a 2020 2020  ional[str]:.    
+0001c350: 2222 220a 2020 2020 4669 6e64 7320 616e  """.    Finds an
+0001c360: 6420 7265 7475 726e 7320 7468 6520 6d61  d returns the ma
+0001c370: 7869 6d75 6d20 4944 2069 6e20 7468 6520  ximum ID in the 
+0001c380: 636f 6c6c 6563 7469 6f6e 2069 6620 6578  collection if ex
+0001c390: 6973 7473 204e 6f6e 6520 6f74 6865 7277  ists None otherw
+0001c3a0: 6973 650a 2020 2020 4172 6773 3a0a 2020  ise.    Args:.  
+0001c3b0: 2020 2020 2020 636f 6c6c 6563 7469 6f6e        collection
+0001c3c0: 3a20 4d6f 6e67 6f44 4220 436f 6c6c 6563  : MongoDB Collec
+0001c3d0: 7469 6f6e 2069 6e73 7461 6e63 650a 0a20  tion instance.. 
+0001c3e0: 2020 2052 6574 7572 6e73 3a20 4d61 7820     Returns: Max 
+0001c3f0: 4944 206f 7220 4e6f 6e65 0a0a 2020 2020  ID or None..    
+0001c400: 2222 220a 2020 2020 726f 7720 3d20 636f  """.    row = co
+0001c410: 6c6c 6563 7469 6f6e 2e66 696e 645f 6f6e  llection.find_on
+0001c420: 6528 736f 7274 3d5b 2822 5f69 6422 2c20  e(sort=[("_id", 
+0001c430: 7079 6d6f 6e67 6f2e 4445 5343 454e 4449  pymongo.DESCENDI
+0001c440: 4e47 295d 290a 2020 2020 6966 2072 6f77  NG)]).    if row
+0001c450: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001c460: 2072 6f77 5b27 5f69 6427 5d0a 0a20 2020   row['_id']..   
+0001c470: 204c 4f47 4745 522e 696e 666f 2822 4e6f   LOGGER.info("No
+0001c480: 206d 6178 2069 6420 666f 756e 6420 666f   max id found fo
+0001c490: 7220 636f 6c6c 6563 7469 6f6e 3a20 636f  r collection: co
+0001c4a0: 6c6c 6563 7469 6f6e 2069 7320 6c69 6b65  llection is like
+0001c4b0: 6c79 2065 6d70 7479 2229 0a20 2020 2072  ly empty").    r
+0001c4c0: 6574 7572 6e20 4e6f 6e65 0a0a 0a64 6566  eturn None...def
+0001c4d0: 2073 796e 635f 636f 6c6c 6563 7469 6f6e   sync_collection
+0001c4e0: 2863 6f6c 6c65 6374 696f 6e3a 2043 6f6c  (collection: Col
+0001c4f0: 6c65 6374 696f 6e2c 2073 7472 6561 6d3a  lection, stream:
+0001c500: 2044 6963 742c 2073 7461 7465 3a20 4469   Dict, state: Di
+0001c510: 6374 2920 2d3e 204e 6f6e 653a 0a20 2020  ct) -> None:.   
+0001c520: 2022 2222 0a20 2020 2053 796e 6320 636f   """.    Sync co
+0001c530: 6c6c 6563 7469 6f6e 2072 6563 6f72 6473  llection records
+0001c540: 2069 6e63 7265 6d65 6e74 616c 6c79 0a20   incrementally. 
+0001c550: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+0001c560: 2063 6f6c 6c65 6374 696f 6e3a 204d 6f6e   collection: Mon
+0001c570: 676f 4442 2063 6f6c 6c65 6374 696f 6e20  goDB collection 
+0001c580: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+0001c590: 2073 7472 6561 6d3a 2064 6963 7469 6f6e   stream: diction
+0001c5a0: 6172 7920 6f66 2061 6c6c 2073 7472 6561  ary of all strea
+0001c5b0: 6d20 6465 7461 696c 730a 2020 2020 2020  m details.      
+0001c5c0: 2020 7374 6174 653a 2074 6865 2074 6170    state: the tap
+0001c5d0: 2073 7461 7465 0a20 2020 2022 2222 0a20   state.    """. 
+0001c5e0: 2020 204c 4f47 4745 522e 696e 666f 2827     LOGGER.info('
+0001c5f0: 5374 6172 7469 6e67 2066 756c 6c20 7461  Starting full ta
+0001c600: 626c 6520 7379 6e63 2066 6f72 2025 7327  ble sync for %s'
+0001c610: 2c20 7374 7265 616d 5b27 7461 705f 7374  , stream['tap_st
+0001c620: 7265 616d 5f69 6427 5d29 0a0a 2020 2020  ream_id'])..    
+0001c630: 2320 6265 666f 7265 2077 7269 7469 6e67  # before writing
+0001c640: 2074 6865 2074 6162 6c65 2076 6572 7369   the table versi
+0001c650: 6f6e 2074 6f20 7374 6174 652c 2063 6865  on to state, che
+0001c660: 636b 2069 6620 7765 2068 6164 206f 6e65  ck if we had one
+0001c670: 2074 6f20 6265 6769 6e20 7769 7468 0a20   to begin with. 
+0001c680: 2020 2066 6972 7374 5f72 756e 203d 2073     first_run = s
+0001c690: 696e 6765 722e 6765 745f 626f 6f6b 6d61  inger.get_bookma
+0001c6a0: 726b 2873 7461 7465 2c20 7374 7265 616d  rk(state, stream
+0001c6b0: 5b27 7461 705f 7374 7265 616d 5f69 6427  ['tap_stream_id'
+0001c6c0: 5d2c 2027 7665 7273 696f 6e27 2920 6973  ], 'version') is
+0001c6d0: 204e 6f6e 650a 0a20 2020 2023 206c 6173   None..    # las
+0001c6e0: 7420 7275 6e20 7761 7320 696e 7465 7272  t run was interr
+0001c6f0: 7570 7465 6420 6966 2074 6865 7265 2069  upted if there i
+0001c700: 7320 6120 6c61 7374 5f69 645f 6665 7463  s a last_id_fetc
+0001c710: 6865 6420 626f 6f6b 6d61 726b 0a20 2020  hed bookmark.   
+0001c720: 2023 2070 6963 6b20 6120 6e65 7720 7461   # pick a new ta
+0001c730: 626c 6520 7665 7273 696f 6e20 6966 206c  ble version if l
+0001c740: 6173 7420 7275 6e20 7761 736e 2774 2069  ast run wasn't i
+0001c750: 6e74 6572 7275 7074 6564 0a20 2020 2069  nterrupted.    i
+0001c760: 6620 7369 6e67 6572 2e67 6574 5f62 6f6f  f singer.get_boo
+0001c770: 6b6d 6172 6b28 7374 6174 652c 2073 7472  kmark(state, str
+0001c780: 6561 6d5b 2774 6170 5f73 7472 6561 6d5f  eam['tap_stream_
+0001c790: 6964 275d 2c20 276c 6173 745f 6964 5f66  id'], 'last_id_f
+0001c7a0: 6574 6368 6564 2729 2069 7320 6e6f 7420  etched') is not 
+0001c7b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7374  None:.        st
+0001c7c0: 7265 616d 5f76 6572 7369 6f6e 203d 2073  ream_version = s
+0001c7d0: 696e 6765 722e 6765 745f 626f 6f6b 6d61  inger.get_bookma
+0001c7e0: 726b 2873 7461 7465 2c20 7374 7265 616d  rk(state, stream
+0001c7f0: 5b27 7461 705f 7374 7265 616d 5f69 6427  ['tap_stream_id'
+0001c800: 5d2c 2027 7665 7273 696f 6e27 290a 2020  ], 'version').  
+0001c810: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001c820: 7374 7265 616d 5f76 6572 7369 6f6e 203d  stream_version =
+0001c830: 2069 6e74 2874 696d 652e 7469 6d65 2829   int(time.time()
+0001c840: 202a 2031 3030 3029 0a0a 2020 2020 7374   * 1000)..    st
+0001c850: 6174 6520 3d20 7369 6e67 6572 2e77 7269  ate = singer.wri
+0001c860: 7465 5f62 6f6f 6b6d 6172 6b28 7374 6174  te_bookmark(stat
+0001c870: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0001c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c890: 2020 2020 2073 7472 6561 6d5b 2774 6170       stream['tap
+0001c8a0: 5f73 7472 6561 6d5f 6964 275d 2c0a 2020  _stream_id'],.  
+0001c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c8d0: 2776 6572 7369 6f6e 272c 0a20 2020 2020  'version',.     
+0001c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c8f0: 2020 2020 2020 2020 2020 2020 2073 7472               str
+0001c900: 6561 6d5f 7665 7273 696f 6e29 0a20 2020  eam_version).   
+0001c910: 2073 696e 6765 722e 7772 6974 655f 6d65   singer.write_me
+0001c920: 7373 6167 6528 7369 6e67 6572 2e53 7461  ssage(singer.Sta
+0001c930: 7465 4d65 7373 6167 6528 7661 6c75 653d  teMessage(value=
+0001c940: 636f 7079 2e64 6565 7063 6f70 7928 7374  copy.deepcopy(st
+0001c950: 6174 6529 2929 0a0a 2020 2020 6163 7469  ate)))..    acti
+0001c960: 7661 7465 5f76 6572 7369 6f6e 5f6d 6573  vate_version_mes
+0001c970: 7361 6765 203d 2073 696e 6765 722e 4163  sage = singer.Ac
+0001c980: 7469 7661 7465 5665 7273 696f 6e4d 6573  tivateVersionMes
+0001c990: 7361 6765 280a 2020 2020 2020 2020 7374  sage(.        st
+0001c9a0: 7265 616d 3d63 6f6d 6d6f 6e2e 6361 6c63  ream=common.calc
+0001c9b0: 756c 6174 655f 6465 7374 696e 6174 696f  ulate_destinatio
+0001c9c0: 6e5f 7374 7265 616d 5f6e 616d 6528 7374  n_stream_name(st
+0001c9d0: 7265 616d 292c 0a20 2020 2020 2020 2076  ream),.        v
+0001c9e0: 6572 7369 6f6e 3d73 7472 6561 6d5f 7665  ersion=stream_ve
+0001c9f0: 7273 696f 6e0a 2020 2020 290a 0a20 2020  rsion.    )..   
+0001ca00: 2023 2046 6f72 2074 6865 2069 6e69 7469   # For the initi
+0001ca10: 616c 2072 6570 6c69 6361 7469 6f6e 2c20  al replication, 
+0001ca20: 656d 6974 2061 6e20 4143 5449 5641 5445  emit an ACTIVATE
+0001ca30: 5f56 4552 5349 4f4e 206d 6573 7361 6765  _VERSION message
+0001ca40: 0a20 2020 2023 2061 7420 7468 6520 6265  .    # at the be
+0001ca50: 6769 6e6e 696e 6720 736f 2074 6865 2072  ginning so the r
+0001ca60: 6563 6f72 6473 2073 686f 7720 7570 2072  ecords show up r
+0001ca70: 6967 6874 2061 7761 792e 0a20 2020 2069  ight away..    i
+0001ca80: 6620 6669 7273 745f 7275 6e3a 0a20 2020  f first_run:.   
+0001ca90: 2020 2020 2073 696e 6765 722e 7772 6974       singer.writ
+0001caa0: 655f 6d65 7373 6167 6528 6163 7469 7661  e_message(activa
+0001cab0: 7465 5f76 6572 7369 6f6e 5f6d 6573 7361  te_version_messa
+0001cac0: 6765 290a 0a20 2020 2069 6620 7369 6e67  ge)..    if sing
+0001cad0: 6572 2e67 6574 5f62 6f6f 6b6d 6172 6b28  er.get_bookmark(
+0001cae0: 7374 6174 652c 2073 7472 6561 6d5b 2774  state, stream['t
+0001caf0: 6170 5f73 7472 6561 6d5f 6964 275d 2c20  ap_stream_id'], 
+0001cb00: 276d 6178 5f69 645f 7661 6c75 6527 293a  'max_id_value'):
+0001cb10: 0a20 2020 2020 2020 2023 2054 6865 7265  .        # There
+0001cb20: 2069 7320 6120 626f 6f6b 6d61 726b 0a20   is a bookmark. 
+0001cb30: 2020 2020 2020 206d 6178 5f69 645f 7661         max_id_va
+0001cb40: 6c75 6520 3d20 636f 6d6d 6f6e 2e73 7472  lue = common.str
+0001cb50: 696e 675f 746f 5f63 6c61 7373 2873 696e  ing_to_class(sin
+0001cb60: 6765 722e 6765 745f 626f 6f6b 6d61 726b  ger.get_bookmark
+0001cb70: 2873 7461 7465 2c20 7374 7265 616d 5b27  (state, stream['
+0001cb80: 7461 705f 7374 7265 616d 5f69 6427 5d2c  tap_stream_id'],
+0001cb90: 2027 6d61 785f 6964 5f76 616c 7565 2729   'max_id_value')
+0001cba0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbd0: 7369 6e67 6572 2e67 6574 5f62 6f6f 6b6d  singer.get_bookm
+0001cbe0: 6172 6b28 7374 6174 652c 2073 7472 6561  ark(state, strea
+0001cbf0: 6d5b 2774 6170 5f73 7472 6561 6d5f 6964  m['tap_stream_id
+0001cc00: 275d 2c20 276d 6178 5f69 645f 7479 7065  '], 'max_id_type
+0001cc10: 2729 290a 2020 2020 656c 7365 3a0a 2020  ')).    else:.  
+0001cc20: 2020 2020 2020 6d61 785f 6964 5f76 616c        max_id_val
+0001cc30: 7565 203d 2067 6574 5f6d 6178 5f69 645f  ue = get_max_id_
+0001cc40: 7661 6c75 6528 636f 6c6c 6563 7469 6f6e  value(collection
+0001cc50: 290a 0a20 2020 206c 6173 745f 6964 5f66  )..    last_id_f
+0001cc60: 6574 6368 6564 203d 2073 696e 6765 722e  etched = singer.
+0001cc70: 6765 745f 626f 6f6b 6d61 726b 2873 7461  get_bookmark(sta
+0001cc80: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+0001cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cca0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0001ccb0: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
+0001ccc0: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
+0001ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ccf0: 2027 6c61 7374 5f69 645f 6665 7463 6865   'last_id_fetche
+0001cd00: 6427 290a 0a20 2020 2069 6620 6d61 785f  d')..    if max_
+0001cd10: 6964 5f76 616c 7565 3a0a 2020 2020 2020  id_value:.      
+0001cd20: 2020 2320 5772 6974 6520 7468 6520 626f    # Write the bo
+0001cd30: 6f6b 6d61 726b 2069 6620 6d61 785f 6964  okmark if max_id
+0001cd40: 5f76 616c 7565 2069 7320 6465 6669 6e65  _value is define
+0001cd50: 640a 2020 2020 2020 2020 7374 6174 6520  d.        state 
+0001cd60: 3d20 7369 6e67 6572 2e77 7269 7465 5f62  = singer.write_b
+0001cd70: 6f6f 6b6d 6172 6b28 7374 6174 652c 0a20  ookmark(state,. 
+0001cd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cda0: 2020 2020 2073 7472 6561 6d5b 2774 6170       stream['tap
+0001cdb0: 5f73 7472 6561 6d5f 6964 275d 2c0a 2020  _stream_id'],.  
+0001cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cde0: 2020 2020 276d 6178 5f69 645f 7661 6c75      'max_id_valu
+0001cdf0: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
+0001ce00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ce10: 2020 2020 2020 2020 2020 636f 6d6d 6f6e            common
+0001ce20: 2e63 6c61 7373 5f74 6f5f 7374 7269 6e67  .class_to_string
+0001ce30: 286d 6178 5f69 645f 7661 6c75 652c 0a20  (max_id_value,. 
+0001ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ce60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ce70: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
+0001ce80: 6964 5f76 616c 7565 2e5f 5f63 6c61 7373  id_value.__class
+0001ce90: 5f5f 2e5f 5f6e 616d 655f 5f29 290a 2020  __.__name__)).  
+0001cea0: 2020 2020 2020 7374 6174 6520 3d20 7369        state = si
+0001ceb0: 6e67 6572 2e77 7269 7465 5f62 6f6f 6b6d  nger.write_bookm
+0001cec0: 6172 6b28 7374 6174 652c 0a20 2020 2020  ark(state,.     
+0001ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cef0: 2073 7472 6561 6d5b 2774 6170 5f73 7472   stream['tap_str
+0001cf00: 6561 6d5f 6964 275d 2c0a 2020 2020 2020  eam_id'],.      
+0001cf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf30: 276d 6178 5f69 645f 7479 7065 272c 0a20  'max_id_type',. 
+0001cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf60: 2020 2020 206d 6178 5f69 645f 7661 6c75       max_id_valu
+0001cf70: 652e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  e.__class__.__na
+0001cf80: 6d65 5f5f 290a 0a20 2020 2066 696e 645f  me__)..    find_
+0001cf90: 6669 6c74 6572 203d 207b 2724 6c74 6527  filter = {'$lte'
+0001cfa0: 3a20 6d61 785f 6964 5f76 616c 7565 7d0a  : max_id_value}.
+0001cfb0: 2020 2020 6966 206c 6173 745f 6964 5f66      if last_id_f
+0001cfc0: 6574 6368 6564 3a0a 2020 2020 2020 2020  etched:.        
+0001cfd0: 6669 6e64 5f66 696c 7465 725b 2724 6774  find_filter['$gt
+0001cfe0: 6527 5d20 3d20 636f 6d6d 6f6e 2e73 7472  e'] = common.str
+0001cff0: 696e 675f 746f 5f63 6c61 7373 286c 6173  ing_to_class(las
+0001d000: 745f 6964 5f66 6574 6368 6564 2c20 7369  t_id_fetched, si
+0001d010: 6e67 6572 2e67 6574 5f62 6f6f 6b6d 6172  nger.get_bookmar
+0001d020: 6b28 7374 6174 652c 0a20 2020 2020 2020  k(state,.       
+0001d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d080: 2020 2073 7472 6561 6d5b 2774 6170 5f73     stream['tap_s
+0001d090: 7472 6561 6d5f 6964 275d 2c0a 2020 2020  tream_id'],.    
+0001d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0f0: 2020 2020 2020 276c 6173 745f 6964 5f66        'last_id_f
+0001d100: 6574 6368 6564 5f74 7970 6527 2929 0a0a  etched_type'))..
+0001d110: 2020 2020 4c4f 4747 4552 2e69 6e66 6f28      LOGGER.info(
+0001d120: 2751 7565 7279 696e 6720 2573 2077 6974  'Querying %s wit
+0001d130: 683a 2025 7327 2c20 7374 7265 616d 5b27  h: %s', stream['
+0001d140: 7461 705f 7374 7265 616d 5f69 6427 5d2c  tap_stream_id'],
+0001d150: 2064 6963 7428 6669 6e64 3d66 696e 645f   dict(find=find_
+0001d160: 6669 6c74 6572 2929 0a0a 2020 2020 7769  filter))..    wi
+0001d170: 7468 2063 6f6c 6c65 6374 696f 6e2e 6669  th collection.fi
+0001d180: 6e64 287b 275f 6964 273a 2066 696e 645f  nd({'_id': find_
+0001d190: 6669 6c74 6572 7d2c 0a20 2020 2020 2020  filter},.       
+0001d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1b0: 2020 736f 7274 3d5b 2822 5f69 6422 2c20    sort=[("_id", 
+0001d1c0: 7079 6d6f 6e67 6f2e 4153 4345 4e44 494e  pymongo.ASCENDIN
+0001d1d0: 4729 5d29 2061 7320 6375 7273 6f72 3a0a  G)]) as cursor:.
+0001d1e0: 2020 2020 2020 2020 726f 7773 5f73 6176          rows_sav
+0001d1f0: 6564 203d 2030 0a20 2020 2020 2020 2073  ed = 0.        s
+0001d200: 7461 7274 5f74 696d 6520 3d20 7469 6d65  tart_time = time
+0001d210: 2e74 696d 6528 290a 0a20 2020 2020 2020  .time()..       
+0001d220: 2066 6f72 2072 6f77 2069 6e20 6375 7273   for row in curs
+0001d230: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0001d240: 726f 7773 5f73 6176 6564 202b 3d20 310a  rows_saved += 1.
+0001d250: 0a20 2020 2020 2020 2020 2020 2073 696e  .            sin
+0001d260: 6765 722e 7772 6974 655f 6d65 7373 6167  ger.write_messag
+0001d270: 6528 636f 6d6d 6f6e 2e72 6f77 5f74 6f5f  e(common.row_to_
+0001d280: 7369 6e67 6572 5f72 6563 6f72 6428 7374  singer_record(st
+0001d290: 7265 616d 3d73 7472 6561 6d2c 0a20 2020  ream=stream,.   
+0001d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2d0: 2020 2020 2020 2020 2020 726f 773d 726f            row=ro
+0001d2e0: 772c 0a20 2020 2020 2020 2020 2020 2020  w,.             
+0001d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d320: 7469 6d65 5f65 7874 7261 6374 6564 3d75  time_extracted=u
+0001d330: 7469 6c73 2e6e 6f77 2829 2c0a 2020 2020  tils.now(),.    
+0001d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d370: 2020 2020 2020 2020 2074 696d 655f 6465           time_de
+0001d380: 6c65 7465 643d 4e6f 6e65 2c0a 2020 2020  leted=None,.    
+0001d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3c0: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
+0001d3d0: 3d73 7472 6561 6d5f 7665 7273 696f 6e29  =stream_version)
+0001d3e0: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0001d3f0: 7461 7465 203d 2073 696e 6765 722e 7772  tate = singer.wr
+0001d400: 6974 655f 626f 6f6b 6d61 726b 2873 7461  ite_bookmark(sta
+0001d410: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+0001d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d430: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0001d440: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
+0001d450: 5f69 6427 5d2c 0a20 2020 2020 2020 2020  _id'],.         
+0001d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d480: 2027 6c61 7374 5f69 645f 6665 7463 6865   'last_id_fetche
+0001d490: 6427 2c0a 2020 2020 2020 2020 2020 2020  d',.            
+0001d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d4b0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0001d4c0: 6d6d 6f6e 2e63 6c61 7373 5f74 6f5f 7374  mmon.class_to_st
+0001d4d0: 7269 6e67 2872 6f77 5b27 5f69 6427 5d2c  ring(row['_id'],
+0001d4e0: 2072 6f77 5b27 5f69 6427 5d2e 5f5f 636c   row['_id'].__cl
+0001d4f0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2929  ass__.__name__))
+0001d500: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+0001d510: 7465 203d 2073 696e 6765 722e 7772 6974  te = singer.writ
+0001d520: 655f 626f 6f6b 6d61 726b 2873 7461 7465  e_bookmark(state
+0001d530: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d550: 2020 2020 2020 2020 2020 2020 7374 7265              stre
+0001d560: 616d 5b27 7461 705f 7374 7265 616d 5f69  am['tap_stream_i
+0001d570: 6427 5d2c 0a20 2020 2020 2020 2020 2020  d'],.           
+0001d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d590: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0001d5a0: 6c61 7374 5f69 645f 6665 7463 6865 645f  last_id_fetched_
+0001d5b0: 7479 7065 272c 0a20 2020 2020 2020 2020  type',.         
+0001d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5e0: 2072 6f77 5b27 5f69 6427 5d2e 5f5f 636c   row['_id'].__cl
+0001d5f0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 290a  ass__.__name__).
+0001d600: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001d610: 726f 7773 5f73 6176 6564 2025 2063 6f6d  rows_saved % com
+0001d620: 6d6f 6e2e 5550 4441 5445 5f42 4f4f 4b4d  mon.UPDATE_BOOKM
+0001d630: 4152 4b5f 5045 5249 4f44 203d 3d20 303a  ARK_PERIOD == 0:
+0001d640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d650: 2073 696e 6765 722e 7772 6974 655f 6d65   singer.write_me
+0001d660: 7373 6167 6528 7369 6e67 6572 2e53 7461  ssage(singer.Sta
+0001d670: 7465 4d65 7373 6167 6528 7661 6c75 653d  teMessage(value=
+0001d680: 636f 7079 2e64 6565 7063 6f70 7928 7374  copy.deepcopy(st
+0001d690: 6174 6529 2929 0a0a 2020 2020 2020 2020  ate)))..        
+0001d6a0: 636f 6d6d 6f6e 2e43 4f55 4e54 535b 7374  common.COUNTS[st
+0001d6b0: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
+0001d6c0: 5f69 6427 5d5d 202b 3d20 726f 7773 5f73  _id']] += rows_s
+0001d6d0: 6176 6564 0a20 2020 2020 2020 2063 6f6d  aved.        com
+0001d6e0: 6d6f 6e2e 5449 4d45 535b 7374 7265 616d  mon.TIMES[stream
+0001d6f0: 5b27 7461 705f 7374 7265 616d 5f69 6427  ['tap_stream_id'
+0001d700: 5d5d 202b 3d20 7469 6d65 2e74 696d 6528  ]] += time.time(
+0001d710: 2920 2d20 7374 6172 745f 7469 6d65 0a0a  ) - start_time..
+0001d720: 2020 2020 2320 636c 6561 7220 6d61 7820      # clear max 
+0001d730: 706b 2076 616c 7565 2061 6e64 206c 6173  pk value and las
+0001d740: 7420 706b 2066 6574 6368 6564 2075 706f  t pk fetched upo
+0001d750: 6e20 7375 6363 6573 7366 756c 2073 796e  n successful syn
+0001d760: 630a 2020 2020 7369 6e67 6572 2e63 6c65  c.    singer.cle
+0001d770: 6172 5f62 6f6f 6b6d 6172 6b28 7374 6174  ar_bookmark(stat
+0001d780: 652c 2073 7472 6561 6d5b 2774 6170 5f73  e, stream['tap_s
+0001d790: 7472 6561 6d5f 6964 275d 2c20 276d 6178  tream_id'], 'max
+0001d7a0: 5f69 645f 7661 6c75 6527 290a 2020 2020  _id_value').    
+0001d7b0: 7369 6e67 6572 2e63 6c65 6172 5f62 6f6f  singer.clear_boo
+0001d7c0: 6b6d 6172 6b28 7374 6174 652c 2073 7472  kmark(state, str
+0001d7d0: 6561 6d5b 2774 6170 5f73 7472 6561 6d5f  eam['tap_stream_
+0001d7e0: 6964 275d 2c20 276d 6178 5f69 645f 7479  id'], 'max_id_ty
+0001d7f0: 7065 2729 0a20 2020 2073 696e 6765 722e  pe').    singer.
+0001d800: 636c 6561 725f 626f 6f6b 6d61 726b 2873  clear_bookmark(s
+0001d810: 7461 7465 2c20 7374 7265 616d 5b27 7461  tate, stream['ta
+0001d820: 705f 7374 7265 616d 5f69 6427 5d2c 2027  p_stream_id'], '
+0001d830: 6c61 7374 5f69 645f 6665 7463 6865 6427  last_id_fetched'
+0001d840: 290a 2020 2020 7369 6e67 6572 2e63 6c65  ).    singer.cle
+0001d850: 6172 5f62 6f6f 6b6d 6172 6b28 7374 6174  ar_bookmark(stat
+0001d860: 652c 2073 7472 6561 6d5b 2774 6170 5f73  e, stream['tap_s
+0001d870: 7472 6561 6d5f 6964 275d 2c20 276c 6173  tream_id'], 'las
+0001d880: 745f 6964 5f66 6574 6368 6564 5f74 7970  t_id_fetched_typ
+0001d890: 6527 290a 0a20 2020 2073 696e 6765 722e  e')..    singer.
+0001d8a0: 7772 6974 655f 626f 6f6b 6d61 726b 2873  write_bookmark(s
+0001d8b0: 7461 7465 2c0a 2020 2020 2020 2020 2020  tate,.          
+0001d8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d8d0: 7374 7265 616d 5b27 7461 705f 7374 7265  stream['tap_stre
+0001d8e0: 616d 5f69 6427 5d2c 0a20 2020 2020 2020  am_id'],.       
+0001d8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d900: 2020 2027 696e 6974 6961 6c5f 6675 6c6c     'initial_full
+0001d910: 5f74 6162 6c65 5f63 6f6d 706c 6574 6527  _table_complete'
+0001d920: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d930: 2020 2020 2020 2020 2020 2020 5472 7565              True
+0001d940: 290a 0a20 2020 2073 696e 6765 722e 7772  )..    singer.wr
+0001d950: 6974 655f 6d65 7373 6167 6528 6163 7469  ite_message(acti
+0001d960: 7661 7465 5f76 6572 7369 6f6e 5f6d 6573  vate_version_mes
+0001d970: 7361 6765 290a 0a20 2020 204c 4f47 4745  sage)..    LOGGE
+0001d980: 522e 696e 666f 2827 5379 6e63 6420 2573  R.info('Syncd %s
+0001d990: 2072 6563 6f72 6473 2066 6f72 2025 7327   records for %s'
+0001d9a0: 2c20 726f 7773 5f73 6176 6564 2c20 7374  , rows_saved, st
+0001d9b0: 7265 616d 5b27 7461 705f 7374 7265 616d  ream['tap_stream
+0001d9c0: 5f69 6427 5d29 0a00 0000 0000 0000 0000  _id'])..........
+0001d9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001d9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001da00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0001da10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001da20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001da30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001da40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001da50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001da60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0001da70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001da80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0001da90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0001daa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001daf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001db00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0001db10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001db20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001db30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001db40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001db50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001db60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001db70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001db80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001db90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dc00: 3232 206d 7469 6d65 3d31 3637 3634 3530  22 mtime=1676450
+0001dc10: 3738 352e 300a 0000 0000 0000 0000 0000  785.0...........
+0001dc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dc80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dc90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ddb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ddc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ddd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ddf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001de00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+0001de10: 2f64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  /dz_mongodb/sync
+0001de20: 5f73 7472 6174 6567 6965 732f 696e 6372  _strategies/incr
+0001de30: 656d 656e 7461 6c2e 7079 0000 0000 0000  emental.py......
+0001de40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001de50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001de60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+0001de70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+0001de80: 3030 3131 3034 3000 3030 3030 3030 3030  0011040.00000000
+0001de90: 3030 3000 3032 3530 3730 0020 3000 0000  000.025070. 0...
+0001dea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001deb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ded0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001def0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001df00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+0001df10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+0001df20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0001df30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001df40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001df50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001df60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001df70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001df80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001df90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001dff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001e000: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
+0001e010: 7974 686f 6e33 0a69 6d70 6f72 7420 636f  ython3.import co
+0001e020: 7079 0a69 6d70 6f72 7420 7469 6d65 0a69  py.import time.i
+0001e030: 6d70 6f72 7420 7079 6d6f 6e67 6f0a 696d  mport pymongo.im
+0001e040: 706f 7274 2073 696e 6765 720a 0a66 726f  port singer..fro
+0001e050: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
+0001e060: 4469 6374 2c20 4f70 7469 6f6e 616c 0a66  Dict, Optional.f
+0001e070: 726f 6d20 7079 6d6f 6e67 6f2e 636f 6c6c  rom pymongo.coll
+0001e080: 6563 7469 6f6e 2069 6d70 6f72 7420 436f  ection import Co
+0001e090: 6c6c 6563 7469 6f6e 0a66 726f 6d20 7369  llection.from si
+0001e0a0: 6e67 6572 2069 6d70 6f72 7420 6d65 7461  nger import meta
+0001e0b0: 6461 7461 2c20 7574 696c 730a 0a66 726f  data, utils..fro
+0001e0c0: 6d20 647a 5f6d 6f6e 676f 6462 2e73 796e  m dz_mongodb.syn
+0001e0d0: 635f 7374 7261 7465 6769 6573 2069 6d70  c_strategies imp
+0001e0e0: 6f72 7420 636f 6d6d 6f6e 0a0a 4c4f 4747  ort common..LOGG
+0001e0f0: 4552 203d 2073 696e 6765 722e 6765 745f  ER = singer.get_
+0001e100: 6c6f 6767 6572 2827 647a 5f6d 6f6e 676f  logger('dz_mongo
+0001e110: 6462 2729 0a0a 0a64 6566 2075 7064 6174  db')...def updat
+0001e120: 655f 626f 6f6b 6d61 726b 2872 6f77 3a20  e_bookmark(row: 
+0001e130: 4469 6374 2c20 7374 6174 653a 2044 6963  Dict, state: Dic
+0001e140: 742c 2074 6170 5f73 7472 6561 6d5f 6964  t, tap_stream_id
+0001e150: 3a20 7374 722c 2072 6570 6c69 6361 7469  : str, replicati
+0001e160: 6f6e 5f6b 6579 5f6e 616d 653a 2073 7472  on_key_name: str
+0001e170: 2920 2d3e 204e 6f6e 653a 0a20 2020 2022  ) -> None:.    "
+0001e180: 2222 0a20 2020 2055 7064 6174 6573 2072  "".    Updates r
+0001e190: 6570 6c69 6361 7469 6f6e 206b 6579 2061  eplication key a
+0001e1a0: 6e64 2074 7970 6520 7661 6c75 6573 2069  nd type values i
+0001e1b0: 6e20 7374 6174 6520 626f 6f6b 6d61 726b  n state bookmark
+0001e1c0: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+0001e1d0: 2020 2072 6f77 3a20 4442 2072 6563 6f72     row: DB recor
+0001e1e0: 640a 2020 2020 2020 2020 7374 6174 653a  d.        state:
+0001e1f0: 2064 6963 7469 6f6e 6172 7920 6f66 2062   dictionary of b
+0001e200: 6f6f 6b6d 6172 6b73 0a20 2020 2020 2020  ookmarks.       
+0001e210: 2074 6170 5f73 7472 6561 6d5f 6964 3a20   tap_stream_id: 
+0001e220: 7374 7265 616d 2049 440a 2020 2020 2020  stream ID.      
+0001e230: 2020 7265 706c 6963 6174 696f 6e5f 6b65    replication_ke
+0001e240: 795f 6e61 6d65 3a20 7265 706c 6963 6174  y_name: replicat
+0001e250: 696f 6e20 6b65 790a 2020 2020 2222 220a  ion key.    """.
+0001e260: 2020 2020 7265 706c 6963 6174 696f 6e5f      replication_
+0001e270: 6b65 795f 7661 6c75 6520 3d20 726f 772e  key_value = row.
+0001e280: 6765 7428 7265 706c 6963 6174 696f 6e5f  get(replication_
+0001e290: 6b65 795f 6e61 6d65 290a 0a20 2020 2069  key_name)..    i
+0001e2a0: 6620 7265 706c 6963 6174 696f 6e5f 6b65  f replication_ke
+0001e2b0: 795f 7661 6c75 653a 0a20 2020 2020 2020  y_value:.       
+0001e2c0: 2072 6570 6c69 6361 7469 6f6e 5f6b 6579   replication_key
+0001e2d0: 5f74 7970 6520 3d20 7265 706c 6963 6174  _type = replicat
+0001e2e0: 696f 6e5f 6b65 795f 7661 6c75 652e 5f5f  ion_key_value.__
+0001e2f0: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
+0001e300: 0a0a 2020 2020 2020 2020 7265 706c 6963  ..        replic
+0001e310: 6174 696f 6e5f 6b65 795f 7661 6c75 655f  ation_key_value_
+0001e320: 626f 6f6b 6d61 726b 203d 2063 6f6d 6d6f  bookmark = commo
+0001e330: 6e2e 636c 6173 735f 746f 5f73 7472 696e  n.class_to_strin
+0001e340: 6728 7265 706c 6963 6174 696f 6e5f 6b65  g(replication_ke
+0001e350: 795f 7661 6c75 652c 2072 6570 6c69 6361  y_value, replica
+0001e360: 7469 6f6e 5f6b 6579 5f74 7970 6529 0a0a  tion_key_type)..
+0001e370: 2020 2020 2020 2020 7374 6174 6520 3d20          state = 
+0001e380: 7369 6e67 6572 2e77 7269 7465 5f62 6f6f  singer.write_boo
+0001e390: 6b6d 6172 6b28 7374 6174 652c 0a20 2020  kmark(state,.   
+0001e3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e3c0: 2020 2074 6170 5f73 7472 6561 6d5f 6964     tap_stream_id
+0001e3d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e3f0: 2020 2020 2020 2020 2772 6570 6c69 6361          'replica
+0001e400: 7469 6f6e 5f6b 6579 5f76 616c 7565 272c  tion_key_value',
+0001e410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e430: 2020 2020 2020 2072 6570 6c69 6361 7469         replicati
+0001e440: 6f6e 5f6b 6579 5f76 616c 7565 5f62 6f6f  on_key_value_boo
+0001e450: 6b6d 6172 6b29 0a0a 2020 2020 2020 2020  kmark)..        
+0001e460: 7369 6e67 6572 2e77 7269 7465 5f62 6f6f  singer.write_boo
+0001e470: 6b6d 6172 6b28 7374 6174 652c 0a20 2020  kmark(state,.   
+0001e480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e490: 2020 2020 2020 2020 2020 2074 6170 5f73             tap_s
+0001e4a0: 7472 6561 6d5f 6964 2c0a 2020 2020 2020  tream_id,.      
+0001e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e4c0: 2020 2020 2020 2020 2772 6570 6c69 6361          'replica
+0001e4d0: 7469 6f6e 5f6b 6579 5f74 7970 6527 2c0a  tion_key_type',.
+0001e4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e4f0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001e500: 706c 6963 6174 696f 6e5f 6b65 795f 7479  plication_key_ty
+0001e510: 7065 290a 0a0a 6465 6620 7379 6e63 5f63  pe)...def sync_c
+0001e520: 6f6c 6c65 6374 696f 6e28 636f 6c6c 6563  ollection(collec
+0001e530: 7469 6f6e 3a20 436f 6c6c 6563 7469 6f6e  tion: Collection
+0001e540: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001e550: 2020 2020 2020 7374 7265 616d 3a20 4469        stream: Di
+0001e560: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
+0001e570: 2020 2020 2020 2020 7374 6174 653a 204f          state: O
+0001e580: 7074 696f 6e61 6c5b 4469 6374 5d2c 0a20  ptional[Dict],. 
+0001e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e5a0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0001e5b0: 2020 2222 220a 2020 2020 5379 6e63 7320    """.    Syncs 
+0001e5c0: 7468 6520 7374 7265 616d 2072 6563 6f72  the stream recor
+0001e5d0: 6473 2069 6e63 7265 6d65 6e74 616c 6c79  ds incrementally
+0001e5e0: 0a20 2020 2041 7267 733a 0a20 2020 2020  .    Args:.     
+0001e5f0: 2020 2063 6f6c 6c65 6374 696f 6e3a 204d     collection: M
+0001e600: 6f6e 676f 4442 2063 6f6c 6c65 6374 696f  ongoDB collectio
+0001e610: 6e20 696e 7374 616e 6365 0a20 2020 2020  n instance.     
+0001e620: 2020 2073 7472 6561 6d3a 2073 7472 6561     stream: strea
+0001e630: 6d20 6469 6374 696f 6e61 7279 0a20 2020  m dictionary.   
+0001e640: 2020 2020 2073 7461 7465 3a20 7374 6174       state: stat
+0001e650: 6520 6469 6374 696f 6e61 7279 2069 6620  e dictionary if 
+0001e660: 6578 6973 7473 0a20 2020 2022 2222 0a20  exists.    """. 
+0001e670: 2020 204c 4f47 4745 522e 696e 666f 2827     LOGGER.info('
+0001e680: 5374 6172 7469 6e67 2069 6e63 7265 6d65  Starting increme
+0001e690: 6e74 616c 2073 796e 6320 666f 7220 2573  ntal sync for %s
+0001e6a0: 272c 2073 7472 6561 6d5b 2774 6170 5f73  ', stream['tap_s
+0001e6b0: 7472 6561 6d5f 6964 275d 290a 0a20 2020  tream_id'])..   
+0001e6c0: 2023 2062 6566 6f72 6520 7772 6974 696e   # before writin
+0001e6d0: 6720 7468 6520 7461 626c 6520 7665 7273  g the table vers
+0001e6e0: 696f 6e20 746f 2073 7461 7465 2c20 6368  ion to state, ch
+0001e6f0: 6563 6b20 6966 2077 6520 6861 6420 6f6e  eck if we had on
+0001e700: 6520 746f 2062 6567 696e 2077 6974 680a  e to begin with.
+0001e710: 2020 2020 6669 7273 745f 7275 6e20 3d20      first_run = 
+0001e720: 7369 6e67 6572 2e67 6574 5f62 6f6f 6b6d  singer.get_bookm
+0001e730: 6172 6b28 7374 6174 652c 2073 7472 6561  ark(state, strea
+0001e740: 6d5b 2774 6170 5f73 7472 6561 6d5f 6964  m['tap_stream_id
+0001e750: 275d 2c20 2776 6572 7369 6f6e 2729 2069  '], 'version') i
+0001e760: 7320 4e6f 6e65 0a0a 2020 2020 2320 7069  s None..    # pi
+0001e770: 636b 2061 206e 6577 2074 6162 6c65 2076  ck a new table v
+0001e780: 6572 7369 6f6e 2069 6620 6c61 7374 2072  ersion if last r
+0001e790: 756e 2077 6173 6e27 7420 696e 7465 7272  un wasn't interr
+0001e7a0: 7570 7465 640a 2020 2020 6966 2066 6972  upted.    if fir
+0001e7b0: 7374 5f72 756e 3a0a 2020 2020 2020 2020  st_run:.        
+0001e7c0: 7374 7265 616d 5f76 6572 7369 6f6e 203d  stream_version =
+0001e7d0: 2069 6e74 2874 696d 652e 7469 6d65 2829   int(time.time()
+0001e7e0: 202a 2031 3030 3029 0a20 2020 2065 6c73   * 1000).    els
+0001e7f0: 653a 0a20 2020 2020 2020 2073 7472 6561  e:.        strea
+0001e800: 6d5f 7665 7273 696f 6e20 3d20 7369 6e67  m_version = sing
+0001e810: 6572 2e67 6574 5f62 6f6f 6b6d 6172 6b28  er.get_bookmark(
+0001e820: 7374 6174 652c 2073 7472 6561 6d5b 2774  state, stream['t
+0001e830: 6170 5f73 7472 6561 6d5f 6964 275d 2c20  ap_stream_id'], 
+0001e840: 2776 6572 7369 6f6e 2729 0a0a 2020 2020  'version')..    
+0001e850: 7374 6174 6520 3d20 7369 6e67 6572 2e77  state = singer.w
+0001e860: 7269 7465 5f62 6f6f 6b6d 6172 6b28 7374  rite_bookmark(st
+0001e870: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+0001e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e890: 2020 2020 2020 2073 7472 6561 6d5b 2774         stream['t
+0001e8a0: 6170 5f73 7472 6561 6d5f 6964 275d 2c0a  ap_stream_id'],.
+0001e8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e8d0: 2020 2776 6572 7369 6f6e 272c 0a20 2020    'version',.   
+0001e8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e8f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001e900: 7472 6561 6d5f 7665 7273 696f 6e29 0a0a  tream_version)..
+0001e910: 2020 2020 6163 7469 7661 7465 5f76 6572      activate_ver
+0001e920: 7369 6f6e 5f6d 6573 7361 6765 203d 2073  sion_message = s
+0001e930: 696e 6765 722e 4163 7469 7661 7465 5665  inger.ActivateVe
+0001e940: 7273 696f 6e4d 6573 7361 6765 280a 2020  rsionMessage(.  
+0001e950: 2020 2020 2020 7374 7265 616d 3d63 6f6d        stream=com
+0001e960: 6d6f 6e2e 6361 6c63 756c 6174 655f 6465  mon.calculate_de
+0001e970: 7374 696e 6174 696f 6e5f 7374 7265 616d  stination_stream
+0001e980: 5f6e 616d 6528 7374 7265 616d 292c 0a20  _name(stream),. 
+0001e990: 2020 2020 2020 2076 6572 7369 6f6e 3d73         version=s
+0001e9a0: 7472 6561 6d5f 7665 7273 696f 6e0a 2020  tream_version.  
+0001e9b0: 2020 290a 0a20 2020 2023 2046 6f72 2074    )..    # For t
+0001e9c0: 6865 2069 6e69 7469 616c 2072 6570 6c69  he initial repli
+0001e9d0: 6361 7469 6f6e 2c20 656d 6974 2061 6e20  cation, emit an 
+0001e9e0: 4143 5449 5641 5445 5f56 4552 5349 4f4e  ACTIVATE_VERSION
+0001e9f0: 206d 6573 7361 6765 0a20 2020 2023 2061   message.    # a
+0001ea00: 7420 7468 6520 6265 6769 6e6e 696e 6720  t the beginning 
+0001ea10: 736f 2074 6865 2072 6563 6f72 6473 2073  so the records s
+0001ea20: 686f 7720 7570 2072 6967 6874 2061 7761  how up right awa
+0001ea30: 792e 0a20 2020 2069 6620 6669 7273 745f  y..    if first_
+0001ea40: 7275 6e3a 0a20 2020 2020 2020 2073 696e  run:.        sin
+0001ea50: 6765 722e 7772 6974 655f 6d65 7373 6167  ger.write_messag
+0001ea60: 6528 6163 7469 7661 7465 5f76 6572 7369  e(activate_versi
+0001ea70: 6f6e 5f6d 6573 7361 6765 290a 0a20 2020  on_message)..   
+0001ea80: 2023 2067 6574 2072 6570 6c69 6361 7469   # get replicati
+0001ea90: 6f6e 206b 6579 2c20 616e 6420 626f 6f6b  on key, and book
+0001eaa0: 6d61 726b 6564 2076 616c 7565 2f74 7970  marked value/typ
+0001eab0: 650a 2020 2020 7374 7265 616d 5f73 7461  e.    stream_sta
+0001eac0: 7465 203d 2073 7461 7465 2e67 6574 2827  te = state.get('
+0001ead0: 626f 6f6b 6d61 726b 7327 2c20 7b7d 292e  bookmarks', {}).
+0001eae0: 6765 7428 7374 7265 616d 5b27 7461 705f  get(stream['tap_
+0001eaf0: 7374 7265 616d 5f69 6427 5d2c 207b 7d29  stream_id'], {})
+0001eb00: 0a0a 2020 2020 7265 706c 6963 6174 696f  ..    replicatio
+0001eb10: 6e5f 6b65 795f 6e61 6d65 203d 206d 6574  n_key_name = met
+0001eb20: 6164 6174 612e 746f 5f6d 6170 2873 7472  adata.to_map(str
+0001eb30: 6561 6d5b 276d 6574 6164 6174 6127 5d29  eam['metadata'])
+0001eb40: 2e67 6574 2828 2929 2e67 6574 2827 7265  .get(()).get('re
+0001eb50: 706c 6963 6174 696f 6e2d 6b65 7927 290a  plication-key').
+0001eb60: 0a20 2020 2023 2077 7269 7465 2073 7461  .    # write sta
+0001eb70: 7465 206d 6573 7361 6765 0a20 2020 2073  te message.    s
+0001eb80: 696e 6765 722e 7772 6974 655f 6d65 7373  inger.write_mess
+0001eb90: 6167 6528 7369 6e67 6572 2e53 7461 7465  age(singer.State
+0001eba0: 4d65 7373 6167 6528 7661 6c75 653d 636f  Message(value=co
+0001ebb0: 7079 2e64 6565 7063 6f70 7928 7374 6174  py.deepcopy(stat
+0001ebc0: 6529 2929 0a0a 2020 2020 2320 6372 6561  e)))..    # crea
+0001ebd0: 7465 2071 7565 7279 0a20 2020 2066 696e  te query.    fin
+0001ebe0: 645f 6669 6c74 6572 203d 207b 7d0a 0a20  d_filter = {}.. 
+0001ebf0: 2020 2069 6620 7374 7265 616d 5f73 7461     if stream_sta
+0001ec00: 7465 2e67 6574 2827 7265 706c 6963 6174  te.get('replicat
+0001ec10: 696f 6e5f 6b65 795f 7661 6c75 6527 293a  ion_key_value'):
+0001ec20: 0a20 2020 2020 2020 2066 696e 645f 6669  .        find_fi
+0001ec30: 6c74 6572 5b72 6570 6c69 6361 7469 6f6e  lter[replication
+0001ec40: 5f6b 6579 5f6e 616d 655d 203d 207b 7d0a  _key_name] = {}.
+0001ec50: 2020 2020 2020 2020 6669 6e64 5f66 696c          find_fil
+0001ec60: 7465 725b 7265 706c 6963 6174 696f 6e5f  ter[replication_
+0001ec70: 6b65 795f 6e61 6d65 5d5b 2724 6774 6527  key_name]['$gte'
+0001ec80: 5d20 3d20 636f 6d6d 6f6e 2e73 7472 696e  ] = common.strin
+0001ec90: 675f 746f 5f63 6c61 7373 2873 7472 6561  g_to_class(strea
+0001eca0: 6d5f 7374 6174 652e 6765 7428 2772 6570  m_state.get('rep
+0001ecb0: 6c69 6361 7469 6f6e 5f6b 6579 5f76 616c  lication_key_val
+0001ecc0: 7565 2729 2c0a 2020 2020 2020 2020 2020  ue'),.          
+0001ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed10: 2073 7472 6561 6d5f 7374 6174 652e 6765   stream_state.ge
+0001ed20: 7428 2772 6570 6c69 6361 7469 6f6e 5f6b  t('replication_k
+0001ed30: 6579 5f74 7970 6527 2929 0a0a 2020 2020  ey_type'))..    
+0001ed40: 2320 6c6f 6720 7175 6572 790a 2020 2020  # log query.    
+0001ed50: 4c4f 4747 4552 2e69 6e66 6f28 2751 7565  LOGGER.info('Que
+0001ed60: 7279 696e 6720 2573 2077 6974 683a 2025  rying %s with: %
+0001ed70: 7327 2c20 7374 7265 616d 5b27 7461 705f  s', stream['tap_
+0001ed80: 7374 7265 616d 5f69 6427 5d2c 2064 6963  stream_id'], dic
+0001ed90: 7428 6669 6e64 3d66 696e 645f 6669 6c74  t(find=find_filt
+0001eda0: 6572 2929 0a0a 2020 2020 7769 7468 2063  er))..    with c
+0001edb0: 6f6c 6c65 6374 696f 6e2e 6669 6e64 2866  ollection.find(f
+0001edc0: 696e 645f 6669 6c74 6572 2c0a 2020 2020  ind_filter,.    
+0001edd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ede0: 2020 2020 2073 6f72 743d 5b28 7265 706c       sort=[(repl
+0001edf0: 6963 6174 696f 6e5f 6b65 795f 6e61 6d65  ication_key_name
+0001ee00: 2c20 7079 6d6f 6e67 6f2e 4153 4345 4e44  , pymongo.ASCEND
+0001ee10: 494e 4729 5d29 2061 7320 6375 7273 6f72  ING)]) as cursor
+0001ee20: 3a0a 2020 2020 2020 2020 726f 7773 5f73  :.        rows_s
+0001ee30: 6176 6564 203d 2030 0a20 2020 2020 2020  aved = 0.       
+0001ee40: 2073 7461 7274 5f74 696d 6520 3d20 7469   start_time = ti
+0001ee50: 6d65 2e74 696d 6528 290a 0a20 2020 2020  me.time()..     
+0001ee60: 2020 2066 6f72 2072 6f77 2069 6e20 6375     for row in cu
+0001ee70: 7273 6f72 3a0a 0a20 2020 2020 2020 2020  rsor:..         
+0001ee80: 2020 2073 696e 6765 722e 7772 6974 655f     singer.write_
+0001ee90: 6d65 7373 6167 6528 636f 6d6d 6f6e 2e72  message(common.r
+0001eea0: 6f77 5f74 6f5f 7369 6e67 6572 5f72 6563  ow_to_singer_rec
+0001eeb0: 6f72 6428 7374 7265 616d 3d73 7472 6561  ord(stream=strea
+0001eec0: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
+0001eed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef00: 726f 773d 726f 772c 0a20 2020 2020 2020  row=row,.       
+0001ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef40: 2020 2020 2020 7469 6d65 5f65 7874 7261        time_extra
+0001ef50: 6374 6564 3d75 7469 6c73 2e6e 6f77 2829  cted=utils.now()
+0001ef60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef90: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0001efa0: 696d 655f 6465 6c65 7465 643d 4e6f 6e65  ime_deleted=None
+0001efb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001efc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001efe0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0001eff0: 6572 7369 6f6e 3d73 7472 6561 6d5f 7665  ersion=stream_ve
+0001f000: 7273 696f 6e29 290a 2020 2020 2020 2020  rsion)).        
+0001f010: 2020 2020 726f 7773 5f73 6176 6564 202b      rows_saved +
+0001f020: 3d20 310a 0a20 2020 2020 2020 2020 2020  = 1..           
+0001f030: 2075 7064 6174 655f 626f 6f6b 6d61 726b   update_bookmark
+0001f040: 2872 6f77 2c20 7374 6174 652c 2073 7472  (row, state, str
+0001f050: 6561 6d5b 2774 6170 5f73 7472 6561 6d5f  eam['tap_stream_
+0001f060: 6964 275d 2c20 7265 706c 6963 6174 696f  id'], replicatio
+0001f070: 6e5f 6b65 795f 6e61 6d65 290a 0a20 2020  n_key_name)..   
+0001f080: 2020 2020 2020 2020 2069 6620 726f 7773           if rows
+0001f090: 5f73 6176 6564 2025 2063 6f6d 6d6f 6e2e  _saved % common.
+0001f0a0: 5550 4441 5445 5f42 4f4f 4b4d 4152 4b5f  UPDATE_BOOKMARK_
+0001f0b0: 5045 5249 4f44 203d 3d20 303a 0a20 2020  PERIOD == 0:.   
+0001f0c0: 2020 2020 2020 2020 2020 2020 2073 696e               sin
+0001f0d0: 6765 722e 7772 6974 655f 6d65 7373 6167  ger.write_messag
+0001f0e0: 6528 7369 6e67 6572 2e53 7461 7465 4d65  e(singer.StateMe
+0001f0f0: 7373 6167 6528 7661 6c75 653d 636f 7079  ssage(value=copy
+0001f100: 2e64 6565 7063 6f70 7928 7374 6174 6529  .deepcopy(state)
+0001f110: 2929 0a0a 2020 2020 2020 2020 636f 6d6d  ))..        comm
+0001f120: 6f6e 2e43 4f55 4e54 535b 7374 7265 616d  on.COUNTS[stream
+0001f130: 5b27 7461 705f 7374 7265 616d 5f69 6427  ['tap_stream_id'
+0001f140: 5d5d 202b 3d20 726f 7773 5f73 6176 6564  ]] += rows_saved
+0001f150: 0a20 2020 2020 2020 2063 6f6d 6d6f 6e2e  .        common.
+0001f160: 5449 4d45 535b 7374 7265 616d 5b27 7461  TIMES[stream['ta
+0001f170: 705f 7374 7265 616d 5f69 6427 5d5d 202b  p_stream_id']] +
+0001f180: 3d20 7469 6d65 2e74 696d 6528 2920 2d20  = time.time() - 
+0001f190: 7374 6172 745f 7469 6d65 0a0a 2020 2020  start_time..    
+0001f1a0: 7369 6e67 6572 2e77 7269 7465 5f6d 6573  singer.write_mes
+0001f1b0: 7361 6765 2861 6374 6976 6174 655f 7665  sage(activate_ve
+0001f1c0: 7273 696f 6e5f 6d65 7373 6167 6529 0a0a  rsion_message)..
+0001f1d0: 2020 2020 4c4f 4747 4552 2e69 6e66 6f28      LOGGER.info(
+0001f1e0: 2753 796e 6364 2025 7320 7265 636f 7264  'Syncd %s record
+0001f1f0: 7320 666f 7220 2573 272c 2072 6f77 735f  s for %s', rows_
+0001f200: 7361 7665 642c 2073 7472 6561 6d5b 2774  saved, stream['t
+0001f210: 6170 5f73 7472 6561 6d5f 6964 275d 290a  ap_stream_id']).
+0001f220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0001f270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0001f280: 3030 3131 3637 3000 3030 3030 3030 3030  0011670.00000000
-0001f290: 3030 3000 3032 3136 3036 0020 3000 0000  000.021606. 0...
+0001f260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f300: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-0001f310: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-0001f320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0001f300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f400: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-0001f410: 3a20 322e 310a 4e61 6d65 3a20 647a 2d6d  : 2.1.Name: dz-m
-0001f420: 6f6e 676f 6462 0a56 6572 7369 6f6e 3a20  ongodb.Version: 
-0001f430: 312e 342e 300a 5375 6d6d 6172 793a 2053  1.4.0.Summary: S
-0001f440: 696e 6765 722e 696f 2074 6170 2066 6f72  inger.io tap for
-0001f450: 2065 7874 7261 6374 696e 6720 6461 7461   extracting data
-0001f460: 2066 726f 6d20 4d6f 6e67 6f44 4220 2d20   from MongoDB - 
-0001f470: 4461 7461 7a69 7020 636f 6d70 6174 6962  Datazip compatib
-0001f480: 6c65 0a48 6f6d 652d 7061 6765 3a20 6874  le.Home-page: ht
-0001f490: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-0001f4a0: 2f64 6174 617a 6970 2f64 7a2d 6d6f 6e67  /datazip/dz-mong
-0001f4b0: 6f64 620a 4175 7468 6f72 3a20 5769 7365  odb.Author: Wise
-0001f4c0: 0a4c 6963 656e 7365 3a20 554e 4b4e 4f57  .License: UNKNOW
-0001f4d0: 4e0a 506c 6174 666f 726d 3a20 554e 4b4e  N.Platform: UNKN
-0001f4e0: 4f57 4e0a 436c 6173 7369 6669 6572 3a20  OWN.Classifier: 
-0001f4f0: 5072 6f67 7261 6d6d 696e 6720 4c61 6e67  Programming Lang
-0001f500: 7561 6765 203a 3a20 5079 7468 6f6e 203a  uage :: Python :
-0001f510: 3a20 3320 3a3a 204f 6e6c 790a 436c 6173  : 3 :: Only.Clas
-0001f520: 7369 6669 6572 3a20 5072 6f67 7261 6d6d  sifier: Programm
-0001f530: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
-0001f540: 5079 7468 6f6e 203a 3a20 332e 360a 436c  Python :: 3.6.Cl
-0001f550: 6173 7369 6669 6572 3a20 5072 6f67 7261  assifier: Progra
-0001f560: 6d6d 696e 6720 4c61 6e67 7561 6765 203a  mming Language :
-0001f570: 3a20 5079 7468 6f6e 203a 3a20 332e 370a  : Python :: 3.7.
-0001f580: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
-0001f590: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
-0001f5a0: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
-0001f5b0: 380a 4465 7363 7269 7074 696f 6e2d 436f  8.Description-Co
-0001f5c0: 6e74 656e 742d 5479 7065 3a20 7465 7874  ntent-Type: text
-0001f5d0: 2f6d 6172 6b64 6f77 6e0a 5072 6f76 6964  /markdown.Provid
-0001f5e0: 6573 2d45 7874 7261 3a20 6465 760a 5072  es-Extra: dev.Pr
-0001f5f0: 6f76 6964 6573 2d45 7874 7261 3a20 7465  ovides-Extra: te
-0001f600: 7374 0a4c 6963 656e 7365 2d46 696c 653a  st.License-File:
-0001f610: 204c 4943 454e 5345 0a0a 2320 647a 2d6d   LICENSE..# dz-m
-0001f620: 6f6e 676f 6462 0a0a 5468 6973 2069 7320  ongodb..This is 
-0001f630: 6120 5b53 696e 6765 725d 2868 7474 7073  a [Singer](https
-0001f640: 3a2f 2f73 696e 6765 722e 696f 2920 7461  ://singer.io) ta
-0001f650: 7020 7468 6174 2070 726f 6475 6365 7320  p that produces 
-0001f660: 4a53 4f4e 2d66 6f72 6d61 7474 6564 2064  JSON-formatted d
-0001f670: 6174 6120 666f 6c6c 6f77 696e 6720 7468  ata following th
-0001f680: 6520 5b53 696e 6765 7220 7370 6563 5d28  e [Singer spec](
-0001f690: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-0001f6a0: 6f6d 2f73 696e 6765 722d 696f 2f67 6574  om/singer-io/get
-0001f6b0: 7469 6e67 2d73 7461 7274 6564 2f62 6c6f  ting-started/blo
-0001f6c0: 622f 6d61 7374 6572 2f53 5045 432e 6d64  b/master/SPEC.md
-0001f6d0: 2920 6672 6f6d 2061 204d 6f6e 676f 4442  ) from a MongoDB
-0001f6e0: 2073 6f75 7263 652e 0a0a 2323 2053 6574   source...## Set
-0001f6f0: 2075 7020 6c6f 6361 6c20 6465 7620 656e   up local dev en
-0001f700: 7669 726f 6e6d 656e 743a 0a0a 6060 6073  vironment:..```s
-0001f710: 6865 6c6c 2073 6372 6970 740a 6d61 6b65  hell script.make
-0001f720: 2073 6574 7570 0a60 6060 0a0a 2323 2041   setup.```..## A
-0001f730: 6374 6976 6174 6520 7669 7274 7561 6c20  ctivate virtual 
-0001f740: 656e 7669 726f 6e6d 656e 740a 0a60 6060  environment..```
-0001f750: 7368 656c 6c20 7363 7269 7074 0a2e 2076  shell script.. v
-0001f760: 656e 762f 6269 6e2f 6163 7469 7661 7465  env/bin/activate
-0001f770: 0a60 6060 0a0a 2323 2053 6574 2075 7020  .```..## Set up 
-0001f780: 436f 6e66 6967 2066 696c 650a 0a43 7265  Config file..Cre
-0001f790: 6174 6520 6a73 6f6e 2066 696c 6520 6361  ate json file ca
-0001f7a0: 6c6c 6564 2060 636f 6e66 6967 2e6a 736f  lled `config.jso
-0001f7b0: 6e60 2c20 7769 7468 2074 6865 2066 6f6c  n`, with the fol
-0001f7c0: 6c6f 7769 6e67 2063 6f6e 7465 6e74 733a  lowing contents:
-0001f7d0: 0a60 6060 6a73 6f6e 0a7b 0a20 2022 7061  .```json.{.  "pa
-0001f7e0: 7373 776f 7264 223a 2022 3c70 6173 7377  ssword": "<passw
-0001f7f0: 6f72 643e 222c 0a20 2022 7573 6572 223a  ord>",.  "user":
-0001f800: 2022 3c75 7365 726e 616d 653e 222c 0a20   "<username>",. 
-0001f810: 2022 686f 7374 223a 2022 3c68 6f73 7420   "host": "<host 
-0001f820: 6970 2061 6464 7265 7373 3e22 2c0a 2020  ip address>",.  
-0001f830: 2261 7574 685f 6461 7461 6261 7365 223a  "auth_database":
-0001f840: 2022 3c64 6174 6162 6173 6520 6e61 6d65   "<database name
-0001f850: 2074 6f20 6175 7468 656e 7469 6361 7465   to authenticate
-0001f860: 206f 6e3e 222c 0a20 2022 6461 7461 6261   on>",.  "databa
-0001f870: 7365 223a 2022 3c64 6174 6162 6173 6520  se": "<database 
-0001f880: 6e61 6d65 2074 6f20 7379 6e63 2066 726f  name to sync fro
-0001f890: 6d3e 220a 7d0a 6060 600a 5468 6520 666f  m>".}.```.The fo
-0001f8a0: 6c6c 6f77 696e 6720 7061 7261 6d65 7465  llowing paramete
-0001f8b0: 7273 2061 7265 206f 7074 696f 6e61 6c20  rs are optional 
-0001f8c0: 666f 7220 796f 7572 2063 6f6e 6669 6720  for your config 
-0001f8d0: 6669 6c65 3a0a 0a7c 204e 616d 6520 7c20  file:..| Name | 
-0001f8e0: 5479 7065 207c 2044 6566 6175 6c74 2076  Type | Default v
-0001f8f0: 616c 7565 7c20 4465 7363 7269 7074 696f  alue| Descriptio
-0001f900: 6e20 7c0a 7c20 2d2d 2d2d 2d7c 2d2d 2d2d  n |.| -----|----
-0001f910: 2d2d 7c2d 2d2d 2d2d 2d2d 2d7c 2d2d 2d2d  --|--------|----
-0001f920: 2d2d 2d2d 2d2d 2d2d 207c 0a7c 2060 7372  -------- |.| `sr
-0001f930: 7660 207c 2042 6f6f 6c65 616e 207c 2066  v` | Boolean | f
-0001f940: 616c 7365 207c 2075 7365 7320 6120 606d  alse | uses a `m
-0001f950: 6f6e 676f 6462 2b73 7276 6020 7072 6f74  ongodb+srv` prot
-0001f960: 6f63 6f6c 2074 6f20 636f 6e6e 6563 742e  ocol to connect.
-0001f970: 2044 6973 6162 6c65 7320 7468 6520 7573   Disables the us
-0001f980: 6167 6520 6f66 2060 706f 7274 6020 6172  age of `port` ar
-0001f990: 6775 6d65 6e74 2069 6620 7365 7420 746f  gument if set to
-0001f9a0: 2060 5472 7565 6020 7c0a 7c20 6070 6f72   `True` |.| `por
-0001f9b0: 7460 207c 2049 6e74 6567 6572 207c 2066  t` | Integer | f
-0001f9c0: 616c 7365 207c 2043 6f6e 6e65 6374 696f  alse | Connectio
-0001f9d0: 6e20 706f 7274 2e20 5265 7175 6972 6564  n port. Required
-0001f9e0: 2069 6620 6120 6e6f 6e2d 7372 7620 636f   if a non-srv co
-0001f9f0: 6e6e 6563 7469 6f6e 2069 7320 6265 696e  nnection is bein
-0001fa00: 6720 7573 6564 2e20 207c 0a7c 2060 7265  g used.  |.| `re
-0001fa10: 706c 6963 615f 7365 7460 207c 2073 7472  plica_set` | str
-0001fa20: 696e 6720 7c20 6e75 6c6c 207c 206e 616d  ing | null | nam
-0001fa30: 6520 6f66 2072 6570 6c69 6361 2073 6574  e of replica set
-0001fa40: 207c 0a7c 2060 7373 6c60 207c 2042 6f6f   |.| `ssl` | Boo
-0001fa50: 6c65 616e 207c 2066 616c 7365 207c 2063  lean | false | c
-0001fa60: 616e 2062 6520 7365 7420 746f 2074 7275  an be set to tru
-0001fa70: 6520 746f 2063 6f6e 6e65 6374 2075 7369  e to connect usi
-0001fa80: 6e67 2073 736c 207c 0a7c 2060 7665 7269  ng ssl |.| `veri
-0001fa90: 6679 5f6d 6f64 6560 207c 2042 6f6f 6c65  fy_mode` | Boole
-0001faa0: 616e 207c 2074 7275 6520 7c20 4465 6661  an | true | Defa
-0001fab0: 756c 7420 5353 4c20 7665 7269 6679 206d  ult SSL verify m
-0001fac0: 6f64 6520 7c0a 7c20 6069 6e63 6c75 6465  ode |.| `include
-0001fad0: 5f73 6368 656d 6173 5f69 6e5f 6465 7374  _schemas_in_dest
-0001fae0: 696e 6174 696f 6e5f 7374 7265 616d 5f6e  ination_stream_n
-0001faf0: 616d 6560 207c 2042 6f6f 6c65 616e 207c  ame` | Boolean |
-0001fb00: 6661 6c73 6520 207c 2066 6f72 6365 7320  false  | forces 
-0001fb10: 7468 6520 7374 7265 616d 206e 616d 6573  the stream names
-0001fb20: 2074 6f20 7461 6b65 2074 6865 2066 6f72   to take the for
-0001fb30: 6d20 603c 6461 7461 6261 7365 5f6e 616d  m `<database_nam
-0001fb40: 653e 2d3c 636f 6c6c 6563 7469 6f6e 5f6e  e>-<collection_n
-0001fb50: 616d 653e 6020 696e 7374 6561 6420 6f66  ame>` instead of
-0001fb60: 2060 3c63 6f6c 6c65 6374 696f 6e5f 6e61   `<collection_na
-0001fb70: 6d65 3e60 7c0a 7c20 6075 7064 6174 655f  me>`|.| `update_
-0001fb80: 6275 6666 6572 5f73 697a 6560 207c 2069  buffer_size` | i
-0001fb90: 6e74 207c 2031 207c 205b 4c4f 475f 4241  nt | 1 | [LOG_BA
-0001fba0: 5345 445d 2054 6865 2073 697a 6520 6f66  SED] The size of
-0001fbb0: 2074 6865 2062 7566 6665 7220 7468 6174   the buffer that
-0001fbc0: 2068 6f6c 6473 2064 6574 6563 7465 6420   holds detected 
-0001fbd0: 7570 6461 7465 206f 7065 7261 7469 6f6e  update operation
-0001fbe0: 7320 696e 206d 656d 6f72 792c 2074 6865  s in memory, the
-0001fbf0: 2062 7566 6665 7220 6973 2066 6c75 7368   buffer is flush
-0001fc00: 6564 206f 6e63 6520 7468 6520 7369 7a65  ed once the size
-0001fc10: 2069 7320 7265 6163 6865 6420 7c0a 7c20   is reached |.| 
-0001fc20: 6061 7761 6974 5f74 696d 655f 6d73 6020  `await_time_ms` 
-0001fc30: 7c20 696e 7420 7c20 3130 3030 207c 205b  | int | 1000 | [
-0001fc40: 4c4f 475f 4241 5345 445d 2054 6865 206d  LOG_BASED] The m
-0001fc50: 6178 696d 756d 2061 6d6f 756e 7420 6f66  aximum amount of
-0001fc60: 2074 696d 6520 696e 206d 696c 6c69 7365   time in millise
-0001fc70: 636f 6e64 7320 7468 6520 6c6f 6765 5f62  conds the loge_b
-0001fc80: 6173 6520 6d65 7468 6f64 2077 6169 7473  ase method waits
-0001fc90: 2066 6f72 206e 6577 2064 6174 6120 6368   for new data ch
-0001fca0: 616e 6765 7320 6265 666f 7265 2065 7869  anges before exi
-0001fcb0: 7469 6e67 2e20 7c0a 7c20 6066 756c 6c5f  ting. |.| `full_
-0001fcc0: 6c6f 6164 5f6f 6e5f 656d 7074 795f 7374  load_on_empty_st
-0001fcd0: 6174 6560 207c 2062 6f6f 6c20 7c20 6661  ate` | bool | fa
-0001fce0: 6c73 6520 7c20 5b4c 4f47 5f42 4153 4544  lse | [LOG_BASED
-0001fcf0: 5d20 4120 666c 6167 2077 6869 6368 2066  ] A flag which f
-0001fd00: 6f72 6365 7320 6675 6c6c 206c 6f61 6420  orces full load 
-0001fd10: 7768 656e 206e 6f20 7072 6576 696f 7573  when no previous
-0001fd20: 2074 6f6b 656e 2069 7320 666f 756e 6420   token is found 
-0001fd30: 696e 2073 7461 7465 2e7c 0a0a 416c 6c20  in state.|..All 
-0001fd40: 6f66 2074 6865 2061 626f 7665 2061 7474  of the above att
-0001fd50: 7269 6275 7465 7320 6172 6520 7265 7175  ributes are requ
-0001fd60: 6972 6564 2062 7920 7468 6520 7461 7020  ired by the tap 
-0001fd70: 746f 2063 6f6e 6e65 6374 2074 6f20 796f  to connect to yo
-0001fd80: 7572 206d 6f6e 676f 2069 6e73 7461 6e63  ur mongo instanc
-0001fd90: 652e 0a68 6572 6520 6973 2061 205b 7361  e..here is a [sa
-0001fda0: 6d70 6c65 2063 6f6e 6669 6775 7261 7469  mple configurati
-0001fdb0: 6f6e 2066 696c 655d 282e 2f73 616d 706c  on file](./sampl
-0001fdc0: 655f 636f 6e66 6967 2e6a 736f 6e29 2e0a  e_config.json)..
-0001fdd0: 0a23 2320 5275 6e20 696e 2064 6973 636f  .## Run in disco
-0001fde0: 7665 7279 206d 6f64 650a 5275 6e20 7468  very mode.Run th
-0001fdf0: 6520 666f 6c6c 6f77 696e 6720 636f 6d6d  e following comm
-0001fe00: 616e 6420 616e 6420 7265 6469 7265 6374  and and redirect
-0001fe10: 2074 6865 206f 7574 7075 7420 696e 746f   the output into
-0001fe20: 2074 6865 2063 6174 616c 6f67 2066 696c   the catalog fil
-0001fe30: 650a 6060 6073 6865 6c6c 2073 6372 6970  e.```shell scrip
-0001fe40: 740a 647a 2d6d 6f6e 676f 6462 202d 2d63  t.dz-mongodb --c
-0001fe50: 6f6e 6669 6720 7e2f 636f 6e66 6967 2e6a  onfig ~/config.j
-0001fe60: 736f 6e20 2d2d 6469 7363 6f76 6572 203e  son --discover >
-0001fe70: 207e 2f63 6174 616c 6f67 2e6a 736f 6e0a   ~/catalog.json.
-0001fe80: 6060 600a 0a59 6f75 7220 6361 7461 6c6f  ```..Your catalo
-0001fe90: 6720 6669 6c65 2073 686f 756c 6420 6e6f  g file should no
-0001fea0: 7720 6c6f 6f6b 206c 696b 6520 7468 6973  w look like this
-0001feb0: 3a0a 6060 606a 736f 6e0a 7b0a 2020 2273  :.```json.{.  "s
-0001fec0: 7472 6561 6d73 223a 205b 0a20 2020 207b  treams": [.    {
-0001fed0: 0a20 2020 2020 2022 7461 626c 655f 6e61  .      "table_na
-0001fee0: 6d65 223a 2022 3c74 6162 6c65 206e 616d  me": "<table nam
-0001fef0: 653e 222c 0a20 2020 2020 2022 7461 705f  e>",.      "tap_
-0001ff00: 7374 7265 616d 5f69 6422 3a20 223c 7461  stream_id": "<ta
-0001ff10: 705f 7374 7265 616d 5f69 643e 222c 0a20  p_stream_id>",. 
-0001ff20: 2020 2020 2022 6d65 7461 6461 7461 223a       "metadata":
-0001ff30: 205b 0a20 2020 2020 2020 207b 0a20 2020   [.        {.   
-0001ff40: 2020 2020 2020 2022 6272 6561 6463 7275         "breadcru
-0001ff50: 6d62 223a 205b 5d2c 0a20 2020 2020 2020  mb": [],.       
-0001ff60: 2020 2022 6d65 7461 6461 7461 223a 207b     "metadata": {
-0001ff70: 0a20 2020 2020 2020 2020 2020 2022 726f  .            "ro
-0001ff80: 772d 636f 756e 7422 3a3c 696e 743e 2c0a  w-count":<int>,.
-0001ff90: 2020 2020 2020 2020 2020 2020 2269 732d              "is-
-0001ffa0: 7669 6577 223a 203c 626f 6f6c 3e2c 0a20  view": <bool>,. 
-0001ffb0: 2020 2020 2020 2020 2020 2022 6461 7461             "data
-0001ffc0: 6261 7365 2d6e 616d 6522 3a20 223c 6461  base-name": "<da
-0001ffd0: 7461 6261 7365 206e 616d 653e 222c 0a20  tabase name>",. 
-0001ffe0: 2020 2020 2020 2020 2020 2022 7461 626c             "tabl
-0001fff0: 652d 6b65 792d 7072 6f70 6572 7469 6573  e-key-properties
-00020000: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
-00020010: 2020 2022 5f69 6422 0a20 2020 2020 2020     "_id".       
-00020020: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00020030: 2020 2020 2276 616c 6964 2d72 6570 6c69      "valid-repli
-00020040: 6361 7469 6f6e 2d6b 6579 7322 3a20 5b0a  cation-keys": [.
-00020050: 2020 2020 2020 2020 2020 2020 2020 225f                "_
-00020060: 6964 220a 2020 2020 2020 2020 2020 2020  id".            
-00020070: 5d0a 2020 2020 2020 2020 2020 7d0a 2020  ].          }.  
-00020080: 2020 2020 2020 7d0a 2020 2020 2020 5d2c        }.      ],
-00020090: 0a20 2020 2020 2022 7374 7265 616d 223a  .      "stream":
-000200a0: 2022 3c73 7472 6561 6d20 6e61 6d65 3e22   "<stream name>"
-000200b0: 2c0a 2020 2020 2020 2273 6368 656d 6122  ,.      "schema"
-000200c0: 3a20 7b0a 2020 2020 2020 2020 2274 7970  : {.        "typ
-000200d0: 6522 3a20 226f 626a 6563 7422 0a20 2020  e": "object".   
-000200e0: 2020 207d 0a20 2020 207d 0a20 205d 0a7d     }.    }.  ].}
-000200f0: 0a60 6060 0a0a 2323 2045 6469 7420 4361  .```..## Edit Ca
-00020100: 7461 6c6f 6720 6669 6c65 0a23 2323 2055  talog file.### U
-00020110: 7369 6e67 2076 616c 6964 206a 736f 6e2c  sing valid json,
-00020120: 2065 6469 7420 7468 6520 636f 6e66 6967   edit the config
-00020130: 2e6a 736f 6e20 6669 6c65 0a54 6f20 7365  .json file.To se
-00020140: 6c65 6374 2061 2073 7472 6561 6d2c 2065  lect a stream, e
-00020150: 6e74 6572 2074 6865 2066 6f6c 6c6f 7769  nter the followi
-00020160: 6e67 2074 6f20 7468 6520 7374 7265 616d  ng to the stream
-00020170: 2773 206d 6574 6164 6174 613a 0a60 6060  's metadata:.```
-00020180: 6a73 6f6e 0a22 7365 6c65 6374 6564 223a  json."selected":
-00020190: 2074 7275 652c 0a22 7265 706c 6963 6174   true,."replicat
-000201a0: 696f 6e2d 6d65 7468 6f64 223a 2022 3c72  ion-method": "<r
-000201b0: 6570 6c69 6361 7469 6f6e 206d 6574 686f  eplication metho
-000201c0: 643e 222c 0a60 6060 0a0a 603c 7265 706c  d>",.```..`<repl
-000201d0: 6963 6174 696f 6e2d 6d65 7468 6f64 3e60  ication-method>`
-000201e0: 206d 7573 7420 6265 2065 6974 6865 7220   must be either 
-000201f0: 6046 554c 4c5f 5441 424c 4560 2c20 6049  `FULL_TABLE`, `I
-00020200: 4e43 5245 4d45 4e54 414c 6020 6f72 2060  NCREMENTAL` or `
-00020210: 4c4f 475f 4241 5345 4460 2c20 6966 2069  LOG_BASED`, if i
-00020220: 7427 7320 6049 4e43 5245 4d45 4e54 414c  t's `INCREMENTAL
-00020230: 602c 206d 616b 6520 7375 7265 2074 6f20  `, make sure to 
-00020240: 6164 6420 6120 6022 7265 706c 6963 6174  add a `"replicat
-00020250: 696f 6e2d 6b65 7922 602e 0a0a 0a46 6f72  ion-key"`....For
-00020260: 2065 7861 6d70 6c65 2c20 6966 2079 6f75   example, if you
-00020270: 2077 6572 6520 746f 2065 6469 7420 7468   were to edit th
-00020280: 6520 6578 616d 706c 6520 7374 7265 616d  e example stream
-00020290: 2074 6f20 7365 6c65 6374 2074 6865 2073   to select the s
-000202a0: 7472 6561 6d20 6173 2077 656c 6c20 6173  tream as well as
-000202b0: 2061 6464 2061 2070 726f 6a65 6374 696f   add a projectio
-000202c0: 6e2c 2063 6f6e 6669 672e 6a73 6f6e 2073  n, config.json s
-000202d0: 686f 756c 6420 6c6f 6f6b 2074 6869 733a  hould look this:
-000202e0: 0a60 6060 6a73 6f6e 0a7b 0a20 2022 7374  .```json.{.  "st
-000202f0: 7265 616d 7322 3a20 5b0a 2020 2020 7b0a  reams": [.    {.
-00020300: 2020 2020 2020 2274 6162 6c65 5f6e 616d        "table_nam
-00020310: 6522 3a20 223c 7461 626c 6520 6e61 6d65  e": "<table name
-00020320: 3e22 2c0a 2020 2020 2020 2274 6170 5f73  >",.      "tap_s
-00020330: 7472 6561 6d5f 6964 223a 2022 3c74 6170  tream_id": "<tap
-00020340: 5f73 7472 6561 6d5f 6964 3e22 2c0a 2020  _stream_id>",.  
-00020350: 2020 2020 226d 6574 6164 6174 6122 3a20      "metadata": 
-00020360: 5b0a 2020 2020 2020 2020 7b0a 2020 2020  [.        {.    
-00020370: 2020 2020 2020 2262 7265 6164 6372 756d        "breadcrum
-00020380: 6222 3a20 5b5d 2c0a 2020 2020 2020 2020  b": [],.        
-00020390: 2020 226d 6574 6164 6174 6122 3a20 7b0a    "metadata": {.
-000203a0: 2020 2020 2020 2020 2020 2020 2272 6f77              "row
-000203b0: 2d63 6f75 6e74 223a 203c 696e 743e 2c0a  -count": <int>,.
-000203c0: 2020 2020 2020 2020 2020 2020 2269 732d              "is-
-000203d0: 7669 6577 223a 203c 626f 6f6c 3e2c 0a20  view": <bool>,. 
-000203e0: 2020 2020 2020 2020 2020 2022 6461 7461             "data
-000203f0: 6261 7365 2d6e 616d 6522 3a20 223c 6461  base-name": "<da
-00020400: 7461 6261 7365 206e 616d 653e 222c 0a20  tabase name>",. 
-00020410: 2020 2020 2020 2020 2020 2022 7461 626c             "tabl
-00020420: 652d 6b65 792d 7072 6f70 6572 7469 6573  e-key-properties
-00020430: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
-00020440: 2020 2022 5f69 6422 0a20 2020 2020 2020     "_id".       
-00020450: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00020460: 2020 2020 2276 616c 6964 2d72 6570 6c69      "valid-repli
-00020470: 6361 7469 6f6e 2d6b 6579 7322 3a20 5b0a  cation-keys": [.
-00020480: 2020 2020 2020 2020 2020 2020 2020 225f                "_
-00020490: 6964 220a 2020 2020 2020 2020 2020 2020  id".            
-000204a0: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-000204b0: 7365 6c65 6374 6564 223a 2074 7275 652c  selected": true,
-000204c0: 0a20 2020 2020 2020 2020 2020 2022 7265  .            "re
-000204d0: 706c 6963 6174 696f 6e2d 6d65 7468 6f64  plication-method
-000204e0: 223a 2022 3c72 6570 6c69 6361 7469 6f6e  ": "<replication
-000204f0: 206d 6574 686f 643e 220a 2020 2020 2020   method>".      
-00020500: 2020 2020 7d0a 2020 2020 2020 2020 7d0a      }.        }.
-00020510: 2020 2020 2020 5d2c 0a20 2020 2020 2022        ],.      "
-00020520: 7374 7265 616d 223a 2022 3c73 7472 6561  stream": "<strea
-00020530: 6d20 6e61 6d65 3e22 2c0a 2020 2020 2020  m name>",.      
-00020540: 2273 6368 656d 6122 3a20 7b0a 2020 2020  "schema": {.    
-00020550: 2020 2020 2274 7970 6522 3a20 226f 626a      "type": "obj
-00020560: 6563 7422 0a20 2020 2020 207d 0a20 2020  ect".      }.   
-00020570: 207d 0a20 205d 0a7d 0a0a 6060 600a 2323   }.  ].}..```.##
-00020580: 2052 756e 2069 6e20 7379 6e63 206d 6f64   Run in sync mod
-00020590: 653a 0a60 6060 7368 656c 6c20 7363 7269  e:.```shell scri
-000205a0: 7074 0a64 7a2d 6d6f 6e67 6f64 6220 2d2d  pt.dz-mongodb --
-000205b0: 636f 6e66 6967 207e 2f63 6f6e 6669 672e  config ~/config.
-000205c0: 6a73 6f6e 202d 2d63 6174 616c 6f67 207e  json --catalog ~
-000205d0: 2f63 6174 616c 6f67 2e6a 736f 6e0a 6060  /catalog.json.``
-000205e0: 600a 0a54 6865 2074 6170 2077 696c 6c20  `..The tap will 
-000205f0: 7772 6974 6520 626f 6f6b 6d61 726b 7320  write bookmarks 
-00020600: 746f 2073 7464 6f75 7420 7768 6963 6820  to stdout which 
-00020610: 6361 6e20 6265 2063 6170 7475 7265 6420  can be captured 
-00020620: 616e 6420 7061 7373 6564 2061 7320 616e  and passed as an
-00020630: 206f 7074 696f 6e61 6c20 602d 2d73 7461   optional `--sta
-00020640: 7465 2073 7461 7465 2e6a 736f 6e60 2070  te state.json` p
-00020650: 6172 616d 6574 6572 2074 6f20 7468 6520  arameter to the 
-00020660: 7461 7020 666f 7220 7468 6520 6e65 7874  tap for the next
-00020670: 2073 796e 632e 0a0a 2323 204c 6f67 6769   sync...## Loggi
-00020680: 6e67 2063 6f6e 6669 6775 7261 7469 6f6e  ng configuration
-00020690: 0a54 6865 2074 6170 2075 7365 7320 6120  .The tap uses a 
-000206a0: 7072 6564 6566 696e 6564 206c 6f67 6769  predefined loggi
-000206b0: 6e67 2063 6f6e 6669 6720 6966 206e 6f6e  ng config if non
-000206c0: 6520 6973 2070 726f 7669 6465 642c 2068  e is provided, h
-000206d0: 6f77 6576 6572 2c20 796f 7520 6361 6e20  owever, you can 
-000206e0: 7365 7420 796f 7572 206f 776e 2063 6f6e  set your own con
-000206f0: 6669 6720 6279 2073 6574 7469 6e67 2074  fig by setting t
-00020700: 6865 2065 6e76 6972 6f6e 6d65 6e74 2076  he environment v
-00020710: 6172 6961 626c 6520 604c 4f47 4749 4e47  ariable `LOGGING
-00020720: 5f43 4f4e 4649 475f 4649 4c45 6020 6173  _CONFIG_FILE` as
-00020730: 2074 6865 2070 6174 6820 746f 2074 6865   the path to the
-00020740: 206c 6f67 6769 6e67 2063 6f6e 6669 672e   logging config.
-00020750: 0a41 2073 616d 706c 6520 636f 6e66 6967  .A sample config
-00020760: 2069 7320 6176 6169 6c61 626c 6520 5b68   is available [h
-00020770: 6572 655d 282e 2f73 616d 706c 655f 6c6f  ere](./sample_lo
-00020780: 6767 696e 672e 636f 6e66 292e 0a0a 2d2d  gging.conf)...--
-00020790: 2d0a 0a43 6f70 7972 6967 6874 2026 636f  -..Copyright &co
-000207a0: 7079 3b20 3230 3230 2054 7261 6e73 6665  py; 2020 Transfe
-000207b0: 7257 6973 650a 0a0a 0000 0000 0000 0000  rWise...........
-000207c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000207d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000207e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000207f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00020810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00020870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00020880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00020890: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-000208a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000208f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00020910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000209f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020a00: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00020a10: 3233 382e 300a 0000 0000 0000 0000 0000  238.0...........
-00020a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020c00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00020c10: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
-00020c20: 696e 666f 2f53 4f55 5243 4553 2e74 7874  info/SOURCES.txt
-00020c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020c60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00020c70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00020c80: 3030 3031 3030 3600 3030 3030 3030 3030  0001006.00000000
-00020c90: 3030 3000 3032 3233 3635 0020 3000 0000  000.022365. 0...
-00020ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020d00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00020d10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00020d20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
-00020d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020e00: 4c49 4345 4e53 450a 5245 4144 4d45 2e6d  LICENSE.README.m
-00020e10: 640a 7365 7475 702e 7079 0a64 7a5f 6d6f  d.setup.py.dz_mo
-00020e20: 6e67 6f64 622f 5f5f 696e 6974 5f5f 2e70  ngodb/__init__.p
-00020e30: 790a 647a 5f6d 6f6e 676f 6462 2f63 6f6e  y.dz_mongodb/con
-00020e40: 6669 675f 7574 696c 732e 7079 0a64 7a5f  fig_utils.py.dz_
-00020e50: 6d6f 6e67 6f64 622f 6462 5f75 7469 6c73  mongodb/db_utils
-00020e60: 2e70 790a 647a 5f6d 6f6e 676f 6462 2f65  .py.dz_mongodb/e
-00020e70: 7272 6f72 732e 7079 0a64 7a5f 6d6f 6e67  rrors.py.dz_mong
-00020e80: 6f64 622f 7374 7265 616d 5f75 7469 6c73  odb/stream_utils
-00020e90: 2e70 790a 647a 5f6d 6f6e 676f 6462 2e65  .py.dz_mongodb.e
-00020ea0: 6767 2d69 6e66 6f2f 504b 472d 494e 464f  gg-info/PKG-INFO
-00020eb0: 0a64 7a5f 6d6f 6e67 6f64 622e 6567 672d  .dz_mongodb.egg-
-00020ec0: 696e 666f 2f53 4f55 5243 4553 2e74 7874  info/SOURCES.txt
-00020ed0: 0a64 7a5f 6d6f 6e67 6f64 622e 6567 672d  .dz_mongodb.egg-
-00020ee0: 696e 666f 2f64 6570 656e 6465 6e63 795f  info/dependency_
-00020ef0: 6c69 6e6b 732e 7478 740a 647a 5f6d 6f6e  links.txt.dz_mon
-00020f00: 676f 6462 2e65 6767 2d69 6e66 6f2f 656e  godb.egg-info/en
-00020f10: 7472 795f 706f 696e 7473 2e74 7874 0a64  try_points.txt.d
-00020f20: 7a5f 6d6f 6e67 6f64 622e 6567 672d 696e  z_mongodb.egg-in
-00020f30: 666f 2f72 6571 7569 7265 732e 7478 740a  fo/requires.txt.
-00020f40: 647a 5f6d 6f6e 676f 6462 2e65 6767 2d69  dz_mongodb.egg-i
-00020f50: 6e66 6f2f 746f 705f 6c65 7665 6c2e 7478  nfo/top_level.tx
-00020f60: 740a 647a 5f6d 6f6e 676f 6462 2f73 796e  t.dz_mongodb/syn
-00020f70: 635f 7374 7261 7465 6769 6573 2f63 6861  c_strategies/cha
-00020f80: 6e67 655f 7374 7265 616d 732e 7079 0a64  nge_streams.py.d
-00020f90: 7a5f 6d6f 6e67 6f64 622f 7379 6e63 5f73  z_mongodb/sync_s
-00020fa0: 7472 6174 6567 6965 732f 636f 6d6d 6f6e  trategies/common
-00020fb0: 2e70 790a 647a 5f6d 6f6e 676f 6462 2f73  .py.dz_mongodb/s
-00020fc0: 796e 635f 7374 7261 7465 6769 6573 2f66  ync_strategies/f
-00020fd0: 756c 6c5f 7461 626c 652e 7079 0a64 7a5f  ull_table.py.dz_
-00020fe0: 6d6f 6e67 6f64 622f 7379 6e63 5f73 7472  mongodb/sync_str
-00020ff0: 6174 6567 6965 732f 696e 6372 656d 656e  ategies/incremen
-00021000: 7461 6c2e 7079 0000 0000 0000 0000 0000  tal.py..........
-00021010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000210f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000211f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00021210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00021270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00021280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00021290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-000212a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000212f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00021310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000213a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000213b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0001f410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0001f470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001f480: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+0001f490: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0001f4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0001f510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f600: 3238 206d 7469 6d65 3d31 3638 3737 3732  28 mtime=1687772
+0001f610: 3038 372e 3433 3036 3037 330a 0000 0000  087.4306073.....
+0001f620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f800: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+0001f810: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
+0001f820: 696e 666f 2f00 0000 0000 0000 0000 0000  info/...........
+0001f830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f860: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
+0001f870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+0001f880: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
+0001f890: 3030 3000 3032 3035 3035 0020 3500 0000  000.020505. 5...
+0001f8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f900: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+0001f910: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+0001f920: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0001f930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0001fa10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fa60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0001fa70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0001fa80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0001fa90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0001faa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001faf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0001fb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fc00: 3232 206d 7469 6d65 3d31 3638 3737 3732  22 mtime=1687772
+0001fc10: 3038 372e 300a 0000 0000 0000 0000 0000  087.0...........
+0001fc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fc80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fc90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fe00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+0001fe10: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
+0001fe20: 696e 666f 2f50 4b47 2d49 4e46 4f00 0000  info/PKG-INFO...
+0001fe30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fe40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fe50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fe60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+0001fe70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+0001fe80: 3030 3131 3637 3000 3030 3030 3030 3030  0011670.00000000
+0001fe90: 3030 3000 3032 3136 3037 0020 3000 0000  000.021607. 0...
+0001fea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001feb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ff00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+0001ff10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+0001ff20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0001ff30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ff40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ff50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ff60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ff70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ff80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ff90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ffa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ffb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ffc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ffd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ffe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001fff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00020000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00020010: 3a20 322e 310a 4e61 6d65 3a20 647a 2d6d  : 2.1.Name: dz-m
+00020020: 6f6e 676f 6462 0a56 6572 7369 6f6e 3a20  ongodb.Version: 
+00020030: 312e 342e 310a 5375 6d6d 6172 793a 2053  1.4.1.Summary: S
+00020040: 696e 6765 722e 696f 2074 6170 2066 6f72  inger.io tap for
+00020050: 2065 7874 7261 6374 696e 6720 6461 7461   extracting data
+00020060: 2066 726f 6d20 4d6f 6e67 6f44 4220 2d20   from MongoDB - 
+00020070: 4461 7461 7a69 7020 636f 6d70 6174 6962  Datazip compatib
+00020080: 6c65 0a48 6f6d 652d 7061 6765 3a20 6874  le.Home-page: ht
+00020090: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+000200a0: 2f64 6174 617a 6970 2f64 7a2d 6d6f 6e67  /datazip/dz-mong
+000200b0: 6f64 620a 4175 7468 6f72 3a20 5769 7365  odb.Author: Wise
+000200c0: 0a4c 6963 656e 7365 3a20 554e 4b4e 4f57  .License: UNKNOW
+000200d0: 4e0a 506c 6174 666f 726d 3a20 554e 4b4e  N.Platform: UNKN
+000200e0: 4f57 4e0a 436c 6173 7369 6669 6572 3a20  OWN.Classifier: 
+000200f0: 5072 6f67 7261 6d6d 696e 6720 4c61 6e67  Programming Lang
+00020100: 7561 6765 203a 3a20 5079 7468 6f6e 203a  uage :: Python :
+00020110: 3a20 3320 3a3a 204f 6e6c 790a 436c 6173  : 3 :: Only.Clas
+00020120: 7369 6669 6572 3a20 5072 6f67 7261 6d6d  sifier: Programm
+00020130: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
+00020140: 5079 7468 6f6e 203a 3a20 332e 360a 436c  Python :: 3.6.Cl
+00020150: 6173 7369 6669 6572 3a20 5072 6f67 7261  assifier: Progra
+00020160: 6d6d 696e 6720 4c61 6e67 7561 6765 203a  mming Language :
+00020170: 3a20 5079 7468 6f6e 203a 3a20 332e 370a  : Python :: 3.7.
+00020180: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
+00020190: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
+000201a0: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
+000201b0: 380a 4465 7363 7269 7074 696f 6e2d 436f  8.Description-Co
+000201c0: 6e74 656e 742d 5479 7065 3a20 7465 7874  ntent-Type: text
+000201d0: 2f6d 6172 6b64 6f77 6e0a 5072 6f76 6964  /markdown.Provid
+000201e0: 6573 2d45 7874 7261 3a20 6465 760a 5072  es-Extra: dev.Pr
+000201f0: 6f76 6964 6573 2d45 7874 7261 3a20 7465  ovides-Extra: te
+00020200: 7374 0a4c 6963 656e 7365 2d46 696c 653a  st.License-File:
+00020210: 204c 4943 454e 5345 0a0a 2320 647a 2d6d   LICENSE..# dz-m
+00020220: 6f6e 676f 6462 0a0a 5468 6973 2069 7320  ongodb..This is 
+00020230: 6120 5b53 696e 6765 725d 2868 7474 7073  a [Singer](https
+00020240: 3a2f 2f73 696e 6765 722e 696f 2920 7461  ://singer.io) ta
+00020250: 7020 7468 6174 2070 726f 6475 6365 7320  p that produces 
+00020260: 4a53 4f4e 2d66 6f72 6d61 7474 6564 2064  JSON-formatted d
+00020270: 6174 6120 666f 6c6c 6f77 696e 6720 7468  ata following th
+00020280: 6520 5b53 696e 6765 7220 7370 6563 5d28  e [Singer spec](
+00020290: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+000202a0: 6f6d 2f73 696e 6765 722d 696f 2f67 6574  om/singer-io/get
+000202b0: 7469 6e67 2d73 7461 7274 6564 2f62 6c6f  ting-started/blo
+000202c0: 622f 6d61 7374 6572 2f53 5045 432e 6d64  b/master/SPEC.md
+000202d0: 2920 6672 6f6d 2061 204d 6f6e 676f 4442  ) from a MongoDB
+000202e0: 2073 6f75 7263 652e 0a0a 2323 2053 6574   source...## Set
+000202f0: 2075 7020 6c6f 6361 6c20 6465 7620 656e   up local dev en
+00020300: 7669 726f 6e6d 656e 743a 0a0a 6060 6073  vironment:..```s
+00020310: 6865 6c6c 2073 6372 6970 740a 6d61 6b65  hell script.make
+00020320: 2073 6574 7570 0a60 6060 0a0a 2323 2041   setup.```..## A
+00020330: 6374 6976 6174 6520 7669 7274 7561 6c20  ctivate virtual 
+00020340: 656e 7669 726f 6e6d 656e 740a 0a60 6060  environment..```
+00020350: 7368 656c 6c20 7363 7269 7074 0a2e 2076  shell script.. v
+00020360: 656e 762f 6269 6e2f 6163 7469 7661 7465  env/bin/activate
+00020370: 0a60 6060 0a0a 2323 2053 6574 2075 7020  .```..## Set up 
+00020380: 436f 6e66 6967 2066 696c 650a 0a43 7265  Config file..Cre
+00020390: 6174 6520 6a73 6f6e 2066 696c 6520 6361  ate json file ca
+000203a0: 6c6c 6564 2060 636f 6e66 6967 2e6a 736f  lled `config.jso
+000203b0: 6e60 2c20 7769 7468 2074 6865 2066 6f6c  n`, with the fol
+000203c0: 6c6f 7769 6e67 2063 6f6e 7465 6e74 733a  lowing contents:
+000203d0: 0a60 6060 6a73 6f6e 0a7b 0a20 2022 7061  .```json.{.  "pa
+000203e0: 7373 776f 7264 223a 2022 3c70 6173 7377  ssword": "<passw
+000203f0: 6f72 643e 222c 0a20 2022 7573 6572 223a  ord>",.  "user":
+00020400: 2022 3c75 7365 726e 616d 653e 222c 0a20   "<username>",. 
+00020410: 2022 686f 7374 223a 2022 3c68 6f73 7420   "host": "<host 
+00020420: 6970 2061 6464 7265 7373 3e22 2c0a 2020  ip address>",.  
+00020430: 2261 7574 685f 6461 7461 6261 7365 223a  "auth_database":
+00020440: 2022 3c64 6174 6162 6173 6520 6e61 6d65   "<database name
+00020450: 2074 6f20 6175 7468 656e 7469 6361 7465   to authenticate
+00020460: 206f 6e3e 222c 0a20 2022 6461 7461 6261   on>",.  "databa
+00020470: 7365 223a 2022 3c64 6174 6162 6173 6520  se": "<database 
+00020480: 6e61 6d65 2074 6f20 7379 6e63 2066 726f  name to sync fro
+00020490: 6d3e 220a 7d0a 6060 600a 5468 6520 666f  m>".}.```.The fo
+000204a0: 6c6c 6f77 696e 6720 7061 7261 6d65 7465  llowing paramete
+000204b0: 7273 2061 7265 206f 7074 696f 6e61 6c20  rs are optional 
+000204c0: 666f 7220 796f 7572 2063 6f6e 6669 6720  for your config 
+000204d0: 6669 6c65 3a0a 0a7c 204e 616d 6520 7c20  file:..| Name | 
+000204e0: 5479 7065 207c 2044 6566 6175 6c74 2076  Type | Default v
+000204f0: 616c 7565 7c20 4465 7363 7269 7074 696f  alue| Descriptio
+00020500: 6e20 7c0a 7c20 2d2d 2d2d 2d7c 2d2d 2d2d  n |.| -----|----
+00020510: 2d2d 7c2d 2d2d 2d2d 2d2d 2d7c 2d2d 2d2d  --|--------|----
+00020520: 2d2d 2d2d 2d2d 2d2d 207c 0a7c 2060 7372  -------- |.| `sr
+00020530: 7660 207c 2042 6f6f 6c65 616e 207c 2066  v` | Boolean | f
+00020540: 616c 7365 207c 2075 7365 7320 6120 606d  alse | uses a `m
+00020550: 6f6e 676f 6462 2b73 7276 6020 7072 6f74  ongodb+srv` prot
+00020560: 6f63 6f6c 2074 6f20 636f 6e6e 6563 742e  ocol to connect.
+00020570: 2044 6973 6162 6c65 7320 7468 6520 7573   Disables the us
+00020580: 6167 6520 6f66 2060 706f 7274 6020 6172  age of `port` ar
+00020590: 6775 6d65 6e74 2069 6620 7365 7420 746f  gument if set to
+000205a0: 2060 5472 7565 6020 7c0a 7c20 6070 6f72   `True` |.| `por
+000205b0: 7460 207c 2049 6e74 6567 6572 207c 2066  t` | Integer | f
+000205c0: 616c 7365 207c 2043 6f6e 6e65 6374 696f  alse | Connectio
+000205d0: 6e20 706f 7274 2e20 5265 7175 6972 6564  n port. Required
+000205e0: 2069 6620 6120 6e6f 6e2d 7372 7620 636f   if a non-srv co
+000205f0: 6e6e 6563 7469 6f6e 2069 7320 6265 696e  nnection is bein
+00020600: 6720 7573 6564 2e20 207c 0a7c 2060 7265  g used.  |.| `re
+00020610: 706c 6963 615f 7365 7460 207c 2073 7472  plica_set` | str
+00020620: 696e 6720 7c20 6e75 6c6c 207c 206e 616d  ing | null | nam
+00020630: 6520 6f66 2072 6570 6c69 6361 2073 6574  e of replica set
+00020640: 207c 0a7c 2060 7373 6c60 207c 2042 6f6f   |.| `ssl` | Boo
+00020650: 6c65 616e 207c 2066 616c 7365 207c 2063  lean | false | c
+00020660: 616e 2062 6520 7365 7420 746f 2074 7275  an be set to tru
+00020670: 6520 746f 2063 6f6e 6e65 6374 2075 7369  e to connect usi
+00020680: 6e67 2073 736c 207c 0a7c 2060 7665 7269  ng ssl |.| `veri
+00020690: 6679 5f6d 6f64 6560 207c 2042 6f6f 6c65  fy_mode` | Boole
+000206a0: 616e 207c 2074 7275 6520 7c20 4465 6661  an | true | Defa
+000206b0: 756c 7420 5353 4c20 7665 7269 6679 206d  ult SSL verify m
+000206c0: 6f64 6520 7c0a 7c20 6069 6e63 6c75 6465  ode |.| `include
+000206d0: 5f73 6368 656d 6173 5f69 6e5f 6465 7374  _schemas_in_dest
+000206e0: 696e 6174 696f 6e5f 7374 7265 616d 5f6e  ination_stream_n
+000206f0: 616d 6560 207c 2042 6f6f 6c65 616e 207c  ame` | Boolean |
+00020700: 6661 6c73 6520 207c 2066 6f72 6365 7320  false  | forces 
+00020710: 7468 6520 7374 7265 616d 206e 616d 6573  the stream names
+00020720: 2074 6f20 7461 6b65 2074 6865 2066 6f72   to take the for
+00020730: 6d20 603c 6461 7461 6261 7365 5f6e 616d  m `<database_nam
+00020740: 653e 2d3c 636f 6c6c 6563 7469 6f6e 5f6e  e>-<collection_n
+00020750: 616d 653e 6020 696e 7374 6561 6420 6f66  ame>` instead of
+00020760: 2060 3c63 6f6c 6c65 6374 696f 6e5f 6e61   `<collection_na
+00020770: 6d65 3e60 7c0a 7c20 6075 7064 6174 655f  me>`|.| `update_
+00020780: 6275 6666 6572 5f73 697a 6560 207c 2069  buffer_size` | i
+00020790: 6e74 207c 2031 207c 205b 4c4f 475f 4241  nt | 1 | [LOG_BA
+000207a0: 5345 445d 2054 6865 2073 697a 6520 6f66  SED] The size of
+000207b0: 2074 6865 2062 7566 6665 7220 7468 6174   the buffer that
+000207c0: 2068 6f6c 6473 2064 6574 6563 7465 6420   holds detected 
+000207d0: 7570 6461 7465 206f 7065 7261 7469 6f6e  update operation
+000207e0: 7320 696e 206d 656d 6f72 792c 2074 6865  s in memory, the
+000207f0: 2062 7566 6665 7220 6973 2066 6c75 7368   buffer is flush
+00020800: 6564 206f 6e63 6520 7468 6520 7369 7a65  ed once the size
+00020810: 2069 7320 7265 6163 6865 6420 7c0a 7c20   is reached |.| 
+00020820: 6061 7761 6974 5f74 696d 655f 6d73 6020  `await_time_ms` 
+00020830: 7c20 696e 7420 7c20 3130 3030 207c 205b  | int | 1000 | [
+00020840: 4c4f 475f 4241 5345 445d 2054 6865 206d  LOG_BASED] The m
+00020850: 6178 696d 756d 2061 6d6f 756e 7420 6f66  aximum amount of
+00020860: 2074 696d 6520 696e 206d 696c 6c69 7365   time in millise
+00020870: 636f 6e64 7320 7468 6520 6c6f 6765 5f62  conds the loge_b
+00020880: 6173 6520 6d65 7468 6f64 2077 6169 7473  ase method waits
+00020890: 2066 6f72 206e 6577 2064 6174 6120 6368   for new data ch
+000208a0: 616e 6765 7320 6265 666f 7265 2065 7869  anges before exi
+000208b0: 7469 6e67 2e20 7c0a 7c20 6066 756c 6c5f  ting. |.| `full_
+000208c0: 6c6f 6164 5f6f 6e5f 656d 7074 795f 7374  load_on_empty_st
+000208d0: 6174 6560 207c 2062 6f6f 6c20 7c20 6661  ate` | bool | fa
+000208e0: 6c73 6520 7c20 5b4c 4f47 5f42 4153 4544  lse | [LOG_BASED
+000208f0: 5d20 4120 666c 6167 2077 6869 6368 2066  ] A flag which f
+00020900: 6f72 6365 7320 6675 6c6c 206c 6f61 6420  orces full load 
+00020910: 7768 656e 206e 6f20 7072 6576 696f 7573  when no previous
+00020920: 2074 6f6b 656e 2069 7320 666f 756e 6420   token is found 
+00020930: 696e 2073 7461 7465 2e7c 0a0a 416c 6c20  in state.|..All 
+00020940: 6f66 2074 6865 2061 626f 7665 2061 7474  of the above att
+00020950: 7269 6275 7465 7320 6172 6520 7265 7175  ributes are requ
+00020960: 6972 6564 2062 7920 7468 6520 7461 7020  ired by the tap 
+00020970: 746f 2063 6f6e 6e65 6374 2074 6f20 796f  to connect to yo
+00020980: 7572 206d 6f6e 676f 2069 6e73 7461 6e63  ur mongo instanc
+00020990: 652e 0a68 6572 6520 6973 2061 205b 7361  e..here is a [sa
+000209a0: 6d70 6c65 2063 6f6e 6669 6775 7261 7469  mple configurati
+000209b0: 6f6e 2066 696c 655d 282e 2f73 616d 706c  on file](./sampl
+000209c0: 655f 636f 6e66 6967 2e6a 736f 6e29 2e0a  e_config.json)..
+000209d0: 0a23 2320 5275 6e20 696e 2064 6973 636f  .## Run in disco
+000209e0: 7665 7279 206d 6f64 650a 5275 6e20 7468  very mode.Run th
+000209f0: 6520 666f 6c6c 6f77 696e 6720 636f 6d6d  e following comm
+00020a00: 616e 6420 616e 6420 7265 6469 7265 6374  and and redirect
+00020a10: 2074 6865 206f 7574 7075 7420 696e 746f   the output into
+00020a20: 2074 6865 2063 6174 616c 6f67 2066 696c   the catalog fil
+00020a30: 650a 6060 6073 6865 6c6c 2073 6372 6970  e.```shell scrip
+00020a40: 740a 647a 2d6d 6f6e 676f 6462 202d 2d63  t.dz-mongodb --c
+00020a50: 6f6e 6669 6720 7e2f 636f 6e66 6967 2e6a  onfig ~/config.j
+00020a60: 736f 6e20 2d2d 6469 7363 6f76 6572 203e  son --discover >
+00020a70: 207e 2f63 6174 616c 6f67 2e6a 736f 6e0a   ~/catalog.json.
+00020a80: 6060 600a 0a59 6f75 7220 6361 7461 6c6f  ```..Your catalo
+00020a90: 6720 6669 6c65 2073 686f 756c 6420 6e6f  g file should no
+00020aa0: 7720 6c6f 6f6b 206c 696b 6520 7468 6973  w look like this
+00020ab0: 3a0a 6060 606a 736f 6e0a 7b0a 2020 2273  :.```json.{.  "s
+00020ac0: 7472 6561 6d73 223a 205b 0a20 2020 207b  treams": [.    {
+00020ad0: 0a20 2020 2020 2022 7461 626c 655f 6e61  .      "table_na
+00020ae0: 6d65 223a 2022 3c74 6162 6c65 206e 616d  me": "<table nam
+00020af0: 653e 222c 0a20 2020 2020 2022 7461 705f  e>",.      "tap_
+00020b00: 7374 7265 616d 5f69 6422 3a20 223c 7461  stream_id": "<ta
+00020b10: 705f 7374 7265 616d 5f69 643e 222c 0a20  p_stream_id>",. 
+00020b20: 2020 2020 2022 6d65 7461 6461 7461 223a       "metadata":
+00020b30: 205b 0a20 2020 2020 2020 207b 0a20 2020   [.        {.   
+00020b40: 2020 2020 2020 2022 6272 6561 6463 7275         "breadcru
+00020b50: 6d62 223a 205b 5d2c 0a20 2020 2020 2020  mb": [],.       
+00020b60: 2020 2022 6d65 7461 6461 7461 223a 207b     "metadata": {
+00020b70: 0a20 2020 2020 2020 2020 2020 2022 726f  .            "ro
+00020b80: 772d 636f 756e 7422 3a3c 696e 743e 2c0a  w-count":<int>,.
+00020b90: 2020 2020 2020 2020 2020 2020 2269 732d              "is-
+00020ba0: 7669 6577 223a 203c 626f 6f6c 3e2c 0a20  view": <bool>,. 
+00020bb0: 2020 2020 2020 2020 2020 2022 6461 7461             "data
+00020bc0: 6261 7365 2d6e 616d 6522 3a20 223c 6461  base-name": "<da
+00020bd0: 7461 6261 7365 206e 616d 653e 222c 0a20  tabase name>",. 
+00020be0: 2020 2020 2020 2020 2020 2022 7461 626c             "tabl
+00020bf0: 652d 6b65 792d 7072 6f70 6572 7469 6573  e-key-properties
+00020c00: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+00020c10: 2020 2022 5f69 6422 0a20 2020 2020 2020     "_id".       
+00020c20: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00020c30: 2020 2020 2276 616c 6964 2d72 6570 6c69      "valid-repli
+00020c40: 6361 7469 6f6e 2d6b 6579 7322 3a20 5b0a  cation-keys": [.
+00020c50: 2020 2020 2020 2020 2020 2020 2020 225f                "_
+00020c60: 6964 220a 2020 2020 2020 2020 2020 2020  id".            
+00020c70: 5d0a 2020 2020 2020 2020 2020 7d0a 2020  ].          }.  
+00020c80: 2020 2020 2020 7d0a 2020 2020 2020 5d2c        }.      ],
+00020c90: 0a20 2020 2020 2022 7374 7265 616d 223a  .      "stream":
+00020ca0: 2022 3c73 7472 6561 6d20 6e61 6d65 3e22   "<stream name>"
+00020cb0: 2c0a 2020 2020 2020 2273 6368 656d 6122  ,.      "schema"
+00020cc0: 3a20 7b0a 2020 2020 2020 2020 2274 7970  : {.        "typ
+00020cd0: 6522 3a20 226f 626a 6563 7422 0a20 2020  e": "object".   
+00020ce0: 2020 207d 0a20 2020 207d 0a20 205d 0a7d     }.    }.  ].}
+00020cf0: 0a60 6060 0a0a 2323 2045 6469 7420 4361  .```..## Edit Ca
+00020d00: 7461 6c6f 6720 6669 6c65 0a23 2323 2055  talog file.### U
+00020d10: 7369 6e67 2076 616c 6964 206a 736f 6e2c  sing valid json,
+00020d20: 2065 6469 7420 7468 6520 636f 6e66 6967   edit the config
+00020d30: 2e6a 736f 6e20 6669 6c65 0a54 6f20 7365  .json file.To se
+00020d40: 6c65 6374 2061 2073 7472 6561 6d2c 2065  lect a stream, e
+00020d50: 6e74 6572 2074 6865 2066 6f6c 6c6f 7769  nter the followi
+00020d60: 6e67 2074 6f20 7468 6520 7374 7265 616d  ng to the stream
+00020d70: 2773 206d 6574 6164 6174 613a 0a60 6060  's metadata:.```
+00020d80: 6a73 6f6e 0a22 7365 6c65 6374 6564 223a  json."selected":
+00020d90: 2074 7275 652c 0a22 7265 706c 6963 6174   true,."replicat
+00020da0: 696f 6e2d 6d65 7468 6f64 223a 2022 3c72  ion-method": "<r
+00020db0: 6570 6c69 6361 7469 6f6e 206d 6574 686f  eplication metho
+00020dc0: 643e 222c 0a60 6060 0a0a 603c 7265 706c  d>",.```..`<repl
+00020dd0: 6963 6174 696f 6e2d 6d65 7468 6f64 3e60  ication-method>`
+00020de0: 206d 7573 7420 6265 2065 6974 6865 7220   must be either 
+00020df0: 6046 554c 4c5f 5441 424c 4560 2c20 6049  `FULL_TABLE`, `I
+00020e00: 4e43 5245 4d45 4e54 414c 6020 6f72 2060  NCREMENTAL` or `
+00020e10: 4c4f 475f 4241 5345 4460 2c20 6966 2069  LOG_BASED`, if i
+00020e20: 7427 7320 6049 4e43 5245 4d45 4e54 414c  t's `INCREMENTAL
+00020e30: 602c 206d 616b 6520 7375 7265 2074 6f20  `, make sure to 
+00020e40: 6164 6420 6120 6022 7265 706c 6963 6174  add a `"replicat
+00020e50: 696f 6e2d 6b65 7922 602e 0a0a 0a46 6f72  ion-key"`....For
+00020e60: 2065 7861 6d70 6c65 2c20 6966 2079 6f75   example, if you
+00020e70: 2077 6572 6520 746f 2065 6469 7420 7468   were to edit th
+00020e80: 6520 6578 616d 706c 6520 7374 7265 616d  e example stream
+00020e90: 2074 6f20 7365 6c65 6374 2074 6865 2073   to select the s
+00020ea0: 7472 6561 6d20 6173 2077 656c 6c20 6173  tream as well as
+00020eb0: 2061 6464 2061 2070 726f 6a65 6374 696f   add a projectio
+00020ec0: 6e2c 2063 6f6e 6669 672e 6a73 6f6e 2073  n, config.json s
+00020ed0: 686f 756c 6420 6c6f 6f6b 2074 6869 733a  hould look this:
+00020ee0: 0a60 6060 6a73 6f6e 0a7b 0a20 2022 7374  .```json.{.  "st
+00020ef0: 7265 616d 7322 3a20 5b0a 2020 2020 7b0a  reams": [.    {.
+00020f00: 2020 2020 2020 2274 6162 6c65 5f6e 616d        "table_nam
+00020f10: 6522 3a20 223c 7461 626c 6520 6e61 6d65  e": "<table name
+00020f20: 3e22 2c0a 2020 2020 2020 2274 6170 5f73  >",.      "tap_s
+00020f30: 7472 6561 6d5f 6964 223a 2022 3c74 6170  tream_id": "<tap
+00020f40: 5f73 7472 6561 6d5f 6964 3e22 2c0a 2020  _stream_id>",.  
+00020f50: 2020 2020 226d 6574 6164 6174 6122 3a20      "metadata": 
+00020f60: 5b0a 2020 2020 2020 2020 7b0a 2020 2020  [.        {.    
+00020f70: 2020 2020 2020 2262 7265 6164 6372 756d        "breadcrum
+00020f80: 6222 3a20 5b5d 2c0a 2020 2020 2020 2020  b": [],.        
+00020f90: 2020 226d 6574 6164 6174 6122 3a20 7b0a    "metadata": {.
+00020fa0: 2020 2020 2020 2020 2020 2020 2272 6f77              "row
+00020fb0: 2d63 6f75 6e74 223a 203c 696e 743e 2c0a  -count": <int>,.
+00020fc0: 2020 2020 2020 2020 2020 2020 2269 732d              "is-
+00020fd0: 7669 6577 223a 203c 626f 6f6c 3e2c 0a20  view": <bool>,. 
+00020fe0: 2020 2020 2020 2020 2020 2022 6461 7461             "data
+00020ff0: 6261 7365 2d6e 616d 6522 3a20 223c 6461  base-name": "<da
+00021000: 7461 6261 7365 206e 616d 653e 222c 0a20  tabase name>",. 
+00021010: 2020 2020 2020 2020 2020 2022 7461 626c             "tabl
+00021020: 652d 6b65 792d 7072 6f70 6572 7469 6573  e-key-properties
+00021030: 223a 205b 0a20 2020 2020 2020 2020 2020  ": [.           
+00021040: 2020 2022 5f69 6422 0a20 2020 2020 2020     "_id".       
+00021050: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00021060: 2020 2020 2276 616c 6964 2d72 6570 6c69      "valid-repli
+00021070: 6361 7469 6f6e 2d6b 6579 7322 3a20 5b0a  cation-keys": [.
+00021080: 2020 2020 2020 2020 2020 2020 2020 225f                "_
+00021090: 6964 220a 2020 2020 2020 2020 2020 2020  id".            
+000210a0: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
+000210b0: 7365 6c65 6374 6564 223a 2074 7275 652c  selected": true,
+000210c0: 0a20 2020 2020 2020 2020 2020 2022 7265  .            "re
+000210d0: 706c 6963 6174 696f 6e2d 6d65 7468 6f64  plication-method
+000210e0: 223a 2022 3c72 6570 6c69 6361 7469 6f6e  ": "<replication
+000210f0: 206d 6574 686f 643e 220a 2020 2020 2020   method>".      
+00021100: 2020 2020 7d0a 2020 2020 2020 2020 7d0a      }.        }.
+00021110: 2020 2020 2020 5d2c 0a20 2020 2020 2022        ],.      "
+00021120: 7374 7265 616d 223a 2022 3c73 7472 6561  stream": "<strea
+00021130: 6d20 6e61 6d65 3e22 2c0a 2020 2020 2020  m name>",.      
+00021140: 2273 6368 656d 6122 3a20 7b0a 2020 2020  "schema": {.    
+00021150: 2020 2020 2274 7970 6522 3a20 226f 626a      "type": "obj
+00021160: 6563 7422 0a20 2020 2020 207d 0a20 2020  ect".      }.   
+00021170: 207d 0a20 205d 0a7d 0a0a 6060 600a 2323   }.  ].}..```.##
+00021180: 2052 756e 2069 6e20 7379 6e63 206d 6f64   Run in sync mod
+00021190: 653a 0a60 6060 7368 656c 6c20 7363 7269  e:.```shell scri
+000211a0: 7074 0a64 7a2d 6d6f 6e67 6f64 6220 2d2d  pt.dz-mongodb --
+000211b0: 636f 6e66 6967 207e 2f63 6f6e 6669 672e  config ~/config.
+000211c0: 6a73 6f6e 202d 2d63 6174 616c 6f67 207e  json --catalog ~
+000211d0: 2f63 6174 616c 6f67 2e6a 736f 6e0a 6060  /catalog.json.``
+000211e0: 600a 0a54 6865 2074 6170 2077 696c 6c20  `..The tap will 
+000211f0: 7772 6974 6520 626f 6f6b 6d61 726b 7320  write bookmarks 
+00021200: 746f 2073 7464 6f75 7420 7768 6963 6820  to stdout which 
+00021210: 6361 6e20 6265 2063 6170 7475 7265 6420  can be captured 
+00021220: 616e 6420 7061 7373 6564 2061 7320 616e  and passed as an
+00021230: 206f 7074 696f 6e61 6c20 602d 2d73 7461   optional `--sta
+00021240: 7465 2073 7461 7465 2e6a 736f 6e60 2070  te state.json` p
+00021250: 6172 616d 6574 6572 2074 6f20 7468 6520  arameter to the 
+00021260: 7461 7020 666f 7220 7468 6520 6e65 7874  tap for the next
+00021270: 2073 796e 632e 0a0a 2323 204c 6f67 6769   sync...## Loggi
+00021280: 6e67 2063 6f6e 6669 6775 7261 7469 6f6e  ng configuration
+00021290: 0a54 6865 2074 6170 2075 7365 7320 6120  .The tap uses a 
+000212a0: 7072 6564 6566 696e 6564 206c 6f67 6769  predefined loggi
+000212b0: 6e67 2063 6f6e 6669 6720 6966 206e 6f6e  ng config if non
+000212c0: 6520 6973 2070 726f 7669 6465 642c 2068  e is provided, h
+000212d0: 6f77 6576 6572 2c20 796f 7520 6361 6e20  owever, you can 
+000212e0: 7365 7420 796f 7572 206f 776e 2063 6f6e  set your own con
+000212f0: 6669 6720 6279 2073 6574 7469 6e67 2074  fig by setting t
+00021300: 6865 2065 6e76 6972 6f6e 6d65 6e74 2076  he environment v
+00021310: 6172 6961 626c 6520 604c 4f47 4749 4e47  ariable `LOGGING
+00021320: 5f43 4f4e 4649 475f 4649 4c45 6020 6173  _CONFIG_FILE` as
+00021330: 2074 6865 2070 6174 6820 746f 2074 6865   the path to the
+00021340: 206c 6f67 6769 6e67 2063 6f6e 6669 672e   logging config.
+00021350: 0a41 2073 616d 706c 6520 636f 6e66 6967  .A sample config
+00021360: 2069 7320 6176 6169 6c61 626c 6520 5b68   is available [h
+00021370: 6572 655d 282e 2f73 616d 706c 655f 6c6f  ere](./sample_lo
+00021380: 6767 696e 672e 636f 6e66 292e 0a0a 2d2d  gging.conf)...--
+00021390: 2d0a 0a43 6f70 7972 6967 6874 2026 636f  -..Copyright &co
+000213a0: 7079 3b20 3230 3230 2054 7261 6e73 6665  py; 2020 Transfe
+000213b0: 7257 6973 650a 0a0a 0000 0000 0000 0000  rWise...........
 000213c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000213d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000213e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000213f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021400: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00021410: 3233 382e 300a 0000 0000 0000 0000 0000  238.0...........
+00021400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00021410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00021470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00021480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00021490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000214a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000214f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00021510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8538,113 +8538,113 @@
 00021590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000215f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021600: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00021610: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
-00021620: 696e 666f 2f64 6570 656e 6465 6e63 795f  info/dependency_
-00021630: 6c69 6e6b 732e 7478 7400 0000 0000 0000  links.txt.......
+00021600: 3232 206d 7469 6d65 3d31 3638 3737 3732  22 mtime=1687772
+00021610: 3038 372e 300a 0000 0000 0000 0000 0000  087.0...........
+00021620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00021670: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00021680: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
-00021690: 3030 3000 3032 3435 3532 0020 3000 0000  000.024552. 0...
+00021660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021700: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00021710: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00021720: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00021700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021800: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
-00021810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021800: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00021810: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
+00021820: 696e 666f 2f53 4f55 5243 4553 2e74 7874  info/SOURCES.txt
 00021830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00021870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00021880: 3030 3031 3034 3300 3030 3030 3030 3030  0001043.00000000
+00021890: 3030 3000 3032 3233 3637 0020 3000 0000  000.022367. 0...
 000218a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021900: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00021910: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00021920: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
 00021930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00021a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00021a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00021a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00021a90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-00021aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00021b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021c00: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00021c10: 3233 382e 300a 0000 0000 0000 0000 0000  238.0...........
-00021c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021a00: 4c49 4345 4e53 450a 5245 4144 4d45 2e6d  LICENSE.README.m
+00021a10: 640a 7365 7475 702e 7079 0a64 7a5f 6d6f  d.setup.py.dz_mo
+00021a20: 6e67 6f64 622f 5f5f 696e 6974 5f5f 2e70  ngodb/__init__.p
+00021a30: 790a 647a 5f6d 6f6e 676f 6462 2f63 6f6e  y.dz_mongodb/con
+00021a40: 6669 675f 7574 696c 732e 7079 0a64 7a5f  fig_utils.py.dz_
+00021a50: 6d6f 6e67 6f64 622f 6461 7465 7469 6d65  mongodb/datetime
+00021a60: 5f75 7469 6c73 2e70 790a 647a 5f6d 6f6e  _utils.py.dz_mon
+00021a70: 676f 6462 2f64 625f 7574 696c 732e 7079  godb/db_utils.py
+00021a80: 0a64 7a5f 6d6f 6e67 6f64 622f 6572 726f  .dz_mongodb/erro
+00021a90: 7273 2e70 790a 647a 5f6d 6f6e 676f 6462  rs.py.dz_mongodb
+00021aa0: 2f73 7472 6561 6d5f 7574 696c 732e 7079  /stream_utils.py
+00021ab0: 0a64 7a5f 6d6f 6e67 6f64 622e 6567 672d  .dz_mongodb.egg-
+00021ac0: 696e 666f 2f50 4b47 2d49 4e46 4f0a 647a  info/PKG-INFO.dz
+00021ad0: 5f6d 6f6e 676f 6462 2e65 6767 2d69 6e66  _mongodb.egg-inf
+00021ae0: 6f2f 534f 5552 4345 532e 7478 740a 647a  o/SOURCES.txt.dz
+00021af0: 5f6d 6f6e 676f 6462 2e65 6767 2d69 6e66  _mongodb.egg-inf
+00021b00: 6f2f 6465 7065 6e64 656e 6379 5f6c 696e  o/dependency_lin
+00021b10: 6b73 2e74 7874 0a64 7a5f 6d6f 6e67 6f64  ks.txt.dz_mongod
+00021b20: 622e 6567 672d 696e 666f 2f65 6e74 7279  b.egg-info/entry
+00021b30: 5f70 6f69 6e74 732e 7478 740a 647a 5f6d  _points.txt.dz_m
+00021b40: 6f6e 676f 6462 2e65 6767 2d69 6e66 6f2f  ongodb.egg-info/
+00021b50: 7265 7175 6972 6573 2e74 7874 0a64 7a5f  requires.txt.dz_
+00021b60: 6d6f 6e67 6f64 622e 6567 672d 696e 666f  mongodb.egg-info
+00021b70: 2f74 6f70 5f6c 6576 656c 2e74 7874 0a64  /top_level.txt.d
+00021b80: 7a5f 6d6f 6e67 6f64 622f 7379 6e63 5f73  z_mongodb/sync_s
+00021b90: 7472 6174 6567 6965 732f 6368 616e 6765  trategies/change
+00021ba0: 5f73 7472 6561 6d73 2e70 790a 647a 5f6d  _streams.py.dz_m
+00021bb0: 6f6e 676f 6462 2f73 796e 635f 7374 7261  ongodb/sync_stra
+00021bc0: 7465 6769 6573 2f63 6f6d 6d6f 6e2e 7079  tegies/common.py
+00021bd0: 0a64 7a5f 6d6f 6e67 6f64 622f 7379 6e63  .dz_mongodb/sync
+00021be0: 5f73 7472 6174 6567 6965 732f 6675 6c6c  _strategies/full
+00021bf0: 5f74 6162 6c65 2e70 790a 647a 5f6d 6f6e  _table.py.dz_mon
+00021c00: 676f 6462 2f73 796e 635f 7374 7261 7465  godb/sync_strate
+00021c10: 6769 6573 2f69 6e63 7265 6d65 6e74 616c  gies/incremental
+00021c20: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
 00021c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8666,51 +8666,51 @@
 00021d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021e00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00021e10: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
-00021e20: 696e 666f 2f65 6e74 7279 5f70 6f69 6e74  info/entry_point
-00021e30: 732e 7478 7400 0000 0000 0000 0000 0000  s.txt...........
+00021e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00021e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00021e70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00021e80: 3030 3030 3131 3000 3030 3030 3030 3030  0000110.00000000
-00021e90: 3030 3000 3032 3337 3732 0020 3000 0000  000.023772. 0...
+00021e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00021e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00021e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00021e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00021ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021f00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00021f10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00021f20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00021f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00021f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022000: 0a20 2020 2020 2020 2020 205b 636f 6e73  .          [cons
-00022010: 6f6c 655f 7363 7269 7074 735d 0a20 2020  ole_scripts].   
-00022020: 2020 2020 2020 2064 7a2d 6d6f 6e67 6f64         dz-mongod
-00022030: 623d 647a 5f6d 6f6e 676f 6462 3a6d 6169  b=dz_mongodb:mai
-00022040: 6e0a 2020 2020 2020 0000 0000 0000 0000  n.      ........
+00022000: 3232 206d 7469 6d65 3d31 3638 3737 3732  22 mtime=1687772
+00022010: 3038 372e 300a 0000 0000 0000 0000 0000  087.0...........
+00022020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000220a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000220b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8730,48 +8730,48 @@
 00022190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00022210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022200: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00022210: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
+00022220: 696e 666f 2f64 6570 656e 6465 6e63 795f  info/dependency_
+00022230: 6c69 6e6b 732e 7478 7400 0000 0000 0000  links.txt.......
 00022240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00022270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00022280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00022290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00022260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00022270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00022280: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
+00022290: 3030 3000 3032 3435 3533 0020 3000 0000  000.024553. 0...
 000222a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00022310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022300: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00022310: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00022320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
 00022330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022400: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00022410: 3233 382e 300a 0000 0000 0000 0000 0000  238.0...........
+00022400: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+00022410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8794,57 +8794,57 @@
 00022590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022600: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00022610: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
-00022620: 696e 666f 2f72 6571 7569 7265 732e 7478  info/requires.tx
-00022630: 7400 0000 0000 0000 0000 0000 0000 0000  t...............
+00022600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00022610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00022670: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00022680: 3030 3030 3235 3600 3030 3030 3030 3030  0000256.00000000
-00022690: 3030 3000 3032 3331 3037 0020 3000 0000  000.023107. 0...
+00022660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00022670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00022680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00022690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000226a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022700: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00022710: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00022720: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00022700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00022710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022800: 7069 7065 6c69 6e65 7769 7365 2d73 696e  pipelinewise-sin
-00022810: 6765 722d 7079 7468 6f6e 3d3d 312e 2a0a  ger-python==1.*.
-00022820: 7079 6d6f 6e67 6f3d 3d34 2e33 2e2a 0a74  pymongo==4.3.*.t
-00022830: 7a6c 6f63 616c 3d3d 322e 312e 2a0a 7465  zlocal==2.1.*.te
-00022840: 726d 696e 616c 7461 626c 6573 3d3d 332e  rminaltables==3.
-00022850: 312e 2a0a 646e 7370 7974 686f 6e3d 3d32  1.*.dnspython==2
-00022860: 2e31 2e2a 0a0a 5b64 6576 5d0a 7079 6c69  .1.*..[dev].pyli
-00022870: 6e74 3d3d 322e 3132 0a69 7064 623d 3d30  nt==2.12.ipdb==0
-00022880: 2e31 332e 2a0a 0a5b 7465 7374 5d0a 7079  .13.*..[test].py
-00022890: 7465 7374 3d3d 362e 322e 350a 7079 7465  test==6.2.5.pyte
-000228a0: 7374 2d63 6f76 3d3d 332e 302e 300a 0000  st-cov==3.0.0...
+00022800: 3232 206d 7469 6d65 3d31 3638 3737 3732  22 mtime=1687772
+00022810: 3038 372e 300a 0000 0000 0000 0000 0000  087.0...........
+00022820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000228a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8858,51 +8858,51 @@
 00022990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00022a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022a00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00022a10: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
+00022a20: 696e 666f 2f65 6e74 7279 5f70 6f69 6e74  info/entry_point
+00022a30: 732e 7478 7400 0000 0000 0000 0000 0000  s.txt...........
 00022a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00022a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00022a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00022a90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00022a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00022a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00022a80: 3030 3030 3131 3000 3030 3030 3030 3030  0000110.00000000
+00022a90: 3030 3000 3032 3337 3733 0020 3000 0000  000.023773. 0...
 00022aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00022b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022b00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00022b10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00022b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
 00022b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022c00: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00022c10: 3233 382e 300a 0000 0000 0000 0000 0000  238.0...........
-00022c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022c00: 0a20 2020 2020 2020 2020 205b 636f 6e73  .          [cons
+00022c10: 6f6c 655f 7363 7269 7074 735d 0a20 2020  ole_scripts].   
+00022c20: 2020 2020 2020 2064 7a2d 6d6f 6e67 6f64         dz-mongod
+00022c30: 623d 647a 5f6d 6f6e 676f 6462 3a6d 6169  b=dz_mongodb:mai
+00022c40: 6e0a 2020 2020 2020 0000 0000 0000 0000  n.      ........
 00022c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8922,48 +8922,48 @@
 00022d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022e00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00022e10: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
-00022e20: 696e 666f 2f74 6f70 5f6c 6576 656c 2e74  info/top_level.t
-00022e30: 7874 0000 0000 0000 0000 0000 0000 0000  xt..............
+00022e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00022e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00022e70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00022e80: 3030 3030 3031 3300 3030 3030 3030 3030  0000013.00000000
-00022e90: 3030 3000 3032 3332 3330 0020 3000 0000  000.023230. 0...
+00022e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00022e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00022e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00022e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 00022ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00022f10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00022f20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00022f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00022f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023000: 647a 5f6d 6f6e 676f 6462 0a00 0000 0000  dz_mongodb......
-00023010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023000: 3232 206d 7469 6d65 3d31 3638 3737 3732  22 mtime=1687772
+00023010: 3038 372e 300a 0000 0000 0000 0000 0000  087.0...........
 00023020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8986,57 +8986,57 @@
 00023190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00023210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023200: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00023210: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
+00023220: 696e 666f 2f72 6571 7569 7265 732e 7478  info/requires.tx
+00023230: 7400 0000 0000 0000 0000 0000 0000 0000  t...............
 00023240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00023270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00023280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00023290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00023260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00023270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00023280: 3030 3030 3235 3600 3030 3030 3030 3030  0000256.00000000
+00023290: 3030 3000 3032 3331 3130 0020 3000 0000  000.023110. 0...
 000232a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00023310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023300: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00023310: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00023320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
 00023330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023400: 3238 206d 7469 6d65 3d31 3637 3634 3439  28 mtime=1676449
-00023410: 3233 382e 3431 3135 3431 370a 0000 0000  238.4115417.....
-00023420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000234a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023400: 7069 7065 6c69 6e65 7769 7365 2d73 696e  pipelinewise-sin
+00023410: 6765 722d 7079 7468 6f6e 3d3d 312e 2a0a  ger-python==1.*.
+00023420: 7079 6d6f 6e67 6f3d 3d34 2e33 2e2a 0a74  pymongo==4.3.*.t
+00023430: 7a6c 6f63 616c 3d3d 322e 312e 2a0a 7465  zlocal==2.1.*.te
+00023440: 726d 696e 616c 7461 626c 6573 3d3d 332e  rminaltables==3.
+00023450: 312e 2a0a 646e 7370 7974 686f 6e3d 3d32  1.*.dnspython==2
+00023460: 2e31 2e2a 0a0a 5b64 6576 5d0a 7079 6c69  .1.*..[dev].pyli
+00023470: 6e74 3d3d 322e 3132 0a69 7064 623d 3d30  nt==2.12.ipdb==0
+00023480: 2e31 332e 2a0a 0a5b 7465 7374 5d0a 7079  .13.*..[test].py
+00023490: 7465 7374 3d3d 362e 322e 350a 7079 7465  test==6.2.5.pyte
+000234a0: 7374 2d63 6f76 3d3d 332e 302e 300a 0000  st-cov==3.0.0...
 000234b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000234c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000234d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000234e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000234f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9050,49 +9050,49 @@
 00023590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023600: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00023610: 2f73 6574 7570 2e63 6667 0000 0000 0000  /setup.cfg......
+00023600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00023610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00023670: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00023680: 3030 3030 3034 3600 3030 3030 3030 3030  0000046.00000000
-00023690: 3030 3000 3031 3635 3131 0020 3000 0000  000.016511. 0...
+00023660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00023670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00023680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00023690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000236a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023700: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00023710: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00023720: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00023700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00023710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023800: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
-00023810: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
-00023820: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
+00023800: 3232 206d 7469 6d65 3d31 3638 3737 3732  22 mtime=1687772
+00023810: 3038 372e 300a 0000 0000 0000 0000 0000  087.0...........
+00023820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9114,48 +9114,48 @@
 00023990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023a00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00023a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00023a10: 2f64 7a5f 6d6f 6e67 6f64 622e 6567 672d  /dz_mongodb.egg-
+00023a20: 696e 666f 2f74 6f70 5f6c 6576 656c 2e74  info/top_level.t
+00023a30: 7874 0000 0000 0000 0000 0000 0000 0000  xt..............
 00023a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00023a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00023a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00023a90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00023a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00023a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00023a80: 3030 3030 3031 3300 3030 3030 3030 3030  0000013.00000000
+00023a90: 3030 3000 3032 3332 3331 0020 3000 0000  000.023231. 0...
 00023aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00023b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023b00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00023b10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00023b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
 00023b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023c00: 3232 206d 7469 6d65 3d31 3637 3634 3439  22 mtime=1676449
-00023c10: 3136 362e 300a 0000 0000 0000 0000 0000  166.0...........
+00023c00: 647a 5f6d 6f6e 676f 6462 0a00 0000 0000  dz_mongodb......
+00023c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9178,125 +9178,125 @@
 00023d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023e00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e30  dz-mongodb-1.4.0
-00023e10: 2f73 6574 7570 2e70 7900 0000 0000 0000  /setup.py.......
+00023e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00023e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00023e70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00023e80: 3030 3032 3336 3000 3030 3030 3030 3030  0002360.00000000
-00023e90: 3030 3000 3031 3634 3033 0020 3000 0000  000.016403. 0...
+00023e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00023e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00023e80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00023e90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
 00023ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023f00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
-00023f10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
-00023f20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00023f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00023f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024000: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
-00024010: 7974 686f 6e0a 6672 6f6d 2073 6574 7570  ython.from setup
-00024020: 746f 6f6c 7320 696d 706f 7274 2073 6574  tools import set
-00024030: 7570 0a0a 7769 7468 206f 7065 6e28 2752  up..with open('R
-00024040: 4541 444d 452e 6d64 272c 2027 7227 2920  EADME.md', 'r') 
-00024050: 6173 2066 683a 0a20 2020 206c 6f6e 675f  as fh:.    long_
-00024060: 6465 7363 203d 2066 682e 7265 6164 2829  desc = fh.read()
-00024070: 0a0a 7365 7475 7028 6e61 6d65 3d27 647a  ..setup(name='dz
-00024080: 2d6d 6f6e 676f 6462 272c 0a20 2020 2020  -mongodb',.     
-00024090: 2076 6572 7369 6f6e 3d27 312e 342e 3027   version='1.4.0'
-000240a0: 2c0a 2020 2020 2020 6465 7363 7269 7074  ,.      descript
-000240b0: 696f 6e3d 2753 696e 6765 722e 696f 2074  ion='Singer.io t
-000240c0: 6170 2066 6f72 2065 7874 7261 6374 696e  ap for extractin
-000240d0: 6720 6461 7461 2066 726f 6d20 4d6f 6e67  g data from Mong
-000240e0: 6f44 4220 2d20 4461 7461 7a69 7020 636f  oDB - Datazip co
-000240f0: 6d70 6174 6962 6c65 272c 0a20 2020 2020  mpatible',.     
-00024100: 206c 6f6e 675f 6465 7363 7269 7074 696f   long_descriptio
-00024110: 6e3d 6c6f 6e67 5f64 6573 632c 0a20 2020  n=long_desc,.   
-00024120: 2020 206c 6f6e 675f 6465 7363 7269 7074     long_descript
-00024130: 696f 6e5f 636f 6e74 656e 745f 7479 7065  ion_content_type
-00024140: 3d27 7465 7874 2f6d 6172 6b64 6f77 6e27  ='text/markdown'
-00024150: 2c0a 2020 2020 2020 6175 7468 6f72 3d27  ,.      author='
-00024160: 5769 7365 272c 0a20 2020 2020 2075 726c  Wise',.      url
-00024170: 3d27 6874 7470 733a 2f2f 6769 7468 7562  ='https://github
-00024180: 2e63 6f6d 2f64 6174 617a 6970 2f64 7a2d  .com/datazip/dz-
-00024190: 6d6f 6e67 6f64 6227 2c0a 2020 2020 2020  mongodb',.      
-000241a0: 636c 6173 7369 6669 6572 733d 5b0a 2020  classifiers=[.  
-000241b0: 2020 2020 2020 2020 2750 726f 6772 616d          'Program
-000241c0: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
-000241d0: 2050 7974 686f 6e20 3a3a 2033 203a 3a20   Python :: 3 :: 
-000241e0: 4f6e 6c79 272c 0a20 2020 2020 2020 2020  Only',.         
-000241f0: 2027 5072 6f67 7261 6d6d 696e 6720 4c61   'Programming La
-00024200: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
-00024210: 203a 3a20 332e 3627 2c0a 2020 2020 2020   :: 3.6',.      
-00024220: 2020 2020 2750 726f 6772 616d 6d69 6e67      'Programming
-00024230: 204c 616e 6775 6167 6520 3a3a 2050 7974   Language :: Pyt
-00024240: 686f 6e20 3a3a 2033 2e37 272c 0a20 2020  hon :: 3.7',.   
-00024250: 2020 2020 2020 2027 5072 6f67 7261 6d6d         'Programm
-00024260: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
-00024270: 5079 7468 6f6e 203a 3a20 332e 3827 2c0a  Python :: 3.8',.
-00024280: 2020 2020 2020 5d2c 0a20 2020 2020 2070        ],.      p
-00024290: 795f 6d6f 6475 6c65 733d 5b27 647a 5f6d  y_modules=['dz_m
-000242a0: 6f6e 676f 6462 275d 2c0a 2020 2020 2020  ongodb'],.      
-000242b0: 696e 7374 616c 6c5f 7265 7175 6972 6573  install_requires
-000242c0: 3d5b 0a20 2020 2020 2020 2020 2027 7069  =[.          'pi
-000242d0: 7065 6c69 6e65 7769 7365 2d73 696e 6765  pelinewise-singe
-000242e0: 722d 7079 7468 6f6e 3d3d 312e 2a27 2c0a  r-python==1.*',.
-000242f0: 2020 2020 2020 2020 2020 2770 796d 6f6e            'pymon
-00024300: 676f 3d3d 342e 332e 2a27 2c0a 2020 2020  go==4.3.*',.    
-00024310: 2020 2020 2020 2774 7a6c 6f63 616c 3d3d        'tzlocal==
-00024320: 322e 312e 2a27 2c0a 2020 2020 2020 2020  2.1.*',.        
-00024330: 2020 2774 6572 6d69 6e61 6c74 6162 6c65    'terminaltable
-00024340: 733d 3d33 2e31 2e2a 272c 0a20 2020 2020  s==3.1.*',.     
-00024350: 2020 2020 2027 646e 7370 7974 686f 6e3d       'dnspython=
-00024360: 3d32 2e31 2e2a 272c 0a20 2020 2020 205d  =2.1.*',.      ]
-00024370: 2c0a 2020 2020 2020 6578 7472 6173 5f72  ,.      extras_r
-00024380: 6571 7569 7265 3d7b 0a20 2020 2020 2020  equire={.       
-00024390: 2020 2027 6465 7627 3a20 5b0a 2020 2020     'dev': [.    
-000243a0: 2020 2020 2020 2020 2020 2770 796c 696e            'pylin
-000243b0: 743d 3d32 2e31 3227 2c0a 2020 2020 2020  t==2.12',.      
-000243c0: 2020 2020 2020 2020 2769 7064 623d 3d30          'ipdb==0
-000243d0: 2e31 332e 2a27 0a20 2020 2020 2020 2020  .13.*'.         
-000243e0: 205d 2c0a 2020 2020 2020 2020 2020 2774   ],.          't
-000243f0: 6573 7427 3a20 5b0a 2020 2020 2020 2020  est': [.        
-00024400: 2020 2020 2020 2770 7974 6573 743d 3d36        'pytest==6
-00024410: 2e32 2e35 272c 0a20 2020 2020 2020 2020  .2.5',.         
-00024420: 2020 2020 2027 7079 7465 7374 2d63 6f76       'pytest-cov
-00024430: 3d3d 332e 302e 3027 0a20 2020 2020 2020  ==3.0.0'.       
-00024440: 2020 205d 0a20 2020 2020 207d 2c0a 2020     ].      },.  
-00024450: 2020 2020 656e 7472 795f 706f 696e 7473      entry_points
-00024460: 3d27 2727 0a20 2020 2020 2020 2020 205b  ='''.          [
-00024470: 636f 6e73 6f6c 655f 7363 7269 7074 735d  console_scripts]
-00024480: 0a20 2020 2020 2020 2020 2064 7a2d 6d6f  .          dz-mo
-00024490: 6e67 6f64 623d 647a 5f6d 6f6e 676f 6462  ngodb=dz_mongodb
-000244a0: 3a6d 6169 6e0a 2020 2020 2020 2727 272c  :main.      ''',
-000244b0: 0a20 2020 2020 2070 6163 6b61 6765 733d  .      packages=
-000244c0: 5b27 647a 5f6d 6f6e 676f 6462 272c 2027  ['dz_mongodb', '
-000244d0: 647a 5f6d 6f6e 676f 6462 2e73 796e 635f  dz_mongodb.sync_
-000244e0: 7374 7261 7465 6769 6573 275d 2c0a 290a  strategies'],.).
+00024000: 3238 206d 7469 6d65 3d31 3638 3737 3732  28 mtime=1687772
+00024010: 3038 372e 3433 3138 3034 320a 0000 0000  087.4318042.....
+00024020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000240a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000240b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000240c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000240d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000240e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000240f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000241a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000241b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000241c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000241d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000241e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000241f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024200: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00024210: 2f73 6574 7570 2e63 6667 0000 0000 0000  /setup.cfg......
+00024220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00024270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00024280: 3030 3030 3034 3600 3030 3030 3030 3030  0000046.00000000
+00024290: 3030 3000 3031 3635 3132 0020 3000 0000  000.016512. 0...
+000242a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000242b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000242c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000242d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000242e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000242f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024300: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00024310: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00024320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00024330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000243a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000243b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000243c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000243d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000243e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000243f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024400: 5b65 6767 5f69 6e66 6f5d 0a74 6167 5f62  [egg_info].tag_b
+00024410: 7569 6c64 203d 200a 7461 675f 6461 7465  uild = .tag_date
+00024420: 203d 2030 0a0a 0000 0000 0000 0000 0000   = 0............
+00024430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000244f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9306,31 +9306,31 @@
 00024590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
 00024610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00024670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00024680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00024690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
 000246a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000246b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000246c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000246d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000246e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000246f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00024710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9338,16 +9338,16 @@
 00024790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024800: 3232 206d 7469 6d65 3d31 3638 3737 3732  22 mtime=1687772
+00024810: 3038 302e 300a 0000 0000 0000 0000 0000  080.0...........
 00024820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9370,125 +9370,125 @@
 00024990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024a00: 647a 2d6d 6f6e 676f 6462 2d31 2e34 2e31  dz-mongodb-1.4.1
+00024a10: 2f73 6574 7570 2e70 7900 0000 0000 0000  /setup.py.......
 00024a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
+00024a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
+00024a80: 3030 3032 3336 3000 3030 3030 3030 3030  0002360.00000000
+00024a90: 3030 3000 3031 3634 3034 0020 3000 0000  000.016404. 0...
 00024aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024b00: 0075 7374 6172 0030 3070 6979 7573 6873  .ustar.00piyushs
+00024b10: 696e 6761 7269 7961 0000 0000 0000 0000  ingariya........
+00024b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
 00024b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000250a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000250b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000250c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000250d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000250e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024c00: 2321 2f75 7372 2f62 696e 2f65 6e76 2070  #!/usr/bin/env p
+00024c10: 7974 686f 6e0a 6672 6f6d 2073 6574 7570  ython.from setup
+00024c20: 746f 6f6c 7320 696d 706f 7274 2073 6574  tools import set
+00024c30: 7570 0a0a 7769 7468 206f 7065 6e28 2752  up..with open('R
+00024c40: 4541 444d 452e 6d64 272c 2027 7227 2920  EADME.md', 'r') 
+00024c50: 6173 2066 683a 0a20 2020 206c 6f6e 675f  as fh:.    long_
+00024c60: 6465 7363 203d 2066 682e 7265 6164 2829  desc = fh.read()
+00024c70: 0a0a 7365 7475 7028 6e61 6d65 3d27 647a  ..setup(name='dz
+00024c80: 2d6d 6f6e 676f 6462 272c 0a20 2020 2020  -mongodb',.     
+00024c90: 2076 6572 7369 6f6e 3d27 312e 342e 3127   version='1.4.1'
+00024ca0: 2c0a 2020 2020 2020 6465 7363 7269 7074  ,.      descript
+00024cb0: 696f 6e3d 2753 696e 6765 722e 696f 2074  ion='Singer.io t
+00024cc0: 6170 2066 6f72 2065 7874 7261 6374 696e  ap for extractin
+00024cd0: 6720 6461 7461 2066 726f 6d20 4d6f 6e67  g data from Mong
+00024ce0: 6f44 4220 2d20 4461 7461 7a69 7020 636f  oDB - Datazip co
+00024cf0: 6d70 6174 6962 6c65 272c 0a20 2020 2020  mpatible',.     
+00024d00: 206c 6f6e 675f 6465 7363 7269 7074 696f   long_descriptio
+00024d10: 6e3d 6c6f 6e67 5f64 6573 632c 0a20 2020  n=long_desc,.   
+00024d20: 2020 206c 6f6e 675f 6465 7363 7269 7074     long_descript
+00024d30: 696f 6e5f 636f 6e74 656e 745f 7479 7065  ion_content_type
+00024d40: 3d27 7465 7874 2f6d 6172 6b64 6f77 6e27  ='text/markdown'
+00024d50: 2c0a 2020 2020 2020 6175 7468 6f72 3d27  ,.      author='
+00024d60: 5769 7365 272c 0a20 2020 2020 2075 726c  Wise',.      url
+00024d70: 3d27 6874 7470 733a 2f2f 6769 7468 7562  ='https://github
+00024d80: 2e63 6f6d 2f64 6174 617a 6970 2f64 7a2d  .com/datazip/dz-
+00024d90: 6d6f 6e67 6f64 6227 2c0a 2020 2020 2020  mongodb',.      
+00024da0: 636c 6173 7369 6669 6572 733d 5b0a 2020  classifiers=[.  
+00024db0: 2020 2020 2020 2020 2750 726f 6772 616d          'Program
+00024dc0: 6d69 6e67 204c 616e 6775 6167 6520 3a3a  ming Language ::
+00024dd0: 2050 7974 686f 6e20 3a3a 2033 203a 3a20   Python :: 3 :: 
+00024de0: 4f6e 6c79 272c 0a20 2020 2020 2020 2020  Only',.         
+00024df0: 2027 5072 6f67 7261 6d6d 696e 6720 4c61   'Programming La
+00024e00: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
+00024e10: 203a 3a20 332e 3627 2c0a 2020 2020 2020   :: 3.6',.      
+00024e20: 2020 2020 2750 726f 6772 616d 6d69 6e67      'Programming
+00024e30: 204c 616e 6775 6167 6520 3a3a 2050 7974   Language :: Pyt
+00024e40: 686f 6e20 3a3a 2033 2e37 272c 0a20 2020  hon :: 3.7',.   
+00024e50: 2020 2020 2020 2027 5072 6f67 7261 6d6d         'Programm
+00024e60: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
+00024e70: 5079 7468 6f6e 203a 3a20 332e 3827 2c0a  Python :: 3.8',.
+00024e80: 2020 2020 2020 5d2c 0a20 2020 2020 2070        ],.      p
+00024e90: 795f 6d6f 6475 6c65 733d 5b27 647a 5f6d  y_modules=['dz_m
+00024ea0: 6f6e 676f 6462 275d 2c0a 2020 2020 2020  ongodb'],.      
+00024eb0: 696e 7374 616c 6c5f 7265 7175 6972 6573  install_requires
+00024ec0: 3d5b 0a20 2020 2020 2020 2020 2027 7069  =[.          'pi
+00024ed0: 7065 6c69 6e65 7769 7365 2d73 696e 6765  pelinewise-singe
+00024ee0: 722d 7079 7468 6f6e 3d3d 312e 2a27 2c0a  r-python==1.*',.
+00024ef0: 2020 2020 2020 2020 2020 2770 796d 6f6e            'pymon
+00024f00: 676f 3d3d 342e 332e 2a27 2c0a 2020 2020  go==4.3.*',.    
+00024f10: 2020 2020 2020 2774 7a6c 6f63 616c 3d3d        'tzlocal==
+00024f20: 322e 312e 2a27 2c0a 2020 2020 2020 2020  2.1.*',.        
+00024f30: 2020 2774 6572 6d69 6e61 6c74 6162 6c65    'terminaltable
+00024f40: 733d 3d33 2e31 2e2a 272c 0a20 2020 2020  s==3.1.*',.     
+00024f50: 2020 2020 2027 646e 7370 7974 686f 6e3d       'dnspython=
+00024f60: 3d32 2e31 2e2a 272c 0a20 2020 2020 205d  =2.1.*',.      ]
+00024f70: 2c0a 2020 2020 2020 6578 7472 6173 5f72  ,.      extras_r
+00024f80: 6571 7569 7265 3d7b 0a20 2020 2020 2020  equire={.       
+00024f90: 2020 2027 6465 7627 3a20 5b0a 2020 2020     'dev': [.    
+00024fa0: 2020 2020 2020 2020 2020 2770 796c 696e            'pylin
+00024fb0: 743d 3d32 2e31 3227 2c0a 2020 2020 2020  t==2.12',.      
+00024fc0: 2020 2020 2020 2020 2769 7064 623d 3d30          'ipdb==0
+00024fd0: 2e31 332e 2a27 0a20 2020 2020 2020 2020  .13.*'.         
+00024fe0: 205d 2c0a 2020 2020 2020 2020 2020 2774   ],.          't
+00024ff0: 6573 7427 3a20 5b0a 2020 2020 2020 2020  est': [.        
+00025000: 2020 2020 2020 2770 7974 6573 743d 3d36        'pytest==6
+00025010: 2e32 2e35 272c 0a20 2020 2020 2020 2020  .2.5',.         
+00025020: 2020 2020 2027 7079 7465 7374 2d63 6f76       'pytest-cov
+00025030: 3d3d 332e 302e 3027 0a20 2020 2020 2020  ==3.0.0'.       
+00025040: 2020 205d 0a20 2020 2020 207d 2c0a 2020     ].      },.  
+00025050: 2020 2020 656e 7472 795f 706f 696e 7473      entry_points
+00025060: 3d27 2727 0a20 2020 2020 2020 2020 205b  ='''.          [
+00025070: 636f 6e73 6f6c 655f 7363 7269 7074 735d  console_scripts]
+00025080: 0a20 2020 2020 2020 2020 2064 7a2d 6d6f  .          dz-mo
+00025090: 6e67 6f64 623d 647a 5f6d 6f6e 676f 6462  ngodb=dz_mongodb
+000250a0: 3a6d 6169 6e0a 2020 2020 2020 2727 272c  :main.      ''',
+000250b0: 0a20 2020 2020 2070 6163 6b61 6765 733d  .      packages=
+000250c0: 5b27 647a 5f6d 6f6e 676f 6462 272c 2027  ['dz_mongodb', '
+000250d0: 647a 5f6d 6f6e 676f 6462 2e73 796e 635f  dz_mongodb.sync_
+000250e0: 7374 7261 7465 6769 6573 275d 2c0a 290a  strategies'],.).
 000250f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

