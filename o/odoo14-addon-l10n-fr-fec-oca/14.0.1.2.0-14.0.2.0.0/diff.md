# Comparing `tmp/odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0-py3-none-any.whl.zip` & `tmp/odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,21 +1,21 @@
-Zip file size: 34305 bytes, number of entries: 19
--rw-r--r--  2.0 unx     4331 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/README.rst
--rw-r--r--  2.0 unx       21 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/__init__.py
--rw-r--r--  2.0 unx      844 b- defN 23-Jun-15 16:48 odoo/addons/l10n_fr_fec_oca/__manifest__.py
--rw-r--r--  2.0 unx    11105 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/i18n/fr.po
--rw-r--r--  2.0 unx     7318 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/i18n/l10n_fr_fec.pot
--rw-r--r--  2.0 unx     9927 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/i18n/l10n_fr_fec_oca.pot
--rw-r--r--  2.0 unx       86 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx     1344 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      136 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/readme/USAGE.rst
--rw-r--r--  2.0 unx      215 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/security/ir.model.access.csv
--rw-r--r--  2.0 unx     9455 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/static/description/icon.png
--rw-r--r--  2.0 unx    13851 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/static/description/index.html
--rw-r--r--  2.0 unx       33 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/wizard/__init__.py
--rw-r--r--  2.0 unx    23459 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py
--rw-r--r--  2.0 unx     5823 b- defN 23-Jun-15 16:47 odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca_view.xml
--rw-r--r--  2.0 unx     4988 b- defN 23-Jun-15 16:48 odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jun-15 16:48 odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Jun-15 16:48 odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1985 b- defN 23-Jun-15 16:48 odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/RECORD
-19 files, 95018 bytes uncompressed, 30905 bytes compressed:  67.5%
+Zip file size: 33316 bytes, number of entries: 19
+-rw-r--r--  2.0 unx     4331 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/README.rst
+-rw-r--r--  2.0 unx       21 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/__init__.py
+-rw-r--r--  2.0 unx      876 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/__manifest__.py
+-rw-r--r--  2.0 unx     7527 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/i18n/fr.po
+-rw-r--r--  2.0 unx     6528 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/i18n/l10n_fr_fec_oca.pot
+-rw-r--r--  2.0 unx       86 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx     1344 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      136 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/readme/USAGE.rst
+-rw-r--r--  2.0 unx      215 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/security/ir.model.access.csv
+-rw-r--r--  2.0 unx      633 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/security/ir_rule.xml
+-rw-r--r--  2.0 unx     9455 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/static/description/icon.png
+-rw-r--r--  2.0 unx    13851 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/static/description/index.html
+-rw-r--r--  2.0 unx       33 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/wizard/__init__.py
+-rw-r--r--  2.0 unx    24633 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py
+-rw-r--r--  2.0 unx     1941 b- defN 23-Jun-26 10:51 odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca_view.xml
+-rw-r--r--  2.0 unx     4988 b- defN 23-Jun-26 10:51 odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-26 10:51 odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jun-26 10:51 odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     1983 b- defN 23-Jun-26 10:51 odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/RECORD
+19 files, 78678 bytes uncompressed, 29916 bytes compressed:  62.0%
```

## zipnote {}

```diff
@@ -6,17 +6,14 @@
 
 Filename: odoo/addons/l10n_fr_fec_oca/__manifest__.py
 Comment: 
 
 Filename: odoo/addons/l10n_fr_fec_oca/i18n/fr.po
 Comment: 
 
-Filename: odoo/addons/l10n_fr_fec_oca/i18n/l10n_fr_fec.pot
-Comment: 
-
 Filename: odoo/addons/l10n_fr_fec_oca/i18n/l10n_fr_fec_oca.pot
 Comment: 
 
 Filename: odoo/addons/l10n_fr_fec_oca/readme/CONTRIBUTORS.rst
 Comment: 
 
 Filename: odoo/addons/l10n_fr_fec_oca/readme/DESCRIPTION.rst
@@ -24,14 +21,17 @@
 
 Filename: odoo/addons/l10n_fr_fec_oca/readme/USAGE.rst
 Comment: 
 
 Filename: odoo/addons/l10n_fr_fec_oca/security/ir.model.access.csv
 Comment: 
 
+Filename: odoo/addons/l10n_fr_fec_oca/security/ir_rule.xml
+Comment: 
+
 Filename: odoo/addons/l10n_fr_fec_oca/static/description/icon.png
 Comment: 
 
 Filename: odoo/addons/l10n_fr_fec_oca/static/description/index.html
 Comment: 
 
 Filename: odoo/addons/l10n_fr_fec_oca/wizard/__init__.py
@@ -39,20 +39,20 @@
 
 Filename: odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py
 Comment: 
 
 Filename: odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca_view.xml
 Comment: 
 
-Filename: odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/METADATA
+Filename: odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/WHEEL
+Filename: odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/top_level.txt
+Filename: odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/RECORD
+Filename: odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/l10n_fr_fec_oca/__manifest__.py

```diff
@@ -2,23 +2,24 @@
 # @author: Alexis de Lattre <alexis.delattre@akretion.com>
 # Copyright 2016-2020 Odoo SA (https://www.odoo.com/fr_FR/)
 # @author: Alexis de Lattre <alexis.delattre@akretion.com>
 
 {
     "name": "France - FEC",
     "category": "Accounting",
-    "version": "14.0.1.2.0",
+    "version": "14.0.2.0.0",
     "license": "LGPL-3",
     "summary": "Fichier d'Échange Informatisé (FEC) for France",
     "author": "Akretion,Odoo Community Association (OCA)",
     "maintainers": ["alexis-via"],
     "website": "https://github.com/OCA/l10n-france",
     "depends": ["l10n_fr", "account", "date_range"],
     "external_dependencies": {
         "python": ["unicodecsv", "unidecode"],
     },
     "data": [
         "security/ir.model.access.csv",
+        "security/ir_rule.xml",
         "wizard/account_fr_fec_oca_view.xml",
     ],
     "installable": True,
 }
```

## odoo/addons/l10n_fr_fec_oca/i18n/fr.po

```diff
@@ -1,175 +1,73 @@
-# Translation of OpenERP Server.
+# Translation of Odoo Server.
 # This file contains the translation of the following modules:
-# 	* l10n_fr_fec
+# 	* l10n_fr_fec_oca
 #
 msgid ""
 msgstr ""
-"Project-Id-Version: OpenERP Server 7.0\n"
+"Project-Id-Version: Odoo Server 14.0\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2018-09-17 13:45+0000\n"
-"PO-Revision-Date: 2021-05-14 18:47+0000\n"
-"Last-Translator: Yves Le Doeuff <yld@alliasys.fr>\n"
+"POT-Creation-Date: 2023-06-16 13:04+0000\n"
+"PO-Revision-Date: 2023-06-16 13:04+0000\n"
+"Last-Translator: \n"
 "Language-Team: \n"
-"Language: fr\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: \n"
-"Plural-Forms: nplurals=2; plural=n > 1;\n"
-"X-Generator: Weblate 4.3.2\n"
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 10"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 11"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 12"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 13"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 14"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 15"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 16"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 17"
-msgstr ""
+"Plural-Forms: \n"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__encoding__ascii
 msgid "ASCII"
-msgstr ""
+msgstr "ASCII"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__partner_account_type_ids
 msgid "Account Types"
 msgstr "Types de comptes"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__partner_account_ids
 msgid "Accounts"
 msgstr "Comptes"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__partner_option__all
 msgid "All"
-msgstr "Tout"
+msgstr "Tous"
 
 #. module: l10n_fr_fec_oca
 #: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
 msgid "Cancel"
 msgstr "Annuler"
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Column"
-msgstr "Colonne"
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Comment"
-msgstr "Commentaire"
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "CompAuxLib"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "CompAuxNum"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "CompteLib"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "CompteNum"
-msgstr ""
+#: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__company_id
+msgid "Company"
+msgstr "Société"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__create_uid
 msgid "Created by"
 msgstr "Créé par"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__create_date
 msgid "Created on"
 msgstr "Créé le"
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Credit"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__date_range_id
 msgid "Date Range"
 msgstr "Période"
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "DateLet"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Debit"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__display_name
 msgid "Display Name"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "EcritureDate"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "EcritureLet"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "EcritureLib"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "EcritureNum"
-msgstr ""
+msgstr "Nom affiché"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__encoding
 msgid "Encoding"
 msgstr "Encodage"
 
 #. module: l10n_fr_fec_oca
@@ -181,187 +79,133 @@
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__export_type
 msgid "Export Type"
 msgstr "Type d'export"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.actions.act_window,name:l10n_fr_fec_oca.account_fr_fec_oca_action
 #: model:ir.ui.menu,name:l10n_fr_fec_oca.account_fr_fec_oca_menu
-msgid "FEC"
-msgstr ""
+msgid "FEC (OCA)"
+msgstr "FEC (OCA)"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__fec_data
 msgid "FEC File"
 msgstr "Fichier FEC"
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "FEC File Generation by OCA"
-msgstr "Génération Fichier FEC (OCA)"
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model,name:l10n_fr_fec_oca.model_account_fr_fec_oca
 msgid "Ficher Echange Informatise"
 msgstr "Fichier Echange Informatise"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__delimiter
 msgid "Field Delimiter"
 msgstr "Séparateur de champ"
 
 #. module: l10n_fr_fec_oca
+#: model:ir.model.fields,help:l10n_fr_fec_oca.field_account_fr_fec_oca__partner_identifier
+msgid ""
+"Field on partner used for the column CompAuxNum. If you select 'Reference', "
+"make sure all partners used in journal items have a Reference and that this "
+"reference is unique."
+msgstr ""
+"Champ du partenaire utilisé pour la colonne CompAuxNum. Si vous sélectionnez"
+" \"Référence\", assurez-vous que tous les partenaires utilisés dans les "
+"écritures comptables ont une référence et que cette référence est unique."
+
+#. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__filename
 msgid "Filename"
 msgstr "Nom du fichier"
 
 #. module: l10n_fr_fec_oca
 #: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
 msgid "Generate"
 msgstr "Générer"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__id
+#: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__partner_identifier__id
 msgid "ID"
-msgstr ""
+msgstr "ID"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__encoding__iso8859_15
 msgid "ISO-8859-15"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Idevise"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "JournalCode"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "JournalLib"
-msgstr ""
+msgstr "ISO-8859-15"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca____last_update
 msgid "Last Modified on"
-msgstr ""
+msgstr "Dernière modification le"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__write_uid
 msgid "Last Updated by"
-msgstr ""
+msgstr "Dernière mise à jour par"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__write_date
 msgid "Last Updated on"
-msgstr ""
+msgstr "Dernière mise à jour le"
 
 #. module: l10n_fr_fec_oca
 #: code:addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py:0
 #, python-format
 msgid "Missing SIRET on company %s."
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Montantdevise"
-msgstr ""
+msgstr "SIRET manquant sur la société %s."
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__export_type__nonofficial
 msgid "Non-official FEC report (posted and draft entries)"
-msgstr ""
+msgstr "Rapport FEC non officiel (écritures comptabilisées et brouillons)"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__export_type__official
 msgid "Official FEC report (posted entries only)"
-msgstr "Rapport FEC officiel (entrées postées uniquement)"
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Options"
-msgstr ""
+msgstr "Rapport FEC officiel (écritures comptabilisées uniquement)"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__partner_option
 msgid "Partner Export Option"
-msgstr "Option d'export du partenaire"
+msgstr "Option d'export pour le partenaire"
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "PieceDate"
-msgstr ""
+#: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__partner_identifier
+msgid "Partner Identifier"
+msgstr "Identifiant du partenaire"
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "PieceRef"
-msgstr ""
+#: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__partner_identifier__ref
+msgid "Reference"
+msgstr "Référence"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__partner_option__types
 msgid "Selected Account Types"
-msgstr "Types de comptes sélectionnés"
+msgstr "Types de compte sélectionnés"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__partner_option__accounts
 msgid "Selected Accounts"
 msgstr "Comptes sélectionnés"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__date_from
 msgid "Start Date"
 msgstr "Date de début"
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__delimiter__tab
 msgid "Tab"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Technical Info"
-msgstr "Info technique"
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Technical Name"
-msgstr "Nom technique"
+msgstr "Tabulation"
 
 #. module: l10n_fr_fec_oca
 #: code:addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py:0
 #, python-format
 msgid "The start date must be before the end date."
-msgstr ""
+msgstr "La date de début doit être antérieure à la date de fin."
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__encoding__utf-8
 msgid "UTF-8"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "ValidDate"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "We use partner.ref (w/ fallback on 'ID' + partner.id)"
-msgstr ""
-
-#~ msgid "Non-official FEC report (posted and unposted entries)"
-#~ msgstr "Rapport FEC non-officiel (entrées postées et non-postées)"
-
-#~ msgid "FEC is for French companies only !"
-#~ msgstr "Le FEC est uniquement pour les sociétés françaises !"
-
-#~ msgid "Missing VAT number for company %s"
-#~ msgstr "Numéro de TVA manquant sur la société %s"
-
-#~ msgid ""
-#~ "The encoding of this text file is UTF-8. The structure of file is CSV "
-#~ "separated by pipe '|'."
-#~ msgstr ""
-#~ "Ce fichier texte est encodé en UTF-8. Le format du fichier est CSV avec "
-#~ "séparateur '|'."
+msgstr "UTF-8"
```

## odoo/addons/l10n_fr_fec_oca/i18n/l10n_fr_fec_oca.pot

```diff
@@ -10,54 +10,14 @@
 "Language-Team: \n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: \n"
 "Plural-Forms: \n"
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 10"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 11"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 12"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 13"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 14"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 15"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 16"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "# 17"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__encoding__ascii
 msgid "ASCII"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__partner_account_type_ids
 msgid "Account Types"
@@ -75,99 +35,39 @@
 
 #. module: l10n_fr_fec_oca
 #: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
 msgid "Cancel"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Column"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Comment"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "CompAuxLib"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "CompAuxNum"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "CompteLib"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "CompteNum"
+#: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__company_id
+msgid "Company"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__create_uid
 msgid "Created by"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__create_date
 msgid "Created on"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Credit"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__date_range_id
 msgid "Date Range"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "DateLet"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Debit"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__display_name
 msgid "Display Name"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "EcritureDate"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "EcritureLet"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "EcritureLib"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "EcritureNum"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__encoding
 msgid "Encoding"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__date_to
 msgid "End Date"
@@ -177,73 +77,62 @@
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__export_type
 msgid "Export Type"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.actions.act_window,name:l10n_fr_fec_oca.account_fr_fec_oca_action
 #: model:ir.ui.menu,name:l10n_fr_fec_oca.account_fr_fec_oca_menu
-msgid "FEC"
+msgid "FEC (OCA)"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__fec_data
 msgid "FEC File"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "FEC File Generation by OCA"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model,name:l10n_fr_fec_oca.model_account_fr_fec_oca
 msgid "Ficher Echange Informatise"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__delimiter
 msgid "Field Delimiter"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
+#: model:ir.model.fields,help:l10n_fr_fec_oca.field_account_fr_fec_oca__partner_identifier
+msgid ""
+"Field on partner used for the column CompAuxNum. If you select 'Reference', "
+"make sure all partners used in journal items have a Reference and that this "
+"reference is unique."
+msgstr ""
+
+#. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__filename
 msgid "Filename"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
 msgid "Generate"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__id
+#: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__partner_identifier__id
 msgid "ID"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__encoding__iso8859_15
 msgid "ISO-8859-15"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Idevise"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "JournalCode"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "JournalLib"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca____last_update
 msgid "Last Modified on"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__write_uid
 msgid "Last Updated by"
@@ -257,46 +146,36 @@
 #. module: l10n_fr_fec_oca
 #: code:addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py:0
 #, python-format
 msgid "Missing SIRET on company %s."
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Montantdevise"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__export_type__nonofficial
 msgid "Non-official FEC report (posted and draft entries)"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__export_type__official
 msgid "Official FEC report (posted entries only)"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Options"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__partner_option
 msgid "Partner Export Option"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "PieceDate"
+#: model:ir.model.fields,field_description:l10n_fr_fec_oca.field_account_fr_fec_oca__partner_identifier
+msgid "Partner Identifier"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "PieceRef"
+#: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__partner_identifier__ref
+msgid "Reference"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__partner_option__types
 msgid "Selected Account Types"
 msgstr ""
 
@@ -312,36 +191,16 @@
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__delimiter__tab
 msgid "Tab"
 msgstr ""
 
 #. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Technical Info"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "Technical Name"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
 #: code:addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py:0
 #, python-format
 msgid "The start date must be before the end date."
 msgstr ""
 
 #. module: l10n_fr_fec_oca
 #: model:ir.model.fields.selection,name:l10n_fr_fec_oca.selection__account_fr_fec_oca__encoding__utf-8
 msgid "UTF-8"
 msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "ValidDate"
-msgstr ""
-
-#. module: l10n_fr_fec_oca
-#: model_terms:ir.ui.view,arch_db:l10n_fr_fec_oca.account_fr_fec_oca_form
-msgid "We use partner.ref (w/ fallback on 'ID' + partner.id)"
-msgstr ""
```

## odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py

```diff
@@ -13,15 +13,15 @@
 # pylint: skip-file
 
 import base64
 import io
 import logging
 
 from odoo import _, api, fields, models
-from odoo.exceptions import UserError
+from odoo.exceptions import AccessDenied, UserError
 from odoo.tools import float_is_zero
 
 logger = logging.getLogger(__name__)
 
 try:
     from unidecode import unidecode
 except ImportError:
@@ -31,26 +31,34 @@
 except ImportError:
     logger.debug("Cannot import unicodecsv")
 
 
 class AccountFrFecOca(models.TransientModel):
     _name = "account.fr.fec.oca"
     _description = "Ficher Echange Informatise"
+    _check_company_auto = True
 
-    date_range_id = fields.Many2one("date.range", string="Date Range")
+    company_id = fields.Many2one(
+        "res.company",
+        ondelete="cascade",
+        required=True,
+        default=lambda self: self.env.company,
+    )
+    date_range_id = fields.Many2one(
+        "date.range",
+        domain="['|', ('company_id', '=', False), ('company_id', '=', company_id)]",
+    )
     date_from = fields.Date(string="Start Date", required=True)
     date_to = fields.Date(string="End Date", required=True)
     encoding = fields.Selection(
         [
             ("iso8859_15", "ISO-8859-15"),
             ("utf-8", "UTF-8"),
-            # ('cp500', 'EBCDIC'),
             ("ascii", "ASCII"),
         ],
-        string="Encoding",
         default="iso8859_15",
         required=True,
     )
     delimiter = fields.Selection(
         [
             ("|", "|"),
             ("tab", "Tab"),
@@ -73,24 +81,36 @@
         "account.account.type",
         string="Account Types",
         default=lambda self: self._default_partner_account_type_ids(),
     )
     partner_account_ids = fields.Many2many(
         "account.account",
         string="Accounts",
+        check_company=True,
+        domain="[('company_id', '=', company_id)]",
         default=lambda self: self._default_partner_account_ids(),
     )
+    partner_identifier = fields.Selection(
+        [
+            ("id", "ID"),
+            ("ref", "Reference"),
+        ],
+        required=True,
+        default="id",
+        help="Field on partner used for the column CompAuxNum. If you select "
+        "'Reference', make sure all partners used in journal items have a Reference "
+        "and that this reference is unique.",
+    )
     fec_data = fields.Binary("FEC File", readonly=True, attachment=True)
-    filename = fields.Char(string="Filename", size=256, readonly=True)
+    filename = fields.Char(size=256, readonly=True)
     export_type = fields.Selection(
         [
             ("official", "Official FEC report (posted entries only)"),
             ("nonofficial", "Non-official FEC report (posted and draft entries)"),
         ],
-        string="Export Type",
         required=True,
         default="official",
     )
 
     @api.onchange("date_range_id")
     def date_range_change(self):
         if self.date_range_id:
@@ -107,15 +127,15 @@
     def _default_partner_account_ids(self):
         pay = self.env["ir.property"]._get("property_account_payable_id", "res.partner")
         rec = self.env["ir.property"]._get(
             "property_account_receivable_id", "res.partner"
         )
         return pay + rec
 
-    def do_query_unaffected_earnings(self):
+    def _do_query_unaffected_earnings(self):
         """Compute the sum of ending balances for all accounts that are
         of a type that does not bring forward the balance in new fiscal years.
         This is needed because we have to display only one line for the initial
         balance of all expense/revenue accounts in the FEC.
         """
         # BENEFIT and LOSS
         sql_query = """
@@ -158,15 +178,15 @@
             AND (aml.debit != 0 OR aml.credit != 0)
         """
         # For official report: only use posted entries
         if self.export_type == "official":
             sql_query += " AND am.state = 'posted' "
         else:
             sql_query += " AND am.state IN ('draft', 'posted') "
-        company = self.env.company
+        company = self.company_id
         formatted_date_from = fields.Date.to_string(self.date_from).replace("-", "")
         date_from = self.date_from
         formatted_date_year = date_from.year
         self._cr.execute(
             sql_query,
             {
                 "formatted_date_year": formatted_date_year,
@@ -189,88 +209,95 @@
         # so that it also work on companies that are not subject to VAT
         if not company.siret:
             raise UserError(_("Missing SIRET on company %s.") % company.display_name)
         siren = company.siret[:9]
         return siren
 
     def _get_aux_fields(self, sql_args):
-        sql_aux_num_base = """
-        CASE WHEN rp.ref IS null OR rp.ref = ''
-        THEN COALESCE('ID' || rp.id, '')
-        ELSE replace(rp.ref, '|', '/')
-        END
-        """
-        sql_aux_lib_base = """
-        COALESCE(replace(replace(rp.name, '|', '/'), '\t', ''), '')
+        aux_dict = {
+            "auxlib": """
+        COALESCE(REGEXP_REPLACE(replace(rp.name, '|', '/'), '[\\t\\r\\n]', ' ', 'g'), '')
         """
+        }
+        if self.partner_identifier == "ref":
+            aux_dict[
+                "auxnum"
+            ] = """
+            CASE WHEN rp.ref IS null OR rp.ref = ''
+            THEN COALESCE('ID' || rp.id, '')
+            ELSE REGEXP_REPLACE(replace(rp.ref, '|', '/'), '[\\t\\r\\n]', ' ', 'g')
+            END
+            """
+        else:
+            aux_dict["auxnum"] = """rp.id::text"""
+
         if self.partner_option == "types":
             sql_args["partner_account_type_ids"] = tuple(
                 self.partner_account_type_ids.ids
             )
-            return (
+            aux_sql = (
                 """
-            case when aat.id in %(partner_account_type_ids)s
-            then """
-                + sql_aux_num_base
-                + """
-            else ''
-            end
-            as CompAuxNum,
-            case when aat.id in %(partner_account_type_ids)s
-            then """
-                + sql_aux_lib_base
-                + """
-            else ''
-            end
-            as CompAuxLib,
+            CASE WHEN aat.id IN %%(partner_account_type_ids)s
+            THEN %(auxnum)s
+            ELSE ''
+            END
+            AS CompAuxNum,
+            CASE WHEN aat.id IN %%(partner_account_type_ids)s
+            THEN %(auxlib)s
+            ELSE ''
+            END
+            AS CompAuxLib,
             """
+                % aux_dict
             )
         elif self.partner_option == "accounts":
             sql_args["partner_account_ids"] = tuple(self.partner_account_ids.ids)
-            return (
+            aux_sql = (
                 """
-            CASE WHEN aa.id IN %(partner_account_ids)s
-            THEN """
-                + sql_aux_num_base
-                + """
+            CASE WHEN aa.id IN %%(partner_account_ids)s
+            THEN %(auxnum)s
             ELSE ''
             END
             AS CompAuxNum,
-            CASE WHEN aa.id IN %(partner_account_ids)s
-            THEN """
-                + sql_aux_lib_base
-                + """
+            CASE WHEN aa.id IN %%(partner_account_ids)s
+            THEN %(auxlib)s
             ELSE ''
             END
             AS CompAuxLib,
             """
+                % aux_dict
             )
         else:
-            return (
-                sql_aux_num_base
-                + "AS CompAuxNum, "
-                + sql_aux_lib_base
-                + "AS CompAuxLib,"
+            aux_sql = (
+                """
+            %(auxnum)s AS CompAuxNum, %(auxlib)s AS CompAuxLib,
+            """
+                % aux_dict
             )
+        return aux_sql
 
     # flake8: noqa: C901
     def generate_fec(self):
         self.ensure_one()
+        if not (
+            self.env.is_admin() or self.env.user.has_group("account.group_account_user")
+        ):
+            raise AccessDenied()
         # We choose to implement the flat file instead of the XML
         # file for 2 reasons :
         # 1) the XSD file impose to have the label on the account.move
         # but Odoo has the label on the account.move.line, so that's a
         # problem !
         # 2) CSV files are easier to read/use for a regular accountant.
         # So it will be easier for the accountant to check the file before
         # sending it to the fiscal administration
         if self.date_from >= self.date_to:
             raise UserError(_("The start date must be before the end date."))
 
-        company = self.env.company
+        company = self.company_id
 
         header = [
             "JournalCode",  # 0
             "JournalLib",  # 1
             "EcritureNum",  # 2
             "EcritureDate",  # 3
             "CompteNum",  # 4
@@ -293,15 +320,15 @@
         unaffected_earnings_xml_ref = self.env.ref("account.data_unaffected_earnings")
         # used to make sure that we add the unaffected earning initial balance
         # only once
         unaffected_earnings_line = True
         if unaffected_earnings_xml_ref:
             # compute the benefit/loss of last year to add in the
             # initial balance of the current year earnings account
-            unaffected_earnings_results = self.do_query_unaffected_earnings()
+            unaffected_earnings_results = self._do_query_unaffected_earnings()
             unaffected_earnings_line = False
 
         # INITIAL BALANCE other than payable/receivable
         sql_query = """
         SELECT
             'OUV' AS JournalCode,
             'Balance initiale' AS JournalLib,
@@ -482,33 +509,32 @@
             account_id = listrow.pop()
             rows_to_write.append(listrow)
 
         # LINES
         sql_query = (
             """
         SELECT
-            replace(replace(aj.code, '|', '/'), '\t', '') AS JournalCode,
-            replace(replace(aj.name, '|', '/'), '\t', '') AS JournalLib,
-            replace(replace(am.name, '|', '/'), '\t', '') AS EcritureNum,
+            REGEXP_REPLACE(replace(aj.code, '|', '/'), '[\\t\\r\\n]', ' ', 'g') AS JournalCode,
+            REGEXP_REPLACE(replace(aj.name, '|', '/'), '[\\t\\r\\n]', ' ', 'g') AS JournalLib,
+            REGEXP_REPLACE(replace(am.name, '|', '/'), '[\\t\\r\\n]', ' ', 'g') AS EcritureNum,
             TO_CHAR(am.date, 'YYYYMMDD') AS EcritureDate,
             aa.code AS CompteNum,
-            replace(replace(aa.name, '|', '/'), '\t', '') AS CompteLib,
+            REGEXP_REPLACE(replace(aa.name, '|', '/'), '[\\t\\r\\n]', ' ', 'g') AS CompteLib,
         """
             + aux_fields
             + """
             CASE
                 WHEN am.ref IS null OR am.ref = ''
                 THEN '-'
-                ELSE replace(replace(am.ref, '|', '/'), '\t', '')
+                ELSE REGEXP_REPLACE(replace(am.ref, '|', '/'), '[\\t\\r\\n]', ' ', 'g')
             END AS PieceRef,
             TO_CHAR(am.date, 'YYYYMMDD') AS PieceDate,
             CASE WHEN aml.name IS NULL OR aml.name = '' THEN '/'
-                WHEN aml.name SIMILAR TO '[\t|\\s|\n]*' THEN '/'
-                ELSE replace(replace(replace(replace(
-                aml.name, '|', '/'), '\t', ''), '\n', ''), '\r', '')
+                WHEN aml.name SIMILAR TO '[\\t|\\s|\\n]*' THEN '/'
+                ELSE REGEXP_REPLACE(replace(aml.name, '|', '/'), '[\\t\\n\\r]', ' ', 'g')
             END AS EcritureLib,
             replace(
                 CASE WHEN aml.debit = 0
                 THEN '0,00'
                 ELSE to_char(aml.debit, '000000000000000D99')
                 END, '.', ',') AS Debit,
             replace(
@@ -523,21 +549,21 @@
             CASE
                 WHEN aml.full_reconcile_id IS NULL
                 THEN ''
                 ELSE TO_CHAR(rec.create_date, 'YYYYMMDD')
             END AS DateLet,
             TO_CHAR(am.date, 'YYYYMMDD') AS ValidDate,
             CASE
-                WHEN aml.amount_currency IS NULL OR aml.amount_currency = 0
+                WHEN aml.currency_id IS NULL OR aml.currency_id = aml.company_currency_id OR aml.amount_currency IS NULL OR aml.amount_currency = 0
                 THEN ''
                 ELSE replace(to_char(
                     aml.amount_currency, '000000000000000D99'), '.', ',')
             END AS Montantdevise,
             CASE
-                WHEN aml.currency_id IS NULL
+                WHEN aml.currency_id IS NULL OR aml.currency_id = aml.company_currency_id OR aml.amount_currency IS NULL OR aml.amount_currency = 0
                 THEN ''
                 ELSE rc.name
             END AS Idevise
         FROM
             account_move_line aml
             LEFT JOIN account_move am ON am.id=aml.move_id
             LEFT JOIN res_partner rp ON rp.id=aml.partner_id
@@ -579,15 +605,15 @@
             suffix = "-NONOFFICIAL"
 
         siren = self._get_siren(company)
         self.write(
             {
                 "fec_data": base64.encodebytes(fecvalue),
                 # Filename = <siren>FECYYYYMMDD where YYYMMDD is the closing date
-                "filename": "{}FEC{}{}.txt".format(siren, end_date, suffix),
+                "filename": "%sFEC%s%s.txt" % (siren, end_date, suffix),
             }
         )
 
         action = {
             "name": "FEC",
             "type": "ir.actions.act_url",
             "url": "web/content/?model=%s&id=%d&filename_field=filename&"
```

## odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca_view.xml

### odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca_view.xml

```diff
@@ -1,121 +1,35 @@
 <?xml version="1.0" encoding="utf-8"?>
 <odoo>
   <record id="account_fr_fec_oca_form" model="ir.ui.view">
     <field name="name">account.fr.fec.oca.form</field>
     <field name="model">account.fr.fec.oca</field>
     <field name="arch" type="xml">
-      <form string="FEC File Generation by OCA">
-        <notebook>
-          <page string="Options">
-            <group>
-              <field name="date_range_id"/>
-              <field name="date_from"/>
-              <field name="date_to"/>
-              <field name="export_type"/>
-              <field name="encoding"/>
-              <field name="delimiter"/>
-              <field name="partner_option" widget="radio"/>
-              <field name="partner_account_type_ids" widget="many2many_tags" attrs="{'invisible': [('partner_option', '!=', 'types')], 'required': [('partner_option', '=', 'types')]}"/>
-              <field name="partner_account_ids" widget="many2many_tags" attrs="{'invisible': [('partner_option', '!=', 'accounts')], 'required': [('partner_option', '=', 'accounts')]}"/>
-            </group>
-          </page>
-          <page string="Technical Info">
-            <group>
-              <table style="width:80%">
-                <tr>
-                  <th>Technical Name</th>
-                  <th>Column</th>
-                  <th>Comment</th>
-                </tr>
-                <tr>
-                  <td>JournalCode</td>
-                  <td># 0</td>
-                </tr>
-                <tr>
-                  <td>JournalLib</td>
-                  <td># 1</td>
-                </tr>
-                <tr>
-                  <td>EcritureNum</td>
-                  <td># 2</td>
-                </tr>
-                <tr>
-                  <td>EcritureDate</td>
-                  <td># 3</td>
-                </tr>
-                <tr>
-                  <td>CompteNum</td>
-                  <td># 4</td>
-                </tr>
-                <tr>
-                  <td>CompteLib</td>
-                  <td># 5</td>
-                </tr>
-                <tr>
-                  <td>CompAuxNum</td>
-                  <td># 6</td>
-                  <td>We use partner.ref (w/ fallback on 'ID' + partner.id)</td>
-                </tr>
-                <tr>
-                  <td>CompAuxLib</td>
-                  <td># 7</td>
-                </tr>
-                <tr>
-                  <td>PieceRef</td>
-                  <td># 8</td>
-                </tr>
-                <tr>
-                  <td>PieceDate</td>
-                  <td># 9</td>
-                </tr>
-                <tr>
-                  <td>EcritureLib</td>
-                  <td># 10</td>
-                </tr>
-                <tr>
-                  <td>Debit</td>
-                  <td># 11</td>
-                </tr>
-                <tr>
-                  <td>Credit</td>
-                  <td># 12</td>
-                </tr>
-                <tr>
-                  <td>EcritureLet</td>
-                  <td># 13</td>
-                </tr>
-                <tr>
-                  <td>DateLet</td>
-                  <td># 14</td>
-                </tr>
-                <tr>
-                  <td>ValidDate</td>
-                  <td># 15</td>
-                </tr>
-                <tr>
-                  <td>Montantdevise</td>
-                  <td># 16</td>
-                </tr>
-                <tr>
-                  <td>Idevise</td>
-                  <td># 17</td>
-                </tr>
-              </table>
-            </group>
-          </page>
-        </notebook>
+      <form>
+        <group>
+          <field name="company_id" groups="base.group_multi_company"/>
+          <field name="company_id" invisible="1"/>
+          <field name="date_range_id"/>
+          <field name="date_from"/>
+          <field name="date_to"/>
+          <field name="export_type"/>
+          <field name="encoding"/>
+          <field name="delimiter"/>
+          <field name="partner_option" widget="radio"/>
+          <field name="partner_account_ids" widget="many2many_tags" attrs="{'invisible': [('partner_option', '!=', 'accounts')], 'required': [('partner_option', '=', 'accounts')]}"/>
+          <field name="partner_identifier" widget="radio"/>
+        </group>
         <footer>
           <button string="Generate" name="generate_fec" type="object" class="btn-primary"/>
           <button string="Cancel" class="btn btn-secondary" special="cancel"/>
         </footer>
       </form>
     </field>
   </record>
   <record id="account_fr_fec_oca_action" model="ir.actions.act_window">
-    <field name="name">FEC</field>
+    <field name="name">FEC (OCA)</field>
     <field name="res_model">account.fr.fec.oca</field>
     <field name="view_mode">form</field>
     <field name="target">new</field>
   </record>
   <menuitem id="account_fr_fec_oca_menu" parent="l10n_fr.account_reports_fr_statements_menu" action="account_fr_fec_oca_action" sequence="110"/>
 </odoo>
```

## Comparing `odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/METADATA` & `odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo14-addon-l10n-fr-fec-oca
-Version: 14.0.1.2.0
+Version: 14.0.2.0.0
 Summary: Fichier d'Échange Informatisé (FEC) for France
 Home-page: https://github.com/OCA/l10n-france
 Author: Akretion,Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: LGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/RECORD` & `odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/RECORD`

 * *Files 14% similar despite different names*

```diff
@@ -1,19 +1,19 @@
 odoo/addons/l10n_fr_fec_oca/README.rst,sha256=Re3BB77jyaryZwHXoQ1QyztBkgSCbHrVKvPj7-zIoH8,4331
 odoo/addons/l10n_fr_fec_oca/__init__.py,sha256=jI5PZDKS0aV-yXubn1o0DHe5ldzQZrLmZYbgF0Q7DWg,21
-odoo/addons/l10n_fr_fec_oca/__manifest__.py,sha256=NnnTTWkiB5fNak1dUyJUuHLxuAcjdVuI8DkS6SwbimA,844
-odoo/addons/l10n_fr_fec_oca/i18n/fr.po,sha256=5LR0fgN1pCk62b4PCYu45g6zOZ-WU74tvx87HDc8ZP8,11105
-odoo/addons/l10n_fr_fec_oca/i18n/l10n_fr_fec.pot,sha256=vPbUHWkHbcrKYEARorxgC8ENHSZGi7GzrIQB89HO8vM,7318
-odoo/addons/l10n_fr_fec_oca/i18n/l10n_fr_fec_oca.pot,sha256=Z8JhkmUL9nlBHKvMAA1hiEfZGagGe-3oGh0-7R2LpYk,9927
+odoo/addons/l10n_fr_fec_oca/__manifest__.py,sha256=LZpZLWptXLbwL1jXrWcvnkVwqw9qdShkZPyLGFhB5Lw,876
+odoo/addons/l10n_fr_fec_oca/i18n/fr.po,sha256=YZlC0t-RAIAQq4nIHkAkr4yBsl_HvrFrkKQs9fqXYIM,7527
+odoo/addons/l10n_fr_fec_oca/i18n/l10n_fr_fec_oca.pot,sha256=Dtp2lWMCwxytc-uUpSCUds9R5NGvrFBKlosg_2MwyP4,6528
 odoo/addons/l10n_fr_fec_oca/readme/CONTRIBUTORS.rst,sha256=KC_8iSJlIHR7lfhH3Z9WRCPtaUFjVA7qr86HDdsGPcs,86
 odoo/addons/l10n_fr_fec_oca/readme/DESCRIPTION.rst,sha256=-esDPu8L8iQTiDuVunV_hgKUKVhKJPE05SJMcSzOlr0,1344
 odoo/addons/l10n_fr_fec_oca/readme/USAGE.rst,sha256=C2V1480tggXuqsBMwgF96-vo1CdZfblint_pngL3O58,136
 odoo/addons/l10n_fr_fec_oca/security/ir.model.access.csv,sha256=fPX_aD3wHT5pSVvXnZ8MjVA_YoygpXWcDEFZpaADVss,215
+odoo/addons/l10n_fr_fec_oca/security/ir_rule.xml,sha256=lOwj_8avgYR1XczjzTVuOsEoKevRoOow_5mc00pzRmo,633
 odoo/addons/l10n_fr_fec_oca/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/l10n_fr_fec_oca/static/description/index.html,sha256=i4bicjvLQ9MDbabU0lj9nzyRRFmoFp3sQKIupMp5uWM,13851
 odoo/addons/l10n_fr_fec_oca/wizard/__init__.py,sha256=fbQd41ELqGqrQXq76xFSqD4Qn5eTh49leHlTKSzJvyI,33
-odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py,sha256=6h7pQ2nZZWyDssLAqBaMpblap2-gt51VQ3r7GnUqav4,23459
-odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca_view.xml,sha256=EjqpSHOSy0Ot6I9RnVkgi7wDZ86wcz6WpvG6CjKf0Zk,5823
-odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/METADATA,sha256=eMvYQD1uPD9QBzROv-s_FoekmOwe_OWVpEm56W9gfIw,4988
-odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo14_addon_l10n_fr_fec_oca-14.0.1.2.0.dist-info/RECORD,,
+odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca.py,sha256=TVInXHj28POOKtBS4HDj6m7Xh_pqKgu26ZtVclYSnF0,24633
+odoo/addons/l10n_fr_fec_oca/wizard/account_fr_fec_oca_view.xml,sha256=5J9nIFqVi8lcK76ExwmaWgx9EDXtfkwjo8pTfG2xBPc,1941
+odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/METADATA,sha256=P3yFZVMlwg_QU0cqTHKMHs3P88BPxz1jfplPsuNylSk,4988
+odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo14_addon_l10n_fr_fec_oca-14.0.2.0.0.dist-info/RECORD,,
```

